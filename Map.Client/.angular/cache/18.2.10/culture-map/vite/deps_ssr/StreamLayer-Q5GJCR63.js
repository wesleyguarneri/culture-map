import { createRequire } from 'module';const require = createRequire(import.meta.url);
import {
  c as c2
} from "./chunk-XUSZNRTW.js";
import "./chunk-W26QF64E.js";
import "./chunk-D3XX7CQS.js";
import {
  c
} from "./chunk-FALQTRQL.js";
import "./chunk-GGTDLTZW.js";
import "./chunk-2W7YKBRA.js";
import {
  s as s3
} from "./chunk-GLFGRGCP.js";
import {
  C,
  l as l4
} from "./chunk-VFQA3B5S.js";
import {
  l as l5
} from "./chunk-NOH3NLJ5.js";
import "./chunk-LX5BT6XP.js";
import "./chunk-PLGJMWC5.js";
import {
  p as p2
} from "./chunk-UGFQYEND.js";
import {
  e as e2
} from "./chunk-XC5RDNAY.js";
import {
  m,
  o as o4,
  u as u2
} from "./chunk-KXVPQVTB.js";
import "./chunk-ARN5GJBK.js";
import "./chunk-MPLS4PY6.js";
import "./chunk-AGBPYPP3.js";
import {
  U as U2
} from "./chunk-VMZV7772.js";
import "./chunk-3FR2T2I2.js";
import "./chunk-LOZRWPGI.js";
import "./chunk-GZ64OOAB.js";
import "./chunk-WR2NVDOI.js";
import "./chunk-EPLJRYUV.js";
import "./chunk-VYRCS5VR.js";
import {
  l as l3
} from "./chunk-PQUZDC3L.js";
import "./chunk-UUQ5O7GK.js";
import "./chunk-JTDKNK44.js";
import "./chunk-RR7OQLEK.js";
import "./chunk-NAG6YX7T.js";
import "./chunk-WFNAKG2H.js";
import "./chunk-EKHRAAS6.js";
import "./chunk-IEB4ZCRH.js";
import "./chunk-WVSTX2NW.js";
import {
  b as b2
} from "./chunk-ORYC4PVJ.js";
import "./chunk-DXIKKLD7.js";
import "./chunk-VQNXE43R.js";
import {
  y as y2
} from "./chunk-VZ37C3ID.js";
import "./chunk-5R3HARKC.js";
import "./chunk-BKSTWG4S.js";
import "./chunk-FSG7HOZQ.js";
import "./chunk-Q5TIVVER.js";
import "./chunk-ZPMUEGLK.js";
import "./chunk-GNFDYYU3.js";
import "./chunk-X36BR2QB.js";
import "./chunk-RGG3YJQA.js";
import "./chunk-GBJYL7OX.js";
import "./chunk-GHKVDSKU.js";
import "./chunk-NVOJILW6.js";
import {
  k as k2
} from "./chunk-KYPTWEOO.js";
import "./chunk-WVFB3H4O.js";
import "./chunk-C7BQE556.js";
import "./chunk-ZREJ3Y2F.js";
import "./chunk-IR6CVPPC.js";
import "./chunk-BBUQOCRA.js";
import "./chunk-YBUJLIWZ.js";
import {
  i
} from "./chunk-DL2B6IFJ.js";
import "./chunk-VOOO6FU5.js";
import "./chunk-IUPJR3FF.js";
import "./chunk-TGZW6QWO.js";
import "./chunk-OYIDHTXG.js";
import "./chunk-KUBMHTYA.js";
import "./chunk-E5NWFBZG.js";
import "./chunk-FP37456K.js";
import "./chunk-VSQZQLTQ.js";
import "./chunk-K43CZ3M5.js";
import "./chunk-6EIBUVMG.js";
import {
  t as t2
} from "./chunk-XCCMILGI.js";
import {
  A
} from "./chunk-NBJSAHZT.js";
import {
  j as j2
} from "./chunk-BD24XM4D.js";
import "./chunk-NXXQ35YM.js";
import "./chunk-3BXPVUY5.js";
import "./chunk-LM3JDV4W.js";
import "./chunk-34V2CLL5.js";
import "./chunk-CXNERL22.js";
import "./chunk-7V4JSBFA.js";
import {
  f as f4
} from "./chunk-REIMIECM.js";
import {
  l
} from "./chunk-EO2EW5KR.js";
import "./chunk-JEFPXTYT.js";
import "./chunk-MVS2BECH.js";
import {
  t as t3
} from "./chunk-UZ7IOCF3.js";
import {
  b
} from "./chunk-OS542PQQ.js";
import {
  j,
  l as l2,
  p,
  s as s2,
  t,
  u,
  y as y3
} from "./chunk-3B5GODXR.js";
import "./chunk-NKXXHQDD.js";
import {
  S
} from "./chunk-7TBQUMV3.js";
import {
  f as f3
} from "./chunk-TPLUZX3A.js";
import {
  h
} from "./chunk-BGLJ2FAH.js";
import "./chunk-2EJFYNM7.js";
import "./chunk-DC5LRNPY.js";
import "./chunk-ASCK5HJ5.js";
import "./chunk-5X5U7R6O.js";
import "./chunk-XNLAOXPY.js";
import "./chunk-ZT7V2AVD.js";
import "./chunk-C2OXE4NQ.js";
import "./chunk-KOI252FF.js";
import {
  g,
  p as p3
} from "./chunk-I2TVVMQ6.js";
import "./chunk-5EGQYY2H.js";
import "./chunk-JKPUNUQA.js";
import "./chunk-SR7PRON4.js";
import {
  o as o3
} from "./chunk-HGHPYGKP.js";
import "./chunk-4DSGTDZJ.js";
import "./chunk-VYTPFEL2.js";
import "./chunk-RLGDH6IY.js";
import "./chunk-MRPCXIVS.js";
import "./chunk-YTKVV2Y3.js";
import "./chunk-GCVQXAS4.js";
import "./chunk-UFQD6AL4.js";
import "./chunk-THZPD5CT.js";
import "./chunk-OBCA6CWH.js";
import "./chunk-2JI245BP.js";
import "./chunk-ZEZ3LI2L.js";
import "./chunk-N34BRXVM.js";
import "./chunk-KETDH2J4.js";
import "./chunk-7QV7DHWN.js";
import "./chunk-4L4Y34YK.js";
import "./chunk-BXONKQKI.js";
import "./chunk-2HDBQXAR.js";
import {
  w
} from "./chunk-RNF7VOCU.js";
import "./chunk-TIRJMGGG.js";
import {
  f as f2
} from "./chunk-ZDRQSPB6.js";
import {
  o as o2
} from "./chunk-DCXDXGAR.js";
import "./chunk-BCCDYCTQ.js";
import "./chunk-AYL3HQHD.js";
import "./chunk-66YQWHHE.js";
import "./chunk-QGBMZIP4.js";
import "./chunk-AOEBZVTA.js";
import "./chunk-2OZSYJDX.js";
import "./chunk-MZM4INJV.js";
import "./chunk-J4GMQHGL.js";
import "./chunk-MHPE4SZA.js";
import "./chunk-6SSA7P3A.js";
import "./chunk-FQBTLEUI.js";
import "./chunk-GS7Y3YOG.js";
import "./chunk-Y2HYKTTT.js";
import {
  U
} from "./chunk-XLEC46FY.js";
import {
  f
} from "./chunk-4AZPIP7K.js";
import "./chunk-G73HQZEL.js";
import "./chunk-LZSLQ24Q.js";
import "./chunk-U3RHUXYK.js";
import "./chunk-7DBI6LQG.js";
import "./chunk-AUUN7RFQ.js";
import "./chunk-JAMSDYD6.js";
import "./chunk-PH6NPTP7.js";
import {
  e
} from "./chunk-NUICEVIH.js";
import "./chunk-NXK752PZ.js";
import {
  y
} from "./chunk-UVNLCXWD.js";
import "./chunk-PNUA7JOS.js";
import "./chunk-OR2FKGUM.js";
import {
  N,
  a3
} from "./chunk-UDMPWVPF.js";
import "./chunk-XJNKCEWL.js";
import {
  a as a2,
  k
} from "./chunk-AIZ3T7E3.js";
import {
  o
} from "./chunk-6UEMNP3E.js";
import "./chunk-6WGE3IUL.js";
import "./chunk-MLYB2YW4.js";
import {
  a,
  n2 as n,
  s2 as s
} from "./chunk-6JFGZTLU.js";
import "./chunk-2ZJE6ZFX.js";
import {
  __async,
  __spreadValues
} from "./chunk-XBPEBUD5.js";

// ../../../node_modules/@arcgis/core/layers/support/PurgeOptions.js
var t4;
var i2 = t4 = class extends f {
  constructor() {
    super(...arguments), this.age = null, this.ageReceived = null, this.displayCount = null, this.maxObservations = 1;
  }
  clone() {
    return new t4({
      age: this.age,
      ageReceived: this.ageReceived,
      displayCount: this.displayCount,
      maxObservations: this.maxObservations
    });
  }
};
e([y({
  type: Number,
  json: {
    write: true
  }
})], i2.prototype, "age", void 0), e([y({
  type: Number,
  json: {
    write: true
  }
})], i2.prototype, "ageReceived", void 0), e([y({
  type: Number,
  json: {
    write: true
  }
})], i2.prototype, "displayCount", void 0), e([y({
  type: Number,
  json: {
    write: true
  }
})], i2.prototype, "maxObservations", void 0), i2 = t4 = e([a3("esri.layers.support.PurgeOptions")], i2);
var p4 = i2;

// ../../../node_modules/@arcgis/core/layers/StreamLayer.js
var Y = s3();
function Z(e3, t5) {
  return new s("layer:unsupported", `Layer (${e3.title}, ${e3.id}) of type '${e3.declaredClass}' ${t5}`, {
    layer: e3
  });
}
var ee = class extends c2(c(l(l5(t3(f4(l3(b(j2(S(e2(i(f3)))))))))))) {
  constructor(...e3) {
    super(...e3), this.copyright = null, this.definitionExpression = null, this.displayField = null, this.elevationInfo = null, this.fields = null, this.fieldsIndex = null, this.geometryDefinition = null, this.geometryType = null, this.labelsVisible = true, this.labelingInfo = null, this.legendEnabled = true, this.maxReconnectionAttempts = 0, this.maxReconnectionInterval = 20, this.maxScale = 0, this.minScale = 0, this.objectIdField = null, this.operationalLayerType = "ArcGISStreamLayer", this.outFields = ["*"], this.popupEnabled = true, this.popupTemplate = null, this.purgeOptions = new p4(), this.refreshInterval = 0, this.screenSizePerspectiveEnabled = true, this.sourceJSON = null, this.spatialReference = f2.WGS84, this.type = "stream", this.url = null, this.updateInterval = 300, this.useViewTime = true, this.webSocketUrl = null, this._debouncedSaveOperations = k((e4, t5, r) => __async(this, null, function* () {
      const {
        save: i3,
        saveAs: o5
      } = yield import("./streamLayerUtils-2CISVEEJ.js");
      switch (e4) {
        case A.SAVE:
          return i3(this, t5);
        case A.SAVE_AS:
          return o5(this, r, t5);
      }
    }));
  }
  normalizeCtorArgs(e3, t5) {
    return "string" == typeof e3 ? __spreadValues({
      url: e3
    }, t5) : e3;
  }
  load(e3) {
    if (!("WebSocket" in globalThis)) return this.addResolvingPromise(Promise.reject(new s("stream-layer:websocket-unsupported", "WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))), Promise.resolve(this);
    const t5 = null != e3 ? e3.signal : null;
    return this.addResolvingPromise(this.loadFromPortal({
      supportedTypes: ["Stream Service", "Feed"]
    }, e3).catch(a2).then(() => this._fetchService(t5))), Promise.resolve(this);
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set featureReduction(e3) {
    const t5 = this._normalizeFeatureReduction(e3);
    this._set("featureReduction", t5);
  }
  set renderer(e3) {
    p3(e3, this.fieldsIndex), this._set("renderer", e3);
  }
  readRenderer(e3, t5, i3) {
    t5 = t5.layerDefinition || t5;
    const o5 = t5.drawingInfo?.renderer;
    if (o5) {
      const e4 = o4(o5, t5, i3) || void 0;
      return e4 || n.getLogger(this).error("Failed to create renderer", {
        rendererDefinition: t5.drawingInfo.renderer,
        layer: this,
        context: i3
      }), e4;
    }
    return U2(t5, i3);
  }
  connect(e3) {
    return __async(this, null, function* () {
      const [{
        createConnection: t5
      }] = yield Promise.all([import("./createConnection-TWLGMONR.js"), this.load()]), r = this.geometryType ? o3.toJSON(this.geometryType) : null, {
        customParameters: i3 = null,
        definitionExpression: o5 = null,
        geometryDefinition: s4 = null,
        maxReconnectionAttempts: n2 = 0,
        maxReconnectionInterval: a4 = 20,
        spatialReference: l6 = this.spatialReference
      } = e3 || this.createConnectionParameters(), d = t5(this.parsedUrl, this.spatialReference, l6, r, o5, s4, n2, a4, i3 ?? void 0), m2 = o([this.on("send-message-to-socket", (e4) => d.sendMessageToSocket(e4)), this.on("send-message-to-client", (e4) => d.sendMessageToClient(e4))]);
      return d.once("destroy", m2.remove), d;
    });
  }
  createConnectionParameters() {
    return {
      spatialReference: this.spatialReference,
      customParameters: this.customParameters,
      definitionExpression: this.definitionExpression,
      geometryDefinition: this.geometryDefinition,
      maxReconnectionAttempts: this.maxReconnectionAttempts,
      maxReconnectionInterval: this.maxReconnectionInterval
    };
  }
  createPopupTemplate(e3) {
    return p2(this, e3);
  }
  createQuery() {
    const e3 = new b2();
    return e3.returnGeometry = true, e3.outFields = ["*"], e3.where = this.definitionExpression || "1=1", e3;
  }
  getFieldDomain(e3, t5) {
    if (!this.fields) return null;
    let r = null;
    return this.fields.some((t6) => (t6.name === e3 && (r = t6.domain), !!r)), r;
  }
  getField(e3) {
    return this.fieldsIndex.get(e3);
  }
  serviceSupportsSpatialReference(e3) {
    return true;
  }
  sendMessageToSocket(e3) {
    this.emit("send-message-to-socket", e3);
  }
  sendMessageToClient(e3) {
    this.emit("send-message-to-client", e3);
  }
  save(e3) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE, e3);
    });
  }
  saveAs(e3, t5) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE_AS, t5, e3);
    });
  }
  write(e3, t5) {
    const r = t5?.messages;
    return this.webSocketUrl ? (r?.push(Z(this, "using a custom websocket connection cannot be written to web scenes and web maps")), null) : this.parsedUrl ? super.write(e3, t5) : (r?.push(Z(this, "using a client-side only connection without a url cannot be written to web scenes and web maps")), null);
  }
  _fetchService(e3) {
    return __async(this, null, function* () {
      if (!!!this.webSocketUrl && this.parsedUrl) {
        if (!this.sourceJSON) {
          const {
            data: t5
          } = yield U(this.parsedUrl.path, {
            query: __spreadValues(__spreadValues({
              f: "json"
            }, this.customParameters), this.parsedUrl.query),
            responseType: "json",
            signal: e3
          });
          this.sourceJSON = t5;
        }
      } else {
        if (!this.timeInfo?.trackIdField) throw new s("stream-layer:missing-metadata", "The stream layer trackIdField must be specified.");
        if (!this.objectIdField) {
          const e4 = this.fields.find((e5) => "oid" === e5.type)?.name;
          if (!e4) throw new s("stream-layer:missing-metadata", "The stream layer objectIdField must be specified.");
          this.objectIdField = e4;
        }
        if (!this.fields) throw new s("stream-layer:missing-metadata", "The stream layer fields must be specified.");
        if (this.fields.some((e4) => e4.name === this.objectIdField) || this.fields.push(new y2({
          name: this.objectIdField,
          alias: this.objectIdField,
          type: "oid"
        })), !this.geometryType) throw new s("stream-layer:missing-metadata", "The stream layer geometryType must be specified.");
        this.webSocketUrl && (this.url = this.webSocketUrl);
      }
      return this.read(this.sourceJSON, {
        origin: "service",
        portalItem: this.portalItem,
        portal: this.portalItem?.portal,
        url: this.parsedUrl
      }), p3(this.renderer, this.fieldsIndex), g(this.timeInfo, this.fieldsIndex), this.objectIdField || (this.objectIdField = "__esri_stream_id__"), t2(this, {
        origin: "service"
      });
    });
  }
};
e([y({
  type: String
})], ee.prototype, "copyright", void 0), e([y({
  readOnly: true
})], ee.prototype, "defaultPopupTemplate", null), e([y({
  type: String,
  json: {
    name: "layerDefinition.definitionExpression",
    write: {
      enabled: true,
      allowNull: true
    }
  }
})], ee.prototype, "definitionExpression", void 0), e([y({
  type: String
})], ee.prototype, "displayField", void 0), e([y({
  type: h
})], ee.prototype, "elevationInfo", void 0), e([y({
  json: {
    origins: {
      "web-map": {
        read: false,
        write: false
      },
      "portal-item": {
        read: false,
        write: false
      },
      "web-scene": {
        read: false,
        write: false
      }
    }
  }
})], ee.prototype, "featureReduction", null), e([y(Y.fields)], ee.prototype, "fields", void 0), e([y(Y.fieldsIndex)], ee.prototype, "fieldsIndex", void 0), e([y({
  type: w,
  json: {
    name: "layerDefinition.definitionGeometry",
    write: true
  }
})], ee.prototype, "geometryDefinition", void 0), e([y({
  type: o3.apiValues,
  json: {
    read: {
      reader: o3.read
    }
  }
})], ee.prototype, "geometryType", void 0), e([y(l2)], ee.prototype, "labelsVisible", void 0), e([y({
  type: [C],
  json: {
    name: "layerDefinition.drawingInfo.labelingInfo",
    read: {
      reader: l4
    },
    write: true
  }
})], ee.prototype, "labelingInfo", void 0), e([y(y3)], ee.prototype, "legendEnabled", void 0), e([y({
  type: ["show", "hide"],
  json: {
    origins: {
      "portal-item": {
        read: false,
        write: false
      }
    }
  }
})], ee.prototype, "listMode", void 0), e([y({
  type: N
})], ee.prototype, "maxReconnectionAttempts", void 0), e([y({
  type: N
})], ee.prototype, "maxReconnectionInterval", void 0), e([y(j)], ee.prototype, "maxScale", void 0), e([y(u)], ee.prototype, "minScale", void 0), e([y({
  type: String
})], ee.prototype, "objectIdField", void 0), e([y({
  value: "ArcGISStreamLayer",
  type: ["ArcGISStreamLayer"]
})], ee.prototype, "operationalLayerType", void 0), e([y({
  readOnly: true
})], ee.prototype, "outFields", void 0), e([y(s2)], ee.prototype, "popupEnabled", void 0), e([y({
  type: k2,
  json: {
    name: "popupInfo",
    write: true
  }
})], ee.prototype, "popupTemplate", void 0), e([y({
  type: p4
})], ee.prototype, "purgeOptions", void 0), e([y({
  json: {
    read: false,
    write: false
  }
})], ee.prototype, "refreshInterval", void 0), e([y({
  types: m,
  json: {
    origins: {
      service: {
        write: {
          target: "drawingInfo.renderer",
          enabled: false
        }
      },
      "web-scene": {
        name: "layerDefinition.drawingInfo.renderer",
        types: u2,
        write: true
      }
    },
    write: {
      target: "layerDefinition.drawingInfo.renderer"
    }
  }
})], ee.prototype, "renderer", null), e([o2("service", "renderer", ["drawingInfo.renderer", "defaultSymbol"]), o2("renderer", ["layerDefinition.drawingInfo.renderer", "layerDefinition.defaultSymbol"])], ee.prototype, "readRenderer", null), e([y((() => {
  const e3 = a(t);
  return e3.json.origins["portal-item"] = {
    read: false,
    write: false
  }, e3;
})())], ee.prototype, "screenSizePerspectiveEnabled", void 0), e([y()], ee.prototype, "sourceJSON", void 0), e([y({
  type: f2,
  json: {
    origins: {
      service: {
        read: {
          source: "spatialReference"
        }
      }
    }
  }
})], ee.prototype, "spatialReference", void 0), e([y({
  json: {
    read: false
  }
})], ee.prototype, "type", void 0), e([y(p)], ee.prototype, "url", void 0), e([y({
  type: Number
})], ee.prototype, "updateInterval", void 0), e([y({
  json: {
    read: false,
    write: false
  }
})], ee.prototype, "useViewTime", void 0), e([y({
  type: String
})], ee.prototype, "webSocketUrl", void 0), ee = e([a3("esri.layers.StreamLayer")], ee);
var te = ee;
export {
  te as default
};
//# sourceMappingURL=StreamLayer-Q5GJCR63.js.map
