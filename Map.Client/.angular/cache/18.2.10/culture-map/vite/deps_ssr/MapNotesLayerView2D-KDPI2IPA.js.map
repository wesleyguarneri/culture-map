{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/2d/layers/MapNotesLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as i } from \"../../../chunks/tslib.es6.js\";\nimport e from \"../../../Graphic.js\";\nimport { isSome as s } from \"../../../core/arrayUtils.js\";\nimport t from \"../../../core/Collection.js\";\nimport { makeHandle as r } from \"../../../core/handleUtils.js\";\nimport { watch as h, on as a, initial as o } from \"../../../core/reactiveUtils.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/Error.js\";\nimport { subclass as l } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { getHighlightBits as n } from \"../engine/highlightReasons.js\";\nimport { LayerView2DMixin as c } from \"./LayerView2D.js\";\nimport p from \"./graphics/GraphicContainer.js\";\nimport g from \"./graphics/GraphicsView2D.js\";\nimport d from \"../../layers/LayerView.js\";\nconst u = \"sublayers\",\n  f = \"layerView\";\nlet m = class extends c(d) {\n  constructor() {\n    super(...arguments), this._highlightIds = new Map();\n  }\n  *graphicsViews() {\n    null == this._graphicsViewsFeatureCollectionMap ? null == this._graphicsViews ? yield* [] : yield* this._graphicsViews : yield* this._graphicsViewsFeatureCollectionMap.keys();\n  }\n  async hitTest(i, e) {\n    return Array.from(this.graphicsViews(), e => {\n      const s = e.hitTest(i);\n      if (null != this._graphicsViewsFeatureCollectionMap) {\n        const i = this._graphicsViewsFeatureCollectionMap.get(e);\n        for (const e of s) !e.popupTemplate && i.popupTemplate && (e.popupTemplate = i.popupTemplate), e.sourceLayer = e.layer = this.layer;\n      }\n      return s;\n    }).flat().map(e => ({\n      type: \"graphic\",\n      graphic: e,\n      layer: this.layer,\n      mapPoint: i\n    }));\n  }\n  highlight(i) {\n    let h;\n    \"number\" == typeof i ? h = [i] : i instanceof e ? h = [i.uid] : Array.isArray(i) && i.length > 0 ? h = \"number\" == typeof i[0] ? i : i.map(i => i && i.uid) : t.isCollection(i) && (h = i.map(i => i && i.uid).toArray());\n    const a = h?.filter(s);\n    return a?.length ? (this._addHighlight(a), r(() => this._removeHighlight(a))) : r();\n  }\n  update(i) {\n    for (const e of this.graphicsViews()) e.processUpdate(i);\n  }\n  attach() {\n    const i = this.view,\n      e = () => this.requestUpdate(),\n      s = this.layer.featureCollections;\n    if (null != s && s.length) {\n      this._graphicsViewsFeatureCollectionMap = new Map();\n      for (const t of s) {\n        const s = new p(this.view.featuresTilingScheme),\n          r = new g({\n            view: i,\n            graphics: t.source,\n            renderer: t.renderer,\n            requestUpdateCallback: e,\n            container: s\n          });\n        this._graphicsViewsFeatureCollectionMap.set(r, t), this.container.addChild(r.container), this.addHandles([h(() => t.visible, i => r.container.visible = i, o), h(() => r.updating, () => this.notifyChange(\"updating\"), o)], f);\n      }\n      this._updateHighlight();\n    } else null != this.layer.sublayers && this.addHandles(a(() => this.layer.sublayers, \"change\", () => this._createGraphicsViews(), {\n      onListenerAdd: () => this._createGraphicsViews(),\n      onListenerRemove: () => this._destroyGraphicsViews()\n    }), u);\n  }\n  detach() {\n    this._destroyGraphicsViews(), this.removeHandles(u);\n  }\n  moveEnd() {}\n  viewChange() {\n    for (const i of this.graphicsViews()) i.viewChange();\n  }\n  isUpdating() {\n    for (const i of this.graphicsViews()) if (i.updating) return !0;\n    return !1;\n  }\n  _destroyGraphicsViews() {\n    this.container.removeAllChildren(), this.removeHandles(f);\n    for (const i of this.graphicsViews()) i.destroy();\n    this._graphicsViews = null, this._graphicsViewsFeatureCollectionMap = null;\n  }\n  _createGraphicsViews() {\n    if (this._destroyGraphicsViews(), null == this.layer.sublayers) return;\n    const i = [],\n      e = this.view,\n      s = () => this.requestUpdate();\n    for (const t of this.layer.sublayers) {\n      const r = new p(this.view.featuresTilingScheme);\n      r.fadeTransitionEnabled = !0;\n      const a = new g({\n        view: e,\n        graphics: t.graphics,\n        requestUpdateCallback: s,\n        container: r\n      });\n      this.addHandles([t.on(\"graphic-update\", a.graphicUpdateHandler), h(() => t.visible, i => a.container.visible = i, o), h(() => a.updating, () => this.notifyChange(\"updating\"), o)], f), this.container.addChild(a.container), i.push(a);\n    }\n    this._graphicsViews = i, this._updateHighlight();\n  }\n  _addHighlight(i) {\n    for (const e of i) if (this._highlightIds.has(e)) {\n      const i = this._highlightIds.get(e);\n      this._highlightIds.set(e, i + 1);\n    } else this._highlightIds.set(e, 1);\n    this._updateHighlight();\n  }\n  _removeHighlight(i) {\n    for (const e of i) if (this._highlightIds.has(e)) {\n      const i = this._highlightIds.get(e) - 1;\n      0 === i ? this._highlightIds.delete(e) : this._highlightIds.set(e, i);\n    }\n    this._updateHighlight();\n  }\n  _updateHighlight() {\n    const i = Array.from(this._highlightIds.keys()),\n      e = n(\"highlight\");\n    for (const s of this.graphicsViews()) s.setHighlight(i.map(i => ({\n      objectId: i,\n      highlightFlags: e\n    })));\n  }\n};\nm = i([l(\"esri.views.2d.layers.MapNotesLayerView2D\")], m);\nconst w = m;\nexport { w as default };"],
  "mappings": "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",
  "names": ["f", "e", "i", "d", "a", "t", "s", "V"]
}
