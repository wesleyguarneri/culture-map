{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/geometry/projection/localLinearScaleFactors.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/LayerElevationProvider.js", "../../../../../../node_modules/@arcgis/core/views/3d/webgl-engine/collections/Component/ObjectParameters.js", "../../../../../../node_modules/@arcgis/core/views/3d/webgl-engine/collections/Component/Transform.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { l as r } from \"../../chunks/vec32.js\";\nimport { classifySpatialReference as t, sourceClassificationCache as s, destClassificationCache as o, ProjectionID as i, invPlateCarreeScale as n } from \"./projectors.js\";\nimport { earth as e } from \"../support/Ellipsoid.js\";\nimport { equals as u } from \"../support/spatialReferenceUtils.js\";\nfunction f(f, p, E, c) {\n  if (null == p || null == c) return !1;\n  const l = t(p, s),\n    C = t(c, o);\n  if (l === C && l !== i.UNKNOWN || u(p, c)) return E[0] = 1, E[1] = 1, E[2] = 1, !0;\n  if (l === i.SPHERICAL_ECEF) {\n    const t = r(f),\n      s = t / Math.sqrt(f[0] * f[0] + f[1] * f[1]),\n      o = t / e.radius;\n    if (C === i.WEB_MERCATOR) return E[0] = s * o, E[1] = s * o, E[2] = 1, !0;\n    if (C === i.WGS84 || C === i.CGCS2000) {\n      const r = n;\n      return E[0] = r * s * o, E[1] = r * o, E[2] = 1, !0;\n    }\n  } else if (l === i.PLATE_CARREE) {\n    if (C === i.WGS84 || C === i.CGCS2000) return E[0] = n, E[1] = n, E[2] = 1, !0;\n    if (C === i.WEB_MERCATOR) {\n      const r = f[1] / e.radius;\n      return E[0] = 1, E[1] = 1 / Math.cos(r), E[2] = 1, !0;\n    }\n  }\n  return !1;\n}\nexport { f as localLinearScaleFactors };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Accessor.js\";\nimport r from \"../../../../core/Evented.js\";\nimport o from \"../../../../core/Logger.js\";\nimport { property as n } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as i } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { fromQuat as s } from \"../../../../core/libs/gl-matrix-2/math/mat4.js\";\nimport { create as a } from \"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";\nimport { s as l, h as c } from \"../../../../chunks/vec32.js\";\nimport { create as p } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { projectBoundingSphere as m } from \"../../../../geometry/projection/projectBoundingSphere.js\";\nimport { empty as u, expand as h } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { f as d } from \"../../../../chunks/sphere.js\";\nimport { ElevationRange as f } from \"../../support/ElevationRange.js\";\nimport { ElevationUpdateEvent as v } from \"../../support/ElevationUpdateEvent.js\";\nimport { newIntersector as g } from \"../../webgl-engine/lib/Intersector.js\";\nimport { StoreResults as E } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nlet x = class extends r.EventedMixin(t) {\n  constructor(e) {\n    super(e), this._tmpEvent = new v(), this._renderCoordsHelper = e.view.renderCoordsHelper, this._renderSR = this._renderCoordsHelper.spatialReference, this._layerElevationSource = e.layerElevationSource;\n  }\n  initialize() {\n    this._intersector = g(this.view.state.viewingMode), this._intersector.options.store = E.MIN, this._intersector.options.normalRequired = !1, this._tmpEvent.context = this.intersectionHandler.isGround ? \"ground\" : \"scene\";\n  }\n  get spatialReference() {\n    return this.view?.elevationProvider?.spatialReference;\n  }\n  getElevation(e, t, r, n) {\n    const i = this._renderCoordsHelper,\n      s = l(R, e, t, r);\n    if (!i.toRenderCoords(s, n, s)) return o.getLogger(this).error(\"could not project point to compute elevation\"), null;\n    const {\n        layerElevationSource: a,\n        _intersector: c,\n        intersectionHandler: p\n      } = this,\n      m = a.fullExtent,\n      u = null != m && Number.isFinite(m.xmin) && Number.isFinite(m.xmax) && Number.isFinite(m.ymin) && Number.isFinite(m.ymax) && Number.isFinite(m.zmin) && Number.isFinite(m.zmax) ? new f(m.zmin, m.zmax) : a.elevationRange;\n    if (null == u) return null;\n    const h = a.elevationOffset,\n      d = u.elevationRangeMin + h,\n      v = u.elevationRangeMax + h,\n      g = i.setAltitude(y, v, s),\n      E = i.setAltitude(b, d, s);\n    return c.reset(g, E, null), p.intersect(c, null, g, E, null, !0), c.results.min.getIntersectionPoint(s) ? i.getAltitude(s) : null;\n  }\n  getSphereElevationBounds(e, t) {\n    return m(e, t, j, this._renderSR), this._layerElevationSource.getElevationRange(j);\n  }\n  getRootElevationBounds() {\n    const e = this.layerElevationSource.fullExtent;\n    return e?.hasZ ? new f(e.zmin, e.zmax) : null;\n  }\n  objectsChanged(e) {\n    this.spatialReference && (this._computeLayerExtent(e, this._tmpEvent.extent), this._tmpEvent.spatialReference = this.spatialReference, this.emit(\"elevation-change\", this._tmpEvent));\n  }\n  objectChanged(e) {\n    this.spatialReference && (this._computeObjectExtent(e, this._tmpEvent.extent), this._tmpEvent.spatialReference = this.spatialReference, this.emit(\"elevation-change\", this._tmpEvent));\n  }\n  _computeObjectExtent(e, t) {\n    u(t), this._expandExtent(e, t);\n  }\n  _computeLayerExtent(e, t) {\n    u(t);\n    for (const r of e) this._expandExtent(r, t);\n  }\n  _expandExtent(e, t) {\n    const r = this.spatialReference;\n    if (null == r) return;\n    if (null == e) return;\n    s(_, e.quaternion), _[12] = e.center[0], _[13] = e.center[1], _[14] = e.center[2];\n    const o = e.halfSize;\n    for (let n = 0; n < 8; ++n) R[0] = 1 & n ? o[0] : -o[0], R[1] = 2 & n ? o[1] : -o[1], R[2] = 4 & n ? o[2] : -o[2], c(R, R, _), this._renderCoordsHelper.fromRenderCoords(R, R, r), h(t, R, t);\n  }\n};\ne([n({\n  constructOnly: !0\n})], x.prototype, \"layerElevationSource\", void 0), e([n({\n  constructOnly: !0\n})], x.prototype, \"intersectionHandler\", void 0), e([n({\n  constructOnly: !0\n})], x.prototype, \"view\", void 0), e([n()], x.prototype, \"spatialReference\", null), x = e([i(\"esri.views.3d.layers.i3s.LayerElevationProvider\")], x);\nconst _ = a(),\n  j = d(0, 0, 0, 0),\n  R = p(),\n  y = p(),\n  b = p();\nexport { x as LayerElevationProvider };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nclass t {\n  constructor(t, s, o, r) {\n    this.toMapSpace = t, this.transform = s, this.obb = o, this.geometry = r;\n  }\n}\nexport { t as ObjectParameters };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nclass i {\n  constructor(i, o) {\n    this.position = i, this.rotationScale = o, this.origin = void 0;\n  }\n}\nexport { i as Transform };"],
  "mappings": "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",
  "names": ["f", "t", "s", "o", "e", "t", "n", "i", "s", "o", "a", "m", "y", "_", "t", "s", "o", "i", "o"]
}
