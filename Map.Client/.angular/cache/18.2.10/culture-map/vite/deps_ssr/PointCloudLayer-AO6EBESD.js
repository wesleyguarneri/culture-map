import { createRequire } from 'module';const require = createRequire(import.meta.url);
import {
  a as a4,
  a2 as a5,
  a3 as a6,
  d as d2
} from "./chunk-MTXTLDZX.js";
import {
  C,
  L
} from "./chunk-N2GJ34YR.js";
import "./chunk-IZJSB4V4.js";
import {
  $,
  Z,
  w
} from "./chunk-ZSJNH2BT.js";
import {
  i
} from "./chunk-JA5GJ7PX.js";
import {
  s as s3
} from "./chunk-GLFGRGCP.js";
import {
  p
} from "./chunk-UGFQYEND.js";
import {
  e as e3
} from "./chunk-XC5RDNAY.js";
import "./chunk-VFYCIIDC.js";
import {
  l
} from "./chunk-PQUZDC3L.js";
import "./chunk-WVSTX2NW.js";
import {
  y as y2
} from "./chunk-VZ37C3ID.js";
import "./chunk-5R3HARKC.js";
import "./chunk-Q5TIVVER.js";
import {
  i4 as i2,
  k
} from "./chunk-KYPTWEOO.js";
import "./chunk-WVFB3H4O.js";
import "./chunk-DL2B6IFJ.js";
import "./chunk-KUBMHTYA.js";
import {
  o as o2
} from "./chunk-6EIBUVMG.js";
import "./chunk-FEZPDSKY.js";
import "./chunk-X4WQKYPS.js";
import "./chunk-VDKX5QNO.js";
import "./chunk-JDVVCQU6.js";
import "./chunk-AKRJ5ORG.js";
import {
  j
} from "./chunk-BD24XM4D.js";
import "./chunk-XU6JZUMA.js";
import "./chunk-3BXPVUY5.js";
import "./chunk-LM3JDV4W.js";
import "./chunk-34V2CLL5.js";
import "./chunk-CXNERL22.js";
import "./chunk-7V4JSBFA.js";
import {
  t
} from "./chunk-UZ7IOCF3.js";
import {
  b
} from "./chunk-OS542PQQ.js";
import {
  d,
  s as s2,
  y as y3
} from "./chunk-3B5GODXR.js";
import "./chunk-NKXXHQDD.js";
import {
  S
} from "./chunk-7TBQUMV3.js";
import {
  f as f2
} from "./chunk-TPLUZX3A.js";
import "./chunk-BGLJ2FAH.js";
import "./chunk-2EJFYNM7.js";
import "./chunk-DC5LRNPY.js";
import "./chunk-ASCK5HJ5.js";
import "./chunk-5X5U7R6O.js";
import "./chunk-XNLAOXPY.js";
import "./chunk-C2OXE4NQ.js";
import "./chunk-I2TVVMQ6.js";
import "./chunk-5EGQYY2H.js";
import "./chunk-JKPUNUQA.js";
import "./chunk-SR7PRON4.js";
import "./chunk-HGHPYGKP.js";
import "./chunk-4DSGTDZJ.js";
import "./chunk-RLGDH6IY.js";
import "./chunk-MRPCXIVS.js";
import "./chunk-YTKVV2Y3.js";
import "./chunk-GCVQXAS4.js";
import "./chunk-UFQD6AL4.js";
import "./chunk-EGBDRLCX.js";
import "./chunk-THZPD5CT.js";
import "./chunk-OBCA6CWH.js";
import "./chunk-2JI245BP.js";
import "./chunk-ZEZ3LI2L.js";
import "./chunk-N34BRXVM.js";
import "./chunk-557VKXWR.js";
import "./chunk-KETDH2J4.js";
import "./chunk-7QV7DHWN.js";
import "./chunk-4L4Y34YK.js";
import "./chunk-BXONKQKI.js";
import "./chunk-2HDBQXAR.js";
import "./chunk-RNF7VOCU.js";
import "./chunk-TIRJMGGG.js";
import "./chunk-ZDRQSPB6.js";
import {
  o
} from "./chunk-DCXDXGAR.js";
import {
  r
} from "./chunk-BCCDYCTQ.js";
import "./chunk-AYL3HQHD.js";
import "./chunk-66YQWHHE.js";
import "./chunk-QGBMZIP4.js";
import "./chunk-AOEBZVTA.js";
import "./chunk-2OZSYJDX.js";
import "./chunk-MZM4INJV.js";
import "./chunk-J4GMQHGL.js";
import "./chunk-MHPE4SZA.js";
import "./chunk-6SSA7P3A.js";
import "./chunk-FQBTLEUI.js";
import "./chunk-GS7Y3YOG.js";
import "./chunk-Y2HYKTTT.js";
import {
  U,
  V
} from "./chunk-XLEC46FY.js";
import {
  f
} from "./chunk-4AZPIP7K.js";
import "./chunk-U3RHUXYK.js";
import "./chunk-7DBI6LQG.js";
import "./chunk-AUUN7RFQ.js";
import "./chunk-JAMSDYD6.js";
import "./chunk-PH6NPTP7.js";
import {
  e as e2
} from "./chunk-NUICEVIH.js";
import "./chunk-NXK752PZ.js";
import {
  y
} from "./chunk-UVNLCXWD.js";
import "./chunk-PNUA7JOS.js";
import "./chunk-OR2FKGUM.js";
import {
  N,
  a3
} from "./chunk-UDMPWVPF.js";
import "./chunk-XJNKCEWL.js";
import {
  a as a2
} from "./chunk-AIZ3T7E3.js";
import "./chunk-6UEMNP3E.js";
import "./chunk-6WGE3IUL.js";
import "./chunk-MLYB2YW4.js";
import {
  a,
  e,
  n2 as n,
  s2 as s
} from "./chunk-6JFGZTLU.js";
import "./chunk-2ZJE6ZFX.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-XBPEBUD5.js";

// ../../../node_modules/@arcgis/core/layers/pointCloudFilters/PointCloudFilter.js
var t2 = class extends f {
  constructor(o3) {
    super(o3), this.field = null, this.type = null;
  }
  clone() {
    return console.warn(".clone() is not implemented for " + this.declaredClass), null;
  }
};
e2([y({
  type: String,
  json: {
    write: {
      enabled: true,
      isRequired: true
    }
  }
})], t2.prototype, "field", void 0), e2([y({
  readOnly: true,
  nonNullable: true,
  json: {
    read: false
  }
})], t2.prototype, "type", void 0), t2 = e2([a3("esri.layers.pointCloudFilters.PointCloudFilter")], t2);
var l2 = t2;

// ../../../node_modules/@arcgis/core/layers/pointCloudFilters/PointCloudBitfieldFilter.js
var d3;
var p2 = d3 = class extends l2 {
  constructor(e5) {
    super(e5), this.requiredClearBits = null, this.requiredSetBits = null, this.type = "bitfield";
  }
  clone() {
    return new d3({
      field: this.field,
      requiredClearBits: a(this.requiredClearBits),
      requiredSetBits: a(this.requiredSetBits)
    });
  }
};
e2([y({
  type: [N],
  json: {
    write: {
      enabled: true,
      overridePolicy() {
        return {
          enabled: true,
          isRequired: !this.requiredSetBits
        };
      }
    }
  }
})], p2.prototype, "requiredClearBits", void 0), e2([y({
  type: [N],
  json: {
    write: {
      enabled: true,
      overridePolicy() {
        return {
          enabled: true,
          isRequired: !this.requiredClearBits
        };
      }
    }
  }
})], p2.prototype, "requiredSetBits", void 0), e2([o2({
  pointCloudBitfieldFilter: "bitfield"
})], p2.prototype, "type", void 0), p2 = d3 = e2([a3("esri.layers.pointCloudFilters.PointCloudBitfieldFilter")], p2);
var u = p2;

// ../../../node_modules/@arcgis/core/layers/pointCloudFilters/PointCloudReturnFilter.js
var n2;
var p3 = n2 = class extends l2 {
  constructor(r2) {
    super(r2), this.includedReturns = [], this.type = "return";
  }
  clone() {
    return new n2({
      field: this.field,
      includedReturns: a(this.includedReturns)
    });
  }
};
e2([y({
  type: [["firstOfMany", "last", "lastOfMany", "single"]],
  json: {
    write: {
      enabled: true,
      isRequired: true
    }
  }
})], p3.prototype, "includedReturns", void 0), e2([o2({
  pointCloudReturnFilter: "return"
})], p3.prototype, "type", void 0), p3 = n2 = e2([a3("esri.layers.pointCloudFilters.PointCloudReturnFilter")], p3);
var u2 = p3;

// ../../../node_modules/@arcgis/core/layers/pointCloudFilters/PointCloudValueFilter.js
var l3;
var p4 = l3 = class extends l2 {
  constructor(e5) {
    super(e5), this.mode = "exclude", this.type = "value", this.values = [];
  }
  clone() {
    return new l3({
      field: this.field,
      mode: this.mode,
      values: a(this.values)
    });
  }
};
e2([y({
  type: ["exclude", "include"],
  json: {
    write: {
      enabled: true,
      isRequired: true
    }
  }
})], p4.prototype, "mode", void 0), e2([o2({
  pointCloudValueFilter: "value"
})], p4.prototype, "type", void 0), e2([y({
  type: [Number],
  json: {
    write: {
      enabled: true,
      isRequired: true
    }
  }
})], p4.prototype, "values", void 0), p4 = l3 = e2([a3("esri.layers.pointCloudFilters.PointCloudValueFilter")], p4);
var u3 = p4;

// ../../../node_modules/@arcgis/core/layers/pointCloudFilters/typeUtils.js
var e4 = {
  key: "type",
  base: l2,
  typeMap: {
    value: u3,
    bitfield: u,
    return: u2
  }
};

// ../../../node_modules/@arcgis/core/renderers/PointCloudRGBRenderer.js
var p5;
var c = p5 = class extends a4 {
  constructor(r2) {
    super(r2), this.type = "point-cloud-rgb", this.field = null;
  }
  clone() {
    return new p5(__spreadProps(__spreadValues({}, this.cloneProperties()), {
      field: a(this.field)
    }));
  }
};
e2([o2({
  pointCloudRGBRenderer: "point-cloud-rgb"
})], c.prototype, "type", void 0), e2([y({
  type: String,
  json: {
    write: true
  }
})], c.prototype, "field", void 0), c = p5 = e2([a3("esri.renderers.PointCloudRGBRenderer")], c);
var n3 = c;

// ../../../node_modules/@arcgis/core/renderers/support/pointCloud/typeUtils.js
var i3 = {
  key: "type",
  base: a4,
  typeMap: {
    "point-cloud-class-breaks": d2,
    "point-cloud-rgb": n3,
    "point-cloud-stretch": a5,
    "point-cloud-unique-value": a6
  },
  errorContext: "renderer"
};

// ../../../node_modules/@arcgis/core/layers/PointCloudLayer.js
var O = s3();
var V2 = class extends L(l(b(j(t(S(e3(i(f2)))))))) {
  constructor(...e5) {
    super(...e5), this.operationalLayerType = "PointCloudLayer", this.popupEnabled = true, this.popupTemplate = null, this.opacity = 1, this.filters = [], this.fields = null, this.fieldsIndex = null, this.outFields = null, this.path = null, this.legendEnabled = true, this.renderer = null, this.type = "point-cloud";
  }
  normalizeCtorArgs(e5, r2) {
    return "string" == typeof e5 ? __spreadValues({
      url: e5
    }, r2) : e5;
  }
  get defaultPopupTemplate() {
    return this.attributeStorageInfo ? this.createPopupTemplate() : null;
  }
  getFieldDomain(e5) {
    const r2 = this.fieldsIndex.get(e5);
    return r2?.domain ? r2.domain : null;
  }
  readServiceFields(e5, r2, t3) {
    return Array.isArray(e5) ? e5.map((e6) => {
      const r3 = new y2();
      return "FieldTypeInteger" === e6.type && ((e6 = a(e6)).type = "esriFieldTypeInteger"), r3.read(e6, t3), r3;
    }) : Array.isArray(r2.attributeStorageInfo) ? r2.attributeStorageInfo.map((e6) => new y2({
      name: e6.name,
      type: "ELEVATION" === e6.name ? "double" : "integer"
    })) : null;
  }
  set elevationInfo(e5) {
    this._set("elevationInfo", e5), this._validateElevationInfo();
  }
  writeRenderer(e5, r2, t3, o3) {
    e("layerDefinition.drawingInfo.renderer", e5.write({}, o3), r2);
  }
  load(e5) {
    const r2 = null != e5 ? e5.signal : null, t3 = this.loadFromPortal({
      supportedTypes: ["Scene Service"]
    }, e5).catch(a2).then(() => this._fetchService(r2));
    return this.addResolvingPromise(t3), Promise.resolve(this);
  }
  createPopupTemplate(e5) {
    const r2 = p(this, e5);
    return r2 && (this._formatPopupTemplateReturnsField(r2), this._formatPopupTemplateRGBField(r2)), r2;
  }
  _formatPopupTemplateReturnsField(e5) {
    const r2 = this.fieldsIndex.get("RETURNS");
    if (!r2) return;
    const t3 = e5.fieldInfos?.find((e6) => e6.fieldName === r2.name);
    if (!t3) return;
    const o3 = new i2({
      name: "pcl-returns-decoded",
      title: r2.alias || r2.name,
      expression: `
        var returnValue = $feature.${r2.name};
        return (returnValue % 16) + " / " + Floor(returnValue / 16);
      `
    });
    e5.expressionInfos = [...e5.expressionInfos || [], o3], t3.fieldName = "expression/pcl-returns-decoded";
  }
  _formatPopupTemplateRGBField(e5) {
    const r2 = this.fieldsIndex.get("RGB");
    if (!r2) return;
    const t3 = e5.fieldInfos?.find((e6) => e6.fieldName === r2.name);
    if (!t3) return;
    const o3 = new i2({
      name: "pcl-rgb-decoded",
      title: r2.alias || r2.name,
      expression: `
        var rgb = $feature.${r2.name};
        var red = Floor(rgb / 65536, 0);
        var green = Floor((rgb - (red * 65536)) / 256,0);
        var blue = rgb - (red * 65536) - (green * 256);

        return "rgb(" + red + "," + green + "," + blue + ")";
      `
    });
    e5.expressionInfos = [...e5.expressionInfos || [], o3], t3.fieldName = "expression/pcl-rgb-decoded";
  }
  queryCachedStatistics(e5, r2) {
    return __async(this, null, function* () {
      if (yield this.load(r2), !this.attributeStorageInfo) throw new s("scenelayer:no-cached-statistics", "Cached statistics are not available for this layer");
      const i4 = this.fieldsIndex.get(e5);
      if (!i4) throw new s("pointcloudlayer:field-unexisting", `Field '${e5}' does not exist on the layer`);
      for (const o3 of this.attributeStorageInfo) if (o3.name === i4.name) {
        const e6 = V(this.parsedUrl?.path ?? "", `./statistics/${o3.key}`);
        return U(e6, {
          query: __spreadProps(__spreadValues({
            f: "json"
          }, this.customParameters), {
            token: this.apiKey
          }),
          responseType: "json",
          signal: r2 ? r2.signal : null
        }).then((e7) => e7.data);
      }
      throw new s("pointcloudlayer:no-cached-statistics", "Cached statistics for this attribute are not available");
    });
  }
  saveAs(e5, r2) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(C.SAVE_AS, __spreadProps(__spreadValues({}, r2), {
        getTypeKeywords: () => this._getTypeKeywords(),
        portalItemLayerType: "point-cloud"
      }), e5);
    });
  }
  save() {
    return __async(this, null, function* () {
      const e5 = {
        getTypeKeywords: () => this._getTypeKeywords(),
        portalItemLayerType: "point-cloud"
      };
      return this._debouncedSaveOperations(C.SAVE, e5);
    });
  }
  validateLayer(e5) {
    if (e5.layerType && "PointCloud" !== e5.layerType) throw new s("pointcloudlayer:layer-type-not-supported", "PointCloudLayer does not support this layer type", {
      layerType: e5.layerType
    });
    if (isNaN(this.version.major) || isNaN(this.version.minor)) throw new s("layer:service-version-not-supported", "Service version is not supported.", {
      serviceVersion: this.version.versionString,
      supportedVersions: "1.x-2.x"
    });
    if (this.version.major > 2) throw new s("layer:service-version-too-new", "Service version is too new.", {
      serviceVersion: this.version.versionString,
      supportedVersions: "1.x-2.x"
    });
  }
  hasCachedStatistics(e5) {
    return null != this.attributeStorageInfo && this.attributeStorageInfo.some((r2) => r2.name === e5);
  }
  _getTypeKeywords() {
    return ["PointCloud"];
  }
  _validateElevationInfo() {
    const e5 = this.elevationInfo;
    $(n.getLogger(this), Z("Point cloud layers", "absolute-height", e5)), $(n.getLogger(this), w("Point cloud layers", e5));
  }
};
e2([y({
  type: ["PointCloudLayer"]
})], V2.prototype, "operationalLayerType", void 0), e2([y(s2)], V2.prototype, "popupEnabled", void 0), e2([y({
  type: k,
  json: {
    name: "popupInfo",
    write: true
  }
})], V2.prototype, "popupTemplate", void 0), e2([y({
  readOnly: true,
  json: {
    read: false
  }
})], V2.prototype, "defaultPopupTemplate", null), e2([y({
  readOnly: true,
  json: {
    write: false,
    read: false,
    origins: {
      "web-document": {
        write: false,
        read: false
      }
    }
  }
})], V2.prototype, "opacity", void 0), e2([y({
  type: ["show", "hide"]
})], V2.prototype, "listMode", void 0), e2([y({
  types: [e4],
  json: {
    origins: {
      service: {
        read: {
          source: "filters"
        }
      }
    },
    name: "layerDefinition.filters",
    write: true
  }
})], V2.prototype, "filters", void 0), e2([y({
  type: [y2]
})], V2.prototype, "fields", void 0), e2([y(O.fieldsIndex)], V2.prototype, "fieldsIndex", void 0), e2([o("service", "fields", ["fields", "attributeStorageInfo"])], V2.prototype, "readServiceFields", null), e2([y(O.outFields)], V2.prototype, "outFields", void 0), e2([y({
  readOnly: true
})], V2.prototype, "attributeStorageInfo", void 0), e2([y(d)], V2.prototype, "elevationInfo", null), e2([y({
  type: String,
  json: {
    origins: {
      "web-scene": {
        read: true,
        write: true
      },
      "portal-item": {
        read: true,
        write: true
      }
    },
    read: false
  }
})], V2.prototype, "path", void 0), e2([y(y3)], V2.prototype, "legendEnabled", void 0), e2([y({
  types: i3,
  json: {
    origins: {
      service: {
        read: {
          source: "drawingInfo.renderer"
        }
      }
    },
    name: "layerDefinition.drawingInfo.renderer",
    write: {
      target: {
        "layerDefinition.drawingInfo.renderer": {
          types: i3
        },
        "layerDefinition.drawingInfo.transparency": {
          type: Number
        }
      }
    }
  }
})], V2.prototype, "renderer", void 0), e2([r("renderer")], V2.prototype, "writeRenderer", null), e2([y({
  json: {
    read: false
  },
  readOnly: true
})], V2.prototype, "type", void 0), V2 = e2([a3("esri.layers.PointCloudLayer")], V2);
var U2 = V2;
export {
  U2 as default
};
//# sourceMappingURL=PointCloudLayer-AO6EBESD.js.map
