import { createRequire } from 'module';const require = createRequire(import.meta.url);
import {
  C,
  N,
  O,
  P,
  R,
  k,
  q,
  v,
  x
} from "./chunk-52IB6TIO.js";
import "./chunk-MWMAA7SE.js";
import "./chunk-LUKDK354.js";
import "./chunk-6A4CZ4JY.js";
import "./chunk-MWDGD75N.js";
import "./chunk-TFW6WS6R.js";
import "./chunk-X5QZGB37.js";
import "./chunk-3XHDZQO5.js";
import "./chunk-2BLQXT54.js";
import "./chunk-JSWVKNBA.js";
import {
  c as c2
} from "./chunk-XUSZNRTW.js";
import "./chunk-W26QF64E.js";
import "./chunk-D3XX7CQS.js";
import {
  n
} from "./chunk-GVEKX2VV.js";
import {
  i as i2
} from "./chunk-JA5GJ7PX.js";
import {
  p as p3
} from "./chunk-Q6OCJ3NG.js";
import "./chunk-DD6UQHSS.js";
import {
  c
} from "./chunk-FALQTRQL.js";
import "./chunk-GGTDLTZW.js";
import "./chunk-2W7YKBRA.js";
import {
  s as s3
} from "./chunk-GLFGRGCP.js";
import "./chunk-WQZJGTGX.js";
import {
  C as C2,
  l as l3
} from "./chunk-VFQA3B5S.js";
import {
  l as l4
} from "./chunk-NOH3NLJ5.js";
import "./chunk-LX5BT6XP.js";
import "./chunk-PLGJMWC5.js";
import {
  p as p2
} from "./chunk-UGFQYEND.js";
import {
  e as e2
} from "./chunk-XC5RDNAY.js";
import {
  m as m2,
  u
} from "./chunk-KXVPQVTB.js";
import "./chunk-ARN5GJBK.js";
import "./chunk-MPLS4PY6.js";
import "./chunk-AGBPYPP3.js";
import "./chunk-VMZV7772.js";
import "./chunk-3FR2T2I2.js";
import "./chunk-LOZRWPGI.js";
import "./chunk-GZ64OOAB.js";
import "./chunk-WR2NVDOI.js";
import "./chunk-EPLJRYUV.js";
import "./chunk-VYRCS5VR.js";
import "./chunk-UUQ5O7GK.js";
import {
  d as d2
} from "./chunk-6XY35LS7.js";
import "./chunk-JTDKNK44.js";
import "./chunk-RR7OQLEK.js";
import "./chunk-NAG6YX7T.js";
import "./chunk-WFNAKG2H.js";
import "./chunk-EKHRAAS6.js";
import "./chunk-IEB4ZCRH.js";
import "./chunk-WVSTX2NW.js";
import {
  b as b2
} from "./chunk-ORYC4PVJ.js";
import "./chunk-DXIKKLD7.js";
import "./chunk-VQNXE43R.js";
import {
  y as y2
} from "./chunk-VZ37C3ID.js";
import "./chunk-5R3HARKC.js";
import "./chunk-BKSTWG4S.js";
import "./chunk-FSG7HOZQ.js";
import "./chunk-Q5TIVVER.js";
import "./chunk-ZPMUEGLK.js";
import "./chunk-GNFDYYU3.js";
import "./chunk-X36BR2QB.js";
import "./chunk-RGG3YJQA.js";
import "./chunk-GBJYL7OX.js";
import "./chunk-GHKVDSKU.js";
import "./chunk-NVOJILW6.js";
import {
  k as k2
} from "./chunk-KYPTWEOO.js";
import "./chunk-WVFB3H4O.js";
import "./chunk-C7BQE556.js";
import "./chunk-ZREJ3Y2F.js";
import "./chunk-IR6CVPPC.js";
import "./chunk-BBUQOCRA.js";
import "./chunk-YBUJLIWZ.js";
import "./chunk-DL2B6IFJ.js";
import "./chunk-VOOO6FU5.js";
import "./chunk-IUPJR3FF.js";
import "./chunk-TGZW6QWO.js";
import "./chunk-OYIDHTXG.js";
import "./chunk-KUBMHTYA.js";
import "./chunk-E5NWFBZG.js";
import "./chunk-FP37456K.js";
import "./chunk-VSQZQLTQ.js";
import "./chunk-K43CZ3M5.js";
import "./chunk-6EIBUVMG.js";
import {
  j
} from "./chunk-BD24XM4D.js";
import "./chunk-NXXQ35YM.js";
import "./chunk-3BXPVUY5.js";
import "./chunk-LM3JDV4W.js";
import "./chunk-34V2CLL5.js";
import "./chunk-7V4JSBFA.js";
import {
  f as f3
} from "./chunk-REIMIECM.js";
import {
  l
} from "./chunk-EO2EW5KR.js";
import "./chunk-JEFPXTYT.js";
import "./chunk-MVS2BECH.js";
import {
  t as t2
} from "./chunk-UZ7IOCF3.js";
import {
  b
} from "./chunk-OS542PQQ.js";
import {
  d,
  l as l2,
  p,
  s as s2,
  t,
  y as y3
} from "./chunk-3B5GODXR.js";
import "./chunk-NKXXHQDD.js";
import {
  S
} from "./chunk-7TBQUMV3.js";
import {
  f as f2
} from "./chunk-TPLUZX3A.js";
import "./chunk-BGLJ2FAH.js";
import "./chunk-2EJFYNM7.js";
import "./chunk-DC5LRNPY.js";
import "./chunk-ASCK5HJ5.js";
import "./chunk-5X5U7R6O.js";
import "./chunk-XNLAOXPY.js";
import "./chunk-ZT7V2AVD.js";
import "./chunk-C2OXE4NQ.js";
import "./chunk-KOI252FF.js";
import {
  g,
  p as p4
} from "./chunk-I2TVVMQ6.js";
import "./chunk-5EGQYY2H.js";
import "./chunk-JKPUNUQA.js";
import "./chunk-SR7PRON4.js";
import {
  i,
  o as o2
} from "./chunk-HGHPYGKP.js";
import "./chunk-4DSGTDZJ.js";
import "./chunk-VYTPFEL2.js";
import "./chunk-RLGDH6IY.js";
import "./chunk-MRPCXIVS.js";
import "./chunk-YTKVV2Y3.js";
import "./chunk-GCVQXAS4.js";
import "./chunk-UFQD6AL4.js";
import "./chunk-THZPD5CT.js";
import "./chunk-OBCA6CWH.js";
import "./chunk-2JI245BP.js";
import "./chunk-ZEZ3LI2L.js";
import "./chunk-N34BRXVM.js";
import "./chunk-KETDH2J4.js";
import "./chunk-7QV7DHWN.js";
import {
  m
} from "./chunk-4L4Y34YK.js";
import "./chunk-BXONKQKI.js";
import "./chunk-2HDBQXAR.js";
import {
  w
} from "./chunk-RNF7VOCU.js";
import "./chunk-TIRJMGGG.js";
import {
  f
} from "./chunk-ZDRQSPB6.js";
import "./chunk-DCXDXGAR.js";
import "./chunk-BCCDYCTQ.js";
import "./chunk-AYL3HQHD.js";
import "./chunk-66YQWHHE.js";
import "./chunk-QGBMZIP4.js";
import "./chunk-AOEBZVTA.js";
import "./chunk-2OZSYJDX.js";
import "./chunk-MZM4INJV.js";
import "./chunk-J4GMQHGL.js";
import "./chunk-MHPE4SZA.js";
import "./chunk-6SSA7P3A.js";
import "./chunk-FQBTLEUI.js";
import "./chunk-GS7Y3YOG.js";
import "./chunk-Y2HYKTTT.js";
import "./chunk-XLEC46FY.js";
import "./chunk-4AZPIP7K.js";
import "./chunk-G73HQZEL.js";
import "./chunk-LZSLQ24Q.js";
import "./chunk-U3RHUXYK.js";
import "./chunk-7DBI6LQG.js";
import "./chunk-AUUN7RFQ.js";
import "./chunk-JAMSDYD6.js";
import "./chunk-PH6NPTP7.js";
import {
  e
} from "./chunk-NUICEVIH.js";
import "./chunk-NXK752PZ.js";
import {
  y
} from "./chunk-UVNLCXWD.js";
import "./chunk-PNUA7JOS.js";
import "./chunk-OR2FKGUM.js";
import {
  a3 as a
} from "./chunk-UDMPWVPF.js";
import "./chunk-XJNKCEWL.js";
import "./chunk-AIZ3T7E3.js";
import "./chunk-6UEMNP3E.js";
import "./chunk-6WGE3IUL.js";
import "./chunk-MLYB2YW4.js";
import {
  o,
  s2 as s
} from "./chunk-6JFGZTLU.js";
import "./chunk-2ZJE6ZFX.js";
import {
  __async
} from "./chunk-XBPEBUD5.js";

// ../../../node_modules/@arcgis/core/layers/graphics/sources/OGCFeatureSource.js
var S2 = class extends m {
  constructor() {
    super(...arguments), this.featureDefinition = null, this.type = "ogc-feature";
  }
  load(t3) {
    return this.addResolvingPromise(this._loadOGCServices(this.layer, t3)), this.when();
  }
  getSource() {
    const {
      featureDefinition: {
        collection: t3,
        layerDefinition: e3,
        spatialReference: s4,
        supportedCrs: r
      },
      layer: {
        apiKey: o3,
        customParameters: p5,
        effectiveMaxRecordCount: i3
      }
    } = this;
    return {
      type: "ogc-source",
      collection: t3,
      layerDefinition: e3,
      maxRecordCount: i3,
      queryParameters: {
        apiKey: o3,
        customParameters: p5
      },
      spatialReference: s4,
      supportedCrs: r
    };
  }
  queryExtent(t3, e3 = {}) {
    return null;
  }
  queryFeatureCount(t3, e3 = {}) {
    return null;
  }
  queryFeatures(t3, e3 = {}) {
    return this.queryFeaturesJSON(t3, e3).then((t4) => d2.fromJSON(t4));
  }
  queryFeaturesJSON(t3, e3 = {}) {
    const s4 = this.getSource();
    return this.load(e3).then(() => R(s4, t3, e3));
  }
  queryObjectIds(t3, e3 = {}) {
    return null;
  }
  serviceSupportsSpatialReference(t3) {
    return !(!t3.isWGS84 && !t3.isWebMercator) || !!this.featureDefinition.supportedCrs[t3.wkid];
  }
  _conformsToType(t3, e3) {
    const s4 = new RegExp(`^${o(e3)}$`, "i");
    return t3.conformsTo.some((t4) => s4.test(t4)) ?? false;
  }
  _getCapabilities(t3, e3) {
    return {
      analytics: {
        supportsCacheHint: false
      },
      attachment: null,
      data: {
        isVersioned: false,
        supportsAttachment: false,
        supportsM: false,
        supportsZ: t3
      },
      metadata: {
        supportsAdvancedFieldProperties: false
      },
      operations: {
        supportsCalculate: false,
        supportsTruncate: false,
        supportsValidateSql: false,
        supportsAdd: false,
        supportsDelete: false,
        supportsEditing: false,
        supportsChangeTracking: false,
        supportsQuery: false,
        supportsQueryAnalytics: false,
        supportsQueryAttachments: false,
        supportsQueryTopFeatures: false,
        supportsResizeAttachments: false,
        supportsSync: false,
        supportsUpdate: false,
        supportsExceedsLimitStatistics: false,
        supportsAsyncConvert3D: false
      },
      query: {
        maxRecordCount: e3,
        maxRecordCountFactor: void 0,
        standardMaxRecordCount: void 0,
        supportsCacheHint: false,
        supportsCentroid: false,
        supportsDisjointSpatialRelationship: false,
        supportsDistance: false,
        supportsDistinct: false,
        supportsExtent: false,
        supportsFormatPBF: false,
        supportsGeometryProperties: false,
        supportsHavingClause: false,
        supportsHistoricMoment: false,
        supportsMaxRecordCountFactor: false,
        supportsOrderBy: false,
        supportsPagination: false,
        supportsPercentileStatistics: false,
        supportsQuantization: false,
        supportsQuantizationEditMode: false,
        supportsQueryByAnonymous: false,
        supportsQueryByOthers: false,
        supportsQueryGeometry: false,
        supportsResultType: false,
        supportsStandardizedQueriesOnly: false,
        supportsTopFeaturesQuery: false,
        supportsStatistics: false,
        supportsSpatialAggregationStatistics: false,
        supportedSpatialAggregationStatistics: {
          envelope: false,
          centroid: false,
          convexHull: false
        },
        supportsDefaultSpatialReference: false,
        supportsFullTextSearch: false,
        supportsCompactGeometry: false,
        supportsSqlExpression: false,
        tileMaxRecordCount: void 0
      },
      queryRelated: {
        supportsCount: false,
        supportsOrderBy: false,
        supportsPagination: false,
        supportsCacheHint: false
      },
      queryTopFeatures: {
        supportsCacheHint: false
      },
      editing: {
        supportsDeleteByAnonymous: false,
        supportsDeleteByOthers: false,
        supportsGeometryUpdate: false,
        supportsGlobalId: false,
        supportsReturnServiceEditsInSourceSpatialReference: false,
        supportsRollbackOnFailure: false,
        supportsUpdateByAnonymous: false,
        supportsUpdateByOthers: false,
        supportsUploadWithItemId: false,
        supportsUpdateWithoutM: false,
        supportsAsyncApplyEdits: false,
        zDefault: void 0
      }
    };
  }
  _getMaxRecordCount(t3) {
    const e3 = t3?.components?.parameters;
    return e3?.limit?.schema?.maximum ?? e3?.limitFeatures?.schema?.maximum;
  }
  _getStorageSpatialReference(t3) {
    const e3 = t3.storageCrs ?? x, s4 = C(e3);
    return null == s4 ? f.WGS84 : new f({
      wkid: s4
    });
  }
  _getSupportedSpatialReferences(t3, e3) {
    const s4 = "#/crs", r = t3.crs ?? [x], o3 = r.includes(s4) ? r.filter((t4) => t4 !== s4).concat(e3.crs ?? []) : r, p5 = /^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;
    return o3.filter((t4) => !p5.test(t4));
  }
  _loadOGCServices(t3, s4) {
    return __async(this, null, function* () {
      const o3 = null != s4 ? s4.signal : null, {
        apiKey: p5,
        collectionId: i3,
        customParameters: a2,
        fields: f4,
        geometryType: g2,
        hasZ: S3,
        objectIdField: C3,
        timeInfo: R2,
        url: w2
      } = t3, j2 = {
        fields: f4?.map((t4) => t4.toJSON()),
        geometryType: i.toJSON(g2),
        hasZ: S3 ?? false,
        objectIdField: C3,
        timeInfo: R2?.toJSON()
      }, x2 = {
        apiKey: p5,
        customParameters: a2,
        signal: o3
      }, v2 = yield P(w2, x2), [F, O2] = yield Promise.all([O(v2, x2), N(v2, x2)]);
      if (!this._conformsToType(F, "http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson")) throw new s("ogc-feature-layer:no-geojson-support", "Server does not support geojson");
      const D = O2.collections.find(({
        id: t4
      }) => t4 === i3);
      if (!D) throw new s("ogc-feature-layer:collection-not-found", "Server does not contain the named collection");
      const T = this._conformsToType(F, "http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30") ? yield q(v2, x2) : null, A = yield v(D, j2, x2), _ = this._getMaxRecordCount(T), P2 = this._getCapabilities(A.hasZ, _), b3 = this._getStorageSpatialReference(D).toJSON(), q2 = this._getSupportedSpatialReferences(D, O2), E = new RegExp(`^${o(k)}`, "i"), G = {};
      for (const e3 of q2) {
        const t4 = C(e3);
        null != t4 && (G[t4] || (G[t4] = e3.replace(E, "")));
      }
      this.featureDefinition = {
        capabilities: P2,
        collection: D,
        layerDefinition: A,
        spatialReference: b3,
        supportedCrs: G
      };
    });
  }
};
e([y()], S2.prototype, "featureDefinition", void 0), e([y({
  constructOnly: true
})], S2.prototype, "layer", void 0), e([y()], S2.prototype, "type", void 0), S2 = e([a("esri.layers.graphics.sources.OGCFeatureSource")], S2);

// ../../../node_modules/@arcgis/core/layers/OGCFeatureLayer.js
var U = s3();
var B = class extends i2(e2(c2(c(l(p3(l4(t2(b(j(f3(S(f2)))))))))))) {
  constructor(e3) {
    super(e3), this.capabilities = null, this.collectionId = null, this.copyright = null, this.description = null, this.displayField = null, this.elevationInfo = null, this.fields = null, this.fieldsIndex = null, this.fullExtent = null, this.geometryType = null, this.hasZ = void 0, this.labelingInfo = null, this.labelsVisible = true, this.legendEnabled = true, this.maxRecordCount = null, this.objectIdField = null, this.operationalLayerType = "OGCFeatureLayer", this.popupEnabled = true, this.popupTemplate = null, this.screenSizePerspectiveEnabled = true, this.source = new S2({
      layer: this
    }), this.spatialReference = null, this.title = null, this.type = "ogc-feature", this.typeIdField = null, this.types = null, this.url = null;
  }
  destroy() {
    this.source?.destroy();
  }
  load(e3) {
    return this.addResolvingPromise(this.loadFromPortal({
      supportedTypes: ["OGCFeatureServer"]
    }, e3).then(() => this._fetchService(e3))), this.when();
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  get effectiveMaxRecordCount() {
    return this.maxRecordCount ?? this.capabilities?.query.maxRecordCount ?? 5e3;
  }
  get isTable() {
    return this.loaded && null == this.geometryType;
  }
  set renderer(e3) {
    p4(e3, this.fieldsIndex), this._set("renderer", e3);
  }
  on(e3, r) {
    return super.on(e3, r);
  }
  createPopupTemplate(e3) {
    return p2(this, e3);
  }
  createQuery() {
    return new b2();
  }
  getField(e3) {
    return this.fieldsIndex.get(e3);
  }
  getFieldDomain(e3, r) {
    let t3, i3 = false;
    const o3 = r?.feature?.attributes, s4 = this.typeIdField && o3?.[this.typeIdField];
    return null != s4 && this.types && (i3 = this.types.some((r2) => r2.id == s4 && (t3 = r2.domains?.[e3], "inherited" === t3?.type && (t3 = this._getLayerDomain(e3)), true))), i3 || t3 || (t3 = this._getLayerDomain(e3)), t3;
  }
  queryFeatures(e3, r) {
    return this.load().then(() => this.source.queryFeatures(b2.from(e3) || this.createQuery(), r)).then((e4) => (e4?.features?.forEach((e5) => {
      e5.layer = e5.sourceLayer = this;
    }), e4));
  }
  serviceSupportsSpatialReference(e3) {
    return this.source?.serviceSupportsSpatialReference(e3) ?? false;
  }
  _fetchService(e3) {
    return __async(this, null, function* () {
      yield this.source.load(e3), this.read(this.source.featureDefinition, {
        origin: "service"
      }), p4(this.renderer, this.fieldsIndex), g(this.timeInfo, this.fieldsIndex);
    });
  }
  _getLayerDomain(e3) {
    if (!this.fields) return null;
    for (const r of this.fields) if (r.name === e3 && r.domain) return r.domain;
    return null;
  }
};
e([y({
  readOnly: true,
  json: {
    origins: {
      service: {
        read: true
      }
    }
  }
})], B.prototype, "capabilities", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], B.prototype, "collectionId", void 0), e([y({
  type: String
})], B.prototype, "copyright", void 0), e([y({
  readOnly: true
})], B.prototype, "defaultPopupTemplate", null), e([y({
  readOnly: true,
  type: String,
  json: {
    origins: {
      service: {
        name: "collection.description"
      }
    }
  }
})], B.prototype, "description", void 0), e([y({
  type: String
})], B.prototype, "displayField", void 0), e([y({
  type: Number
})], B.prototype, "effectiveMaxRecordCount", null), e([y(d)], B.prototype, "elevationInfo", void 0), e([y({
  type: [y2],
  json: {
    origins: {
      service: {
        name: "layerDefinition.fields"
      }
    }
  }
})], B.prototype, "fields", void 0), e([y(U.fieldsIndex)], B.prototype, "fieldsIndex", void 0), e([y({
  readOnly: true,
  type: w,
  json: {
    origins: {
      service: {
        name: "layerDefinition.extent"
      }
    }
  }
})], B.prototype, "fullExtent", void 0), e([y({
  type: o2.apiValues,
  json: {
    origins: {
      service: {
        name: "layerDefinition.geometryType",
        read: {
          reader: o2.read
        }
      }
    }
  }
})], B.prototype, "geometryType", void 0), e([y({
  type: Boolean,
  json: {
    origins: {
      service: {
        name: "layerDefinition.hasZ"
      }
    }
  }
})], B.prototype, "hasZ", void 0), e([y({
  type: Boolean,
  readOnly: true
})], B.prototype, "isTable", null), e([y({
  type: [C2],
  json: {
    origins: {
      "web-document": {
        name: "layerDefinition.drawingInfo.labelingInfo",
        read: {
          reader: l3
        },
        write: true
      }
    }
  }
})], B.prototype, "labelingInfo", void 0), e([y(l2)], B.prototype, "labelsVisible", void 0), e([y(y3)], B.prototype, "legendEnabled", void 0), e([y({
  type: Number
})], B.prototype, "maxRecordCount", void 0), e([y({
  type: String,
  json: {
    origins: {
      service: {
        name: "layerDefinition.objectIdField"
      }
    }
  }
})], B.prototype, "objectIdField", void 0), e([y({
  type: ["OGCFeatureLayer"]
})], B.prototype, "operationalLayerType", void 0), e([y(s2)], B.prototype, "popupEnabled", void 0), e([y({
  type: k2,
  json: {
    name: "popupInfo",
    write: true
  }
})], B.prototype, "popupTemplate", void 0), e([y({
  types: m2,
  json: {
    origins: {
      service: {
        name: "layerDefinition.drawingInfo.renderer",
        write: false
      },
      "web-scene": {
        types: u,
        name: "layerDefinition.drawingInfo.renderer",
        write: true
      }
    },
    name: "layerDefinition.drawingInfo.renderer",
    write: true
  }
})], B.prototype, "renderer", null), e([y(t)], B.prototype, "screenSizePerspectiveEnabled", void 0), e([y({
  readOnly: true
})], B.prototype, "source", void 0), e([y({
  readOnly: true,
  type: f,
  json: {
    origins: {
      service: {
        read: true
      }
    }
  }
})], B.prototype, "spatialReference", void 0), e([y({
  type: String,
  json: {
    write: {
      enabled: true,
      ignoreOrigin: true,
      isRequired: true
    },
    origins: {
      service: {
        name: "collection.title"
      }
    }
  }
})], B.prototype, "title", void 0), e([y({
  readOnly: true,
  json: {
    read: false
  }
})], B.prototype, "type", void 0), e([y({
  type: String,
  readOnly: true
})], B.prototype, "typeIdField", void 0), e([y({
  type: [n]
})], B.prototype, "types", void 0), e([y(p)], B.prototype, "url", void 0), B = e([a("esri.layers.OGCFeatureLayer")], B);
var V = B;
export {
  V as default
};
//# sourceMappingURL=OGCFeatureLayer-E7GKID2X.js.map
