{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { debounce as a } from \"../../../core/promiseUtils.js\";\nimport { when as t } from \"../../../core/reactiveUtils.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/RandomLCG.js\";\nimport \"../../../core/Error.js\";\nimport { subclass as i } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport r from \"./DynamicLayerView3D.js\";\nimport s from \"../../layers/ImageryLayerView.js\";\nlet n = class extends s(r) {\n  constructor() {\n    super(...arguments), this.type = \"imagery-3d\", this.redrawDebounced = a(async e => {\n      this.redraw((e, a) => this._redrawImage(e, a), e);\n    }, 2e3);\n  }\n  initialize() {\n    this.addHandles([t(() => this.view.basemapTerrain.ready, () => this._initializeMaximumDataResolution(), {\n      once: !0,\n      initial: !0\n    }), this.layer.on(\"redraw\", () => this._updatingHandles.addPromise(this.redrawDebounced()))]), this._updatingHandles.add(() => this.layer?.exportImageServiceParameters?.version, () => {\n      this._updatingHandles.addPromise(this.refreshDebounced());\n    }), this._updatingHandles.add(() => this.layer?.renderer, () => {\n      this._updatingHandles.addPromise(this.refreshDebounced());\n    }), this._updatingHandles.add(() => this.timeExtent, () => this._updatingHandles.addPromise(this.refreshDebounced()));\n  }\n  _initializeMaximumDataResolution() {\n    this.maximumDataResolution = this.layer.loaded ? this.layer.serviceRasterInfo.pixelSize : null;\n  }\n  getFetchOptions() {\n    return {\n      timeExtent: this.timeExtent\n    };\n  }\n  async processResult(e, a, t) {\n    a.imageOrCanvasElement ? e.image = a.imageOrCanvasElement : (e.image = document.createElement(\"canvas\"), e.pixelData = a.pixelData, await this._redrawImage(e, t));\n  }\n  async _redrawImage(e, a) {\n    if (!(e.image instanceof HTMLCanvasElement) || null == e.pixelData) throw new Error();\n    const t = e.image,\n      i = t.getContext(\"2d\"),\n      r = await this.layer.applyRenderer(e.pixelData, {\n        signal: a\n      }),\n      s = this.layer.applyFilter(r).pixelBlock;\n    if (null == s) throw new Error();\n    t.width = s.width, t.height = s.height;\n    const n = i.createImageData(s.width, s.height);\n    n.data.set(s.getAsRGBA()), i.putImageData(n, 0, 0);\n  }\n};\nn = e([i(\"esri.views.3d.layers.ImageryLayerView3D\")], n);\nconst o = n;\nexport { o as default };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,IAAI,IAAI,cAAc,EAAE,CAAC,EAAE;AAAA,EACzB,cAAc;AACZ,UAAM,GAAG,SAAS,GAAG,KAAK,OAAO,cAAc,KAAK,kBAAkB,EAAE,CAAMA,OAAK;AACjF,WAAK,OAAO,CAACA,IAAGC,OAAM,KAAK,aAAaD,IAAGC,EAAC,GAAGD,EAAC;AAAA,IAClD,IAAG,GAAG;AAAA,EACR;AAAA,EACA,aAAa;AACX,SAAK,WAAW,CAAC,EAAE,MAAM,KAAK,KAAK,eAAe,OAAO,MAAM,KAAK,iCAAiC,GAAG;AAAA,MACtG,MAAM;AAAA,MACN,SAAS;AAAA,IACX,CAAC,GAAG,KAAK,MAAM,GAAG,UAAU,MAAM,KAAK,iBAAiB,WAAW,KAAK,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,iBAAiB,IAAI,MAAM,KAAK,OAAO,8BAA8B,SAAS,MAAM;AACtL,WAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC;AAAA,IAC1D,CAAC,GAAG,KAAK,iBAAiB,IAAI,MAAM,KAAK,OAAO,UAAU,MAAM;AAC9D,WAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC;AAAA,IAC1D,CAAC,GAAG,KAAK,iBAAiB,IAAI,MAAM,KAAK,YAAY,MAAM,KAAK,iBAAiB,WAAW,KAAK,iBAAiB,CAAC,CAAC;AAAA,EACtH;AAAA,EACA,mCAAmC;AACjC,SAAK,wBAAwB,KAAK,MAAM,SAAS,KAAK,MAAM,kBAAkB,YAAY;AAAA,EAC5F;AAAA,EACA,kBAAkB;AAChB,WAAO;AAAA,MACL,YAAY,KAAK;AAAA,IACnB;AAAA,EACF;AAAA,EACM,cAAcA,IAAGC,IAAG,GAAG;AAAA;AAC3B,MAAAA,GAAE,uBAAuBD,GAAE,QAAQC,GAAE,wBAAwBD,GAAE,QAAQ,SAAS,cAAc,QAAQ,GAAGA,GAAE,YAAYC,GAAE,WAAW,MAAM,KAAK,aAAaD,IAAG,CAAC;AAAA,IAClK;AAAA;AAAA,EACM,aAAaA,IAAGC,IAAG;AAAA;AACvB,UAAI,EAAED,GAAE,iBAAiB,sBAAsB,QAAQA,GAAE,UAAW,OAAM,IAAI,MAAM;AACpF,YAAM,IAAIA,GAAE,OACV,IAAI,EAAE,WAAW,IAAI,GACrB,IAAI,MAAM,KAAK,MAAM,cAAcA,GAAE,WAAW;AAAA,QAC9C,QAAQC;AAAA,MACV,CAAC,GACD,IAAI,KAAK,MAAM,YAAY,CAAC,EAAE;AAChC,UAAI,QAAQ,EAAG,OAAM,IAAI,MAAM;AAC/B,QAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE;AAChC,YAAMC,KAAI,EAAE,gBAAgB,EAAE,OAAO,EAAE,MAAM;AAC7C,MAAAA,GAAE,KAAK,IAAI,EAAE,UAAU,CAAC,GAAG,EAAE,aAAaA,IAAG,GAAG,CAAC;AAAA,IACnD;AAAA;AACF;AACA,IAAI,EAAE,CAAC,EAAE,yCAAyC,CAAC,GAAG,CAAC;AACvD,IAAM,IAAI;",
  "names": ["e", "a", "n"]
}
