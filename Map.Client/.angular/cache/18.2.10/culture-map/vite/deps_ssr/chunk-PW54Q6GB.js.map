{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/widgets/support/geolocationUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../config.js\";\nimport t from \"../../core/Error.js\";\nimport has from \"../../core/has.js\";\nimport o from \"../../core/Logger.js\";\nimport r from \"../../geometry/Point.js\";\nimport { geographicToWebMercator as i } from \"../../geometry/support/webMercatorUtils.js\";\nimport n from \"../../portal/Portal.js\";\nimport { project as c } from \"../../rest/geometryService/project.js\";\nimport s from \"../../rest/support/ProjectParameters.js\";\nconst u = () => o.getLogger(\"esri.widgets.support.geolocationUtils\"),\n  a = {\n    maximumAge: 0,\n    timeout: 15e3,\n    enableHighAccuracy: !0\n  };\nfunction m() {\n  const e = has(\"esri-geolocation\");\n  return e || u().warn(\"geolocation-unsupported\", \"Geolocation unsupported.\"), e;\n}\nfunction l() {\n  const e = window.isSecureContext;\n  return e || u().warn(\"insecure-context\", \"Geolocation requires a secure origin.\"), e;\n}\nfunction g() {\n  return m() && l();\n}\nfunction p(e) {\n  const o = 15e3;\n  return e || (e = a), new Promise((r, i) => {\n    setTimeout(() => i(new t(\"geolocation:timeout\", \"getting the current geolocation position timed out\")), o), navigator.geolocation.getCurrentPosition(r, i, e ?? void 0);\n  });\n}\nlet d;\nfunction f(e, o) {\n  if (d) return d(e, o);\n  const {\n      position: r,\n      view: i\n    } = e,\n    n = v(r),\n    c = n?.coords;\n  if (!c) throw new t(\"geometry-service:no-coords\", \"Geolocation has no coordinates\");\n  return h(y(c), i, o);\n}\nfunction w(e) {\n  d = e;\n}\nfunction v(e) {\n  const t = e && e.coords || {},\n    o = {\n      accuracy: t.accuracy,\n      altitude: t.altitude,\n      altitudeAccuracy: t.altitudeAccuracy,\n      heading: t.heading,\n      latitude: t.latitude,\n      longitude: t.longitude,\n      speed: t.speed\n    };\n  return e ? {\n    coords: o,\n    timestamp: e.timestamp\n  } : e;\n}\nfunction y({\n  longitude: e,\n  latitude: t,\n  altitude: o\n}) {\n  return new r({\n    longitude: e,\n    latitude: t,\n    z: o || void 0,\n    spatialReference: {\n      wkid: 4326\n    }\n  });\n}\nfunction h(e, o, r) {\n  if (!o) return Promise.resolve(e);\n  const n = o.spatialReference;\n  return n.isWGS84 ? Promise.resolve(e) : n.isWebMercator ? Promise.resolve(i(e)) : j(r).then(o => {\n    if (!o) throw new t(\"geometry-service:missing-url\", \"Geometry service URL is missing\");\n    const i = new s({\n      geometries: [e],\n      outSpatialReference: n\n    });\n    return c(o, i, r).then(e => e[0]);\n  });\n}\nfunction j(t) {\n  if (e.geometryServiceUrl) return Promise.resolve(e.geometryServiceUrl);\n  const o = n.getDefault();\n  return o.load(t).catch(() => {}).then(() => o.helperServices?.geometry?.url);\n}\nexport { p as getCurrentPosition, w as overridePositionToPoint, f as positionToPoint, g as supported };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAaA,IAAM,IAAI,MAAM,EAAE,UAAU,uCAAuC;AAAnE,IACE,IAAI;AAAA,EACF,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,oBAAoB;AACtB;AACF,SAAS,IAAI;AACX,QAAM,IAAI,IAAI,kBAAkB;AAChC,SAAO,KAAK,EAAE,EAAE,KAAK,2BAA2B,0BAA0B,GAAG;AAC/E;AACA,SAAS,IAAI;AACX,QAAM,IAAI,OAAO;AACjB,SAAO,KAAK,EAAE,EAAE,KAAK,oBAAoB,uCAAuC,GAAG;AACrF;AACA,SAAS,IAAI;AACX,SAAO,EAAE,KAAK,EAAE;AAClB;AACA,SAASA,GAAE,GAAG;AACZ,QAAM,IAAI;AACV,SAAO,MAAM,IAAI,IAAI,IAAI,QAAQ,CAAC,GAAG,MAAM;AACzC,eAAW,MAAM,EAAE,IAAIC,GAAE,uBAAuB,oDAAoD,CAAC,GAAG,CAAC,GAAG,UAAU,YAAY,mBAAmB,GAAG,GAAG,KAAK,MAAM;AAAA,EACxK,CAAC;AACH;AACA,IAAIC;AACJ,SAAS,EAAE,GAAG,GAAG;AACf,MAAIA,GAAG,QAAOA,GAAE,GAAG,CAAC;AACpB,QAAM;AAAA,IACF,UAAU;AAAA,IACV,MAAM;AAAA,EACR,IAAI,GACJC,KAAI,EAAE,CAAC,GACP,IAAIA,IAAG;AACT,MAAI,CAAC,EAAG,OAAM,IAAIF,GAAE,8BAA8B,gCAAgC;AAClF,SAAO,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC;AACrB;AAIA,SAAS,EAAE,GAAG;AACZ,QAAM,IAAI,KAAK,EAAE,UAAU,CAAC,GAC1B,IAAI;AAAA,IACF,UAAU,EAAE;AAAA,IACZ,UAAU,EAAE;AAAA,IACZ,kBAAkB,EAAE;AAAA,IACpB,SAAS,EAAE;AAAA,IACX,UAAU,EAAE;AAAA,IACZ,WAAW,EAAE;AAAA,IACb,OAAO,EAAE;AAAA,EACX;AACF,SAAO,IAAI;AAAA,IACT,QAAQ;AAAA,IACR,WAAW,EAAE;AAAA,EACf,IAAI;AACN;AACA,SAAS,EAAE;AAAA,EACT,WAAW;AAAA,EACX,UAAU;AAAA,EACV,UAAU;AACZ,GAAG;AACD,SAAO,IAAI,EAAE;AAAA,IACX,WAAW;AAAA,IACX,UAAU;AAAA,IACV,GAAG,KAAK;AAAA,IACR,kBAAkB;AAAA,MAChB,MAAM;AAAA,IACR;AAAA,EACF,CAAC;AACH;AACA,SAAS,EAAE,GAAG,GAAG,GAAG;AAClB,MAAI,CAAC,EAAG,QAAO,QAAQ,QAAQ,CAAC;AAChC,QAAMG,KAAI,EAAE;AACZ,SAAOA,GAAE,UAAU,QAAQ,QAAQ,CAAC,IAAIA,GAAE,gBAAgB,QAAQ,QAAQ,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,EAAE,KAAK,CAAAC,OAAK;AAC/F,QAAI,CAACA,GAAG,OAAM,IAAIC,GAAE,gCAAgC,iCAAiC;AACrF,UAAM,IAAI,IAAI,EAAE;AAAA,MACd,YAAY,CAAC,CAAC;AAAA,MACd,qBAAqBF;AAAA,IACvB,CAAC;AACD,WAAOA,GAAEC,IAAG,GAAG,CAAC,EAAE,KAAK,CAAAE,OAAKA,GAAE,CAAC,CAAC;AAAA,EAClC,CAAC;AACH;AACA,SAAS,EAAE,GAAG;AACZ,MAAI,EAAE,mBAAoB,QAAO,QAAQ,QAAQ,EAAE,kBAAkB;AACrE,QAAM,IAAI,EAAE,WAAW;AACvB,SAAO,EAAE,KAAK,CAAC,EAAE,MAAM,MAAM;AAAA,EAAC,CAAC,EAAE,KAAK,MAAM,EAAE,gBAAgB,UAAU,GAAG;AAC7E;",
  "names": ["p", "s", "d", "n", "n", "o", "s", "e"]
}
