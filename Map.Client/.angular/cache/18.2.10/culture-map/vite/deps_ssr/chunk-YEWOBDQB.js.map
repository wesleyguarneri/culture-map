{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/layers/graphics/data/BoundsStore.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport has from \"../../../core/has.js\";\nimport { PooledRBush as i } from \"../../../core/libs/rbush/PooledRBush.js\";\nimport { empty as s } from \"../../../geometry/support/aaBoundingRect.js\";\nconst d = 5e4,\n  n = {\n    minX: 0,\n    minY: 0,\n    maxX: 0,\n    maxY: 0\n  };\nfunction t(i) {\n  n.minX = i[0], n.minY = i[1], n.maxX = i[2], n.maxY = i[3];\n}\nfunction e(i, s, d) {\n  t(s), i.search(n, d);\n}\nclass o {\n  constructor() {\n    this._indexInvalid = !1, this._boundsToLoad = [], this._boundsById = new Map(), this._idByBounds = new Map(), this._index = new i(9, has(\"esri-csp-restrictions\") ? i => ({\n      minX: i[0],\n      minY: i[1],\n      maxX: i[2],\n      maxY: i[3]\n    }) : [\"[0]\", \"[1]\", \"[2]\", \"[3]\"]), this._loadIndex = () => {\n      if (this._indexInvalid) {\n        const i = new Array(this._idByBounds.size);\n        let s = 0;\n        this._idByBounds.forEach((d, n) => {\n          i[s++] = n;\n        }), this._indexInvalid = !1, this._index.clear(), this._index.load(i);\n      } else this._boundsToLoad.length && (this._index.load(Array.from(new Set(this._boundsToLoad.filter(i => this._idByBounds.has(i))))), this._boundsToLoad.length = 0);\n    };\n  }\n  get fullBounds() {\n    if (!this._boundsById.size) return null;\n    const i = s();\n    for (const s of this._boundsById.values()) s && (i[0] = Math.min(s[0], i[0]), i[1] = Math.min(s[1], i[1]), i[2] = Math.max(s[2], i[2]), i[3] = Math.max(s[3], i[3]));\n    return i;\n  }\n  get valid() {\n    return !this._indexInvalid;\n  }\n  clear() {\n    this._indexInvalid = !1, this._boundsToLoad.length = 0, this._boundsById.clear(), this._idByBounds.clear(), this._index.clear();\n  }\n  delete(i) {\n    const s = this._boundsById.get(i);\n    this._boundsById.delete(i), s && (this._idByBounds.delete(s), this._indexInvalid || this._index.remove(s));\n  }\n  forEachInBounds(i, s) {\n    this._loadIndex(), e(this._index, i, i => s(this._idByBounds.get(i)));\n  }\n  get(i) {\n    return this._boundsById.get(i);\n  }\n  has(i) {\n    return this._boundsById.has(i);\n  }\n  invalidateIndex() {\n    this._indexInvalid || (this._indexInvalid = !0, this._boundsToLoad.length = 0);\n  }\n  set(i, s) {\n    if (!this._indexInvalid) {\n      const s = this._boundsById.get(i);\n      s && (this._index.remove(s), this._idByBounds.delete(s));\n    }\n    this._boundsById.set(i, s), s && (this._idByBounds.set(s, i), this._indexInvalid || (this._boundsToLoad.push(s), this._boundsToLoad.length > d && this._loadIndex()));\n  }\n}\nexport { o as BoundsStore };"],
  "mappings": ";;;;;;;;;;;;AAOA,IAAM,IAAI;AAAV,IACE,IAAI;AAAA,EACF,MAAM;AAAA,EACN,MAAM;AAAA,EACN,MAAM;AAAA,EACN,MAAM;AACR;AACF,SAAS,EAAE,GAAG;AACZ,IAAE,OAAO,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC;AAC3D;AACA,SAAS,EAAE,GAAG,GAAGA,IAAG;AAClB,IAAE,CAAC,GAAG,EAAE,OAAO,GAAGA,EAAC;AACrB;AACA,IAAM,IAAN,MAAQ;AAAA,EACN,cAAc;AACZ,SAAK,gBAAgB,OAAI,KAAK,gBAAgB,CAAC,GAAG,KAAK,cAAc,oBAAI,IAAI,GAAG,KAAK,cAAc,oBAAI,IAAI,GAAG,KAAK,SAAS,IAAI,EAAE,GAAG,IAAI,uBAAuB,IAAI,QAAM;AAAA,MACxK,MAAM,EAAE,CAAC;AAAA,MACT,MAAM,EAAE,CAAC;AAAA,MACT,MAAM,EAAE,CAAC;AAAA,MACT,MAAM,EAAE,CAAC;AAAA,IACX,KAAK,CAAC,OAAO,OAAO,OAAO,KAAK,CAAC,GAAG,KAAK,aAAa,MAAM;AAC1D,UAAI,KAAK,eAAe;AACtB,cAAM,IAAI,IAAI,MAAM,KAAK,YAAY,IAAI;AACzC,YAAI,IAAI;AACR,aAAK,YAAY,QAAQ,CAACA,IAAGC,OAAM;AACjC,YAAE,GAAG,IAAIA;AAAA,QACX,CAAC,GAAG,KAAK,gBAAgB,OAAI,KAAK,OAAO,MAAM,GAAG,KAAK,OAAO,KAAK,CAAC;AAAA,MACtE,MAAO,MAAK,cAAc,WAAW,KAAK,OAAO,KAAK,MAAM,KAAK,IAAI,IAAI,KAAK,cAAc,OAAO,OAAK,KAAK,YAAY,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,cAAc,SAAS;AAAA,IACnK;AAAA,EACF;AAAA,EACA,IAAI,aAAa;AACf,QAAI,CAAC,KAAK,YAAY,KAAM,QAAO;AACnC,UAAM,IAAI,EAAE;AACZ,eAAW,KAAK,KAAK,YAAY,OAAO,EAAG,OAAM,EAAE,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;AAClK,WAAO;AAAA,EACT;AAAA,EACA,IAAI,QAAQ;AACV,WAAO,CAAC,KAAK;AAAA,EACf;AAAA,EACA,QAAQ;AACN,SAAK,gBAAgB,OAAI,KAAK,cAAc,SAAS,GAAG,KAAK,YAAY,MAAM,GAAG,KAAK,YAAY,MAAM,GAAG,KAAK,OAAO,MAAM;AAAA,EAChI;AAAA,EACA,OAAO,GAAG;AACR,UAAM,IAAI,KAAK,YAAY,IAAI,CAAC;AAChC,SAAK,YAAY,OAAO,CAAC,GAAG,MAAM,KAAK,YAAY,OAAO,CAAC,GAAG,KAAK,iBAAiB,KAAK,OAAO,OAAO,CAAC;AAAA,EAC1G;AAAA,EACA,gBAAgB,GAAG,GAAG;AACpB,SAAK,WAAW,GAAG,EAAE,KAAK,QAAQ,GAAG,CAAAC,OAAK,EAAE,KAAK,YAAY,IAAIA,EAAC,CAAC,CAAC;AAAA,EACtE;AAAA,EACA,IAAI,GAAG;AACL,WAAO,KAAK,YAAY,IAAI,CAAC;AAAA,EAC/B;AAAA,EACA,IAAI,GAAG;AACL,WAAO,KAAK,YAAY,IAAI,CAAC;AAAA,EAC/B;AAAA,EACA,kBAAkB;AAChB,SAAK,kBAAkB,KAAK,gBAAgB,MAAI,KAAK,cAAc,SAAS;AAAA,EAC9E;AAAA,EACA,IAAI,GAAG,GAAG;AACR,QAAI,CAAC,KAAK,eAAe;AACvB,YAAMC,KAAI,KAAK,YAAY,IAAI,CAAC;AAChC,MAAAA,OAAM,KAAK,OAAO,OAAOA,EAAC,GAAG,KAAK,YAAY,OAAOA,EAAC;AAAA,IACxD;AACA,SAAK,YAAY,IAAI,GAAG,CAAC,GAAG,MAAM,KAAK,YAAY,IAAI,GAAG,CAAC,GAAG,KAAK,kBAAkB,KAAK,cAAc,KAAK,CAAC,GAAG,KAAK,cAAc,SAAS,KAAK,KAAK,WAAW;AAAA,EACpK;AACF;",
  "names": ["d", "n", "i", "s"]
}
