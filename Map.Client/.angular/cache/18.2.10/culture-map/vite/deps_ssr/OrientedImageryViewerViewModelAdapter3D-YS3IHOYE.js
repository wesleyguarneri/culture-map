import { createRequire } from 'module';const require = createRequire(import.meta.url);
import {
  E3 as E,
  L,
  M2 as M,
  N,
  b as b2,
  u
} from "./chunk-K2N5C427.js";
import "./chunk-6VEI6WC5.js";
import "./chunk-IVVINOEJ.js";
import "./chunk-2U6PTPT5.js";
import "./chunk-VBF36LQH.js";
import "./chunk-QXI57KH6.js";
import "./chunk-DSARYBLQ.js";
import "./chunk-5ZLERKFB.js";
import "./chunk-62NDSO75.js";
import "./chunk-FN552AT6.js";
import "./chunk-OEC3KBO5.js";
import "./chunk-3MEAEIED.js";
import "./chunk-6JVMYNKO.js";
import "./chunk-MAPT6E5F.js";
import "./chunk-RIA56QWL.js";
import "./chunk-C7GHK6X7.js";
import "./chunk-YGUT6MDD.js";
import "./chunk-GNNS7MMB.js";
import "./chunk-KU2YMUPJ.js";
import {
  $
} from "./chunk-KSVRNA4R.js";
import "./chunk-4UXMYOWI.js";
import "./chunk-2H3S7IXI.js";
import "./chunk-2B3WLK32.js";
import "./chunk-JARG4EKD.js";
import "./chunk-H65MVS3B.js";
import "./chunk-YT63GLYW.js";
import "./chunk-2CXNO3UO.js";
import {
  l
} from "./chunk-EJXWYKCR.js";
import "./chunk-CE7BUKSQ.js";
import "./chunk-NOVQFMBE.js";
import "./chunk-IQ72QELA.js";
import "./chunk-SU5BOQUT.js";
import "./chunk-7MWFHTLS.js";
import "./chunk-SNHVHW2N.js";
import "./chunk-Q47GASPN.js";
import "./chunk-PK6A5N2R.js";
import "./chunk-44O4APOL.js";
import "./chunk-MIIC4I55.js";
import "./chunk-B63XAMYJ.js";
import "./chunk-THUD7LGO.js";
import "./chunk-A45QR3VT.js";
import "./chunk-MYCEJRPQ.js";
import "./chunk-YSJVVDDH.js";
import "./chunk-53Z6KOJR.js";
import "./chunk-DLWZ3HVT.js";
import "./chunk-B76NC7GX.js";
import "./chunk-EFLOBCAZ.js";
import "./chunk-BY3XBMAH.js";
import "./chunk-OO7WNZEW.js";
import "./chunk-LU7PU2CS.js";
import "./chunk-4O23HCRT.js";
import "./chunk-T5C2TZNO.js";
import "./chunk-AOGKNBDG.js";
import "./chunk-F4FQ67JP.js";
import "./chunk-FDI2X6GO.js";
import "./chunk-3XHDZQO5.js";
import "./chunk-2BLQXT54.js";
import "./chunk-JSWVKNBA.js";
import "./chunk-MM5HQGRH.js";
import "./chunk-NOH3NLJ5.js";
import "./chunk-LX5BT6XP.js";
import "./chunk-PLGJMWC5.js";
import "./chunk-UGFQYEND.js";
import "./chunk-XC5RDNAY.js";
import "./chunk-AGBPYPP3.js";
import "./chunk-LOZRWPGI.js";
import "./chunk-WR2NVDOI.js";
import "./chunk-EPLJRYUV.js";
import "./chunk-VYRCS5VR.js";
import "./chunk-OOK3QTWF.js";
import "./chunk-VFYCIIDC.js";
import "./chunk-PQUZDC3L.js";
import "./chunk-UUQ5O7GK.js";
import "./chunk-6XY35LS7.js";
import "./chunk-T42EJVJR.js";
import "./chunk-RR7OQLEK.js";
import "./chunk-L6FG3WIC.js";
import "./chunk-6ZLH7XBS.js";
import "./chunk-44ZUWZXU.js";
import "./chunk-NAG6YX7T.js";
import "./chunk-EKHRAAS6.js";
import "./chunk-IEB4ZCRH.js";
import "./chunk-7QOUHKW5.js";
import "./chunk-NHYYZMJR.js";
import "./chunk-WVSTX2NW.js";
import "./chunk-CSK4VZQ7.js";
import "./chunk-2TNGEJGS.js";
import "./chunk-OYGNGIHQ.js";
import "./chunk-GSG4T2KM.js";
import "./chunk-BZHHBBFX.js";
import "./chunk-GK5M6FUR.js";
import "./chunk-MRP3FBLV.js";
import "./chunk-Y7SJWJAL.js";
import "./chunk-A2FDYA6M.js";
import "./chunk-YGAXDKHF.js";
import "./chunk-4TOSJLKR.js";
import "./chunk-EXPZNTF3.js";
import "./chunk-ORYC4PVJ.js";
import "./chunk-DXIKKLD7.js";
import "./chunk-VQNXE43R.js";
import "./chunk-VZ37C3ID.js";
import "./chunk-5R3HARKC.js";
import "./chunk-BKSTWG4S.js";
import "./chunk-FSG7HOZQ.js";
import "./chunk-Q5TIVVER.js";
import "./chunk-ZPMUEGLK.js";
import "./chunk-GNFDYYU3.js";
import "./chunk-X36BR2QB.js";
import "./chunk-RGG3YJQA.js";
import "./chunk-GBJYL7OX.js";
import "./chunk-GHKVDSKU.js";
import {
  d
} from "./chunk-NVOJILW6.js";
import "./chunk-KYPTWEOO.js";
import "./chunk-WVFB3H4O.js";
import "./chunk-C7BQE556.js";
import "./chunk-ZREJ3Y2F.js";
import "./chunk-IR6CVPPC.js";
import "./chunk-BBUQOCRA.js";
import "./chunk-YBUJLIWZ.js";
import "./chunk-DL2B6IFJ.js";
import "./chunk-VOOO6FU5.js";
import "./chunk-IUPJR3FF.js";
import "./chunk-TGZW6QWO.js";
import "./chunk-OYIDHTXG.js";
import "./chunk-KUBMHTYA.js";
import "./chunk-V33IUWAS.js";
import "./chunk-VSQZQLTQ.js";
import "./chunk-K43CZ3M5.js";
import "./chunk-6EIBUVMG.js";
import "./chunk-NBJSAHZT.js";
import "./chunk-BD24XM4D.js";
import "./chunk-NXXQ35YM.js";
import "./chunk-3BXPVUY5.js";
import {
  I
} from "./chunk-LM3JDV4W.js";
import "./chunk-34V2CLL5.js";
import "./chunk-RXENIWFD.js";
import "./chunk-CXNERL22.js";
import "./chunk-7V4JSBFA.js";
import "./chunk-ACSTKBET.js";
import "./chunk-KAHESDP5.js";
import "./chunk-ONRZ4VTT.js";
import "./chunk-REIMIECM.js";
import "./chunk-EO2EW5KR.js";
import "./chunk-JEFPXTYT.js";
import "./chunk-MVS2BECH.js";
import "./chunk-UZ7IOCF3.js";
import "./chunk-OS542PQQ.js";
import "./chunk-3B5GODXR.js";
import "./chunk-NKXXHQDD.js";
import "./chunk-7TBQUMV3.js";
import "./chunk-TPLUZX3A.js";
import "./chunk-BGLJ2FAH.js";
import "./chunk-2EJFYNM7.js";
import "./chunk-DC5LRNPY.js";
import "./chunk-ASCK5HJ5.js";
import "./chunk-5X5U7R6O.js";
import "./chunk-XNLAOXPY.js";
import "./chunk-ZT7V2AVD.js";
import "./chunk-C2OXE4NQ.js";
import "./chunk-KOI252FF.js";
import "./chunk-I2TVVMQ6.js";
import "./chunk-5EGQYY2H.js";
import "./chunk-JKPUNUQA.js";
import "./chunk-SR7PRON4.js";
import "./chunk-HGHPYGKP.js";
import "./chunk-4DSGTDZJ.js";
import "./chunk-VYTPFEL2.js";
import "./chunk-RLGDH6IY.js";
import "./chunk-MRPCXIVS.js";
import "./chunk-YTKVV2Y3.js";
import "./chunk-GCVQXAS4.js";
import "./chunk-UFQD6AL4.js";
import "./chunk-THZPD5CT.js";
import "./chunk-OBCA6CWH.js";
import "./chunk-2JI245BP.js";
import "./chunk-ZEZ3LI2L.js";
import "./chunk-N34BRXVM.js";
import "./chunk-KETDH2J4.js";
import "./chunk-7QV7DHWN.js";
import "./chunk-4L4Y34YK.js";
import "./chunk-BXONKQKI.js";
import "./chunk-2HDBQXAR.js";
import "./chunk-RNF7VOCU.js";
import {
  _
} from "./chunk-TIRJMGGG.js";
import "./chunk-ZDRQSPB6.js";
import "./chunk-DCXDXGAR.js";
import "./chunk-BCCDYCTQ.js";
import "./chunk-AYL3HQHD.js";
import "./chunk-66YQWHHE.js";
import "./chunk-QGBMZIP4.js";
import "./chunk-AOEBZVTA.js";
import "./chunk-2OZSYJDX.js";
import "./chunk-MZM4INJV.js";
import "./chunk-J4GMQHGL.js";
import "./chunk-MHPE4SZA.js";
import "./chunk-6SSA7P3A.js";
import "./chunk-FQBTLEUI.js";
import "./chunk-GS7Y3YOG.js";
import "./chunk-Y2HYKTTT.js";
import "./chunk-XLEC46FY.js";
import "./chunk-4AZPIP7K.js";
import "./chunk-G73HQZEL.js";
import "./chunk-LZSLQ24Q.js";
import "./chunk-U3RHUXYK.js";
import "./chunk-7DBI6LQG.js";
import "./chunk-AUUN7RFQ.js";
import "./chunk-JAMSDYD6.js";
import "./chunk-PH6NPTP7.js";
import "./chunk-NUICEVIH.js";
import "./chunk-NXK752PZ.js";
import "./chunk-UVNLCXWD.js";
import "./chunk-PNUA7JOS.js";
import "./chunk-OR2FKGUM.js";
import {
  b
} from "./chunk-UDMPWVPF.js";
import "./chunk-XJNKCEWL.js";
import {
  D,
  s
} from "./chunk-AIZ3T7E3.js";
import "./chunk-6UEMNP3E.js";
import "./chunk-6WGE3IUL.js";
import "./chunk-MLYB2YW4.js";
import "./chunk-6JFGZTLU.js";
import {
  O
} from "./chunk-2ZJE6ZFX.js";
import {
  __async
} from "./chunk-XBPEBUD5.js";

// ../../../node_modules/@arcgis/core/widgets/OrientedImageryViewer/adapters/OrientedImageryViewerViewModelAdapter3D.js
var w = class {
  constructor(g) {
    this.viewModel = g, this.createFootprints = (r) => __async(this, null, function* () {
      const {
        coverageFrustums: o,
        currentBestFeature: c,
        isAdditionalCoverageVisible: m,
        view: p
      } = this.viewModel, g2 = o.filter(O);
      for (const t of g2) {
        let o2 = t.clone();
        if (!p.spatialReference.equals(o2.spatialReference)) {
          const {
            components: e,
            spatialReference: t2,
            origin: c2,
            vertexAttributes: m2,
            vertexSpace: u2
          } = o2;
          if ("local" === u2.type) {
            const e2 = yield I(c2, p.spatialReference, r);
            s(r), o2.centerAt(e2);
          } else {
            const s2 = m2.position, c3 = Float64Array.from(yield N([...s2], t2.clone(), p.spatialReference.clone(), r));
            s(r), o2 = new $({
              vertexAttributes: new l({
                position: c3
              }),
              components: e,
              spatialReference: p.spatialReference.clone()
            });
          }
        }
        t.imageID === c.attributes.objectId ? this.viewModel.bestFeatureFootprint = new d({
          attributes: {
            imageID: t.imageID
          },
          geometry: o2,
          symbol: u.clone(),
          visible: false
        }) : this.viewModel.additionalFootprints.push(new d({
          attributes: {
            imageID: t.imageID
          },
          geometry: o2,
          symbol: M.clone(),
          visible: m
        }));
      }
    }), this.updateFootprint = (r, n) => __async(this, null, function* () {
      const {
        currentBestFeature: l2,
        imagePointsInView: m,
        activeViewer: f,
        footprintExtent: g2,
        view: w2
      } = this.viewModel, y = b($, this.viewModel.getCurrentBestFeaturePolygon().geometry), h = f?.imageSize;
      if (!(l2 && y && m && h && g2)) return;
      const {
        cameraHeight: v,
        location: b3,
        cameraPitch: F,
        horizontalFieldOfView: R,
        verticalFieldOfView: j,
        cameraRoll: M2,
        imageRotation: V
      } = l2.attributes, I2 = b3.toArray(), {
        vertexAttributes: {
          position: A
        },
        spatialReference: P
      } = y, x = yield d2(A, P, b3.spatialReference), z = yield E(r, {
        feature: l2,
        imageProperties: {
          width: h[0],
          height: h[1]
        },
        options: n,
        footprintExtent: g2
      });
      s(n);
      let C = z.filter(O);
      if (!C.length) return;
      C[0].spatialReference.equals(b3.spatialReference) || (C = yield Promise.all(C.map((e) => __async(this, null, function* () {
        const t = yield I(e, b3.spatialReference, n);
        return s(n), t;
      }))));
      const O2 = yield L(m.slice(0, 4).map(({
        x: e,
        y: t
      }) => [e, t]), C.slice(0, 4).map((e) => e.toArray()), {
        cameraHeight: v,
        cameraLocation: I2,
        cameraPitch: F,
        frustumVertices: x,
        horizontalFieldOfView: R,
        imageHeight: h[1],
        imageWidth: h[0],
        inSRS: {
          wkid: b3.spatialReference.wkid
        },
        outSRS: {
          wkid: w2.spatialReference.wkid
        },
        verticalFieldOfView: j,
        cameraRoll: M2 ?? 0,
        imageRotation: V ?? 0,
        options: n
      });
      this.viewModel.updateCurrentCoveragePolygon(new d({
        attributes: {
          imageID: l2.attributes.objectId
        },
        geometry: O2,
        symbol: u.clone(),
        visible: this.viewModel.currentCoverageVisible
      }));
    }), this.updateFootprintPanorama = (t, i) => __async(this, null, function* () {
      yield D(i);
      const {
        horizontalFieldOfView: o,
        pitch: a,
        verticalFieldOfView: s2,
        yaw: n
      } = t, l2 = this.viewModel.currentBestFeature?.clone();
      if (!l2) return;
      const {
        attributes: c
      } = l2;
      c.orientedImageryType = null, c.cameraHeading = (n + c.cameraHeading) % 360, c.cameraPitch = a, c.horizontalFieldOfView = o, c.verticalFieldOfView = s2, c.cameraRoll = 0;
      const {
        frustum: p
      } = b2(c);
      p && this.viewModel.updateCurrentCoveragePolygon(new d({
        attributes: {
          imageID: c.objectId
        },
        geometry: p,
        symbol: u.clone(),
        visible: this.viewModel.currentCoverageVisible
      }));
    });
  }
  updateGroundElevation(e, t) {
    const {
      geometry: i
    } = this.viewModel.currentBestFeature, r = t.queryElevation(i);
    e.forEach((e2) => {
      const {
        geometry: t2
      } = e2;
      switch (t2?.type) {
        case "mesh": {
          const {
            vertexAttributes: {
              position: e3
            }
          } = t2, i2 = Math.floor(e3.length / 3);
          for (let t3 = 0; t3 < i2; t3 += 1) e3[3 * t3 + 2] += r?.z ?? 0;
          break;
        }
        case "point":
          t2.z = (t2.z ?? 0) + (r?.z ?? 0);
      }
    });
  }
};
function d2(e, t, i, r) {
  return __async(this, null, function* () {
    return Float64Array.from((yield Promise.all(e.reduce((e2, t2, i2) => {
      const r2 = Math.floor(i2 / 3);
      return e2[r2] = e2[r2] ?? [], e2[r2].push(t2), e2;
    }, new Array()).map((e2) => __async(this, null, function* () {
      return (yield I(new _(e2, t), i, r)).toArray();
    })))).flat());
  });
}
export {
  w as default
};
//# sourceMappingURL=OrientedImageryViewerViewModelAdapter3D-YS3IHOYE.js.map
