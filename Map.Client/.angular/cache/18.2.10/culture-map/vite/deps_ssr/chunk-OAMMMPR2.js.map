{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/layers/graphics/applyEditsUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport t from \"../../Graphic.js\";\nimport e from \"../../core/Error.js\";\nimport r from \"../../core/Logger.js\";\nimport { getMetersPerCartesianUnitForSR as a } from \"../../core/unitUtils.js\";\nimport { parseData as o } from \"../../core/urlUtils.js\";\nimport { isEqualBaseGCS as s, canProjectWithoutEngine as n, projectWithoutEngine as l } from \"../../geometry/projection.js\";\nimport { fromJSON as i } from \"../../geometry/support/jsonUtils.js\";\nimport u from \"../../geometry/support/MeshTransform.js\";\nimport { equals as d } from \"../../geometry/support/spatialReferenceUtils.js\";\nimport { isFeatureIdentifierArrayWithGlobalId as c, isFeatureIdentifierArrayWithObjectId as p } from \"./editingSupport.js\";\nasync function m(t, e, r) {\n  const {\n      geometry: o\n    } = e,\n    i = {\n      ...e.attributes\n    };\n  if (null != r && \"mesh\" === o?.type) {\n    const {\n        transformFieldRoles: e\n      } = r,\n      {\n        origin: c,\n        spatialReference: p,\n        vertexSpace: m\n      } = o,\n      f = o.transform ?? new u(),\n      g = \"local\" === m.type,\n      b = t.spatialReference,\n      y = b.isGeographic,\n      R = d(b, p),\n      h = s(p, b) && n(p, b);\n    if (!(g && y && h || !g && !y && R)) return null;\n    const I = l(c, p, b);\n    if (null == I) return null;\n    if (i[e.originX] = I.x, i[e.originY] = I.y, i[e.originZ] = I.z ?? 0, null != f) {\n      const {\n          translation: t,\n          scale: r,\n          rotation: o\n        } = f,\n        s = g ? 1 : a(p) / a(b);\n      i[e.translationX] = t[0] * s, i[e.translationY] = t[2] * s, i[e.translationZ] = -t[1] * s, i[e.scaleX] = r[0], i[e.scaleY] = r[2], i[e.scaleZ] = r[1], i[e.rotationX] = o[0], i[e.rotationY] = o[2], i[e.rotationZ] = -o[1], i[e.rotationDeg] = o[3];\n    }\n    return {\n      attributes: i\n    };\n  }\n  return null == o ? {\n    attributes: i\n  } : \"mesh\" === o.type || \"extent\" === o.type ? null : {\n    geometry: o.toJSON(),\n    attributes: i\n  };\n}\nasync function f(t, e) {\n  const r = await Promise.all((e.addAttachments ?? []).map(e => g(t, e))),\n    a = await Promise.all((e.updateAttachments ?? []).map(e => g(t, e))),\n    o = e.deleteAttachments ?? [];\n  return r.length || a.length || o.length ? {\n    adds: r,\n    updates: a,\n    deletes: [...o]\n  } : null;\n}\nasync function g(t, e) {\n  const {\n      feature: r,\n      attachment: a\n    } = e,\n    {\n      globalId: s,\n      name: n,\n      contentType: l,\n      data: i,\n      uploadId: u\n    } = a,\n    d = {\n      globalId: s\n    };\n  if (r && (\"attributes\" in r ? d.parentGlobalId = r.attributes?.[t.globalIdField] : r.globalId && (d.parentGlobalId = r.globalId)), u) d.uploadId = u;else if (i) {\n    const t = await o(i);\n    t && (d.contentType = t.mediaType, d.data = t.data), i instanceof File && (d.name = i.name);\n  }\n  return n && (d.name = n), l && (d.contentType = l), d;\n}\nfunction b(t, e, r) {\n  if (!e || 0 === e.length) return [];\n  if (r && c(e)) return e.map(t => t.globalId);\n  if (p(e)) return e.map(t => t.objectId);\n  const a = r ? t.globalIdField : t.objectIdField;\n  return a ? e.map(t => t.getAttribute(a)) : [];\n}\nfunction y(t) {\n  const e = t?.assetMaps;\n  if (e) {\n    for (const t of e.addResults) t.success || r.getLogger(\"esri.layers.graphics.sources.support.sourceUtils\").error(`Failed to map asset to feature with globalId ${t.globalId}.`);\n    for (const t of e.updateResults) t.success || r.getLogger(\"esri.layers.graphics.sources.support.sourceUtils\").error(`Failed to map asset to feature with globalId ${t.globalId}.`);\n  }\n  const a = t?.attachments,\n    o = {\n      addFeatureResults: t?.addResults?.map(R) ?? [],\n      updateFeatureResults: t?.updateResults?.map(R) ?? [],\n      deleteFeatureResults: t?.deleteResults?.map(R) ?? [],\n      addAttachmentResults: a?.addResults ? a.addResults.map(R) : [],\n      updateAttachmentResults: a?.updateResults ? a.updateResults.map(R) : [],\n      deleteAttachmentResults: a?.deleteResults ? a.deleteResults.map(R) : []\n    };\n  return t?.editMoment && (o.editMoment = t.editMoment), o;\n}\nfunction R(t) {\n  const r = !0 === t.success ? null : t.error || {\n    code: void 0,\n    description: void 0\n  };\n  return {\n    objectId: t.objectId,\n    globalId: t.globalId,\n    error: r ? new e(\"feature-layer-source:edit-failure\", r.description, {\n      code: r.code\n    }) : null\n  };\n}\nfunction h(e, r) {\n  return new t({\n    attributes: e.attributes,\n    geometry: i({\n      ...e.geometry,\n      spatialReference: r\n    })\n  });\n}\nfunction I(t, e) {\n  return {\n    adds: t?.adds?.map(t => h(t, e)) || [],\n    updates: t?.updates?.map(t => ({\n      original: h(t[0], e),\n      current: h(t[1], e)\n    })) || [],\n    deletes: t?.deletes?.map(t => h(t, e)) || [],\n    spatialReference: e\n  };\n}\nfunction j(t) {\n  const e = t.details.raw,\n    r = +e.code,\n    a = +e.extendedCode;\n  return 500 === r && (-2147217144 === a || -2147467261 === a);\n}\nexport { I as createEditedFeatures, R as createFeatureEditResult, f as getAttachmentEditsJSON, b as getFeatureIds, m as getFeatureJSON, j as isProtectedOrPrivateVersionError, y as unpackEditResultData };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,SAAe,EAAE,GAAG,GAAG,GAAG;AAAA;AACxB,UAAM;AAAA,MACF,UAAU;AAAA,IACZ,IAAI,GACJ,IAAI,mBACC,EAAE;AAET,QAAI,QAAQ,KAAK,WAAW,GAAG,MAAM;AACnC,YAAM;AAAA,QACF,qBAAqBA;AAAA,MACvB,IAAI,GACJ;AAAA,QACE,QAAQ;AAAA,QACR,kBAAkB;AAAA,QAClB,aAAaC;AAAA,MACf,IAAI,GACJC,KAAI,EAAE,aAAa,IAAI,EAAE,GACzBC,KAAI,YAAYF,GAAE,MAClBG,KAAI,EAAE,kBACNC,KAAID,GAAE,cACNE,KAAI,EAAEF,IAAG,CAAC,GACVG,KAAI,EAAE,GAAGH,EAAC,KAAK,EAAE,GAAGA,EAAC;AACvB,UAAI,EAAED,MAAKE,MAAKE,MAAK,CAACJ,MAAK,CAACE,MAAKC,IAAI,QAAO;AAC5C,YAAME,KAAI,EAAE,GAAG,GAAGJ,EAAC;AACnB,UAAI,QAAQI,GAAG,QAAO;AACtB,UAAI,EAAER,GAAE,OAAO,IAAIQ,GAAE,GAAG,EAAER,GAAE,OAAO,IAAIQ,GAAE,GAAG,EAAER,GAAE,OAAO,IAAIQ,GAAE,KAAK,GAAG,QAAQN,IAAG;AAC9E,cAAM;AAAA,UACF,aAAaO;AAAA,UACb,OAAOC;AAAA,UACP,UAAUC;AAAA,QACZ,IAAIT,IACJU,KAAIT,KAAI,IAAI,EAAE,CAAC,IAAI,EAAEC,EAAC;AACxB,UAAEJ,GAAE,YAAY,IAAIS,GAAE,CAAC,IAAIG,IAAG,EAAEZ,GAAE,YAAY,IAAIS,GAAE,CAAC,IAAIG,IAAG,EAAEZ,GAAE,YAAY,IAAI,CAACS,GAAE,CAAC,IAAIG,IAAG,EAAEZ,GAAE,MAAM,IAAIU,GAAE,CAAC,GAAG,EAAEV,GAAE,MAAM,IAAIU,GAAE,CAAC,GAAG,EAAEV,GAAE,MAAM,IAAIU,GAAE,CAAC,GAAG,EAAEV,GAAE,SAAS,IAAIW,GAAE,CAAC,GAAG,EAAEX,GAAE,SAAS,IAAIW,GAAE,CAAC,GAAG,EAAEX,GAAE,SAAS,IAAI,CAACW,GAAE,CAAC,GAAG,EAAEX,GAAE,WAAW,IAAIW,GAAE,CAAC;AAAA,MACrP;AACA,aAAO;AAAA,QACL,YAAY;AAAA,MACd;AAAA,IACF;AACA,WAAO,QAAQ,IAAI;AAAA,MACjB,YAAY;AAAA,IACd,IAAI,WAAW,EAAE,QAAQ,aAAa,EAAE,OAAO,OAAO;AAAA,MACpD,UAAU,EAAE,OAAO;AAAA,MACnB,YAAY;AAAA,IACd;AAAA,EACF;AAAA;AACA,SAAe,EAAE,GAAG,GAAG;AAAA;AACrB,UAAM,IAAI,MAAM,QAAQ,KAAK,EAAE,kBAAkB,CAAC,GAAG,IAAI,CAAAX,OAAK,EAAE,GAAGA,EAAC,CAAC,CAAC,GACpE,IAAI,MAAM,QAAQ,KAAK,EAAE,qBAAqB,CAAC,GAAG,IAAI,CAAAA,OAAK,EAAE,GAAGA,EAAC,CAAC,CAAC,GACnE,IAAI,EAAE,qBAAqB,CAAC;AAC9B,WAAO,EAAE,UAAU,EAAE,UAAU,EAAE,SAAS;AAAA,MACxC,MAAM;AAAA,MACN,SAAS;AAAA,MACT,SAAS,CAAC,GAAG,CAAC;AAAA,IAChB,IAAI;AAAA,EACN;AAAA;AACA,SAAe,EAAE,GAAG,GAAG;AAAA;AACrB,UAAM;AAAA,MACF,SAAS;AAAA,MACT,YAAY;AAAA,IACd,IAAI,GACJ;AAAA,MACE,UAAUY;AAAA,MACV,MAAMC;AAAA,MACN,aAAa;AAAA,MACb,MAAM;AAAA,MACN,UAAU;AAAA,IACZ,IAAI,GACJC,KAAI;AAAA,MACF,UAAUF;AAAA,IACZ;AACF,QAAI,MAAM,gBAAgB,IAAIE,GAAE,iBAAiB,EAAE,aAAa,EAAE,aAAa,IAAI,EAAE,aAAaA,GAAE,iBAAiB,EAAE,YAAY,EAAG,CAAAA,GAAE,WAAW;AAAA,aAAW,GAAG;AAC/J,YAAML,KAAI,MAAM,GAAE,CAAC;AACnB,MAAAA,OAAMK,GAAE,cAAcL,GAAE,WAAWK,GAAE,OAAOL,GAAE,OAAO,aAAa,SAASK,GAAE,OAAO,EAAE;AAAA,IACxF;AACA,WAAOD,OAAMC,GAAE,OAAOD,KAAI,MAAMC,GAAE,cAAc,IAAIA;AAAA,EACtD;AAAA;AACA,SAAS,EAAE,GAAG,GAAG,GAAG;AAClB,MAAI,CAAC,KAAK,MAAM,EAAE,OAAQ,QAAO,CAAC;AAClC,MAAI,KAAK,EAAE,CAAC,EAAG,QAAO,EAAE,IAAI,CAAAL,OAAKA,GAAE,QAAQ;AAC3C,MAAI,EAAE,CAAC,EAAG,QAAO,EAAE,IAAI,CAAAA,OAAKA,GAAE,QAAQ;AACtC,QAAM,IAAI,IAAI,EAAE,gBAAgB,EAAE;AAClC,SAAO,IAAI,EAAE,IAAI,CAAAA,OAAKA,GAAE,aAAa,CAAC,CAAC,IAAI,CAAC;AAC9C;AACA,SAASJ,GAAE,GAAG;AACZ,QAAM,IAAI,GAAG;AACb,MAAI,GAAG;AACL,eAAWI,MAAK,EAAE,WAAY,CAAAA,GAAE,WAAW,EAAE,UAAU,kDAAkD,EAAE,MAAM,gDAAgDA,GAAE,QAAQ,GAAG;AAC9K,eAAWA,MAAK,EAAE,cAAe,CAAAA,GAAE,WAAW,EAAE,UAAU,kDAAkD,EAAE,MAAM,gDAAgDA,GAAE,QAAQ,GAAG;AAAA,EACnL;AACA,QAAM,IAAI,GAAG,aACX,IAAI;AAAA,IACF,mBAAmB,GAAG,YAAY,IAAI,CAAC,KAAK,CAAC;AAAA,IAC7C,sBAAsB,GAAG,eAAe,IAAI,CAAC,KAAK,CAAC;AAAA,IACnD,sBAAsB,GAAG,eAAe,IAAI,CAAC,KAAK,CAAC;AAAA,IACnD,sBAAsB,GAAG,aAAa,EAAE,WAAW,IAAI,CAAC,IAAI,CAAC;AAAA,IAC7D,yBAAyB,GAAG,gBAAgB,EAAE,cAAc,IAAI,CAAC,IAAI,CAAC;AAAA,IACtE,yBAAyB,GAAG,gBAAgB,EAAE,cAAc,IAAI,CAAC,IAAI,CAAC;AAAA,EACxE;AACF,SAAO,GAAG,eAAe,EAAE,aAAa,EAAE,aAAa;AACzD;AACA,SAAS,EAAE,GAAG;AACZ,QAAM,IAAI,SAAO,EAAE,UAAU,OAAO,EAAE,SAAS;AAAA,IAC7C,MAAM;AAAA,IACN,aAAa;AAAA,EACf;AACA,SAAO;AAAA,IACL,UAAU,EAAE;AAAA,IACZ,UAAU,EAAE;AAAA,IACZ,OAAO,IAAI,IAAI,EAAE,qCAAqC,EAAE,aAAa;AAAA,MACnE,MAAM,EAAE;AAAA,IACV,CAAC,IAAI;AAAA,EACP;AACF;AACA,SAAS,EAAE,GAAG,GAAG;AACf,SAAO,IAAI,EAAE;AAAA,IACX,YAAY,EAAE;AAAA,IACd,UAAU,EAAE,iCACP,EAAE,WADK;AAAA,MAEV,kBAAkB;AAAA,IACpB,EAAC;AAAA,EACH,CAAC;AACH;AACA,SAAS,EAAE,GAAG,GAAG;AACf,SAAO;AAAA,IACL,MAAM,GAAG,MAAM,IAAI,CAAAA,OAAK,EAAEA,IAAG,CAAC,CAAC,KAAK,CAAC;AAAA,IACrC,SAAS,GAAG,SAAS,IAAI,CAAAA,QAAM;AAAA,MAC7B,UAAU,EAAEA,GAAE,CAAC,GAAG,CAAC;AAAA,MACnB,SAAS,EAAEA,GAAE,CAAC,GAAG,CAAC;AAAA,IACpB,EAAE,KAAK,CAAC;AAAA,IACR,SAAS,GAAG,SAAS,IAAI,CAAAA,OAAK,EAAEA,IAAG,CAAC,CAAC,KAAK,CAAC;AAAA,IAC3C,kBAAkB;AAAA,EACpB;AACF;AACA,SAAS,EAAE,GAAG;AACZ,QAAM,IAAI,EAAE,QAAQ,KAClB,IAAI,CAAC,EAAE,MACP,IAAI,CAAC,EAAE;AACT,SAAO,QAAQ,MAAM,gBAAgB,KAAK,gBAAgB;AAC5D;",
  "names": ["e", "m", "f", "g", "b", "y", "R", "h", "I", "t", "r", "o", "s", "n", "d"]
}
