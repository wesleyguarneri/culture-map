{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { watch as e } from \"../../../../core/reactiveUtils.js\";\nimport { fromTranslation as t, scale as r } from \"../../../../core/libs/gl-matrix-2/math/mat4.js\";\nimport { create as i } from \"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";\nimport { p as s, n as o, f as a, c as n, e as c, g as l } from \"../../../../chunks/vec32.js\";\nimport { create as u, ZEROS as h } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { c as d } from \"../../../../chunks/vec42.js\";\nimport { fromValues as m } from \"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";\nimport { sv3d as _ } from \"../../../../geometry/support/vectorStacks.js\";\nimport { makeDehydratedPoint as p } from \"../../../../layers/graphics/dehydratedPoint.js\";\nimport { EngineVisualElement as f } from \"./EngineVisualElement.js\";\nimport { drapedZ as g } from \"../../terrain/OverlayRenderer.js\";\nimport { Attribute as b } from \"../../webgl-engine/lib/Attribute.js\";\nimport { Geometry as M } from \"../../webgl-engine/lib/Geometry.js\";\nimport { createPolylineGeometry as O } from \"../../webgl-engine/lib/GeometryUtil.js\";\nimport { RenderOccludedFlag as j } from \"../../webgl-engine/lib/Material.js\";\nimport { RenderGeometry as R } from \"../../webgl-engine/lib/RenderGeometry.js\";\nimport { VertexAttribute as w } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { ColorMaterial as z } from \"../../webgl-engine/materials/ColorMaterial.js\";\nimport { RibbonLineMaterial as y } from \"../../webgl-engine/materials/RibbonLineMaterial.js\";\nclass D extends f {\n  constructor(e) {\n    super(e), this._maxSize = 0, this._position = u(), this._up = u(), this._right = u(), this._renderOccluded = j.OccludeAndTransparent, this._color = m(1, 0, 0, 1), this._outlineColor = m(0, 0, 0, 1), this._outlineSize = 0, this._size = 32, this._outlineRenderOccluded = j.Opaque, this.applyProperties(e);\n  }\n  createObject3DResourceFactory(e) {\n    return {\n      view: e,\n      createResources: e => this._createObject3DResources(e),\n      destroyResources: () => {},\n      cameraChanged: () => this._updateTransformObject3D()\n    };\n  }\n  createDrapedResourceFactory(e) {\n    return {\n      view: e,\n      createResources: () => this._createDrapedResources(),\n      destroyResources: P\n    };\n  }\n  get renderOccluded() {\n    return this._renderOccluded;\n  }\n  set renderOccluded(e) {\n    e !== this._renderOccluded && (this._renderOccluded = e, this._updateQuadMaterial());\n  }\n  get color() {\n    return this._color;\n  }\n  set color(e) {\n    d(this._color, e), this._updateQuadMaterial();\n  }\n  get outlineColor() {\n    return this._outlineColor;\n  }\n  set outlineColor(e) {\n    d(this._outlineColor, e), this._updateOutlineMaterial();\n  }\n  get outlineSize() {\n    return this._outlineSize;\n  }\n  set outlineSize(e) {\n    const t = 0 === this._outlineSize != (0 === e);\n    this._outlineSize = e, t ? this.recreateGeometry() : this._updateOutlineMaterial();\n  }\n  get size() {\n    return this._size;\n  }\n  set size(e) {\n    e !== this._size && (this._size = e, this._updateTransform());\n  }\n  get outlineRenderOccluded() {\n    return this._outlineRenderOccluded;\n  }\n  set outlineRenderOccluded(e) {\n    this._outlineRenderOccluded = e, this._updateOutlineMaterial();\n  }\n  set geometry({\n    previous: e,\n    center: t,\n    next: r\n  }) {\n    this._maxSize = Math.min(s(t, e), s(t, r)) / 3, o(this._up, a(this._up, e, t)), o(this._right, a(this._right, r, t)), n(this._position, t), this.recreateGeometry();\n  }\n  _createObject3DResources(e) {\n    const t = new z(this._quadMaterialParameters),\n      r = 0 === this._outlineSize ? void 0 : new y(this._outlineMaterialParameters);\n    return this._createObject3DGeometries(e, t, r), {\n      quadMaterial: t,\n      outlineMaterial: r,\n      forEach: e => {\n        e(t), r && e(r);\n      }\n    };\n  }\n  _createObject3DGeometries(e, t, r) {\n    if (c(this._up, h) && c(this._right, h)) return;\n    const i = this._createGeometries(t, r);\n    for (const s of i) e.addGeometry(s);\n    this._updateTransformObject3D(e);\n  }\n  _createDrapedResources() {\n    const t = new z(this._quadMaterialParameters),\n      r = 0 === this._outlineSize ? void 0 : new y(this._outlineMaterialParameters),\n      i = this._createGeometries(t, r).map(e => new R(e));\n    this._setTransformDraped(i);\n    return {\n      quadMaterial: t,\n      outlineMaterial: r,\n      geometries: i,\n      pixelRatioHandle: e(() => this.view.state.contentPixelRatio, () => {\n        this.drapedResources.recreateGeometry();\n      })\n    };\n  }\n  _createGeometries(e, t) {\n    const {\n        up: r,\n        right: i,\n        corner: s\n      } = this._getVertices(),\n      o = v(r, i, s, e);\n    if (!t) return [o];\n    return [o, O(t, [r, s, i])];\n  }\n  _getVertices() {\n    let e = this._up,\n      t = this._right;\n    const r = l(_.get(), e, t);\n    return this.isDraped && (e = n(_.get(), e), t = n(_.get(), t), e[2] = 0, t[2] = 0, r[2] = 0), {\n      up: e,\n      right: t,\n      corner: r\n    };\n  }\n  _updateTransform() {\n    this.isDraped ? this.drapedResources.recreateGeometry() : this._updateTransformObject3D();\n  }\n  _updateTransformObject3D(e = this.object3dResources.object) {\n    if (!e) return;\n    const i = this.view.state.camera,\n      s = this._size * i.computeScreenPixelSizeAt(this._position),\n      o = Math.min(this._maxSize, s);\n    t(x, this._position), r(x, x, [o, o, o]), e.transformation = x;\n  }\n  _setTransformDraped(e) {\n    if (0 === e.length) return;\n    const {\n        view: {\n          basemapTerrain: {\n            overlayManager: i\n          },\n          state: {\n            contentPixelRatio: s\n          }\n        }\n      } = this,\n      {\n        _position: o,\n        _size: a\n      } = this,\n      c = n(_.get(), o);\n    c[2] = g;\n    const l = S;\n    l.spatialReference = i.renderer.spatialReference, l.x = c[0], l.y = c[1];\n    const u = a * (this.view.overlayPixelSizeInMapUnits(l) * s),\n      h = Math.min(this._maxSize, u);\n    t(x, c), r(x, x, [h, h, 1]);\n    for (const t of e) t.transformation = x;\n  }\n  get _quadMaterialParameters() {\n    return {\n      color: this._color,\n      forceTransparentMode: !0,\n      writeDepth: !1,\n      polygonOffset: !0,\n      renderOccluded: this._renderOccluded,\n      isDecoration: this.isDecoration\n    };\n  }\n  _updateQuadMaterial() {\n    this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters), this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters);\n  }\n  get _outlineMaterialParameters() {\n    return {\n      color: this._outlineColor,\n      width: this._outlineSize,\n      renderOccluded: this._outlineRenderOccluded,\n      isDecoration: this.isDecoration\n    };\n  }\n  _updateOutlineMaterial() {\n    this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters), this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters);\n  }\n}\nfunction P(e) {\n  e.pixelRatioHandle.remove(), e.geometries = [];\n}\nfunction v(e, t, r, i) {\n  return new M(i, [[w.POSITION, new b([0, 0, 0, ...t, ...e, ...r], [0, 1, 2, 1, 2, 3], 3, !0)]]);\n}\nconst x = i(),\n  S = p(0, 0, void 0, null);\nexport { D as RightAngleQuadVisualElement };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA,IAAM,IAAN,cAAgBA,GAAE;AAAA,EAChB,YAAYC,IAAG;AACb,UAAMA,EAAC,GAAG,KAAK,WAAW,GAAG,KAAK,YAAY,EAAE,GAAG,KAAK,MAAM,EAAE,GAAG,KAAK,SAAS,EAAE,GAAG,KAAK,kBAAkB,EAAE,uBAAuB,KAAK,SAASC,GAAE,GAAG,GAAG,GAAG,CAAC,GAAG,KAAK,gBAAgBA,GAAE,GAAG,GAAG,GAAG,CAAC,GAAG,KAAK,eAAe,GAAG,KAAK,QAAQ,IAAI,KAAK,yBAAyB,EAAE,QAAQ,KAAK,gBAAgBD,EAAC;AAAA,EAC/S;AAAA,EACA,8BAA8BA,IAAG;AAC/B,WAAO;AAAA,MACL,MAAMA;AAAA,MACN,iBAAiB,CAAAA,OAAK,KAAK,yBAAyBA,EAAC;AAAA,MACrD,kBAAkB,MAAM;AAAA,MAAC;AAAA,MACzB,eAAe,MAAM,KAAK,yBAAyB;AAAA,IACrD;AAAA,EACF;AAAA,EACA,4BAA4BA,IAAG;AAC7B,WAAO;AAAA,MACL,MAAMA;AAAA,MACN,iBAAiB,MAAM,KAAK,uBAAuB;AAAA,MACnD,kBAAkB;AAAA,IACpB;AAAA,EACF;AAAA,EACA,IAAI,iBAAiB;AACnB,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,eAAeA,IAAG;AACpB,IAAAA,OAAM,KAAK,oBAAoB,KAAK,kBAAkBA,IAAG,KAAK,oBAAoB;AAAA,EACpF;AAAA,EACA,IAAI,QAAQ;AACV,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,MAAMA,IAAG;AACX,MAAE,KAAK,QAAQA,EAAC,GAAG,KAAK,oBAAoB;AAAA,EAC9C;AAAA,EACA,IAAI,eAAe;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,aAAaA,IAAG;AAClB,MAAE,KAAK,eAAeA,EAAC,GAAG,KAAK,uBAAuB;AAAA,EACxD;AAAA,EACA,IAAI,cAAc;AAChB,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,YAAYA,IAAG;AACjB,UAAMD,KAAI,MAAM,KAAK,iBAAiB,MAAMC;AAC5C,SAAK,eAAeA,IAAGD,KAAI,KAAK,iBAAiB,IAAI,KAAK,uBAAuB;AAAA,EACnF;AAAA,EACA,IAAI,OAAO;AACT,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,KAAKC,IAAG;AACV,IAAAA,OAAM,KAAK,UAAU,KAAK,QAAQA,IAAG,KAAK,iBAAiB;AAAA,EAC7D;AAAA,EACA,IAAI,wBAAwB;AAC1B,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,sBAAsBA,IAAG;AAC3B,SAAK,yBAAyBA,IAAG,KAAK,uBAAuB;AAAA,EAC/D;AAAA,EACA,IAAI,SAAS;AAAA,IACX,UAAUA;AAAA,IACV,QAAQD;AAAA,IACR,MAAME;AAAA,EACR,GAAG;AACD,SAAK,WAAW,KAAK,IAAI,EAAEF,IAAGC,EAAC,GAAG,EAAED,IAAGE,EAAC,CAAC,IAAI,GAAG,EAAE,KAAK,KAAK,EAAE,KAAK,KAAKD,IAAGD,EAAC,CAAC,GAAG,EAAE,KAAK,QAAQ,EAAE,KAAK,QAAQE,IAAGF,EAAC,CAAC,GAAG,EAAE,KAAK,WAAWA,EAAC,GAAG,KAAK,iBAAiB;AAAA,EACpK;AAAA,EACA,yBAAyBC,IAAG;AAC1B,UAAMD,KAAI,IAAIG,GAAE,KAAK,uBAAuB,GAC1CD,KAAI,MAAM,KAAK,eAAe,SAAS,IAAIE,GAAE,KAAK,0BAA0B;AAC9E,WAAO,KAAK,0BAA0BH,IAAGD,IAAGE,EAAC,GAAG;AAAA,MAC9C,cAAcF;AAAA,MACd,iBAAiBE;AAAA,MACjB,SAAS,CAAAD,OAAK;AACZ,QAAAA,GAAED,EAAC,GAAGE,MAAKD,GAAEC,EAAC;AAAA,MAChB;AAAA,IACF;AAAA,EACF;AAAA,EACA,0BAA0BD,IAAGD,IAAGE,IAAG;AACjC,QAAI,EAAE,KAAK,KAAK,CAAC,KAAK,EAAE,KAAK,QAAQ,CAAC,EAAG;AACzC,UAAM,IAAI,KAAK,kBAAkBF,IAAGE,EAAC;AACrC,eAAW,KAAK,EAAG,CAAAD,GAAE,YAAY,CAAC;AAClC,SAAK,yBAAyBA,EAAC;AAAA,EACjC;AAAA,EACA,yBAAyB;AACvB,UAAMD,KAAI,IAAIG,GAAE,KAAK,uBAAuB,GAC1CD,KAAI,MAAM,KAAK,eAAe,SAAS,IAAIE,GAAE,KAAK,0BAA0B,GAC5E,IAAI,KAAK,kBAAkBJ,IAAGE,EAAC,EAAE,IAAI,CAAAD,OAAK,IAAI,EAAEA,EAAC,CAAC;AACpD,SAAK,oBAAoB,CAAC;AAC1B,WAAO;AAAA,MACL,cAAcD;AAAA,MACd,iBAAiBE;AAAA,MACjB,YAAY;AAAA,MACZ,kBAAkB,EAAE,MAAM,KAAK,KAAK,MAAM,mBAAmB,MAAM;AACjE,aAAK,gBAAgB,iBAAiB;AAAA,MACxC,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,kBAAkBD,IAAGD,IAAG;AACtB,UAAM;AAAA,MACF,IAAIE;AAAA,MACJ,OAAO;AAAA,MACP,QAAQ;AAAA,IACV,IAAI,KAAK,aAAa,GACtB,IAAI,EAAEA,IAAG,GAAG,GAAGD,EAAC;AAClB,QAAI,CAACD,GAAG,QAAO,CAAC,CAAC;AACjB,WAAO,CAAC,GAAG,GAAEA,IAAG,CAACE,IAAG,GAAG,CAAC,CAAC,CAAC;AAAA,EAC5B;AAAA,EACA,eAAe;AACb,QAAID,KAAI,KAAK,KACXD,KAAI,KAAK;AACX,UAAME,KAAI,EAAE,EAAE,IAAI,GAAGD,IAAGD,EAAC;AACzB,WAAO,KAAK,aAAaC,KAAI,EAAE,EAAE,IAAI,GAAGA,EAAC,GAAGD,KAAI,EAAE,EAAE,IAAI,GAAGA,EAAC,GAAGC,GAAE,CAAC,IAAI,GAAGD,GAAE,CAAC,IAAI,GAAGE,GAAE,CAAC,IAAI,IAAI;AAAA,MAC5F,IAAID;AAAA,MACJ,OAAOD;AAAA,MACP,QAAQE;AAAA,IACV;AAAA,EACF;AAAA,EACA,mBAAmB;AACjB,SAAK,WAAW,KAAK,gBAAgB,iBAAiB,IAAI,KAAK,yBAAyB;AAAA,EAC1F;AAAA,EACA,yBAAyBD,KAAI,KAAK,kBAAkB,QAAQ;AAC1D,QAAI,CAACA,GAAG;AACR,UAAM,IAAI,KAAK,KAAK,MAAM,QACxB,IAAI,KAAK,QAAQ,EAAE,yBAAyB,KAAK,SAAS,GAC1D,IAAI,KAAK,IAAI,KAAK,UAAU,CAAC;AAC/B,MAAEI,IAAG,KAAK,SAAS,GAAG,EAAEA,IAAGA,IAAG,CAAC,GAAG,GAAG,CAAC,CAAC,GAAGJ,GAAE,iBAAiBI;AAAA,EAC/D;AAAA,EACA,oBAAoBJ,IAAG;AACrB,QAAI,MAAMA,GAAE,OAAQ;AACpB,UAAM;AAAA,MACF,MAAM;AAAA,QACJ,gBAAgB;AAAA,UACd,gBAAgB;AAAA,QAClB;AAAA,QACA,OAAO;AAAA,UACL,mBAAmB;AAAA,QACrB;AAAA,MACF;AAAA,IACF,IAAI,MACJ;AAAA,MACE,WAAW;AAAA,MACX,OAAOK;AAAA,IACT,IAAI,MACJC,KAAI,EAAE,EAAE,IAAI,GAAG,CAAC;AAClB,IAAAA,GAAE,CAAC,IAAI;AACP,UAAMC,KAAI;AACV,IAAAA,GAAE,mBAAmB,EAAE,SAAS,kBAAkBA,GAAE,IAAID,GAAE,CAAC,GAAGC,GAAE,IAAID,GAAE,CAAC;AACvE,UAAME,KAAIH,MAAK,KAAK,KAAK,2BAA2BE,EAAC,IAAI,IACvDE,KAAI,KAAK,IAAI,KAAK,UAAUD,EAAC;AAC/B,MAAEJ,IAAGE,EAAC,GAAG,EAAEF,IAAGA,IAAG,CAACK,IAAGA,IAAG,CAAC,CAAC;AAC1B,eAAWV,MAAKC,GAAG,CAAAD,GAAE,iBAAiBK;AAAA,EACxC;AAAA,EACA,IAAI,0BAA0B;AAC5B,WAAO;AAAA,MACL,OAAO,KAAK;AAAA,MACZ,sBAAsB;AAAA,MACtB,YAAY;AAAA,MACZ,eAAe;AAAA,MACf,gBAAgB,KAAK;AAAA,MACrB,cAAc,KAAK;AAAA,IACrB;AAAA,EACF;AAAA,EACA,sBAAsB;AACpB,SAAK,kBAAkB,WAAW,aAAa,cAAc,KAAK,uBAAuB,GAAG,KAAK,gBAAgB,WAAW,aAAa,cAAc,KAAK,uBAAuB;AAAA,EACrL;AAAA,EACA,IAAI,6BAA6B;AAC/B,WAAO;AAAA,MACL,OAAO,KAAK;AAAA,MACZ,OAAO,KAAK;AAAA,MACZ,gBAAgB,KAAK;AAAA,MACrB,cAAc,KAAK;AAAA,IACrB;AAAA,EACF;AAAA,EACA,yBAAyB;AACvB,SAAK,kBAAkB,WAAW,iBAAiB,cAAc,KAAK,0BAA0B,GAAG,KAAK,gBAAgB,WAAW,iBAAiB,cAAc,KAAK,0BAA0B;AAAA,EACnM;AACF;AACA,SAAS,EAAEJ,IAAG;AACZ,EAAAA,GAAE,iBAAiB,OAAO,GAAGA,GAAE,aAAa,CAAC;AAC/C;AACA,SAAS,EAAEA,IAAGD,IAAGE,IAAG,GAAG;AACrB,SAAO,IAAI,EAAE,GAAG,CAAC,CAACD,GAAE,UAAU,IAAI,EAAE,CAAC,GAAG,GAAG,GAAG,GAAGD,IAAG,GAAGC,IAAG,GAAGC,EAAC,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,IAAE,CAAC,CAAC,CAAC;AAC/F;AACA,IAAMG,KAAIJ,GAAE;AAAZ,IACE,IAAIA,GAAE,GAAG,GAAG,QAAQ,IAAI;",
  "names": ["t", "e", "r", "d", "z", "x", "a", "c", "l", "u", "h"]
}
