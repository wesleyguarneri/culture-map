{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js", "../../../../../../node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js", "../../../../../../node_modules/@arcgis/core/views/2d/layers/graphics/AGraphicContainer.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { FeatureTechniqueInstance as e } from \"./TechniqueInstance.js\";\nimport { Techniques as i } from \"./TechniqueRegistry.js\";\nimport { castInstanceId as t } from \"./mesh/instanceIdUtils.js\";\nlet l = 0;\nfunction n(i, n) {\n  return new e(t(l++), i, n);\n}\nconst a = {\n  visualVariableColor: null,\n  visualVariableOpacity: null,\n  visualVariableSizeMinMaxValue: null,\n  visualVariableSizeScaleStops: null,\n  visualVariableSizeStops: null,\n  visualVariableSizeUnitValue: null,\n  visualVariableRotation: null,\n  visualVariableSizeOutlineScaleStops: null\n};\nclass o {\n  constructor() {\n    this.instances = {\n      fill: n(i.fill, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0\n        }\n      }),\n      marker: n(i.marker, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0\n        }\n      }),\n      line: n(i.line, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0\n        }\n      }),\n      text: n(i.text, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0,\n          referenceSymbol: !1,\n          clipAngle: !1\n        }\n      }),\n      complexFill: n(i.complexFill, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0\n        }\n      }),\n      texturedLine: n(i.texturedLine, {\n        uniforms: a,\n        optionalAttributes: {\n          zoomRange: !0\n        }\n      })\n    }, this._instancesById = Object.values(this.instances).reduce((e, i) => (e.set(i.instanceId, i), e), new Map());\n  }\n  getInstance(e) {\n    return this._instancesById.get(e);\n  }\n}\nexport { o as GraphicInstanceStore };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { disposeMaybe as t } from \"../../../../core/maybe.js\";\nimport { identity as e, multiply as r, translate as i, scale as s, rotate as o } from \"../../../../core/libs/gl-matrix-2/math/mat3.js\";\nimport { create as a } from \"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";\nimport { fromValues as n } from \"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";\nimport { fromValues as l } from \"../../../../core/libs/gl-matrix-2/factories/vec3f32.js\";\nimport { normalizeMapX as f } from \"../../../../geometry/support/normalizeUtils.js\";\nimport { DisplayObject as m } from \"../../engine/DisplayObject.js\";\nimport { createProgramDescriptor as c } from \"../../engine/webgl/Utils.js\";\nimport { BufferObject as u } from \"../../../webgl/BufferObject.js\";\nimport { BlendFactor as _, PrimitiveType as h, DataType as d, Usage as p } from \"../../../webgl/enums.js\";\nimport { VertexArrayObject as g } from \"../../../webgl/VertexArrayObject.js\";\nconst v = Math.PI / 180,\n  x = 4;\nclass b extends m {\n  constructor(t) {\n    super(), this._program = null, this._vao = null, this._vertexBuffer = null, this._indexBuffer = null, this._dvsMat3 = a(), this._localOrigin = {\n      x: 0,\n      y: 0\n    }, this._getBounds = t;\n  }\n  destroy() {\n    this._vao && (this._vao.dispose(), this._vao = null, this._vertexBuffer = null, this._indexBuffer = null), this._program = t(this._program);\n  }\n  doRender(t) {\n    const {\n        context: e\n      } = t,\n      r = this._getBounds();\n    if (r.length < 1) return;\n    this._createShaderProgram(e), this._updateMatricesAndLocalOrigin(t), this._updateBufferData(e, r), e.setBlendingEnabled(!0), e.setDepthTestEnabled(!1), e.setStencilWriteMask(0), e.setStencilTestEnabled(!1), e.setBlendFunction(_.ONE, _.ONE_MINUS_SRC_ALPHA), e.setColorMask(!0, !0, !0, !0);\n    const i = this._program;\n    e.bindVAO(this._vao), e.useProgram(i), i.setUniformMatrix3fv(\"u_dvsMat3\", this._dvsMat3), e.gl.lineWidth(1), e.drawElements(h.LINES, 8 * r.length, d.UNSIGNED_INT, 0), e.bindVAO();\n  }\n  _createTransforms() {\n    return {\n      displayViewScreenMat3: a()\n    };\n  }\n  _createShaderProgram(t) {\n    if (this._program) return;\n    const e = \"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",\n      r = \"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";\n    this._program = t.programCache.acquire(e, r, y().attributes);\n  }\n  _updateMatricesAndLocalOrigin(t) {\n    const {\n        state: a\n      } = t,\n      {\n        displayMat3: m,\n        size: c,\n        resolution: u,\n        pixelRatio: _,\n        rotation: h,\n        viewpoint: d\n      } = a,\n      p = v * h,\n      {\n        x: g,\n        y: x\n      } = d.targetGeometry,\n      b = f(g, a.spatialReference);\n    this._localOrigin.x = b, this._localOrigin.y = x;\n    const y = _ * c[0],\n      B = _ * c[1],\n      M = u * y,\n      j = u * B,\n      A = e(this._dvsMat3);\n    r(A, A, m), i(A, A, n(y / 2, B / 2)), s(A, A, l(c[0] / M, -B / j, 1)), o(A, A, -p);\n  }\n  _updateBufferData(t, e) {\n    const {\n        x: r,\n        y: i\n      } = this._localOrigin,\n      s = 2 * x * e.length,\n      o = new Float32Array(s),\n      a = new Uint32Array(8 * e.length);\n    let n = 0,\n      l = 0;\n    for (const f of e) f && (o[2 * n] = f[0] - r, o[2 * n + 1] = f[1] - i, o[2 * n + 2] = f[0] - r, o[2 * n + 3] = f[3] - i, o[2 * n + 4] = f[2] - r, o[2 * n + 5] = f[3] - i, o[2 * n + 6] = f[2] - r, o[2 * n + 7] = f[1] - i, a[l] = n + 0, a[l + 1] = n + 3, a[l + 2] = n + 3, a[l + 3] = n + 2, a[l + 4] = n + 2, a[l + 5] = n + 1, a[l + 6] = n + 1, a[l + 7] = n + 0, n += 4, l += 8);\n    if (this._vertexBuffer ? this._vertexBuffer.setData(o.buffer) : this._vertexBuffer = u.createVertex(t, p.DYNAMIC_DRAW, o.buffer), this._indexBuffer ? this._indexBuffer.setData(a) : this._indexBuffer = u.createIndex(t, p.DYNAMIC_DRAW, a), !this._vao) {\n      const e = y();\n      this._vao = new g(t, e.attributes, e.bufferLayouts, {\n        geometry: this._vertexBuffer\n      }, this._indexBuffer);\n    }\n  }\n}\nconst y = () => c(\"bounds\", {\n  geometry: [{\n    location: 0,\n    name: \"a_position\",\n    count: 2,\n    type: d.FLOAT\n  }]\n});\nexport { b as default };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { destroyMaybe as e } from \"../../../../core/maybe.js\";\nimport { AFeatureContainer as t } from \"../../engine/AFeatureContainer.js\";\nimport { FeatureBatchingStrategy as n } from \"../../engine/webgl/enums.js\";\nimport { GraphicInstanceStore as r } from \"../../engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js\";\nimport s from \"./GraphicBoundsRenderer.js\";\nclass i extends t {\n  constructor(e) {\n    super(e), this._instanceStore = new r(), this.checkHighlight = () => !0;\n  }\n  destroy() {\n    super.destroy(), this._boundsRenderer = e(this._boundsRenderer);\n  }\n  get instanceStore() {\n    return this._instanceStore;\n  }\n  enableRenderingBounds(e) {\n    this._boundsRenderer = new s(e), this.requestRender();\n  }\n  get hasHighlight() {\n    return this.checkHighlight();\n  }\n  onTileData(e, t) {\n    e.onMessage(t), this.contains(e) || this.addChild(e), this.requestRender();\n  }\n  _renderChildren(e, t) {\n    e.selection = t;\n    for (const r of this.children) {\n      if (!r.visible) continue;\n      const t = r.getDisplayList(this._instanceStore, n.STRICT_ORDER);\n      t?.render(e);\n    }\n  }\n}\nexport { i as AGraphicContainer };"],
  "mappings": "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",
  "names": ["i", "n", "r", "o", "h", "e", "b", "t", "e", "r", "i", "a", "c", "u", "h", "x", "y", "M", "s", "o", "n", "l", "f", "i", "r", "e", "o", "b", "t"]
}
