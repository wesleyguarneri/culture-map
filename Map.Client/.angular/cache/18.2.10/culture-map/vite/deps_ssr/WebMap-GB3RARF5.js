import { createRequire } from 'module';const require = createRequire(import.meta.url);
import {
  f as f5
} from "./chunk-G2BTFFN6.js";
import {
  T
} from "./chunk-776Z2TJ3.js";
import {
  i as i2,
  i2 as i3,
  l
} from "./chunk-AHJ63KFV.js";
import {
  n2 as n6
} from "./chunk-5WZBN555.js";
import "./chunk-PE64OF24.js";
import "./chunk-BNB2X2FJ.js";
import "./chunk-JDM73SXR.js";
import "./chunk-4YRHCFPB.js";
import "./chunk-2Q6GNCAJ.js";
import "./chunk-FD6MY73F.js";
import "./chunk-BQY5LM3B.js";
import {
  m as m3
} from "./chunk-IYAKOGH7.js";
import {
  L
} from "./chunk-7HNGFXGM.js";
import "./chunk-ZGV7AVXO.js";
import "./chunk-H5Z6ZNKP.js";
import "./chunk-2L7HC722.js";
import {
  m as m2
} from "./chunk-AENXIHUM.js";
import "./chunk-Z3B4X2BG.js";
import {
  n as n5,
  p
} from "./chunk-GJ3FZNZ2.js";
import "./chunk-HKAONIBH.js";
import "./chunk-AOGKNBDG.js";
import "./chunk-FDI2X6GO.js";
import "./chunk-FJ3AI2QH.js";
import "./chunk-XUSZNRTW.js";
import "./chunk-W26QF64E.js";
import "./chunk-D3XX7CQS.js";
import "./chunk-D5ZVYTUT.js";
import "./chunk-MY2HOJQI.js";
import "./chunk-CAYYEMNX.js";
import "./chunk-6NY22YWY.js";
import "./chunk-JBJJW35I.js";
import "./chunk-PXTZCDRW.js";
import "./chunk-GVEKX2VV.js";
import "./chunk-MM5HQGRH.js";
import "./chunk-JA5GJ7PX.js";
import "./chunk-Q6OCJ3NG.js";
import "./chunk-DD6UQHSS.js";
import "./chunk-FALQTRQL.js";
import "./chunk-GGTDLTZW.js";
import "./chunk-2W7YKBRA.js";
import "./chunk-GLFGRGCP.js";
import "./chunk-WQZJGTGX.js";
import "./chunk-VFQA3B5S.js";
import "./chunk-NOH3NLJ5.js";
import "./chunk-LX5BT6XP.js";
import "./chunk-PLGJMWC5.js";
import "./chunk-UGFQYEND.js";
import "./chunk-XC5RDNAY.js";
import "./chunk-KXVPQVTB.js";
import "./chunk-ARN5GJBK.js";
import "./chunk-MPLS4PY6.js";
import "./chunk-AGBPYPP3.js";
import "./chunk-IKBXTTSU.js";
import "./chunk-VMZV7772.js";
import "./chunk-3FR2T2I2.js";
import "./chunk-LOZRWPGI.js";
import "./chunk-GZ64OOAB.js";
import "./chunk-WR2NVDOI.js";
import "./chunk-EPLJRYUV.js";
import "./chunk-VYRCS5VR.js";
import "./chunk-OOK3QTWF.js";
import "./chunk-VFYCIIDC.js";
import "./chunk-PQUZDC3L.js";
import "./chunk-UUQ5O7GK.js";
import "./chunk-6XY35LS7.js";
import "./chunk-T42EJVJR.js";
import "./chunk-D3QK4EV3.js";
import {
  r as r3
} from "./chunk-JTDKNK44.js";
import "./chunk-RR7OQLEK.js";
import "./chunk-NAG6YX7T.js";
import "./chunk-WFNAKG2H.js";
import "./chunk-EKHRAAS6.js";
import "./chunk-IEB4ZCRH.js";
import "./chunk-7QOUHKW5.js";
import "./chunk-NHYYZMJR.js";
import "./chunk-WVSTX2NW.js";
import "./chunk-EXPZNTF3.js";
import "./chunk-ORYC4PVJ.js";
import "./chunk-DXIKKLD7.js";
import "./chunk-VQNXE43R.js";
import "./chunk-VZ37C3ID.js";
import "./chunk-5R3HARKC.js";
import "./chunk-BKSTWG4S.js";
import "./chunk-FSG7HOZQ.js";
import "./chunk-Q5TIVVER.js";
import "./chunk-ZPMUEGLK.js";
import "./chunk-GNFDYYU3.js";
import "./chunk-X36BR2QB.js";
import "./chunk-RGG3YJQA.js";
import "./chunk-GBJYL7OX.js";
import "./chunk-GHKVDSKU.js";
import "./chunk-NVOJILW6.js";
import "./chunk-KYPTWEOO.js";
import "./chunk-WVFB3H4O.js";
import "./chunk-C7BQE556.js";
import "./chunk-ZREJ3Y2F.js";
import "./chunk-IR6CVPPC.js";
import "./chunk-BBUQOCRA.js";
import "./chunk-YBUJLIWZ.js";
import {
  i
} from "./chunk-DL2B6IFJ.js";
import "./chunk-VOOO6FU5.js";
import "./chunk-IUPJR3FF.js";
import "./chunk-TGZW6QWO.js";
import "./chunk-OYIDHTXG.js";
import "./chunk-KUBMHTYA.js";
import "./chunk-TVHVZK5G.js";
import "./chunk-P2MUOE6G.js";
import "./chunk-E5NWFBZG.js";
import "./chunk-FP37456K.js";
import "./chunk-VSQZQLTQ.js";
import "./chunk-K43CZ3M5.js";
import {
  o as o3
} from "./chunk-6EIBUVMG.js";
import "./chunk-XCCMILGI.js";
import {
  e as e2
} from "./chunk-AKRJ5ORG.js";
import "./chunk-M6PHREXO.js";
import "./chunk-KLK34CGP.js";
import {
  A
} from "./chunk-NBJSAHZT.js";
import "./chunk-BD24XM4D.js";
import {
  f as f3
} from "./chunk-YCXNHEGB.js";
import {
  t
} from "./chunk-CSATD3VX.js";
import "./chunk-NXXQ35YM.js";
import {
  f as f4
} from "./chunk-3BXPVUY5.js";
import "./chunk-LM3JDV4W.js";
import "./chunk-34V2CLL5.js";
import "./chunk-CXNERL22.js";
import "./chunk-7V4JSBFA.js";
import "./chunk-REIMIECM.js";
import "./chunk-EO2EW5KR.js";
import "./chunk-JEFPXTYT.js";
import "./chunk-MVS2BECH.js";
import "./chunk-UZ7IOCF3.js";
import "./chunk-OS542PQQ.js";
import "./chunk-3B5GODXR.js";
import "./chunk-NKXXHQDD.js";
import {
  S as S3
} from "./chunk-7TBQUMV3.js";
import "./chunk-TPLUZX3A.js";
import "./chunk-BGLJ2FAH.js";
import "./chunk-2EJFYNM7.js";
import "./chunk-DC5LRNPY.js";
import "./chunk-ASCK5HJ5.js";
import "./chunk-5X5U7R6O.js";
import "./chunk-XNLAOXPY.js";
import "./chunk-ZT7V2AVD.js";
import "./chunk-C2OXE4NQ.js";
import "./chunk-KOI252FF.js";
import "./chunk-I2TVVMQ6.js";
import "./chunk-5EGQYY2H.js";
import "./chunk-JKPUNUQA.js";
import {
  n as n4
} from "./chunk-SR7PRON4.js";
import "./chunk-HGHPYGKP.js";
import {
  y as y2
} from "./chunk-4DSGTDZJ.js";
import "./chunk-VYTPFEL2.js";
import "./chunk-RLGDH6IY.js";
import "./chunk-MRPCXIVS.js";
import "./chunk-YTKVV2Y3.js";
import "./chunk-GCVQXAS4.js";
import "./chunk-UFQD6AL4.js";
import "./chunk-EGBDRLCX.js";
import "./chunk-THZPD5CT.js";
import "./chunk-OBCA6CWH.js";
import {
  o as o2
} from "./chunk-2JI245BP.js";
import "./chunk-ZEZ3LI2L.js";
import "./chunk-N34BRXVM.js";
import {
  S as S2
} from "./chunk-KETDH2J4.js";
import {
  C
} from "./chunk-7QV7DHWN.js";
import {
  m
} from "./chunk-4L4Y34YK.js";
import "./chunk-BXONKQKI.js";
import {
  n as n3
} from "./chunk-2HDBQXAR.js";
import "./chunk-RNF7VOCU.js";
import {
  d as d2
} from "./chunk-TIRJMGGG.js";
import {
  f as f2
} from "./chunk-ZDRQSPB6.js";
import {
  o
} from "./chunk-DCXDXGAR.js";
import {
  r
} from "./chunk-BCCDYCTQ.js";
import "./chunk-AYL3HQHD.js";
import "./chunk-66YQWHHE.js";
import "./chunk-QGBMZIP4.js";
import "./chunk-AOEBZVTA.js";
import "./chunk-2OZSYJDX.js";
import "./chunk-MZM4INJV.js";
import "./chunk-J4GMQHGL.js";
import "./chunk-MHPE4SZA.js";
import "./chunk-6SSA7P3A.js";
import "./chunk-FQBTLEUI.js";
import "./chunk-GS7Y3YOG.js";
import {
  n as n2
} from "./chunk-Y2HYKTTT.js";
import {
  kt,
  ot,
  r2,
  tt
} from "./chunk-XLEC46FY.js";
import {
  d,
  f
} from "./chunk-4AZPIP7K.js";
import "./chunk-G73HQZEL.js";
import {
  w
} from "./chunk-LZSLQ24Q.js";
import {
  V
} from "./chunk-U3RHUXYK.js";
import "./chunk-7DBI6LQG.js";
import "./chunk-AUUN7RFQ.js";
import "./chunk-JAMSDYD6.js";
import "./chunk-PH6NPTP7.js";
import {
  e
} from "./chunk-NUICEVIH.js";
import {
  S
} from "./chunk-NXK752PZ.js";
import {
  y
} from "./chunk-UVNLCXWD.js";
import "./chunk-PNUA7JOS.js";
import "./chunk-OR2FKGUM.js";
import {
  a3 as a2
} from "./chunk-UDMPWVPF.js";
import "./chunk-XJNKCEWL.js";
import {
  k
} from "./chunk-AIZ3T7E3.js";
import "./chunk-6UEMNP3E.js";
import {
  u
} from "./chunk-6WGE3IUL.js";
import "./chunk-MLYB2YW4.js";
import {
  a,
  n2 as n,
  s2 as s
} from "./chunk-6JFGZTLU.js";
import {
  O
} from "./chunk-2ZJE6ZFX.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-XBPEBUD5.js";

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/ExpressionInfo.js
var p2 = class extends i(f) {
  constructor(r4) {
    super(r4), this.expression = null, this.returnType = "string", this.title = null;
  }
};
e([y({
  type: String,
  json: {
    write: {
      isRequired: true
    }
  }
})], p2.prototype, "expression", void 0), e([y({
  type: ["number", "string"],
  json: {
    write: true
  }
})], p2.prototype, "returnType", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], p2.prototype, "title", void 0), p2 = e([a2("esri.webdoc.geotriggersInfo.ExpressionInfo")], p2);
var i4 = p2;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/DeviceLocationFeed.js
var c = new n2({
  deviceLocation: "device-location"
});
var a3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.filterExpression = null, this.type = "device-location";
  }
};
e([y({
  type: i4,
  json: {
    write: true
  }
})], a3.prototype, "filterExpression", void 0), e([y({
  type: c.apiValues,
  readOnly: true,
  json: {
    type: c.jsonValues,
    read: c.read,
    write: c.write
  }
})], a3.prototype, "type", void 0), a3 = e([a2("esri.webdoc.geotriggersInfo.DeviceLocationFeed")], a3);
var n7 = a3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFilter.js
var m4 = class extends i(f) {
  constructor(o6) {
    super(o6), this.geometry = null, this.where = null;
  }
};
e([y({
  types: n4,
  json: {
    read: y2,
    write: true
  }
})], m4.prototype, "geometry", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], m4.prototype, "where", void 0), m4 = e([a2("esri.webdoc.geotriggersInfo.FeatureFilter")], m4);
var c2 = m4;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureLayerSource.js
var p3 = class extends i(f) {
  constructor(r4) {
    super(r4), this.layerId = null, this.layerUrl = null, this.type = "feature-layer";
  }
};
e([y({
  type: String,
  json: {
    write: {
      overridePolicy() {
        return {
          isRequired: null === this.layerUrl
        };
      }
    }
  }
})], p3.prototype, "layerId", void 0), e([y({
  type: String,
  json: {
    write: {
      overridePolicy() {
        return {
          isRequired: null === this.layerId
        };
      }
    }
  }
})], p3.prototype, "layerUrl", void 0), e([o3({
  featureLayer: "feature-layer"
}, {
  readOnly: true
})], p3.prototype, "type", void 0), p3 = e([a2("esri.webdoc.geotriggersInfo.FeatureLayerSource")], p3);
var a4 = p3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFenceParameters.js
var a5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.fenceSource = null, this.filter = null, this.bufferDistance = null, this.type = "features";
  }
};
e([y({
  type: a4,
  json: {
    write: {
      isRequired: true
    }
  }
})], a5.prototype, "fenceSource", void 0), e([y({
  type: c2,
  json: {
    write: true
  }
})], a5.prototype, "filter", void 0), e([y({
  type: Number,
  json: {
    write: true
  }
})], a5.prototype, "bufferDistance", void 0), e([o3({
  features: "features"
}, {
  readOnly: true
})], a5.prototype, "type", void 0), a5 = e([a2("esri.webdoc.geotriggersInfo.FeatureFenceParameters")], a5);
var u2 = a5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/Geotrigger.js
var c3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.type = "fence";
  }
};
e([o3({
  fence: "fence"
}, {
  readOnly: true
})], c3.prototype, "type", void 0), c3 = e([a2("esri.webdoc.geotriggersInfo.Geotrigger")], c3);
var p4 = c3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/GeotriggerNotificationOptions.js
var p5 = class extends i(f) {
  constructor(o6) {
    super(o6), this.expressionInfo = null, this.requestedActions = null;
  }
};
e([y({
  type: i4,
  json: {
    write: true
  }
})], p5.prototype, "expressionInfo", void 0), e([y({
  type: [String],
  json: {
    write: true
  }
})], p5.prototype, "requestedActions", void 0), p5 = e([a2("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")], p5);
var c4 = p5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/support/typeUtils.js
var t2 = new n2({
  enterContainsAndExitDoesNotContain: "enter-contains-and-exit-does-not-contain",
  enterContainsAndExitDoesNotIntersect: "enter-contains-and-exit-does-not-intersect",
  enterIntersectsAndExitDoesNotIntersect: "enter-intersects-and-exit-does-not-intersect"
});
var n8 = new n2({
  useGeometry: "use-geometry",
  useGeometryWithAccuracy: "use-geometry-with-accuracy"
});
var o4 = new n2({
  enter: "enter",
  enterOrExit: "enter-or-exit",
  exit: "exit"
});

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FenceGeotrigger.js
var m5 = class extends p4 {
  constructor(e3) {
    super(e3), this.enterExitRule = "enter-contains-and-exit-does-not-intersect", this.feed = null, this.feedAccuracyMode = "use-geometry", this.fenceNotificationRule = null, this.fenceParameters = null, this.name = null, this.notificationOptions = null, this.type = "fence";
  }
};
e([o3(t2)], m5.prototype, "enterExitRule", void 0), e([y({
  type: n7,
  json: {
    write: {
      isRequired: true
    }
  }
})], m5.prototype, "feed", void 0), e([o3(n8)], m5.prototype, "feedAccuracyMode", void 0), e([y({
  type: o4.apiValues,
  json: {
    type: o4.jsonValues,
    read: o4.read,
    write: {
      writer: o4.write,
      isRequired: true
    }
  }
})], m5.prototype, "fenceNotificationRule", void 0), e([y({
  type: u2,
  json: {
    write: {
      isRequired: true
    }
  }
})], m5.prototype, "fenceParameters", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], m5.prototype, "name", void 0), e([y({
  type: c4,
  json: {
    write: true
  }
})], m5.prototype, "notificationOptions", void 0), e([o3({
  fence: "fence"
}, {
  readOnly: true
})], m5.prototype, "type", void 0), m5 = e([a2("esri.webdoc.geotriggersInfo.FenceGeotrigger")], m5);
var u3 = m5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/support/geotriggerTypes.js
var o5 = {
  base: p4,
  key: "type",
  typeMap: {
    fence: u3
  }
};

// ../../../node_modules/@arcgis/core/webdoc/GeotriggersInfo.js
var i5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.geotriggers = null;
  }
};
e([y({
  types: [o5],
  json: {
    write: {
      isRequired: true
    }
  }
})], i5.prototype, "geotriggers", void 0), i5 = e([a2("esri.webdoc.GeotriggersInfo")], i5);
var c5 = i5;

// ../../../node_modules/@arcgis/core/webdoc/RangeInfo.js
var s2;
var a6 = s2 = class extends f {
  constructor(e3) {
    super(e3), this.activeRange = null, this.currentRangeExtent = null, this.fullRangeExtent = null;
  }
  clone() {
    return new s2(a({
      activeRange: this.activeRange,
      currentRangeExtent: this.currentRangeExtent,
      fullRangeExtent: this.fullRangeExtent
    }));
  }
};
e([y({
  type: String,
  nonNullable: true,
  json: {
    read: {
      source: "activeRangeName"
    },
    write: {
      target: "activeRangeName",
      isRequired: true
    }
  }
})], a6.prototype, "activeRange", void 0), e([y({
  type: [Number],
  json: {
    write: true
  }
})], a6.prototype, "currentRangeExtent", void 0), e([y({
  type: [Number],
  json: {
    write: true
  }
})], a6.prototype, "fullRangeExtent", void 0), a6 = s2 = e([a2("esri.webdoc.RangeInfo")], a6);
var c6 = a6;

// ../../../node_modules/@arcgis/core/webdoc/support/webdocLoadUtils.js
function p6(e3, t3) {
  return t3.resourceInfo ? l2(t3, t3.resourceInfo, {
    origin: e3.origin
  }) : t3.portalItem?.id ? c7(e3, t3, t3.portalItem) : Promise.resolve();
}
function l2(e3, t3, r4) {
  const o6 = {
    context: __spreadProps(__spreadValues({}, r4), {
      layerContainerType: "operational-layers"
    })
  };
  return e3.portalItem && (o6.context.portal = e3.portalItem.portal || C.getDefault()), import("./layersCreator-OMBY2VPO.js").then(({
    populateOperationalLayers: r5
  }) => {
    const n10 = [], i6 = t3.operationalLayers;
    i6?.length && n10.push(r5(e3.layers, i6, o6));
    const a8 = __spreadProps(__spreadValues({}, o6), {
      context: __spreadProps(__spreadValues({}, o6.context), {
        layerContainerType: "tables"
      }),
      defaultLayerType: "ArcGISFeatureLayer"
    }), s4 = t3.tables;
    return s4?.length && n10.push(r5(e3.tables, s4, a8)), Promise.allSettled(n10).then(() => {
    });
  });
}
function c7(e3, o6, n10) {
  return __async(this, null, function* () {
    if (yield n10.load().catch((r4) => {
      throw new s(`${e3.name}:load-portal-item`, "Failed to load portal item", {
        error: r4
      });
    }), n10.type !== e3.itemType) throw new s(`${e3.name}:invalid-portal-item`, `Invalid portal item type '${n10.type}', expected '${e3.itemType}'`, {
      type: n10.type
    });
    const a8 = yield n10.fetchData();
    o6.resourceInfo = a8;
    const s4 = e2(n10, e3.origin);
    yield m6(e3, o6, a8, s4), o6.resourceReferences = {
      portalItem: n10,
      paths: s4.readResourcePaths
    };
    const p8 = yield f6(o6.initialViewProperties, n10, n.getLogger(o6));
    if (p8) {
      const t3 = o6.initialViewProperties?.clone() ?? e3.createInitialViewProperties();
      t3.viewpoint = p8, o6.initialViewProperties = t3;
    }
  });
}
function m6(e3, t3, r4, o6) {
  const n10 = u4(e3, r4);
  return t3.read(n10, o6), l2(t3, n10, o6);
}
function u4(e3, t3) {
  const r4 = e3.parseVersion(t3.version || "", e3.name);
  return e3.currentVersion.validate(r4), t3.version = `${r4.major}.${r4.minor}`, t3;
}
function f6(t3, r4, o6) {
  return __async(this, null, function* () {
    const n10 = t3?.viewpoint?.targetGeometry;
    if (n10) return null;
    const i6 = yield y3(t3, r4, o6);
    if (!i6) return null;
    return new m2({
      targetGeometry: i6
    });
  });
}
function y3(e3, t3, r4) {
  return __async(this, null, function* () {
    const n10 = e3?.spatialReference, i6 = t3?.extent;
    if (!n10 || !i6) return null;
    if (n10.isWGS84) return i6.clone();
    if (n10.isWebMercator) return d2(i6);
    const {
      getGeometryServiceURL: p8
    } = yield import("./geometryServiceUtils-4YUGP3CP.js");
    try {
      const e4 = yield p8(t3), r5 = new p({
        geometries: [i6],
        outSpatialReference: n10
      });
      return (yield n5(e4, r5))[0];
    } catch (l4) {
      r4.error("Error projecting item's extent:", l4);
    }
    return null;
  });
}

// ../../../node_modules/@arcgis/core/webmap/ApplicationProperties.js
var p7;
var n9 = p7 = class extends f {
  constructor(o6) {
    super(o6), this.editing = null, this.offline = null, this.viewing = null;
  }
  clone() {
    return new p7(a({
      editing: this.editing,
      offline: this.offline,
      viewing: this.viewing
    }));
  }
};
e([y({
  json: {
    write: true
  }
})], n9.prototype, "editing", void 0), e([y({
  json: {
    write: true
  }
})], n9.prototype, "offline", void 0), e([y({
  type: i3,
  json: {
    write: true
  }
})], n9.prototype, "viewing", void 0), n9 = p7 = e([a2("esri.webmap.ApplicationProperties")], n9);
var c8 = n9;

// ../../../node_modules/@arcgis/core/webmap/InitialViewProperties.js
var a7 = class extends i(S) {
  constructor(o6) {
    super(o6), this.background = null, this.rangeInfo = null, this.spatialReference = null, this.timeZone = o2, this.viewpoint = null;
  }
};
e([y({
  type: m3
})], a7.prototype, "background", void 0), e([y({
  type: c6
})], a7.prototype, "rangeInfo", void 0), e([y({
  type: f2
})], a7.prototype, "spatialReference", void 0), e([y({
  nonNullable: true
})], a7.prototype, "timeZone", void 0), e([y({
  type: m2
})], a7.prototype, "viewpoint", void 0), a7 = e([a2("esri.webmap.InitialViewProperties")], a7);
var l3 = a7;

// ../../../node_modules/@arcgis/core/webmap/Version.js
var s3 = class extends r3 {
  constructor(r4, s4) {
    super(r4, s4, "webmap");
  }
};

// ../../../node_modules/@arcgis/core/WebMap.js
var M = new s3(2, 31);
var Z = "Web Map";
var W = "webmap";
var $ = "web-map";
var C2 = V.ofType(f5);
var G = V.ofType(T);
var z = /* @__PURE__ */ new Map([["image/jpeg", "jpeg"], ["image/jpg", "jpg"], ["image/png", "png"], ["image/gif", "gif"]]);
var D = "ArcGIS Pro";
var q = f4.JSAPI;
var H = {
  currentVersion: M,
  createInitialViewProperties: () => new l3(),
  parseVersion: s3.parse,
  itemType: Z,
  name: W,
  origin: $
};
var K = class extends S3(m.LoadableMixin(n3(L))) {
  constructor(e3) {
    super(e3), this._isAuthoringAppSetByUser = false, this._isAuthoringAppVersionSetByUser = false, this._thumbnailFilename = null, this._updateFromPromise = null, this.resourceReferences = {
      portalItem: null,
      paths: []
    }, this.applicationProperties = null, this.bookmarks = new C2(), this.floorInfo = null, this.geotriggersInfo = null, this.initialViewProperties = new l3(), this.ipsInfo = null, this.portalItem = null, this.presentation = null, this.sourceVersion = null, this.widgets = null, this.utilityNetworks = null, this._debouncedSaveOperations = k((e4, t3, r4) => __async(this, null, function* () {
      const {
        save: i6,
        saveAs: o6
      } = yield import("./webdocSaveUtils-4FLTCYMT.js");
      switch (e4) {
        case A.SAVE:
          return i6(H, this, t3);
        case A.SAVE_AS:
          return o6(H, this, r4, t3);
      }
    })), this.authoringApp = this.authoringAppVersion = null, this._isAuthoringAppSetByUser = this._isAuthoringAppVersionSetByUser = false;
  }
  destroy() {
    if (this.portalItem = u(this.portalItem), this.utilityNetworks) {
      const e3 = this.utilityNetworks.removeAll();
      for (const t3 of e3) t3.destroy();
      this.utilityNetworks.destroy();
    }
  }
  initialize() {
    if (this.when().catch((e3) => {
      n.getLogger(this).error("#load()", "Failed to load web map", e3);
    }), this.resourceInfo) {
      let t3;
      try {
        t3 = this._validateJSON(this.resourceInfo);
      } catch (e3) {
        return void this.addResolvingPromise(Promise.reject(e3));
      }
      this.read(t3);
    }
  }
  set authoringApp(e3) {
    this._isAuthoringAppSetByUser = true, this._set("authoringApp", e3);
  }
  writeAuthoringApp(e3, t3) {
    e3 && this._isAuthoringAppSetByUser ? t3.authoringApp = e3 : t3.authoringApp = q;
  }
  set authoringAppVersion(e3) {
    this._isAuthoringAppVersionSetByUser = true, this._set("authoringAppVersion", e3);
  }
  writeAuthoringAppVersion(e3, r4) {
    e3 && this._isAuthoringAppVersionSetByUser ? r4.authoringAppVersion = e3 : r4.authoringAppVersion = r2;
  }
  readInitialViewProperties(e3, t3) {
    const r4 = new l3();
    t3.background && (r4.background = m3.fromJSON(t3.background));
    const o6 = t3.initialState?.viewpoint;
    if (o6) {
      if (o6.rotation) {
        s3.parse(t3.version || "", "webmap").lessThan(2, 20) && t3.authoringApp === D && (o6.rotation *= -1);
      }
      r4.viewpoint = m2.fromJSON(o6);
    }
    return t3.mapRangeInfo && (r4.rangeInfo = c6.fromJSON(t3.mapRangeInfo)), t3.spatialReference && (r4.spatialReference = f2.fromJSON(t3.spatialReference)), t3.timeZone && (r4.timeZone = t3.timeZone), r4;
  }
  writeInitialViewProperties(e3, t3, r4, i6) {
    e3 && (e3.background?.color && (t3.background = e3.background.write({}, i6)), e3.viewpoint && (t3.initialState = {
      viewpoint: e3.viewpoint.write({}, i6)
    }), e3.rangeInfo && (t3.mapRangeInfo = e3.rangeInfo.toJSON(i6)), e3.spatialReference && (t3.spatialReference = e3.spatialReference.write({}, i6)), t3.timeZone = e3.timeZone);
  }
  writeLayers(e3, t3, r4, i6) {
    t3[r4] = this._writeLayers(e3, i6, "operational-layers");
  }
  readSourceVersion(e3, t3) {
    const [r4, i6] = t3.version.split(".");
    return new s3(parseInt(r4, 10), parseInt(i6, 10));
  }
  writeSourceVersion(e3, t3, r4) {
    t3[r4] = `${M.major}.${M.minor}`;
  }
  writeTables(e3, t3, r4, i6) {
    const o6 = this._writeLayers(e3, i6, "tables");
    o6.length && (t3[r4] = o6);
  }
  get thumbnailUrl() {
    return this.portalItem?.thumbnailUrl || null;
  }
  set thumbnailUrl(e3) {
    e3 ? (this._override("thumbnailUrl", e3), this._thumbnailFilename = this._generateCustomThumbnailFilename(e3)) : this._clearThumbnailOverride();
  }
  get updatingFromView() {
    return !!this._updateFromPromise;
  }
  load(e3) {
    return this.addResolvingPromise(p6(H, this)), Promise.resolve(this);
  }
  loadAll() {
    return t(this, (e3) => {
      e3(this.ground, this.basemap, this.layers, this.tables);
    });
  }
  read(e3, t3) {
    t3 = __spreadProps(__spreadValues({}, t3), {
      origin: $
    });
    const r4 = this._getAuthoringPropsState();
    d(this, e3, (t4) => super.read(e3, t4), t3), this._restoreAuthoringPropsFromState(r4);
  }
  write(e3, t3) {
    if ("loaded" !== this.loadStatus) {
      const e4 = new s("webmap:not-loaded", "Web map must be loaded before it can be serialized");
      throw n.getLogger(this).error("#toJSON()", "Web map must be loaded before it can be serialized", this.loadError || this.loadStatus), e4;
    }
    return this._removeDanglingLayerRefs(), t3 = __spreadProps(__spreadValues({}, t3), {
      origin: $,
      restrictedWebMapWriting: true,
      webmap: this
    }), super.write(e3, t3);
  }
  save(e3) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE, e3);
    });
  }
  saveAs(e3, t3) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE_AS, t3, e3);
    });
  }
  updateFrom(e3, t3) {
    return __async(this, null, function* () {
      const r4 = this._updateFromInternal(e3, t3);
      this._updateFromPromise = r4, yield r4;
      r4 === this._updateFromPromise && (this._updateFromPromise = null);
    });
  }
  getLayerJSONFromResourceInfo(e3) {
    const t3 = this.resourceInfo;
    return this._collectAllLayersJSON([...t3?.baseMap?.baseMapLayers || [], ...t3?.operationalLayers || [], ...this.basemap?.resourceInfo?.data?.baseMapLayers || []]).find((t4) => t4.id === e3.id);
  }
  updateItemThumbnail() {
    return __async(this, null, function* () {
      this.thumbnailUrl && this._isOverridden("thumbnailUrl") && (yield this.portalItem?.updateThumbnail({
        thumbnail: this.thumbnailUrl,
        filename: this._thumbnailFilename
      }), this._clearThumbnailOverride());
    });
  }
  getThumbnailState() {
    let e3 = this.thumbnailUrl;
    return e3 && (e3 = this._isOverridden("thumbnailUrl") ? e3 : kt(e3, "w", "8192")), {
      thumbnailUrl: e3,
      filename: this._thumbnailFilename
    };
  }
  restoreThumbnailFromState(e3) {
    this.thumbnailUrl = e3.thumbnailUrl, this._thumbnailFilename = e3.filename;
  }
  _collectAllLayersJSON(e3) {
    return e3.reduce((e4, t3) => (e4.push(t3), "GroupLayer" === t3.layerType && (e4 = e4.concat(this._collectAllLayersJSON(t3.layers || []))), e4), []);
  }
  _writeLayers(e3, t3, r4) {
    t3 = __spreadProps(__spreadValues({}, t3), {
      layerContainerType: r4
    });
    return e3.map((e4) => f3(e4, "tables" === r4 ? null : this.getLayerJSONFromResourceInfo(e4), t3)).filter(O).toArray();
  }
  _validateJSON(e3) {
    const t3 = s3.parse(e3.version || "", "webmap");
    return M.validate(t3), e3.version = `${t3.major}.${t3.minor}`, e3;
  }
  _removeDanglingLayerRefs() {
    const e3 = this.applicationProperties, t3 = e3?.viewing?.search, r4 = (e4) => this.allLayers.some((t4) => t4.id === e4);
    if (t3?.layers && (t3.layers = t3.layers.filter((e4) => r4(e4.id))), t3?.tables && (t3.tables = t3.tables.filter((e4) => this.tables.some((t4) => t4.id === e4.id))), e3) {
      const t4 = e3.editing?.locationTracking;
      t4?.info && !r4(t4.info.layerId) && (e3.editing = null);
    }
    const i6 = this.presentation?.slides;
    i6 && i6.forEach((e4) => {
      e4.visibleLayers && (e4.visibleLayers = e4.visibleLayers.filter((e5) => r4(e5.id)));
    });
  }
  _updateFromInternal(e3, t3) {
    return __async(this, null, function* () {
      if (t3 ??= {}, yield w(() => e3.ready), this._updateInitialViewProperties(e3, t3), e3.map === this) for (const r4 of e3.allLayerViews) "visible" in r4 && "visible" in r4.layer && r4._isOverridden("visible") && (r4.layer.visible = r4.visible), "featureEffect" in r4 && "featureEffect" in r4.layer && r4._isOverridden("featureEffect") && (r4.layer.featureEffect = r4.featureEffect);
      yield this._updateThumbnailUrl(e3, t3);
    });
  }
  _updateInitialViewProperties(e3, t3) {
    if (t3.backgroundExcluded || (this.initialViewProperties.background = e3.background?.clone()), this.initialViewProperties.spatialReference = e3.spatialReference?.clone(), this.initialViewProperties.timeZone = e3.timeZone, t3.viewpointExcluded || (this.initialViewProperties.viewpoint = new m2({
      rotation: e3.rotation,
      scale: t3.scalePreserved ? e3.scale : null,
      targetGeometry: this._getViewExtent(e3)
    })), !t3.widgetsExcluded) for (const r4 of e3.persistableViewModels) r4.updateWebDocument(this);
  }
  _getViewExtent(e3) {
    const t3 = e3.center.clone().normalize(), r4 = e3.extent.clone(), i6 = r4.width / 2;
    return r4.xmin = t3.x - i6, r4.xmax = t3.x + i6, r4;
  }
  _updateThumbnailUrl(e3, t3) {
    return __async(this, null, function* () {
      if (t3.thumbnailExcluded) return;
      const r4 = i2(e3, t3.thumbnailSize), i6 = yield e3.takeScreenshot({
        format: "png",
        width: r4.width,
        height: r4.height
      });
      this._setAutoGeneratedThumbnail(i6.dataUrl);
    });
  }
  _setAutoGeneratedThumbnail(e3) {
    this.thumbnailUrl = e3, this._thumbnailFilename = null;
  }
  _clearThumbnailOverride() {
    this._clearOverride("thumbnailUrl"), this.clear("thumbnailUrl", "user"), this._thumbnailFilename = null;
  }
  _generateCustomThumbnailFilename(e3) {
    if (tt(e3)) {
      const t3 = ot(e3), r4 = t3?.mediaType, i6 = r4 && z.get(r4.toLowerCase()) || null, o6 = `thumbnail${Date.now()}`;
      return i6 ? `${o6}.${i6}` : o6;
    }
    return null;
  }
  _getAuthoringPropsState() {
    return {
      authoringApp: this.authoringApp,
      authoringAppVersion: this.authoringAppVersion,
      isAuthoringAppSetByUser: this._isAuthoringAppSetByUser,
      isAuthoringAppVersionSetByUser: this._isAuthoringAppVersionSetByUser
    };
  }
  _restoreAuthoringPropsFromState(e3) {
    e3.isAuthoringAppSetByUser ? this.authoringApp = e3.authoringApp : this._isAuthoringAppSetByUser = false, e3.isAuthoringAppVersionSetByUser ? this.authoringAppVersion = e3.authoringAppVersion : this._isAuthoringAppVersionSetByUser = false;
  }
  static fromJSON(e3) {
    const t3 = e3;
    if (!t3) throw new s("webmap:empty-resource", "Expected a JSON resource but got nothing");
    return new this({
      resourceInfo: t3
    });
  }
};
K.VERSION = M, e([y()], K.prototype, "_updateFromPromise", void 0), e([y({
  type: c8,
  json: {
    write: true
  }
})], K.prototype, "applicationProperties", void 0), e([y({
  type: String,
  json: {
    write: {
      allowNull: true,
      ignoreOrigin: true
    }
  }
})], K.prototype, "authoringApp", null), e([r("authoringApp")], K.prototype, "writeAuthoringApp", null), e([y({
  type: String,
  json: {
    write: {
      allowNull: true,
      ignoreOrigin: true
    }
  }
})], K.prototype, "authoringAppVersion", null), e([r("authoringAppVersion")], K.prototype, "writeAuthoringAppVersion", null), e([y({
  type: C2,
  json: {
    write: {
      overridePolicy: (e3) => ({
        enabled: !!(e3 && e3.length > 0),
        ignoreOrigin: true
      })
    }
  }
})], K.prototype, "bookmarks", void 0), e([y({
  type: l,
  json: {
    name: "mapFloorInfo",
    write: true
  }
})], K.prototype, "floorInfo", void 0), e([y({
  type: c5,
  json: {
    write: true
  }
})], K.prototype, "geotriggersInfo", void 0), e([y({
  type: l3,
  nonNullable: true,
  json: {
    read: {
      source: ["background", "initialState.viewpoint", "mapRangeInfo", "spatialReference", "timeZone"]
    },
    write: {
      ignoreOrigin: true,
      target: {
        background: {
          type: m3
        },
        "initialState.viewpoint": {
          type: m2
        },
        mapRangeInfo: {
          type: c6
        },
        spatialReference: {
          type: f2
        },
        "timeZone:": {
          type: String
        }
      }
    }
  }
})], K.prototype, "initialViewProperties", void 0), e([o("initialViewProperties")], K.prototype, "readInitialViewProperties", null), e([r("initialViewProperties")], K.prototype, "writeInitialViewProperties", null), e([y({
  json: {
    write: true,
    name: "mapIPSInfo"
  }
})], K.prototype, "ipsInfo", void 0), e([y({
  json: {
    read: false,
    write: {
      target: "operationalLayers",
      ignoreOrigin: true
    }
  }
})], K.prototype, "layers", void 0), e([r("layers")], K.prototype, "writeLayers", null), e([y({
  type: S2
})], K.prototype, "portalItem", void 0), e([y({
  json: {
    write: true
  }
})], K.prototype, "presentation", void 0), e([y()], K.prototype, "resourceInfo", void 0), e([y({
  readOnly: true,
  type: s3,
  json: {
    read: {
      source: "version"
    },
    write: {
      allowNull: true,
      ignoreOrigin: true,
      target: "version",
      isRequired: true
    }
  }
})], K.prototype, "sourceVersion", void 0), e([o("sourceVersion")], K.prototype, "readSourceVersion", null), e([r("sourceVersion")], K.prototype, "writeSourceVersion", null), e([y({
  json: {
    read: false,
    write: {
      ignoreOrigin: true
    }
  }
})], K.prototype, "tables", void 0), e([r("tables")], K.prototype, "writeTables", null), e([y()], K.prototype, "thumbnailUrl", null), e([y()], K.prototype, "updatingFromView", null), e([y({
  type: n6,
  json: {
    write: true
  }
})], K.prototype, "widgets", void 0), e([y({
  type: G,
  json: {
    read: true,
    write: true
  }
})], K.prototype, "utilityNetworks", void 0), K = e([a2("esri.WebMap")], K);
var Q = K;
export {
  Q as default
};
//# sourceMappingURL=WebMap-GB3RARF5.js.map
