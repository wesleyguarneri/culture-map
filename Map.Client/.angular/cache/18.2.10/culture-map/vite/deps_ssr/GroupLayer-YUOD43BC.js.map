{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/layers/GroupLayer.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport i from \"../core/CollectionFlattener.js\";\nimport { loadAll as t } from \"../core/loadAll.js\";\nimport r from \"../core/Logger.js\";\nimport { MultiOriginJSONMixin as s } from \"../core/MultiOriginJSONSupport.js\";\nimport { debounce as o, throwIfAbortError as a } from \"../core/promiseUtils.js\";\nimport { watch as l, syncAndInitial as n, on as p, sync as d } from \"../core/reactiveUtils.js\";\nimport { property as y } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/has.js\";\nimport \"../core/RandomLCG.js\";\nimport { getProperties as c } from \"../core/accessorSupport/utils.js\";\nimport { reader as h } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as m } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as u } from \"../core/accessorSupport/decorators/writer.js\";\nimport { OriginId as b } from \"../core/accessorSupport/PropertyOrigin.js\";\nimport v from \"./Layer.js\";\nimport { BlendLayer as f } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as j } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as L } from \"./mixins/PortalLayer.js\";\nimport { ScaleRangeLayer as g } from \"./mixins/ScaleRangeLayer.js\";\nimport { layerLookupMap as w } from \"./support/lazyLayerLoader.js\";\nimport S from \"../portal/PortalItem.js\";\nimport { createFlattenedTablesCollection as _ } from \"../support/collectionUtils.js\";\nimport { LayersMixin as I } from \"../support/LayersMixin.js\";\nimport { TablesMixin as O } from \"../support/TablesMixin.js\";\nimport { WebSceneTag as M } from \"../support/tagSymbols.js\";\nimport { SaveOperationType as x } from \"../webdoc/interfaces.js\";\nimport { beforeSave as P } from \"../webdoc/support/saveUtils.js\";\nimport { getLayerJSON as A } from \"../webdoc/support/writeUtils.js\";\nlet V = class extends f(g(j(L(O(I(s(v))))))) {\n  constructor(e) {\n    super(e), this.allLayers = new i({\n      getCollections: () => [this.layers],\n      getChildrenFunction: e => \"layers\" in e ? e.layers : null\n    }), this.allTables = _(this), this.fullExtent = void 0, this.operationalLayerType = \"GroupLayer\", this.spatialReference = void 0, this.type = \"group\", this._debouncedSaveOperations = o(async (e, i, t) => {\n      const {\n        save: r,\n        saveAs: s\n      } = await import(\"./save/groupLayerUtils.js\");\n      switch (e) {\n        case x.SAVE:\n          return r(this, i);\n        case x.SAVE_AS:\n          return s(this, t, i);\n      }\n    });\n  }\n  initialize() {\n    this._enforceVisibility(this.visibilityMode, this.visible), this.addHandles([l(() => {\n      let e = this.parent;\n      for (; e && \"parent\" in e && e.parent;) e = e.parent;\n      return e && M in e;\n    }, e => {\n      const i = \"prevent-adding-tables\";\n      this.removeHandles(i), e && (this.tables.removeAll(), this.addHandles(p(() => this.tables, \"before-add\", e => {\n        e.preventDefault(), r.getLogger(this).errorOnce(\"tables\", \"tables in group layers in a webscene are not supported. Please move the tables from the group layer to the webscene if you want to persist them.\");\n      }), i));\n    }, n), l(() => this.visible, this._onVisibilityChange.bind(this), d)]);\n  }\n  destroy() {\n    this.allLayers.destroy(), this.allTables.destroy();\n  }\n  get sourceIsPortalItem() {\n    return this.portalItem && this.originIdOf(\"portalItem\") === b.USER;\n  }\n  _writeLayers(e, i, t, r) {\n    const s = [];\n    if (!e) return s;\n    e.forEach(e => {\n      const i = A(e, r.webmap ? r.webmap.getLayerJSONFromResourceInfo(e) : null, r);\n      i?.layerType && s.push(i);\n    }), i.layers = s;\n  }\n  set portalItem(e) {\n    this._set(\"portalItem\", e);\n  }\n  readPortalItem(e, i, t) {\n    const {\n      itemId: r,\n      layerType: s\n    } = i;\n    if (\"GroupLayer\" === s && r) return new S({\n      id: r,\n      portal: t?.portal\n    });\n  }\n  writePortalItem(e, i) {\n    e?.id && (i.itemId = e.id);\n  }\n  set visibilityMode(e) {\n    const i = this._get(\"visibilityMode\") !== e;\n    this._set(\"visibilityMode\", e), i && this._enforceVisibility(e, this.visible);\n  }\n  async beforeSave() {\n    return P(this);\n  }\n  load(e) {\n    const i = this.loadFromPortal({\n      supportedTypes: [\"Feature Service\", \"Feature Collection\", \"Group Layer\", \"Scene Service\"],\n      layerModuleTypeMap: w\n    }, e).catch(e => {\n      if (a(e), this.sourceIsPortalItem) throw e;\n    });\n    return this.addResolvingPromise(i), Promise.resolve(this);\n  }\n  async loadAll() {\n    return t(this, e => {\n      e(this.layers, this.tables);\n    });\n  }\n  async save(e) {\n    return this._debouncedSaveOperations(x.SAVE, e);\n  }\n  async saveAs(e, i) {\n    return this._debouncedSaveOperations(x.SAVE_AS, i, e);\n  }\n  layerAdded(e) {\n    e.visible && \"exclusive\" === this.visibilityMode ? this._turnOffOtherLayers(e) : \"inherited\" === this.visibilityMode && (e.visible = this.visible), this.hasHandles(e.uid) ? console.error(`Layer read to Grouplayer: uid=${e.uid}`) : this.addHandles(l(() => e.visible, i => this._onChildVisibilityChange(e, i), d), e.uid);\n  }\n  layerRemoved(e) {\n    this.removeHandles(e.uid), this._enforceVisibility(this.visibilityMode, this.visible);\n  }\n  _turnOffOtherLayers(e) {\n    this.layers.forEach(i => {\n      i !== e && (i.visible = !1);\n    });\n  }\n  _enforceVisibility(e, i) {\n    if (!c(this).initialized) return;\n    const t = this.layers;\n    let r = t.find(e => e.visible);\n    switch (e) {\n      case \"exclusive\":\n        t.length && !r && (r = t.at(0), r.visible = !0), this._turnOffOtherLayers(r);\n        break;\n      case \"inherited\":\n        t.forEach(e => {\n          e.visible = i;\n        });\n    }\n  }\n  _onVisibilityChange(e) {\n    \"inherited\" === this.visibilityMode && this.layers.forEach(i => {\n      i.visible = e;\n    });\n  }\n  _onChildVisibilityChange(e, i) {\n    switch (this.visibilityMode) {\n      case \"exclusive\":\n        i ? this._turnOffOtherLayers(e) : this._isAnyLayerVisible() || (e.visible = !0);\n        break;\n      case \"inherited\":\n        e.visible = this.visible;\n    }\n  }\n  _isAnyLayerVisible() {\n    return this.layers.some(e => e.visible);\n  }\n};\ne([y({\n  readOnly: !0,\n  dependsOn: []\n})], V.prototype, \"allLayers\", void 0), e([y({\n  readOnly: !0\n})], V.prototype, \"allTables\", void 0), e([y({\n  json: {\n    read: !0,\n    write: !0\n  }\n})], V.prototype, \"blendMode\", void 0), e([y()], V.prototype, \"fullExtent\", void 0), e([y({\n  readOnly: !0\n})], V.prototype, \"sourceIsPortalItem\", null), e([y({\n  json: {\n    read: !1,\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], V.prototype, \"layers\", void 0), e([u(\"layers\")], V.prototype, \"_writeLayers\", null), e([y({\n  type: [\"GroupLayer\"]\n})], V.prototype, \"operationalLayerType\", void 0), e([y({\n  json: {\n    origins: {\n      \"web-map\": {\n        read: !1,\n        write: {\n          overridePolicy(e, i, t) {\n            return {\n              enabled: \"Group Layer\" === e?.type && t?.initiator !== this\n            };\n          }\n        }\n      },\n      \"web-scene\": {\n        read: !1,\n        write: !1\n      }\n    }\n  }\n})], V.prototype, \"portalItem\", null), e([h(\"web-map\", \"portalItem\", [\"itemId\"])], V.prototype, \"readPortalItem\", null), e([u(\"web-map\", \"portalItem\", {\n  itemId: {\n    type: String\n  }\n})], V.prototype, \"writePortalItem\", null), e([y()], V.prototype, \"spatialReference\", void 0), e([y({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"group\"\n})], V.prototype, \"type\", void 0), e([y({\n  type: [\"independent\", \"inherited\", \"exclusive\"],\n  value: \"independent\",\n  json: {\n    write: !0,\n    origins: {\n      \"web-map\": {\n        type: [\"independent\", \"exclusive\"],\n        write: (e, i, t) => {\n          \"inherited\" !== e && (i[t] = e);\n        }\n      }\n    }\n  }\n})], V.prototype, \"visibilityMode\", null), V = e([m(\"esri.layers.GroupLayer\")], V);\nconst C = V;\nexport { C as default };"],
  "mappings": "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",
  "names": ["l", "t", "n", "S", "f", "e", "r", "A", "i", "a", "C"]
}
