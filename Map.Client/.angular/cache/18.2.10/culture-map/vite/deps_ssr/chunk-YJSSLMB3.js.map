{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/widgets/FeatureForm/featureFormUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport \"../../intl.js\";\nimport { isSome as e } from \"../../core/arrayUtils.js\";\nimport { neverReached as t } from \"../../core/compilerUtils.js\";\nimport { equalsShallow as n } from \"../../core/lang.js\";\nimport r from \"../../core/Logger.js\";\nimport { templateHasKey as o, replace as i } from \"../../core/string.js\";\nimport { isFieldElement as s } from \"../../form/support/formUtils.js\";\nimport { DomainValidationError as l } from \"../../layers/support/domainUtils.js\";\nimport { isTimeOnlyField as u, NumericRangeValidationError as a, TypeValidationError as p } from \"../../layers/support/fieldUtils.js\";\nimport { isAnyDateField as m } from \"../../smartMapping/support/utils.js\";\nimport { getLabelForDateFieldValue as d, getIntlOptionsForField as c } from \"../support/dateUtils.js\";\nimport { substitute as f } from \"../../intl/substitute.js\";\nconst y = e => \"field\" === e?.type,\n  b = e => \"group\" === e?.type,\n  g = e => \"relationship\" === e?.type,\n  x = e => \"text\" === e.type,\n  T = e => !b(e) && null != e.group,\n  O = e => e.reduce((e, t) => b(t) ? [...e, ...t.inputs] : [...e, t], []),\n  j = e => O(e).filter(y),\n  N = e => O(e).filter(g),\n  h = e => null != e && (v(e, \"combo-box\") || v(e, \"radio-buttons\")),\n  v = (e, t) => null != e && e.input?.type === t,\n  F = e => null != e && (v(e, \"text-box\") || v(e, \"text-area\")),\n  E = ({\n    domain: e,\n    inputType: t = \"text-box\",\n    dataType: n\n  }) => \"number\" === n && \"text-box\" === t && (!e || \"coded-value\" !== e.type),\n  V = e => \"items\" in e;\nfunction U(t) {\n  const {\n    attributes: n,\n    fieldsIndex: r,\n    label: i,\n    timeZone: s\n  } = t;\n  if (!n || \"object\" != typeof n) return i;\n  const l = Object.keys(n).filter(e => o(i, e)),\n    u = l.map(e => n[e]),\n    a = l.map(e => r.get(e)).filter(e);\n  return Z(i, S({\n    values: u,\n    fields: a,\n    timeZone: s\n  }));\n}\nconst L = \"expression/\",\n  _ = \"expr/\",\n  A = \"field/\";\nfunction I(e) {\n  const [t, n] = e.split(L);\n  return \"\" === t && n ? n : (r.getLogger(\"esri.widgets.FeatureForm/featureFormUtils\").error(\"extractExpressionNameFromString:invalid-input\", `The string ${e} is not a valid expression reference of the form '${L}/expressionName'`), \"\");\n}\nfunction R(e) {\n  return `${L}${e}`;\n}\nfunction $(e) {\n  return `${A}${e}`;\n}\nfunction D(e) {\n  return e.startsWith(L);\n}\nfunction w(e) {\n  return e.startsWith(_);\n}\nfunction S(e) {\n  const {\n      fields: t,\n      values: n\n    } = e,\n    r = e.timeZone ?? void 0,\n    o = t.map((e, t) => {\n      let o = n[t];\n      if (e.domain && \"coded-value\" === e.domain.type) {\n        const t = e.domain.codedValues.find(e => e.code === o);\n        t?.name && (o = t.name);\n      }\n      return (m(e) || u(e)) && (o = d(e, o, {\n        timeZone: r,\n        ...c(e)\n      })), [e.name, o];\n    });\n  return Object.fromEntries(o);\n}\nfunction Z(e, t) {\n  return i(i(e, e => `{${e.toLowerCase()}}`), Object.fromEntries(Object.entries(t).map(([e, t]) => [e.toLowerCase(), t])));\n}\nconst C = e => {\n    const t = {\n      typeFieldName: null,\n      types: []\n    };\n    return e ? (\"subtype-sublayer\" === e.type ? (t.typeFieldName = e.parent?.subtypeField, t.types = e.parent?.subtypes ?? []) : \"subtype-group\" === e.type || \"feature\" === e.type && e.subtypes?.length ? (t.typeFieldName = e.subtypeField, t.types = e.subtypes ?? []) : \"types\" in e && e.types && (t.typeFieldName = e.typeIdField, t.types = e.types.map(({\n      id: e,\n      name: t,\n      domains: n\n    }) => ({\n      code: e,\n      name: t,\n      domains: n\n    }))), null != t.typeFieldName && (t.typeFieldName = e.getField(t.typeFieldName)?.name ?? t.typeFieldName), t) : t;\n  },\n  G = (e, t) => {\n    if (!e) return !0;\n    const {\n      operations: n\n    } = e;\n    switch (t) {\n      case \"INSERT\":\n        return n.supportsAdd;\n      case \"UPDATE\":\n      case \"DELETE\":\n        return n.supportsUpdate;\n      default:\n        return !0;\n    }\n  };\nvar M;\n!function (e) {\n  e.TOO_SHORT = \"length-validation-error::too-short\", e.TOO_LONG = \"length-validation-error::too-long\";\n}(M || (M = {}));\nconst H = {\n    type: \"number\"\n  },\n  P = {\n    type: \"number\",\n    intlOptions: {\n      notation: \"scientific\"\n    }\n  };\nfunction W(e) {\n  return e >= 1e7 || e <= -1e7;\n}\nfunction k(e, {\n  validationErrors: t\n}) {\n  return null != e.max && null != e.min ? t.outsideRange : null != e.max ? t.outsideRangeMax : t.outsideRangeMin;\n}\nconst q = (e, t, n) => {\n    const {\n        dataType: r,\n        error: o,\n        minLength: i,\n        value: s,\n        required: u\n      } = e,\n      m = t?.validationErrors;\n    if (!m || !o) return null;\n    if (u && null === s) return m.cannotBeNull;\n    if (o === l.VALUE_OUT_OF_RANGE || o === a.OUT_OF_RANGE) {\n      const {\n          field: o,\n          range: i\n        } = e,\n        s = {\n          type: \"date\",\n          intlOptions: {\n            timeZone: \"date\" === o.type && n ? n : void 0,\n            ...c(o)\n          }\n        },\n        l = k(i, t);\n      return f(l, i, {\n        format: {\n          max: \"date\" === r ? s : null != i.max && W(i.max) ? P : H,\n          min: \"date\" === r ? s : null != i.min && W(i.min) ? P : H\n        }\n      });\n    }\n    return o === l.INVALID_CODED_VALUE ? m.invalidCodedValue : o === p.INVALID_TYPE ? m.invalidType : o === M.TOO_SHORT ? f(m.tooShort, {\n      min: i\n    }) : (M.TOO_LONG, null);\n  },\n  B = e => {\n    if (!e) return;\n    const t = e.layer,\n      n = t && \"geometryType\" in t ? t.geometryType : void 0,\n      r = e.geometry?.type;\n    return \"polyline\" === r || \"polyline\" === n ? \"line\" : \"mesh\" === r || \"mesh\" === n || \"multipatch\" === n ? \"cube\" : \"multipoint\" === r || \"multipoint\" === n ? \"point\" : r || n || \"table\";\n  },\n  Y = e => {\n    const t = [];\n    if (e.formTemplate) {\n      const {\n        description: n,\n        title: r\n      } = e.formTemplate;\n      e.fields?.forEach(e => {\n        const i = r && o(r, e.name),\n          s = n && o(n, e.name);\n        (i || s) && t.push(e.name);\n      });\n    }\n    return t;\n  };\nfunction z(e, t) {\n  const n = t ?? (\"formTemplate\" in e && e.formTemplate);\n  if (n) {\n    return (n.elements?.filter(s) ?? []).some(({\n      fieldName: t\n    }) => !e.fieldsIndex.get(t));\n  }\n  return !1;\n}\nfunction J(e, t) {\n  return null == e || t.onValue !== e && t.offValue !== e;\n}\nfunction K(e, n) {\n  switch (n.objectType) {\n    case \"any\":\n      return !0;\n    case \"null\":\n      return null == e;\n    case \"code\":\n      return e === n.codedValue?.code;\n    case \"range\":\n      return null != e && null != n.minValue && null != n.maxValue && +e >= n.minValue && +e <= n.maxValue;\n    default:\n      return t(n.objectType), !1;\n  }\n}\nfunction Q(e, t, r) {\n  if (!e || !(\"subtypes\" in e)) return !1;\n  const o = e.subtypes?.find(e => e.code === r);\n  if (!o) return !1;\n  const i = e.subtypes?.find(e => e.code === t);\n  return !n(o.defaultValues, i?.defaultValues) && Object.values(o.defaultValues).some(e => null != e);\n}\nexport { M as LengthValidationError, G as capabilitiesAllowEditType, I as extractExpressionNameFromString, j as flattenFieldInputs, O as flattenInputs, N as flattenRelationshipInputs, z as formTemplateHasInvalidFields, S as getComputedAttributes, q as getErrorMessageForFieldInput, Y as getFieldsInTitleAndDesc, B as getIconForFeature, C as getNormalizedFeatureTypeInfo, D as isExpressionReference, v as isFieldElementWithInputType, h as isFieldElementWithShowNoValueOptionInput, F as isFieldElementWithTextInput, y as isFieldInput, b as isGroupInput, T as isInputInGroupInput, w as isLegacyFieldMapsExpressionReference, E as isNumberFieldInput, g as isRelationshipInput, V as isTemplateItemGroup, x as isTextElementInput, U as parseFormTemplateString, R as prependExpressionPrefix, $ as prependFieldPrefix, Z as substituteFieldTemplatesInString, Q as subtypeChangeShouldPrompt, J as valueIsInvalidSwitchValue, K as valueIsValidContingentValue };"],
  "mappings": "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",
  "names": ["T", "O", "e", "t", "h", "F", "n", "r", "i", "s", "l", "Z", "o"]
}
