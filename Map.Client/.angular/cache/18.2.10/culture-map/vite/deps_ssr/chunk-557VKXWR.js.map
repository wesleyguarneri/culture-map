{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/portal/support/resourceUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../request.js\";\nimport t from \"../../core/Error.js\";\nimport { join as r, getPathExtension as s } from \"../../core/urlUtils.js\";\nasync function o(e, t = {}, s) {\n  await e.load(s);\n  const o = r(e.itemUrl, \"resources\"),\n    {\n      start: a = 1,\n      num: n = 10,\n      sortOrder: c = \"asc\",\n      sortField: l = \"resource\"\n    } = t,\n    i = {\n      query: {\n        start: a,\n        num: n,\n        sortOrder: c,\n        sortField: l,\n        token: e.apiKey\n      },\n      signal: s?.signal\n    },\n    u = await e.portal.request(o, i);\n  return {\n    total: u.total,\n    nextStart: u.nextStart,\n    resources: u.resources.map(({\n      created: t,\n      size: r,\n      resource: s\n    }) => ({\n      created: new Date(t),\n      size: r,\n      resource: e.resourceFromPath(s)\n    }))\n  };\n}\nasync function a(e, s, o, a) {\n  const n = new Map();\n  for (const {\n    resource: r,\n    content: i,\n    compress: u,\n    access: p\n  } of s) {\n    if (!r.hasPath()) throw new t(`portal-item-resource-${o}:invalid-path`, \"Resource does not have a valid path\");\n    const [e, s] = l(r.path),\n      a = `${e}/${u ?? \"\"}/${p ?? \"\"}`;\n    n.has(a) || n.set(a, {\n      prefix: e,\n      compress: u,\n      access: p,\n      files: []\n    });\n    n.get(a).files.push({\n      fileName: s,\n      content: i\n    });\n  }\n  await e.load(a);\n  const c = r(e.userItemUrl, \"add\" === o ? \"addResources\" : \"updateResources\");\n  for (const {\n    prefix: t,\n    compress: r,\n    access: l,\n    files: i\n  } of n.values()) {\n    const s = 25;\n    for (let o = 0; o < i.length; o += s) {\n      const n = i.slice(o, o + s),\n        u = new FormData();\n      t && \".\" !== t && u.append(\"resourcesPrefix\", t), r && u.append(\"compress\", \"true\"), l && u.append(\"access\", l);\n      let p = 0;\n      for (const {\n        fileName: e,\n        content: t\n      } of n) u.append(\"file\" + ++p, t, e);\n      u.append(\"f\", \"json\"), await e.portal.request(c, {\n        method: \"post\",\n        body: u,\n        signal: a?.signal\n      });\n    }\n  }\n}\nasync function n(e, s, o) {\n  if (!s.hasPath()) throw new t(\"portal-item-resources-remove:invalid-path\", \"Resource does not have a valid path\");\n  await e.load(o);\n  const a = r(e.userItemUrl, \"removeResources\");\n  await e.portal.request(a, {\n    method: \"post\",\n    query: {\n      resource: s.path\n    },\n    signal: o?.signal\n  }), s.portalItem = null;\n}\nasync function c(e, t) {\n  await e.load(t);\n  const s = r(e.userItemUrl, \"removeResources\");\n  return e.portal.request(s, {\n    method: \"post\",\n    query: {\n      deleteAll: !0\n    },\n    signal: t?.signal\n  });\n}\nfunction l(e) {\n  const t = e.lastIndexOf(\"/\");\n  return -1 === t ? [\".\", e] : [e.slice(0, t), e.slice(t + 1)];\n}\nfunction i(e) {\n  const [t, r] = u(e),\n    [s, o] = l(t);\n  return [s, o, r];\n}\nfunction u(e) {\n  const t = s(e);\n  return null == t ? [e, \"\"] : [e.slice(0, e.length - t.length - 1), `.${t}`];\n}\nasync function p(t) {\n  if (\"blob\" === t.type) return t.blob;\n  if (\"json\" === t.type) return new Blob([t.jsonString], {\n    type: \"application/json\"\n  });\n  return (await e(t.url, {\n    responseType: \"blob\"\n  })).data;\n}\nfunction f(e, t) {\n  if (!e.hasPath()) return null;\n  const [s,, o] = i(e.path);\n  return e.portalItem.resourceFromPath(r(s, t + o));\n}\nfunction m(e, t) {\n  if (!e.hasPath()) return null;\n  const [s,, o] = i(e.path);\n  return e.portalItem.resourceFromPath(r(s, t + o));\n}\nexport { a as addOrUpdateResources, p as contentToBlob, o as fetchResources, f as getSiblingOfSameType, m as getSiblingOfSameTypeI, c as removeAllResources, n as removeResource, i as splitPrefixFileNameAndExtension };"],
  "mappings": "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",
  "names": ["s", "o", "a", "n", "c", "l", "i", "u", "t", "p", "e"]
}
