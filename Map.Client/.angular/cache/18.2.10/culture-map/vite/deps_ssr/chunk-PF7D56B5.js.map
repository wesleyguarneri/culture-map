{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/interactive/snapping/SnappingOperation.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport s from \"../../../core/Accessor.js\";\nimport { abortMaybe as o, removeMaybe as n } from \"../../../core/maybe.js\";\nimport { debounce as i } from \"../../../core/promiseUtils.js\";\nimport { property as r } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as e } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { TaskPriority as a, ImmediateTask as l } from \"../../support/Scheduler.js\";\nlet p = class extends s {\n  constructor(t) {\n    super(t), this.constrainResult = t => t, this._snapPoints = null, this._frameTask = null, this._abortController = null, this._stagedPoint = null, this._snap = i(async (t, s, o, n) => {\n      const i = this._frameTask;\n      if (null == i) return;\n      const r = await i.schedule(() => s.snap({\n        ...t,\n        context: o,\n        signal: n\n      }), n);\n      r.valid && (await i.schedule(() => {\n        this.stagedPoint = r.apply(), t !== this._snapPoints && null != this._snapPoints && (this.stagedPoint = s.update({\n          ...this._snapPoints,\n          context: o\n        }));\n      }, n));\n    });\n  }\n  get stagedPoint() {\n    return this._stagedPoint;\n  }\n  set stagedPoint(t) {\n    this._stagedPoint = this.constrainResult(t);\n  }\n  initialize() {\n    const t = \"3d\" === this.view.type ? this.view?.resourceController?.scheduler : null;\n    this._frameTask = null != t ? t.registerTask(a.SNAPPING) : l;\n  }\n  destroy() {\n    this._abortController = o(this._abortController), this._frameTask = n(this._frameTask);\n  }\n  update(t, s, o) {\n    this._snapPoints = t;\n    const {\n        point: n,\n        scenePoint: i\n      } = t,\n      r = s.update({\n        point: n,\n        scenePoint: i,\n        context: o\n      });\n    return this.stagedPoint = r, r;\n  }\n  async snap(t, s, o) {\n    const {\n      point: n,\n      scenePoint: i\n    } = t;\n    return this.stagedPoint = s.update({\n      point: n,\n      scenePoint: i,\n      context: o\n    }), this._snapPoints = t, null == this._abortController && (this._abortController = new AbortController()), this._snap(t, s, o, this._abortController.signal);\n  }\n  async snapAgainNearPreviousMapPoint(t, s) {\n    null != this._snapPoints && (await this.snap(this._snapPoints, t, s));\n  }\n  abort() {\n    this._abortController = o(this._abortController), this._snapPoints = null;\n  }\n};\nt([r({\n  constructOnly: !0\n})], p.prototype, \"view\", void 0), t([r()], p.prototype, \"stagedPoint\", null), t([r()], p.prototype, \"constrainResult\", void 0), t([r()], p.prototype, \"_stagedPoint\", void 0), p = t([e(\"esri.views.interactive.snapping.SnappingOperation\")], p);\nexport { p as SnappingOperation };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,IAAI,IAAI,cAAc,EAAE;AAAA,EACtB,YAAY,GAAG;AACb,UAAM,CAAC,GAAG,KAAK,kBAAkB,CAAAA,OAAKA,IAAG,KAAK,cAAc,MAAM,KAAK,aAAa,MAAM,KAAK,mBAAmB,MAAM,KAAK,eAAe,MAAM,KAAK,QAAQ,EAAE,CAAOA,IAAG,GAAG,GAAG,MAAM;AACrL,YAAM,IAAI,KAAK;AACf,UAAI,QAAQ,EAAG;AACf,YAAM,IAAI,MAAM,EAAE,SAAS,MAAM,EAAE,KAAK,iCACnCA,KADmC;AAAA,QAEtC,SAAS;AAAA,QACT,QAAQ;AAAA,MACV,EAAC,GAAG,CAAC;AACL,QAAE,UAAU,MAAM,EAAE,SAAS,MAAM;AACjC,aAAK,cAAc,EAAE,MAAM,GAAGA,OAAM,KAAK,eAAe,QAAQ,KAAK,gBAAgB,KAAK,cAAc,EAAE,OAAO,iCAC5G,KAAK,cADuG;AAAA,UAE/G,SAAS;AAAA,QACX,EAAC;AAAA,MACH,GAAG,CAAC;AAAA,IACN,EAAC;AAAA,EACH;AAAA,EACA,IAAI,cAAc;AAChB,WAAO,KAAK;AAAA,EACd;AAAA,EACA,IAAI,YAAY,GAAG;AACjB,SAAK,eAAe,KAAK,gBAAgB,CAAC;AAAA,EAC5C;AAAA,EACA,aAAa;AACX,UAAM,IAAI,SAAS,KAAK,KAAK,OAAO,KAAK,MAAM,oBAAoB,YAAY;AAC/E,SAAK,aAAa,QAAQ,IAAI,EAAE,aAAa,EAAE,QAAQ,IAAI;AAAA,EAC7D;AAAA,EACA,UAAU;AACR,SAAK,mBAAmB,EAAE,KAAK,gBAAgB,GAAG,KAAK,aAAa,EAAE,KAAK,UAAU;AAAA,EACvF;AAAA,EACA,OAAO,GAAG,GAAG,GAAG;AACd,SAAK,cAAc;AACnB,UAAM;AAAA,MACF,OAAO;AAAA,MACP,YAAY;AAAA,IACd,IAAI,GACJ,IAAI,EAAE,OAAO;AAAA,MACX,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,SAAS;AAAA,IACX,CAAC;AACH,WAAO,KAAK,cAAc,GAAG;AAAA,EAC/B;AAAA,EACM,KAAK,GAAG,GAAG,GAAG;AAAA;AAClB,YAAM;AAAA,QACJ,OAAO;AAAA,QACP,YAAY;AAAA,MACd,IAAI;AACJ,aAAO,KAAK,cAAc,EAAE,OAAO;AAAA,QACjC,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,SAAS;AAAA,MACX,CAAC,GAAG,KAAK,cAAc,GAAG,QAAQ,KAAK,qBAAqB,KAAK,mBAAmB,IAAI,gBAAgB,IAAI,KAAK,MAAM,GAAG,GAAG,GAAG,KAAK,iBAAiB,MAAM;AAAA,IAC9J;AAAA;AAAA,EACM,8BAA8B,GAAG,GAAG;AAAA;AACxC,cAAQ,KAAK,gBAAgB,MAAM,KAAK,KAAK,KAAK,aAAa,GAAG,CAAC;AAAA,IACrE;AAAA;AAAA,EACA,QAAQ;AACN,SAAK,mBAAmB,EAAE,KAAK,gBAAgB,GAAG,KAAK,cAAc;AAAA,EACvE;AACF;AACAC,GAAE,CAAC,EAAE;AAAA,EACH,eAAe;AACjB,CAAC,CAAC,GAAG,EAAE,WAAW,QAAQ,MAAM,GAAGA,GAAE,CAAC,EAAE,CAAC,GAAG,EAAE,WAAW,eAAe,IAAI,GAAGA,GAAE,CAAC,EAAE,CAAC,GAAG,EAAE,WAAW,mBAAmB,MAAM,GAAGA,GAAE,CAAC,EAAE,CAAC,GAAG,EAAE,WAAW,gBAAgB,MAAM,GAAG,IAAIA,GAAE,CAAC,EAAE,mDAAmD,CAAC,GAAG,CAAC;",
  "names": ["t", "e"]
}
