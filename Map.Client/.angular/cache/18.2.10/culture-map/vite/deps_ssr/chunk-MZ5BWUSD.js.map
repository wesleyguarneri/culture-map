{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/interactive/visualElements/PointVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { clamp as e } from \"../../../../core/mathUtils.js\";\nimport { s as t } from \"../../../../chunks/vec32.js\";\nimport { create as i } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { a as r, c as s } from \"../../../../chunks/vec42.js\";\nimport { fromValues as o } from \"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";\nimport { projectVectorToVector as n } from \"../../../../geometry/projection/projectVectorToVector.js\";\nimport { expandWithBuffer as l } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { sv3d as a } from \"../../../../geometry/support/vectorStacks.js\";\nimport { Object3DVisualElement as u } from \"./Object3DVisualElement.js\";\nimport { evaluateElevationAlignmentAtPoint as h } from \"../../layers/graphics/elevationAlignmentUtils.js\";\nimport { ElevationContext as m } from \"../../layers/graphics/ElevationContext.js\";\nimport { requiresHalfTexelOffset as p, createTexture as _, defaultSymbolSizeRatio as c } from \"../../support/engineContent/sdfPrimitives.js\";\nimport { createPointGeometry as g } from \"../../webgl-engine/lib/GeometryUtil.js\";\nimport { VertexAttribute as d } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { HUDMaterial as f } from \"../../webgl-engine/materials/HUDMaterial.js\";\nclass x extends u {\n  constructor(e) {\n    super(e), this._material = null, this._texture = null, this._geometry = null, this._size = 3, this._color = o(1, 0, 1, 1), this._pixelSnappingEnabled = !0, this._primitive = \"square\", this._outlineSize = 1, this._outlineColor = o(1, 1, 1, 1), this._elevationInfo = null, this.applyProperties(e);\n  }\n  get geometry() {\n    return this._geometry;\n  }\n  set geometry(e) {\n    this._geometry = e, this.recreateGeometry();\n  }\n  get size() {\n    return this._size;\n  }\n  set size(e) {\n    if (e !== this._size) {\n      const t = this._preferredTextureSize;\n      this._size = e, t < this._preferredTextureSize ? this.recreate() : this._updateSizeAttribute();\n    }\n  }\n  get color() {\n    return this._color;\n  }\n  set color(e) {\n    r(e, this._color) || (s(this._color, e), this._updateMaterial());\n  }\n  get pixelSnappingEnabled() {\n    return this._pixelSnappingEnabled;\n  }\n  set pixelSnappingEnabled(e) {\n    this._pixelSnappingEnabled !== e && (this._pixelSnappingEnabled = e, this._updateMaterial());\n  }\n  get primitive() {\n    return this._primitive;\n  }\n  set primitive(e) {\n    this._primitive !== e && (this._primitive = e, this.recreate());\n  }\n  get outlineSize() {\n    return this._outlineSize;\n  }\n  set outlineSize(e) {\n    e !== this._outlineSize && (this._outlineSize = e, this._updateMaterial());\n  }\n  get outlineColor() {\n    return this._outlineColor;\n  }\n  set outlineColor(e) {\n    r(e, this._outlineColor) || (s(this._outlineColor, e), this._updateMaterial());\n  }\n  get elevationInfo() {\n    return this._elevationInfo;\n  }\n  set elevationInfo(e) {\n    this._elevationInfo = e, this.recreateGeometry();\n  }\n  _updateMaterial() {\n    this._material && this._material.setParameters(this._materialParameters);\n  }\n  _updateSizeAttribute() {\n    const e = this.object;\n    if (null == e) return;\n    const t = e.geometries[0];\n    if (null == t) return;\n    const i = t.getMutableAttribute(d.SIZE).data,\n      r = this._geometrySize;\n    i[0] = r, i[1] = r, e.geometryVertexAttributeUpdated(e.geometries[0], d.SIZE);\n  }\n  get _materialParameters() {\n    return {\n      color: this._color,\n      textureIsSignedDistanceField: !0,\n      sampleSignedDistanceFieldTexelCenter: p(this._primitive),\n      distanceFieldBoundingBox: v,\n      occlusionTest: !1,\n      outlineColor: this._outlineColor,\n      outlineSize: this._outlineSize,\n      textureId: this._texture?.id,\n      polygonOffset: !1,\n      shaderPolygonOffset: 0,\n      drawInSecondSlot: !0,\n      depthEnabled: !1,\n      pixelSnappingEnabled: this.pixelSnappingEnabled,\n      isDecoration: this.isDecoration\n    };\n  }\n  get _geometrySize() {\n    return this._size / S;\n  }\n  createExternalResources() {\n    this._texture = _(this._primitive, this._preferredTextureSize), this._material = new f(this._materialParameters);\n    const e = this.view._stage;\n    this._texture.load(e.renderView.renderingContext), e.add(this._texture);\n  }\n  destroyExternalResources() {\n    if (this._texture) {\n      this.view._stage.remove(this._texture), this._texture.dispose(), this._texture = null;\n    }\n    this._material = null;\n  }\n  createGeometries(e) {\n    const t = this._createRenderGeometry();\n    null != t && e.addGeometry(t);\n  }\n  forEachExternalMaterial(e) {\n    this._material && e(this._material);\n  }\n  get _preferredTextureSize() {\n    return e(2 * this._geometrySize, 16, 128);\n  }\n  calculateMapBounds(e) {\n    const t = this.object?.geometries[0];\n    if (!t) return !1;\n    const i = t.attributes.get(d.POSITION).data;\n    return n(i, this.view.renderCoordsHelper.spatialReference, y, this.view.spatialReference), l(e, y), !0;\n  }\n  _createRenderGeometry() {\n    const {\n      geometry: e,\n      _material: i\n    } = this;\n    if (null == e || null == i) return null;\n    const {\n        renderCoordsHelper: r,\n        elevationProvider: s\n      } = this.view,\n      o = h(e, s, m.fromElevationInfo(this.elevationInfo), r),\n      l = t(a.get(), e.x, e.y, o),\n      u = a.get();\n    n(l, e.spatialReference, u, r.spatialReference);\n    const p = this._geometrySize;\n    return g(i, null, u, null, [p, p], [0, 0, 0, 1]);\n  }\n}\nconst S = c,\n  v = [S / 2, S / 2, 1 - S / 2, 1 - S / 2],\n  y = i();\nexport { x as PointVisualElement };"],
  "mappings": "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",
  "names": ["a", "e", "r", "n", "o", "c", "u"]
}
