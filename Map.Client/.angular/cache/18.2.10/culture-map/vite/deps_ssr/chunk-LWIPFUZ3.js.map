{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/webscene/utils.js", "../../../../../../node_modules/@arcgis/core/support/timeUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { WebSceneTag as o } from \"../support/tagSymbols.js\";\nfunction t(t) {\n  return null != t && \"object\" == typeof t && o in t;\n}\nexport { t as isWebScene };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport t from \"../TimeExtent.js\";\nimport { isSome as e } from \"../core/arrayUtils.js\";\nimport { deprecatedFunction as n } from \"../core/deprecate.js\";\nimport { clone as i } from \"../core/lang.js\";\nimport r from \"../core/Logger.js\";\nimport { offsetDate as s } from \"../core/timeUtils.js\";\nimport { isWebMap as l } from \"../webmap/utils.js\";\nimport { isWebScene as o } from \"../webscene/utils.js\";\nfunction m(t) {\n  return void 0 !== t.timeInfo;\n}\nasync function u(t, e) {\n  return t.widgets?.timeSlider?.fullTimeExtent ?? f(t.allLayers, e);\n}\nfunction a(t) {\n  const e = t.numThumbs ?? 2,\n    n = t.currentTimeExtent;\n  if (n) {\n    const {\n      start: t,\n      end: i\n    } = n;\n    return null != t && null != i && t.getTime() === i.getTime() ? \"instant\" : 2 === e ? \"time-window\" : null == t || 0 === t.getTime() ? \"cumulative-from-start\" : \"cumulative-from-end\";\n  }\n  return 2 === e ? \"time-window\" : \"cumulative-from-start\";\n}\nfunction c(t) {\n  const {\n    numStops: e,\n    stopInterval: n,\n    stops: r\n  } = t;\n  return r ? {\n    dates: i(r)\n  } : n ? {\n    interval: n.clone()\n  } : {\n    count: e ?? 5\n  };\n}\nasync function f(n, i) {\n  if (0 === n.length) return t.allTime;\n  await Promise.all(n.map(t => t.load({\n    signal: i\n  })));\n  const r = n.filter(m),\n    s = n.filter(t => !m(t) && null != t.visibilityTimeExtent);\n  if (0 === r.length && 0 === s.length) return t.allTime;\n  const l = [],\n    o = [];\n  for (const t of r) \"feature\" !== t?.type && \"map-image\" !== t?.type || !t.timeInfo?.hasLiveData ? o.push(t) : l.push(t);\n  const u = t => null == t || t.isAllTime,\n    a = [...o.map(t => {\n      const e = t.timeInfo?.fullTimeExtent,\n        {\n          visibilityTimeExtent: n\n        } = t;\n      return e?.intersection(n) ?? n;\n    }), ...s.map(t => t.visibilityTimeExtent)];\n  if (a.some(u)) return t.allTime;\n  const c = l.map(async t => {\n      const e = (await t.fetchRecomputedExtents({\n          signal: i\n        }))?.timeExtent ?? t.timeInfo?.fullTimeExtent,\n        {\n          visibilityTimeExtent: n\n        } = t;\n      return e?.intersection(n) ?? n;\n    }),\n    f = (await Promise.allSettled(c)).map(t => \"fulfilled\" === t.status ? t.value : null);\n  if (f.some(u)) return t.allTime;\n  const p = [...f, ...a].filter(e);\n  if (0 === p.length) return t.allTime;\n  return p.reduce((t, e) => t.union(e));\n}\nfunction p(e, n) {\n  const i = e.currentTimeExtent;\n  if (!i) return null;\n  const {\n      start: r,\n      end: s\n    } = i,\n    l = r ?? s ?? null;\n  switch (n) {\n    case \"time-window\":\n      return new t({\n        start: r,\n        end: s\n      });\n    case \"cumulative-from-start\":\n      return new t({\n        start: null,\n        end: l\n      });\n    case \"cumulative-from-end\":\n      return new t({\n        start: l,\n        end: null\n      });\n    case \"instant\":\n      return new t({\n        start: l,\n        end: l\n      });\n  }\n}\nasync function d(t, e) {\n  return n(r.getLogger(\"esri.support.timeUtils.getTimeSliderSettingsFromWebMap\"), \"`timeUtils.getTimeSliderSettingsFromWebMap` is deprecated in favor of 'timeUtils.getTimeSliderSettingsFromWebDocument'\", {\n    replacement: \"timeUtils.getTimeSliderSettingsFromWebDocument\",\n    version: \"4.30\",\n    see: \"https://developers.arcgis.com/javascript/latest/api-reference/esri-support-timeUtils.html#getTimeSliderSettingsFromWebDocument\",\n    warnOnce: !0\n  }), null != t && l(t) ? await g(t, e) : null;\n}\nasync function g(t, e) {\n  if (!l(t) && !o(t)) return null;\n  await t.load({\n    signal: e\n  });\n  const n = t?.widgets?.timeSlider;\n  if (!n) return null;\n  const i = await u(t, e),\n    r = n.loop,\n    s = a(n);\n  return {\n    fullTimeExtent: i,\n    loop: r,\n    mode: s,\n    playRate: n.stopDelay ?? 2e3,\n    stops: c(n),\n    timeExtent: p(n, s)\n  };\n}\nfunction T(e) {\n  if (!e) return e;\n  const {\n    start: n,\n    end: i\n  } = e;\n  return new t({\n    start: null != n ? s(n, -n.getTimezoneOffset(), \"minutes\") : n,\n    end: null != i ? s(i, -i.getTimezoneOffset(), \"minutes\") : i\n  });\n}\nfunction w(e) {\n  if (!e) return e;\n  const {\n    start: n,\n    end: i\n  } = e;\n  return new t({\n    start: null != n ? s(n, n.getTimezoneOffset(), \"minutes\") : n,\n    end: null != i ? s(i, i.getTimezoneOffset(), \"minutes\") : i\n  });\n}\nexport { f as getTimeExtentFromLayers, g as getTimeSliderSettingsFromWebDocument, d as getTimeSliderSettingsFromWebMap, w as toLocalTimeExtent, T as toUTCTimeExtent };"],
  "mappings": "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",
  "names": ["t", "t", "e", "a", "n", "c", "o", "u", "f", "p"]
}
