import {
  f as f5
} from "./chunk-ALHGAKLZ.js";
import {
  T
} from "./chunk-IFHCRMMI.js";
import {
  i as i2,
  i2 as i3,
  l
} from "./chunk-2O2QC5E4.js";
import {
  n2 as n6
} from "./chunk-NETSBKIF.js";
import "./chunk-UWCDGS6C.js";
import "./chunk-PQKIJHUT.js";
import "./chunk-GJ7RIUPZ.js";
import "./chunk-7NERSLA5.js";
import "./chunk-CYRWOVUJ.js";
import "./chunk-VKKATW5E.js";
import "./chunk-2ACBZNFZ.js";
import {
  m as m3
} from "./chunk-LLR77XQN.js";
import {
  L
} from "./chunk-OMJYNM3Z.js";
import "./chunk-2EMKXJIJ.js";
import "./chunk-B4LTKMH6.js";
import "./chunk-WHRK5GAD.js";
import {
  m as m2
} from "./chunk-XTCHBO6P.js";
import "./chunk-NE4OJEWH.js";
import {
  n as n5,
  p
} from "./chunk-IM5W3NWZ.js";
import "./chunk-SLCHZ6DD.js";
import "./chunk-F35MWZH7.js";
import "./chunk-YA5CTHMT.js";
import "./chunk-B7GRWOZI.js";
import "./chunk-SAOPWBKU.js";
import "./chunk-Z2JVKOTW.js";
import "./chunk-YW5DYBTP.js";
import "./chunk-2C54H6O6.js";
import "./chunk-UHMXQYZT.js";
import "./chunk-LZUPV7SL.js";
import "./chunk-2GRLWAHK.js";
import "./chunk-C3UDKWXD.js";
import "./chunk-YTFX4PFO.js";
import "./chunk-VOROPCKI.js";
import "./chunk-N3IR233K.js";
import "./chunk-DSMB46HB.js";
import "./chunk-USSQX44O.js";
import "./chunk-OTI4DGZ5.js";
import "./chunk-KQDYTHCF.js";
import "./chunk-TR6FCWXY.js";
import "./chunk-TROPJVOL.js";
import "./chunk-JKHDI77M.js";
import "./chunk-3AY5EJVP.js";
import "./chunk-XQCKIDQO.js";
import "./chunk-BNK4CEA6.js";
import "./chunk-BPMRTFHU.js";
import "./chunk-6LDLRQX4.js";
import "./chunk-Z4YAQ5JI.js";
import "./chunk-K2XCQKCC.js";
import "./chunk-AJS4B62I.js";
import "./chunk-S5EXT7FA.js";
import "./chunk-73Y7XDLH.js";
import "./chunk-YFOAET4H.js";
import "./chunk-5U4TBXYS.js";
import "./chunk-6WG22V46.js";
import "./chunk-OOGIXDXG.js";
import "./chunk-JFYQTYD3.js";
import "./chunk-KDJZAYOF.js";
import "./chunk-5453A3C5.js";
import "./chunk-HCFDI7IX.js";
import "./chunk-AQJS6F3O.js";
import "./chunk-WUB6LJVL.js";
import "./chunk-QXSES7JX.js";
import "./chunk-5YIMTGEC.js";
import "./chunk-YPU2P4KO.js";
import "./chunk-UFVMJL32.js";
import "./chunk-B67FUUE5.js";
import "./chunk-5GQ3OMCZ.js";
import {
  r as r3
} from "./chunk-2SMFPIRI.js";
import "./chunk-2GMKFOCL.js";
import "./chunk-ZR5BOILP.js";
import "./chunk-QCBC3RJX.js";
import "./chunk-6XGV55XZ.js";
import "./chunk-HOH445RO.js";
import "./chunk-63QCTVYB.js";
import "./chunk-U74WRHVJ.js";
import "./chunk-TCPN7AEH.js";
import "./chunk-W2IRSMFY.js";
import "./chunk-TRSGUVSM.js";
import "./chunk-U3MA63JX.js";
import "./chunk-WYKKCLBI.js";
import "./chunk-PFMGJTQM.js";
import "./chunk-Q7SRMLJZ.js";
import "./chunk-PQ4T66BG.js";
import "./chunk-SWPHGZYB.js";
import "./chunk-DWASPXVI.js";
import "./chunk-TNWXOQKO.js";
import "./chunk-MAO5BVLA.js";
import "./chunk-T2S5VXNP.js";
import "./chunk-4U5GUJRA.js";
import "./chunk-7KRERHHR.js";
import "./chunk-T4AP6CTC.js";
import "./chunk-HD65DNIO.js";
import "./chunk-4KWLMXIA.js";
import "./chunk-BIUXKPKA.js";
import "./chunk-N6TJI25E.js";
import "./chunk-634JLXD4.js";
import "./chunk-Y3EDGYWG.js";
import "./chunk-UF6JOUSJ.js";
import "./chunk-T5JGQSO3.js";
import {
  i
} from "./chunk-CIW3KHOW.js";
import "./chunk-J55F4AC2.js";
import "./chunk-IQLBZKUD.js";
import "./chunk-7MZZCQ64.js";
import "./chunk-5EBAJR7X.js";
import "./chunk-5JA2JHV3.js";
import "./chunk-JOJZ6YC5.js";
import "./chunk-L4TOCXR5.js";
import "./chunk-IMVP5ADD.js";
import "./chunk-H7WPOTQH.js";
import "./chunk-RTWBKPWJ.js";
import {
  e as e2
} from "./chunk-B5ZW6SJE.js";
import "./chunk-ZACL2JP7.js";
import "./chunk-L3T5PF4P.js";
import {
  A
} from "./chunk-ZZEAVAVX.js";
import "./chunk-SJX5DIA7.js";
import {
  f as f3
} from "./chunk-SGSUM5YO.js";
import {
  t
} from "./chunk-SG5TCCCK.js";
import "./chunk-6A7CWJED.js";
import {
  f as f4
} from "./chunk-LFKEQKEA.js";
import "./chunk-DUTZNK67.js";
import "./chunk-IN6BQCWS.js";
import "./chunk-CRNUMTSV.js";
import "./chunk-JM7HAEY6.js";
import "./chunk-DOK4SACJ.js";
import "./chunk-OUKUASAF.js";
import "./chunk-V5RMUGJJ.js";
import "./chunk-D2NB6D6N.js";
import "./chunk-UWJIHV6Q.js";
import "./chunk-ZUSCOMQM.js";
import "./chunk-DSEUCBVP.js";
import "./chunk-UPDWQH75.js";
import {
  S as S3
} from "./chunk-RXWBJSJ5.js";
import "./chunk-M2NS3MSU.js";
import "./chunk-HMNBB7ED.js";
import "./chunk-3RRMLFFN.js";
import "./chunk-DR5TVNEL.js";
import "./chunk-HT2T6PUB.js";
import "./chunk-K64AAM77.js";
import "./chunk-6EUVKE22.js";
import "./chunk-A3NNJ7XA.js";
import "./chunk-OKJHJ3CY.js";
import "./chunk-XTVPEVHA.js";
import "./chunk-DTUSTSEJ.js";
import "./chunk-JCWFGRHQ.js";
import "./chunk-JILEJ6R2.js";
import {
  n as n4
} from "./chunk-GAW5JHG4.js";
import "./chunk-OEKKQXBD.js";
import {
  y as y2
} from "./chunk-S3IO7V4Q.js";
import "./chunk-DZALMCYL.js";
import "./chunk-K226GFDN.js";
import {
  o as o3
} from "./chunk-4ZZRP4MA.js";
import "./chunk-7ZJ6P7J7.js";
import "./chunk-FPFZQCEQ.js";
import "./chunk-5I6J67HP.js";
import "./chunk-YVULORT6.js";
import "./chunk-PB33BAI3.js";
import {
  o as o2
} from "./chunk-CVB43GGP.js";
import "./chunk-EODIWR2E.js";
import "./chunk-LLDOZWVV.js";
import {
  S as S2
} from "./chunk-FYAEQPUY.js";
import {
  C
} from "./chunk-7XMEZQ34.js";
import {
  m
} from "./chunk-BDM2D6IC.js";
import "./chunk-U2ZVAEKG.js";
import {
  n as n3
} from "./chunk-EDSMXTFO.js";
import "./chunk-MNLT652N.js";
import "./chunk-OGZAGPIO.js";
import "./chunk-HJJIIYFF.js";
import "./chunk-7RMVJCDW.js";
import "./chunk-T6GCUITX.js";
import "./chunk-TUIGM7TV.js";
import "./chunk-IHVSZYZS.js";
import "./chunk-6CA6K3O7.js";
import "./chunk-NYQ5CYNR.js";
import {
  d as d2
} from "./chunk-O7UDKFOW.js";
import {
  f as f2
} from "./chunk-TKPMIAIW.js";
import {
  o
} from "./chunk-NQOJNTB3.js";
import {
  r
} from "./chunk-MFOQYQFG.js";
import "./chunk-NKCPFCP3.js";
import "./chunk-3ZXOUEQG.js";
import "./chunk-AXVPJBVW.js";
import "./chunk-OXEPWRM7.js";
import "./chunk-POILQGXA.js";
import "./chunk-JJS7PR2U.js";
import "./chunk-L5YS4GSA.js";
import "./chunk-PRREDSOB.js";
import {
  n as n2
} from "./chunk-V5C6HSAM.js";
import {
  kt,
  ot,
  r2,
  tt
} from "./chunk-SYATLP3H.js";
import {
  d,
  f
} from "./chunk-V6AMQYXE.js";
import {
  w
} from "./chunk-6WHTZNUH.js";
import {
  V
} from "./chunk-EITGQLII.js";
import "./chunk-TIVJXVMN.js";
import "./chunk-XNUH25NY.js";
import "./chunk-WGAPNV7F.js";
import "./chunk-BXQGM56A.js";
import {
  e
} from "./chunk-4Z5SGKRM.js";
import {
  S
} from "./chunk-ANKOCGE2.js";
import {
  y
} from "./chunk-7CJXZOFG.js";
import "./chunk-IRGZKO7V.js";
import "./chunk-5SELS7VU.js";
import {
  a3 as a2
} from "./chunk-DDYVXG4F.js";
import "./chunk-ANP42J2U.js";
import {
  k
} from "./chunk-HJY2YILU.js";
import "./chunk-7DA6A5LD.js";
import {
  u
} from "./chunk-2MMLMOWS.js";
import "./chunk-4323ZVPF.js";
import {
  a,
  n2 as n,
  s2 as s
} from "./chunk-WYIDUUN2.js";
import {
  O
} from "./chunk-DXLOWWK7.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-JWIQHGQB.js";

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/ExpressionInfo.js
var p2 = class extends i(f) {
  constructor(r4) {
    super(r4), this.expression = null, this.returnType = "string", this.title = null;
  }
};
e([y({
  type: String,
  json: {
    write: {
      isRequired: true
    }
  }
})], p2.prototype, "expression", void 0), e([y({
  type: ["number", "string"],
  json: {
    write: true
  }
})], p2.prototype, "returnType", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], p2.prototype, "title", void 0), p2 = e([a2("esri.webdoc.geotriggersInfo.ExpressionInfo")], p2);
var i4 = p2;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/DeviceLocationFeed.js
var c = new n2({
  deviceLocation: "device-location"
});
var a3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.filterExpression = null, this.type = "device-location";
  }
};
e([y({
  type: i4,
  json: {
    write: true
  }
})], a3.prototype, "filterExpression", void 0), e([y({
  type: c.apiValues,
  readOnly: true,
  json: {
    type: c.jsonValues,
    read: c.read,
    write: c.write
  }
})], a3.prototype, "type", void 0), a3 = e([a2("esri.webdoc.geotriggersInfo.DeviceLocationFeed")], a3);
var n7 = a3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFilter.js
var m4 = class extends i(f) {
  constructor(o6) {
    super(o6), this.geometry = null, this.where = null;
  }
};
e([y({
  types: n4,
  json: {
    read: y2,
    write: true
  }
})], m4.prototype, "geometry", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], m4.prototype, "where", void 0), m4 = e([a2("esri.webdoc.geotriggersInfo.FeatureFilter")], m4);
var c2 = m4;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureLayerSource.js
var p3 = class extends i(f) {
  constructor(r4) {
    super(r4), this.layerId = null, this.layerUrl = null, this.type = "feature-layer";
  }
};
e([y({
  type: String,
  json: {
    write: {
      overridePolicy() {
        return {
          isRequired: null === this.layerUrl
        };
      }
    }
  }
})], p3.prototype, "layerId", void 0), e([y({
  type: String,
  json: {
    write: {
      overridePolicy() {
        return {
          isRequired: null === this.layerId
        };
      }
    }
  }
})], p3.prototype, "layerUrl", void 0), e([o3({
  featureLayer: "feature-layer"
}, {
  readOnly: true
})], p3.prototype, "type", void 0), p3 = e([a2("esri.webdoc.geotriggersInfo.FeatureLayerSource")], p3);
var a4 = p3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFenceParameters.js
var a5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.fenceSource = null, this.filter = null, this.bufferDistance = null, this.type = "features";
  }
};
e([y({
  type: a4,
  json: {
    write: {
      isRequired: true
    }
  }
})], a5.prototype, "fenceSource", void 0), e([y({
  type: c2,
  json: {
    write: true
  }
})], a5.prototype, "filter", void 0), e([y({
  type: Number,
  json: {
    write: true
  }
})], a5.prototype, "bufferDistance", void 0), e([o3({
  features: "features"
}, {
  readOnly: true
})], a5.prototype, "type", void 0), a5 = e([a2("esri.webdoc.geotriggersInfo.FeatureFenceParameters")], a5);
var u2 = a5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/Geotrigger.js
var c3 = class extends i(f) {
  constructor(o6) {
    super(o6), this.type = "fence";
  }
};
e([o3({
  fence: "fence"
}, {
  readOnly: true
})], c3.prototype, "type", void 0), c3 = e([a2("esri.webdoc.geotriggersInfo.Geotrigger")], c3);
var p4 = c3;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/GeotriggerNotificationOptions.js
var p5 = class extends i(f) {
  constructor(o6) {
    super(o6), this.expressionInfo = null, this.requestedActions = null;
  }
};
e([y({
  type: i4,
  json: {
    write: true
  }
})], p5.prototype, "expressionInfo", void 0), e([y({
  type: [String],
  json: {
    write: true
  }
})], p5.prototype, "requestedActions", void 0), p5 = e([a2("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")], p5);
var c4 = p5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/support/typeUtils.js
var t2 = new n2({
  enterContainsAndExitDoesNotContain: "enter-contains-and-exit-does-not-contain",
  enterContainsAndExitDoesNotIntersect: "enter-contains-and-exit-does-not-intersect",
  enterIntersectsAndExitDoesNotIntersect: "enter-intersects-and-exit-does-not-intersect"
});
var n8 = new n2({
  useGeometry: "use-geometry",
  useGeometryWithAccuracy: "use-geometry-with-accuracy"
});
var o4 = new n2({
  enter: "enter",
  enterOrExit: "enter-or-exit",
  exit: "exit"
});

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/FenceGeotrigger.js
var m5 = class extends p4 {
  constructor(e3) {
    super(e3), this.enterExitRule = "enter-contains-and-exit-does-not-intersect", this.feed = null, this.feedAccuracyMode = "use-geometry", this.fenceNotificationRule = null, this.fenceParameters = null, this.name = null, this.notificationOptions = null, this.type = "fence";
  }
};
e([o3(t2)], m5.prototype, "enterExitRule", void 0), e([y({
  type: n7,
  json: {
    write: {
      isRequired: true
    }
  }
})], m5.prototype, "feed", void 0), e([o3(n8)], m5.prototype, "feedAccuracyMode", void 0), e([y({
  type: o4.apiValues,
  json: {
    type: o4.jsonValues,
    read: o4.read,
    write: {
      writer: o4.write,
      isRequired: true
    }
  }
})], m5.prototype, "fenceNotificationRule", void 0), e([y({
  type: u2,
  json: {
    write: {
      isRequired: true
    }
  }
})], m5.prototype, "fenceParameters", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], m5.prototype, "name", void 0), e([y({
  type: c4,
  json: {
    write: true
  }
})], m5.prototype, "notificationOptions", void 0), e([o3({
  fence: "fence"
}, {
  readOnly: true
})], m5.prototype, "type", void 0), m5 = e([a2("esri.webdoc.geotriggersInfo.FenceGeotrigger")], m5);
var u3 = m5;

// ../../../node_modules/@arcgis/core/webdoc/geotriggersInfo/support/geotriggerTypes.js
var o5 = {
  base: p4,
  key: "type",
  typeMap: {
    fence: u3
  }
};

// ../../../node_modules/@arcgis/core/webdoc/GeotriggersInfo.js
var i5 = class extends i(f) {
  constructor(r4) {
    super(r4), this.geotriggers = null;
  }
};
e([y({
  types: [o5],
  json: {
    write: {
      isRequired: true
    }
  }
})], i5.prototype, "geotriggers", void 0), i5 = e([a2("esri.webdoc.GeotriggersInfo")], i5);
var c5 = i5;

// ../../../node_modules/@arcgis/core/webdoc/RangeInfo.js
var s2;
var a6 = s2 = class extends f {
  constructor(e3) {
    super(e3), this.activeRange = null, this.currentRangeExtent = null, this.fullRangeExtent = null;
  }
  clone() {
    return new s2(a({
      activeRange: this.activeRange,
      currentRangeExtent: this.currentRangeExtent,
      fullRangeExtent: this.fullRangeExtent
    }));
  }
};
e([y({
  type: String,
  nonNullable: true,
  json: {
    read: {
      source: "activeRangeName"
    },
    write: {
      target: "activeRangeName",
      isRequired: true
    }
  }
})], a6.prototype, "activeRange", void 0), e([y({
  type: [Number],
  json: {
    write: true
  }
})], a6.prototype, "currentRangeExtent", void 0), e([y({
  type: [Number],
  json: {
    write: true
  }
})], a6.prototype, "fullRangeExtent", void 0), a6 = s2 = e([a2("esri.webdoc.RangeInfo")], a6);
var c6 = a6;

// ../../../node_modules/@arcgis/core/webdoc/support/webdocLoadUtils.js
function p6(e3, t3) {
  return t3.resourceInfo ? l2(t3, t3.resourceInfo, {
    origin: e3.origin
  }) : t3.portalItem?.id ? c7(e3, t3, t3.portalItem) : Promise.resolve();
}
function l2(e3, t3, r4) {
  const o6 = {
    context: __spreadProps(__spreadValues({}, r4), {
      layerContainerType: "operational-layers"
    })
  };
  return e3.portalItem && (o6.context.portal = e3.portalItem.portal || C.getDefault()), import("./layersCreator-Y3WHDGYL.js").then(({
    populateOperationalLayers: r5
  }) => {
    const n10 = [], i6 = t3.operationalLayers;
    i6?.length && n10.push(r5(e3.layers, i6, o6));
    const a8 = __spreadProps(__spreadValues({}, o6), {
      context: __spreadProps(__spreadValues({}, o6.context), {
        layerContainerType: "tables"
      }),
      defaultLayerType: "ArcGISFeatureLayer"
    }), s4 = t3.tables;
    return s4?.length && n10.push(r5(e3.tables, s4, a8)), Promise.allSettled(n10).then(() => {
    });
  });
}
function c7(e3, o6, n10) {
  return __async(this, null, function* () {
    if (yield n10.load().catch((r4) => {
      throw new s(`${e3.name}:load-portal-item`, "Failed to load portal item", {
        error: r4
      });
    }), n10.type !== e3.itemType) throw new s(`${e3.name}:invalid-portal-item`, `Invalid portal item type '${n10.type}', expected '${e3.itemType}'`, {
      type: n10.type
    });
    const a8 = yield n10.fetchData();
    o6.resourceInfo = a8;
    const s4 = e2(n10, e3.origin);
    yield m6(e3, o6, a8, s4), o6.resourceReferences = {
      portalItem: n10,
      paths: s4.readResourcePaths
    };
    const p8 = yield f6(o6.initialViewProperties, n10, n.getLogger(o6));
    if (p8) {
      const t3 = o6.initialViewProperties?.clone() ?? e3.createInitialViewProperties();
      t3.viewpoint = p8, o6.initialViewProperties = t3;
    }
  });
}
function m6(e3, t3, r4, o6) {
  const n10 = u4(e3, r4);
  return t3.read(n10, o6), l2(t3, n10, o6);
}
function u4(e3, t3) {
  const r4 = e3.parseVersion(t3.version || "", e3.name);
  return e3.currentVersion.validate(r4), t3.version = `${r4.major}.${r4.minor}`, t3;
}
function f6(t3, r4, o6) {
  return __async(this, null, function* () {
    const n10 = t3?.viewpoint?.targetGeometry;
    if (n10) return null;
    const i6 = yield y3(t3, r4, o6);
    if (!i6) return null;
    return new m2({
      targetGeometry: i6
    });
  });
}
function y3(e3, t3, r4) {
  return __async(this, null, function* () {
    const n10 = e3?.spatialReference, i6 = t3?.extent;
    if (!n10 || !i6) return null;
    if (n10.isWGS84) return i6.clone();
    if (n10.isWebMercator) return d2(i6);
    const {
      getGeometryServiceURL: p8
    } = yield import("./geometryServiceUtils-ZLQQG2XD.js");
    try {
      const e4 = yield p8(t3), r5 = new p({
        geometries: [i6],
        outSpatialReference: n10
      });
      return (yield n5(e4, r5))[0];
    } catch (l4) {
      r4.error("Error projecting item's extent:", l4);
    }
    return null;
  });
}

// ../../../node_modules/@arcgis/core/webmap/ApplicationProperties.js
var p7;
var n9 = p7 = class extends f {
  constructor(o6) {
    super(o6), this.editing = null, this.offline = null, this.viewing = null;
  }
  clone() {
    return new p7(a({
      editing: this.editing,
      offline: this.offline,
      viewing: this.viewing
    }));
  }
};
e([y({
  json: {
    write: true
  }
})], n9.prototype, "editing", void 0), e([y({
  json: {
    write: true
  }
})], n9.prototype, "offline", void 0), e([y({
  type: i3,
  json: {
    write: true
  }
})], n9.prototype, "viewing", void 0), n9 = p7 = e([a2("esri.webmap.ApplicationProperties")], n9);
var c8 = n9;

// ../../../node_modules/@arcgis/core/webmap/InitialViewProperties.js
var a7 = class extends i(S) {
  constructor(o6) {
    super(o6), this.background = null, this.rangeInfo = null, this.spatialReference = null, this.timeZone = o2, this.viewpoint = null;
  }
};
e([y({
  type: m3
})], a7.prototype, "background", void 0), e([y({
  type: c6
})], a7.prototype, "rangeInfo", void 0), e([y({
  type: f2
})], a7.prototype, "spatialReference", void 0), e([y({
  nonNullable: true
})], a7.prototype, "timeZone", void 0), e([y({
  type: m2
})], a7.prototype, "viewpoint", void 0), a7 = e([a2("esri.webmap.InitialViewProperties")], a7);
var l3 = a7;

// ../../../node_modules/@arcgis/core/webmap/Version.js
var s3 = class extends r3 {
  constructor(r4, s4) {
    super(r4, s4, "webmap");
  }
};

// ../../../node_modules/@arcgis/core/WebMap.js
var M = new s3(2, 31);
var Z = "Web Map";
var W = "webmap";
var $ = "web-map";
var C2 = V.ofType(f5);
var G = V.ofType(T);
var z = /* @__PURE__ */ new Map([["image/jpeg", "jpeg"], ["image/jpg", "jpg"], ["image/png", "png"], ["image/gif", "gif"]]);
var D = "ArcGIS Pro";
var q = f4.JSAPI;
var H = {
  currentVersion: M,
  createInitialViewProperties: () => new l3(),
  parseVersion: s3.parse,
  itemType: Z,
  name: W,
  origin: $
};
var K = class extends S3(m.LoadableMixin(n3(L))) {
  constructor(e3) {
    super(e3), this._isAuthoringAppSetByUser = false, this._isAuthoringAppVersionSetByUser = false, this._thumbnailFilename = null, this._updateFromPromise = null, this.resourceReferences = {
      portalItem: null,
      paths: []
    }, this.applicationProperties = null, this.bookmarks = new C2(), this.floorInfo = null, this.geotriggersInfo = null, this.initialViewProperties = new l3(), this.ipsInfo = null, this.portalItem = null, this.presentation = null, this.sourceVersion = null, this.widgets = null, this.utilityNetworks = null, this._debouncedSaveOperations = k((e4, t3, r4) => __async(this, null, function* () {
      const {
        save: i6,
        saveAs: o6
      } = yield import("./webdocSaveUtils-HD2BCCM7.js");
      switch (e4) {
        case A.SAVE:
          return i6(H, this, t3);
        case A.SAVE_AS:
          return o6(H, this, r4, t3);
      }
    })), this.authoringApp = this.authoringAppVersion = null, this._isAuthoringAppSetByUser = this._isAuthoringAppVersionSetByUser = false;
  }
  destroy() {
    if (this.portalItem = u(this.portalItem), this.utilityNetworks) {
      const e3 = this.utilityNetworks.removeAll();
      for (const t3 of e3) t3.destroy();
      this.utilityNetworks.destroy();
    }
  }
  initialize() {
    if (this.when().catch((e3) => {
      n.getLogger(this).error("#load()", "Failed to load web map", e3);
    }), this.resourceInfo) {
      let t3;
      try {
        t3 = this._validateJSON(this.resourceInfo);
      } catch (e3) {
        return void this.addResolvingPromise(Promise.reject(e3));
      }
      this.read(t3);
    }
  }
  set authoringApp(e3) {
    this._isAuthoringAppSetByUser = true, this._set("authoringApp", e3);
  }
  writeAuthoringApp(e3, t3) {
    e3 && this._isAuthoringAppSetByUser ? t3.authoringApp = e3 : t3.authoringApp = q;
  }
  set authoringAppVersion(e3) {
    this._isAuthoringAppVersionSetByUser = true, this._set("authoringAppVersion", e3);
  }
  writeAuthoringAppVersion(e3, r4) {
    e3 && this._isAuthoringAppVersionSetByUser ? r4.authoringAppVersion = e3 : r4.authoringAppVersion = r2;
  }
  readInitialViewProperties(e3, t3) {
    const r4 = new l3();
    t3.background && (r4.background = m3.fromJSON(t3.background));
    const o6 = t3.initialState?.viewpoint;
    if (o6) {
      if (o6.rotation) {
        s3.parse(t3.version || "", "webmap").lessThan(2, 20) && t3.authoringApp === D && (o6.rotation *= -1);
      }
      r4.viewpoint = m2.fromJSON(o6);
    }
    return t3.mapRangeInfo && (r4.rangeInfo = c6.fromJSON(t3.mapRangeInfo)), t3.spatialReference && (r4.spatialReference = f2.fromJSON(t3.spatialReference)), t3.timeZone && (r4.timeZone = t3.timeZone), r4;
  }
  writeInitialViewProperties(e3, t3, r4, i6) {
    e3 && (e3.background?.color && (t3.background = e3.background.write({}, i6)), e3.viewpoint && (t3.initialState = {
      viewpoint: e3.viewpoint.write({}, i6)
    }), e3.rangeInfo && (t3.mapRangeInfo = e3.rangeInfo.toJSON(i6)), e3.spatialReference && (t3.spatialReference = e3.spatialReference.write({}, i6)), t3.timeZone = e3.timeZone);
  }
  writeLayers(e3, t3, r4, i6) {
    t3[r4] = this._writeLayers(e3, i6, "operational-layers");
  }
  readSourceVersion(e3, t3) {
    const [r4, i6] = t3.version.split(".");
    return new s3(parseInt(r4, 10), parseInt(i6, 10));
  }
  writeSourceVersion(e3, t3, r4) {
    t3[r4] = `${M.major}.${M.minor}`;
  }
  writeTables(e3, t3, r4, i6) {
    const o6 = this._writeLayers(e3, i6, "tables");
    o6.length && (t3[r4] = o6);
  }
  get thumbnailUrl() {
    return this.portalItem?.thumbnailUrl || null;
  }
  set thumbnailUrl(e3) {
    e3 ? (this._override("thumbnailUrl", e3), this._thumbnailFilename = this._generateCustomThumbnailFilename(e3)) : this._clearThumbnailOverride();
  }
  get updatingFromView() {
    return !!this._updateFromPromise;
  }
  load(e3) {
    return this.addResolvingPromise(p6(H, this)), Promise.resolve(this);
  }
  loadAll() {
    return t(this, (e3) => {
      e3(this.ground, this.basemap, this.layers, this.tables);
    });
  }
  read(e3, t3) {
    t3 = __spreadProps(__spreadValues({}, t3), {
      origin: $
    });
    const r4 = this._getAuthoringPropsState();
    d(this, e3, (t4) => super.read(e3, t4), t3), this._restoreAuthoringPropsFromState(r4);
  }
  write(e3, t3) {
    if ("loaded" !== this.loadStatus) {
      const e4 = new s("webmap:not-loaded", "Web map must be loaded before it can be serialized");
      throw n.getLogger(this).error("#toJSON()", "Web map must be loaded before it can be serialized", this.loadError || this.loadStatus), e4;
    }
    return this._removeDanglingLayerRefs(), t3 = __spreadProps(__spreadValues({}, t3), {
      origin: $,
      restrictedWebMapWriting: true,
      webmap: this
    }), super.write(e3, t3);
  }
  save(e3) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE, e3);
    });
  }
  saveAs(e3, t3) {
    return __async(this, null, function* () {
      return this._debouncedSaveOperations(A.SAVE_AS, t3, e3);
    });
  }
  updateFrom(e3, t3) {
    return __async(this, null, function* () {
      const r4 = this._updateFromInternal(e3, t3);
      this._updateFromPromise = r4, yield r4;
      r4 === this._updateFromPromise && (this._updateFromPromise = null);
    });
  }
  getLayerJSONFromResourceInfo(e3) {
    const t3 = this.resourceInfo;
    return this._collectAllLayersJSON([...t3?.baseMap?.baseMapLayers || [], ...t3?.operationalLayers || [], ...this.basemap?.resourceInfo?.data?.baseMapLayers || []]).find((t4) => t4.id === e3.id);
  }
  updateItemThumbnail() {
    return __async(this, null, function* () {
      this.thumbnailUrl && this._isOverridden("thumbnailUrl") && (yield this.portalItem?.updateThumbnail({
        thumbnail: this.thumbnailUrl,
        filename: this._thumbnailFilename
      }), this._clearThumbnailOverride());
    });
  }
  getThumbnailState() {
    let e3 = this.thumbnailUrl;
    return e3 && (e3 = this._isOverridden("thumbnailUrl") ? e3 : kt(e3, "w", "8192")), {
      thumbnailUrl: e3,
      filename: this._thumbnailFilename
    };
  }
  restoreThumbnailFromState(e3) {
    this.thumbnailUrl = e3.thumbnailUrl, this._thumbnailFilename = e3.filename;
  }
  _collectAllLayersJSON(e3) {
    return e3.reduce((e4, t3) => (e4.push(t3), "GroupLayer" === t3.layerType && (e4 = e4.concat(this._collectAllLayersJSON(t3.layers || []))), e4), []);
  }
  _writeLayers(e3, t3, r4) {
    t3 = __spreadProps(__spreadValues({}, t3), {
      layerContainerType: r4
    });
    return e3.map((e4) => f3(e4, "tables" === r4 ? null : this.getLayerJSONFromResourceInfo(e4), t3)).filter(O).toArray();
  }
  _validateJSON(e3) {
    const t3 = s3.parse(e3.version || "", "webmap");
    return M.validate(t3), e3.version = `${t3.major}.${t3.minor}`, e3;
  }
  _removeDanglingLayerRefs() {
    const e3 = this.applicationProperties, t3 = e3?.viewing?.search, r4 = (e4) => this.allLayers.some((t4) => t4.id === e4);
    if (t3?.layers && (t3.layers = t3.layers.filter((e4) => r4(e4.id))), t3?.tables && (t3.tables = t3.tables.filter((e4) => this.tables.some((t4) => t4.id === e4.id))), e3) {
      const t4 = e3.editing?.locationTracking;
      t4?.info && !r4(t4.info.layerId) && (e3.editing = null);
    }
    const i6 = this.presentation?.slides;
    i6 && i6.forEach((e4) => {
      e4.visibleLayers && (e4.visibleLayers = e4.visibleLayers.filter((e5) => r4(e5.id)));
    });
  }
  _updateFromInternal(e3, t3) {
    return __async(this, null, function* () {
      if (t3 ??= {}, yield w(() => e3.ready), this._updateInitialViewProperties(e3, t3), e3.map === this) for (const r4 of e3.allLayerViews) "visible" in r4 && "visible" in r4.layer && r4._isOverridden("visible") && (r4.layer.visible = r4.visible), "featureEffect" in r4 && "featureEffect" in r4.layer && r4._isOverridden("featureEffect") && (r4.layer.featureEffect = r4.featureEffect);
      yield this._updateThumbnailUrl(e3, t3);
    });
  }
  _updateInitialViewProperties(e3, t3) {
    if (t3.backgroundExcluded || (this.initialViewProperties.background = e3.background?.clone()), this.initialViewProperties.spatialReference = e3.spatialReference?.clone(), this.initialViewProperties.timeZone = e3.timeZone, t3.viewpointExcluded || (this.initialViewProperties.viewpoint = new m2({
      rotation: e3.rotation,
      scale: t3.scalePreserved ? e3.scale : null,
      targetGeometry: this._getViewExtent(e3)
    })), !t3.widgetsExcluded) for (const r4 of e3.persistableViewModels) r4.updateWebDocument(this);
  }
  _getViewExtent(e3) {
    const t3 = e3.center.clone().normalize(), r4 = e3.extent.clone(), i6 = r4.width / 2;
    return r4.xmin = t3.x - i6, r4.xmax = t3.x + i6, r4;
  }
  _updateThumbnailUrl(e3, t3) {
    return __async(this, null, function* () {
      if (t3.thumbnailExcluded) return;
      const r4 = i2(e3, t3.thumbnailSize), i6 = yield e3.takeScreenshot({
        format: "png",
        width: r4.width,
        height: r4.height
      });
      this._setAutoGeneratedThumbnail(i6.dataUrl);
    });
  }
  _setAutoGeneratedThumbnail(e3) {
    this.thumbnailUrl = e3, this._thumbnailFilename = null;
  }
  _clearThumbnailOverride() {
    this._clearOverride("thumbnailUrl"), this.clear("thumbnailUrl", "user"), this._thumbnailFilename = null;
  }
  _generateCustomThumbnailFilename(e3) {
    if (tt(e3)) {
      const t3 = ot(e3), r4 = t3?.mediaType, i6 = r4 && z.get(r4.toLowerCase()) || null, o6 = `thumbnail${Date.now()}`;
      return i6 ? `${o6}.${i6}` : o6;
    }
    return null;
  }
  _getAuthoringPropsState() {
    return {
      authoringApp: this.authoringApp,
      authoringAppVersion: this.authoringAppVersion,
      isAuthoringAppSetByUser: this._isAuthoringAppSetByUser,
      isAuthoringAppVersionSetByUser: this._isAuthoringAppVersionSetByUser
    };
  }
  _restoreAuthoringPropsFromState(e3) {
    e3.isAuthoringAppSetByUser ? this.authoringApp = e3.authoringApp : this._isAuthoringAppSetByUser = false, e3.isAuthoringAppVersionSetByUser ? this.authoringAppVersion = e3.authoringAppVersion : this._isAuthoringAppVersionSetByUser = false;
  }
  static fromJSON(e3) {
    const t3 = e3;
    if (!t3) throw new s("webmap:empty-resource", "Expected a JSON resource but got nothing");
    return new this({
      resourceInfo: t3
    });
  }
};
K.VERSION = M, e([y()], K.prototype, "_updateFromPromise", void 0), e([y({
  type: c8,
  json: {
    write: true
  }
})], K.prototype, "applicationProperties", void 0), e([y({
  type: String,
  json: {
    write: {
      allowNull: true,
      ignoreOrigin: true
    }
  }
})], K.prototype, "authoringApp", null), e([r("authoringApp")], K.prototype, "writeAuthoringApp", null), e([y({
  type: String,
  json: {
    write: {
      allowNull: true,
      ignoreOrigin: true
    }
  }
})], K.prototype, "authoringAppVersion", null), e([r("authoringAppVersion")], K.prototype, "writeAuthoringAppVersion", null), e([y({
  type: C2,
  json: {
    write: {
      overridePolicy: (e3) => ({
        enabled: !!(e3 && e3.length > 0),
        ignoreOrigin: true
      })
    }
  }
})], K.prototype, "bookmarks", void 0), e([y({
  type: l,
  json: {
    name: "mapFloorInfo",
    write: true
  }
})], K.prototype, "floorInfo", void 0), e([y({
  type: c5,
  json: {
    write: true
  }
})], K.prototype, "geotriggersInfo", void 0), e([y({
  type: l3,
  nonNullable: true,
  json: {
    read: {
      source: ["background", "initialState.viewpoint", "mapRangeInfo", "spatialReference", "timeZone"]
    },
    write: {
      ignoreOrigin: true,
      target: {
        background: {
          type: m3
        },
        "initialState.viewpoint": {
          type: m2
        },
        mapRangeInfo: {
          type: c6
        },
        spatialReference: {
          type: f2
        },
        "timeZone:": {
          type: String
        }
      }
    }
  }
})], K.prototype, "initialViewProperties", void 0), e([o("initialViewProperties")], K.prototype, "readInitialViewProperties", null), e([r("initialViewProperties")], K.prototype, "writeInitialViewProperties", null), e([y({
  json: {
    write: true,
    name: "mapIPSInfo"
  }
})], K.prototype, "ipsInfo", void 0), e([y({
  json: {
    read: false,
    write: {
      target: "operationalLayers",
      ignoreOrigin: true
    }
  }
})], K.prototype, "layers", void 0), e([r("layers")], K.prototype, "writeLayers", null), e([y({
  type: S2
})], K.prototype, "portalItem", void 0), e([y({
  json: {
    write: true
  }
})], K.prototype, "presentation", void 0), e([y()], K.prototype, "resourceInfo", void 0), e([y({
  readOnly: true,
  type: s3,
  json: {
    read: {
      source: "version"
    },
    write: {
      allowNull: true,
      ignoreOrigin: true,
      target: "version",
      isRequired: true
    }
  }
})], K.prototype, "sourceVersion", void 0), e([o("sourceVersion")], K.prototype, "readSourceVersion", null), e([r("sourceVersion")], K.prototype, "writeSourceVersion", null), e([y({
  json: {
    read: false,
    write: {
      ignoreOrigin: true
    }
  }
})], K.prototype, "tables", void 0), e([r("tables")], K.prototype, "writeTables", null), e([y()], K.prototype, "thumbnailUrl", null), e([y()], K.prototype, "updatingFromView", null), e([y({
  type: n6,
  json: {
    write: true
  }
})], K.prototype, "widgets", void 0), e([y({
  type: G,
  json: {
    read: true,
    write: true
  }
})], K.prototype, "utilityNetworks", void 0), K = e([a2("esri.WebMap")], K);
var Q = K;
export {
  Q as default
};
//# sourceMappingURL=WebMap-2ZWMGYYQ.js.map
