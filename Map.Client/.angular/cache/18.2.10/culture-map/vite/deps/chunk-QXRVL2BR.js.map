{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/interactive/visualElements/DrapedVisualElementResources.js", "../../../../../../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElementResources.js", "../../../../../../node_modules/@arcgis/core/views/3d/interactive/visualElements/EngineVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport r from \"../../../../core/Accessor.js\";\nimport { IdentifiableMixin as s } from \"../../../../core/Identifiable.js\";\nimport { property as t } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/Logger.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as o } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { DrapeSourceType as i, DrapedRenderGroup as c } from \"../../layers/interfaces.js\";\nimport { DirtyOperation as u } from \"../../webgl-engine/lib/ModelDirtyTypes.js\";\nimport { UpdatePolicy as n } from \"../../webgl-engine/lib/UpdatePolicy.js\";\nclass d {\n  constructor(e) {\n    this._resourceFactory = e, this._resources = null, this._visible = !0, this._attached = !1, this._renderGroup = c.Outline;\n  }\n  destroy() {\n    this._destroyResources();\n  }\n  get resources() {\n    return null != this._resources ? this._resources.external : null;\n  }\n  get visible() {\n    return this._visible;\n  }\n  set visible(e) {\n    e !== this._visible && (this._visible = e, this._syncGeometriesToRenderer());\n  }\n  get attached() {\n    return this._attached;\n  }\n  set attached(e) {\n    e !== this._attached && (this._attached = e, this._createOrDestroyResources());\n  }\n  get renderGroup() {\n    return this._renderGroup;\n  }\n  set renderGroup(e) {\n    this._renderGroup = e;\n    const r = this._resources?.layerView;\n    r && (r.renderGroup = e);\n  }\n  recreate() {\n    this.attached && this._createResources();\n  }\n  recreateGeometry() {\n    this._resourceFactory.recreateGeometry ? null != this._resources && (this._ensureRenderGeometriesRemoved(), this._resourceFactory.recreateGeometry(this._resources.external), this._syncGeometriesToRenderer()) : this.recreate();\n  }\n  _createOrDestroyResources() {\n    this._attached ? null == this._resources && this._createResources() : this._destroyResources();\n  }\n  _createResources() {\n    this._destroyResources();\n    const e = this._resourceFactory.createResources(),\n      r = new a({\n        view: this._resourceFactory.view,\n        renderGroup: this._renderGroup\n      }),\n      s = this._resourceFactory.view.basemapTerrain?.overlayManager;\n    this._resources = {\n      layerView: new a({\n        view: this._resourceFactory.view,\n        renderGroup: this._renderGroup\n      }),\n      external: e,\n      geometriesAdded: !1\n    }, s && (this._resources.drapeSourceRenderer = s.registerGeometryDrapeSource(r)), this._syncGeometriesToRenderer();\n  }\n  _destroyResources() {\n    if (null == this._resources) return;\n    this._ensureRenderGeometriesRemoved();\n    const e = this._resourceFactory.view.basemapTerrain?.overlayManager;\n    e && e.unregisterDrapeSource(this._resources.layerView), this._resourceFactory.destroyResources(this._resources.external), this._resources = null;\n  }\n  _syncGeometriesToRenderer() {\n    this._visible ? this._ensureRenderGeometriesAdded() : this._ensureRenderGeometriesRemoved();\n  }\n  _ensureRenderGeometriesRemoved() {\n    if (null == this._resources?.drapeSourceRenderer) return;\n    if (!this._resources.geometriesAdded) return;\n    this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries, u.UPDATE), this._resources.geometriesAdded = !1;\n  }\n  _ensureRenderGeometriesAdded() {\n    if (null == this._resources?.drapeSourceRenderer) return;\n    if (this._resources.geometriesAdded) return;\n    this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries, u.UPDATE), this._resources.geometriesAdded = !0;\n  }\n}\nlet a = class extends s(r) {\n  constructor(e) {\n    super(e), this.drapeSourceType = i.Features, this.updatePolicy = n.SYNC, this.renderGroup = c.Outline;\n  }\n};\ne([t({\n  constructOnly: !0\n})], a.prototype, \"view\", void 0), e([t({\n  readOnly: !0\n})], a.prototype, \"drapeSourceType\", void 0), e([t()], a.prototype, \"renderGroup\", void 0), a = e([o(\"esri.views.3d.interactive.visualElements.DrapedVisualElementResources\")], a);\nexport { d as DrapedVisualElementResources };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { watch as e, initial as s } from \"../../../../core/reactiveUtils.js\";\nimport { ContentObjectType as r } from \"../../webgl-engine/lib/ContentObjectType.js\";\nimport { Object3D as t } from \"../../webgl-engine/lib/Object3D.js\";\nimport { UpdatePolicy as o } from \"../../webgl-engine/lib/UpdatePolicy.js\";\nimport { WebGLLayer as i } from \"../../webgl-engine/lib/WebGLLayer.js\";\nclass c {\n  constructor(e) {\n    this._resourceFactory = e, this._resources = null, this._visible = !0, this._attached = !1;\n  }\n  destroy() {\n    this._destroyResources();\n  }\n  get object() {\n    return null != this._resources ? this._resources.object : null;\n  }\n  get resources() {\n    return null != this._resources ? this._resources.external : null;\n  }\n  get visible() {\n    return this._visible;\n  }\n  set visible(e) {\n    e !== this._visible && (this._visible = e, this._syncVisible());\n  }\n  get attached() {\n    return this._attached;\n  }\n  set attached(e) {\n    e !== this._attached && (this._attached = e, this._createOrDestroyResources());\n  }\n  recreate() {\n    this.attached && this._createResources();\n  }\n  recreateGeometry() {\n    if (!this._resourceFactory.recreateGeometry) return void this.recreate();\n    const e = this._resourceFactory.view._stage;\n    if (null == this._resources || !e) return;\n    const s = this._resources.object;\n    this._resources.external.forEach(s => {\n      s.type !== r.Mesh && s.type !== r.Line && s.type !== r.Point || e.remove(s);\n    }), s.removeAllGeometries(), this._resourceFactory.recreateGeometry(this._resources.external, s, this._resources.layer), this._resources.external.forEach(s => {\n      s.type !== r.Mesh && s.type !== r.Line && s.type !== r.Point || e.add(s);\n    });\n  }\n  _createOrDestroyResources() {\n    this._attached ? this._resources || this._createResources() : this._destroyResources();\n  }\n  _createResources() {\n    this._destroyResources();\n    const c = this._resourceFactory,\n      a = c.view,\n      h = a._stage;\n    if (!h) return;\n    const u = new i(h, {\n        pickable: !1,\n        updatePolicy: o.SYNC\n      }),\n      l = new t({\n        castShadow: !1\n      }),\n      n = c.createResources(l, u);\n    n.forEach(e => {\n      h.add(e), e.type === r.Texture && e.load(h.renderView.renderingContext);\n    }), h.add(l), u.add(l);\n    const _ = c.cameraChanged,\n      y = _ ? e(() => a.state.camera, e => _(e), s) : null;\n    this._resources = {\n      layer: u,\n      object: l,\n      external: n,\n      cameraHandle: y\n    }, this._syncVisible();\n  }\n  _destroyResources() {\n    if (null == this._resources) return;\n    const e = this._resourceFactory.view._stage;\n    e && (e.remove(this._resources.object), this._resources.layer.destroy(), this._resources.external.forEach(s => {\n      e.remove(s), s.type === r.Texture && s.unload();\n    })), this._resources.object.dispose(), this._resources.cameraHandle?.remove(), this._resourceFactory.destroyResources(this._resources.external), this._resources = null;\n  }\n  _syncVisible() {\n    null != this._resources && (this._resources.object.visible = this._visible);\n  }\n}\nexport { c as VisualElementResources };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { DrapedVisualElementResources as e } from \"./DrapedVisualElementResources.js\";\nimport { VisualElement as s } from \"./VisualElement.js\";\nimport { VisualElementResources as r } from \"./VisualElementResources.js\";\nclass t extends s {\n  constructor(s) {\n    super(s), this._isDraped = !1, this.object3dResources = new r(this.createObject3DResourceFactory(s.view)), this.drapedResources = new e(this.createDrapedResourceFactory(s.view)), this.isDraped = s.isDraped ?? !1;\n  }\n  get isDraped() {\n    return this._isDraped;\n  }\n  set isDraped(e) {\n    e !== this._isDraped && (this._isDraped = e, this.object3dResources.attached = this.attached && !e, this.drapedResources.attached = this.attached && e);\n  }\n  get renderGroup() {\n    return this.drapedResources.renderGroup;\n  }\n  set renderGroup(e) {\n    this.drapedResources.renderGroup = e;\n  }\n  createResources() {\n    this.object3dResources.attached = !this._isDraped, this.drapedResources.attached = this._isDraped;\n  }\n  destroyResources() {\n    this.object3dResources.attached = !1, this.drapedResources.attached = !1;\n  }\n  recreate() {\n    this.object3dResources.recreate(), this.drapedResources.recreate();\n  }\n  recreateGeometry() {\n    this.object3dResources.recreateGeometry(), this.drapedResources.recreateGeometry();\n  }\n  destroy() {\n    this.object3dResources.destroy(), this.drapedResources.destroy(), super.destroy();\n  }\n  updateVisibility(e) {\n    this.object3dResources.visible = e, this.drapedResources.visible = e;\n  }\n}\nexport { t as EngineVisualElement };"],
  "mappings": "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",
  "names": ["d", "e", "a", "s", "e", "s", "c", "a", "y", "t", "s", "d", "e"]
}
