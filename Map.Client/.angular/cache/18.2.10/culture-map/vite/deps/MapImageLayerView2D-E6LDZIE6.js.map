{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport e from \"../../../core/Logger.js\";\nimport { isAbortError as i } from \"../../../core/promiseUtils.js\";\nimport { watch as r } from \"../../../core/reactiveUtils.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as a } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { GraphicsCollection as h } from \"../../../support/GraphicsCollection.js\";\nimport { BitmapContainer as o } from \"../engine/BitmapContainer.js\";\nimport { LayerView2DMixin as p } from \"./LayerView2D.js\";\nimport n from \"./graphics/GraphicsView2D.js\";\nimport g from \"./graphics/HighlightGraphicContainer.js\";\nimport l from \"./support/ExportStrategy.js\";\nimport m from \"../../layers/LayerView.js\";\nimport c from \"../../layers/MapImageLayerView.js\";\nimport d from \"../../layers/RefreshableLayerView.js\";\nimport { MapServiceLayerViewHelper as u } from \"../../layers/support/MapServiceLayerViewHelper.js\";\nimport { createQueryGeometry as f } from \"../../support/drapedUtils.js\";\nlet y = class extends c(d(p(m))) {\n  constructor() {\n    super(...arguments), this._highlightGraphics = new h(), this._updateHash = \"\";\n  }\n  fetchPopupFeaturesAtLocation(t, e) {\n    return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(t, e);\n  }\n  update(t) {\n    const r = `${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;\n    this._updateHash !== r && (this._updateHash = r, this.strategy.update(t).catch(t => {\n      i(t) || e.getLogger(this).error(t);\n    }), t.stationary && this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)), this._highlightView.processUpdate(t);\n  }\n  attach() {\n    const {\n        imageMaxWidth: t,\n        imageMaxHeight: e,\n        version: i\n      } = this.layer,\n      s = i >= 10.3,\n      a = i >= 10;\n    this._bitmapContainer = new o(), this.container.addChild(this._bitmapContainer), this._highlightView = new n({\n      view: this.view,\n      graphics: this._highlightGraphics,\n      requestUpdateCallback: () => this.requestUpdate(),\n      container: new g(this.view.featuresTilingScheme),\n      defaultPointSymbolEnabled: !1\n    }), this.container.addChild(this._highlightView.container), this._popupHighlightHelper = new u({\n      createFetchPopupFeaturesQueryGeometry: (t, e) => f(t, e, this.view),\n      highlightGraphics: this._highlightGraphics,\n      highlightGraphicUpdated: (t, e) => {\n        this._highlightView.graphicUpdateHandler({\n          graphic: t,\n          property: e\n        });\n      },\n      layerView: this,\n      updatingHandles: this._updatingHandles\n    }), this.strategy = new l({\n      container: this._bitmapContainer,\n      fetchSource: this.fetchImageBitmap.bind(this),\n      requestUpdate: this.requestUpdate.bind(this),\n      imageMaxWidth: t,\n      imageMaxHeight: e,\n      imageRotationSupported: s,\n      imageNormalizationSupported: a,\n      hidpi: !0\n    }), this.addAttachHandles(r(() => this.exportImageVersion, () => this.requestUpdate())), this.requestUpdate();\n  }\n  detach() {\n    this.strategy.destroy(), this.container.removeAllChildren(), this._bitmapContainer.removeAllChildren(), this._highlightView.destroy(), this._popupHighlightHelper.destroy();\n  }\n  viewChange() {}\n  moveEnd() {\n    this.requestUpdate();\n  }\n  supportsSpatialReference(t) {\n    return this.layer.serviceSupportsSpatialReference(t);\n  }\n  async doRefresh() {\n    this._updateHash = \"\", this.requestUpdate();\n  }\n  isUpdating() {\n    return this.strategy.updating || this.updateRequested;\n  }\n  fetchImage(t, e, i, r) {\n    return this.layer.fetchImage(t, e, i, {\n      timeExtent: this.timeExtent,\n      floors: this.floors,\n      ...r\n    });\n  }\n  fetchImageBitmap(t, e, i, r) {\n    return this.layer.fetchImageBitmap(t, e, i, {\n      timeExtent: this.timeExtent,\n      floors: this.floors,\n      ...r\n    });\n  }\n  highlight(t) {\n    return this._popupHighlightHelper.highlight(t);\n  }\n};\nt([s()], y.prototype, \"strategy\", void 0), t([s()], y.prototype, \"updating\", void 0), y = t([a(\"esri.views.2d.layers.MapImageLayerView2D\")], y);\nconst w = y;\nexport { w as default };"],
  "mappings": "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",
  "names": ["y", "i", "e", "r", "t", "a", "_"]
}
