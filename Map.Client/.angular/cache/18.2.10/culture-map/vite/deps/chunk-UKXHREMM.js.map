{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/layers/support/DefinitionExpressionSceneLayerView.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/support/TemporalSceneLayerView.js", "../../../../../../node_modules/@arcgis/core/core/maybeUpdating.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../../../chunks/tslib.es6.js\";\nimport i from \"../../../../core/Logger.js\";\nimport { property as e } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as s } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { WhereClause as o } from \"../../../../core/sql/WhereClause.js\";\nimport { findFieldsCaseInsensitive as n } from \"../i3s/I3SUtil.js\";\nconst t = t => {\n  let p = class extends t {\n    constructor() {\n      super(...arguments), this._definitionExpressionErrors = 0, this._maxDefinitionExpressionErrors = 20, this.logError = r => {\n        this._definitionExpressionErrors < this._maxDefinitionExpressionErrors && i.getLogger(this).error(\"Error while evaluating definitionExpression: \" + r), this._definitionExpressionErrors++, this._definitionExpressionErrors === this._maxDefinitionExpressionErrors && i.getLogger(this).error(\"Further errors are ignored\");\n      };\n    }\n    get parsedDefinitionExpression() {\n      if (!this.i3slayer?.definitionExpression) return null;\n      try {\n        const r = o.create(this.i3slayer.definitionExpression, this.i3slayer.fieldsIndex);\n        if (!r.isStandardized) return i.getLogger(this).error(\"definitionExpression is using non standard function\"), null;\n        const e = [],\n          s = r.fieldNames;\n        return n(s, this.i3slayer.fields, {\n          missingFields: e\n        }), e.length > 0 ? (i.getLogger(this).error(`definitionExpression references unknown fields: ${e.join(\", \")}`), null) : (this._definitionExpressionErrors = 0, r);\n      } catch (r) {\n        return i.getLogger(this).error(\"Failed to parse definitionExpression: \" + r), null;\n      }\n    }\n    get definitionExpressionFields() {\n      return this.parsedDefinitionExpression ? this.parsedDefinitionExpression.fieldNames : [];\n    }\n    _evaluateClause(r, i) {\n      try {\n        return r.testFeature(i);\n      } catch (e) {\n        return this.logError(e), !1;\n      }\n    }\n    _addDefinitionExpressionToQuery(r) {\n      if (!this.parsedDefinitionExpression) return r;\n      const i = this.i3slayer.definitionExpression,\n        e = r.clone();\n      return e.where ? e.where = `(${i}) AND (${e.where})` : e.where = i, e;\n    }\n  };\n  return r([e({\n    readOnly: !0\n  })], p.prototype, \"parsedDefinitionExpression\", null), r([e({\n    readOnly: !0\n  })], p.prototype, \"definitionExpressionFields\", null), p = r([s(\"esri.views.3d.layers.support.DefinitionExpressionSceneLayerView\")], p), p;\n};\nexport { t as DefinitionExpressionSceneLayerView };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../../chunks/tslib.es6.js\";\nimport { property as e } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/Logger.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as r } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { getTimeOperator as i } from \"../../../../layers/graphics/data/timeSupport.js\";\nimport s from \"../../../../layers/support/FeatureFilter.js\";\nimport { combineTimeExtent as n } from \"../../../../layers/support/timeSupport.js\";\nimport { filterInPlace as o, getCachedAttributeValue as l } from \"../i3s/I3SUtil.js\";\nconst u = i => {\n  let o = class extends i {\n    get timeExtent() {\n      return n(this.i3slayer, this.view?.timeExtent, this._get(\"timeExtent\"));\n    }\n    get mergedFilter() {\n      const {\n        filter: t,\n        timeExtent: e\n      } = this;\n      if (null == e) return t;\n      const r = t?.clone() ?? new s();\n      return null != e && (r.timeExtent = r.timeExtent?.intersection(e) ?? e), r;\n    }\n    getTimeFilterDependencies() {\n      const {\n        timeInfo: t\n      } = this.i3slayer;\n      if (null == t) return [];\n      const {\n        startField: e,\n        endField: r\n      } = t;\n      return [e, r];\n    }\n    addTimeFilter(t, e) {\n      if (null == e) return;\n      const {\n        timeInfo: r\n      } = this.i3slayer;\n      if (null == r) return;\n      const {\n        startField: i,\n        endField: s,\n        useTime: n\n      } = r;\n      if (!n || null == i && null == s) return;\n      const o = r.toJSON(),\n        l = e.toJSON();\n      t.push((t, e) => a(t, e, o, l));\n    }\n  };\n  return t([e({\n    readOnly: !0\n  })], o.prototype, \"timeExtent\", null), t([e()], o.prototype, \"mergedFilter\", null), o = t([r(\"esri.views.3d.layers.support.TemporalSceneLayerView\")], o), o;\n};\nfunction a(t, e, r, s) {\n  const n = e.attributeInfo?.attributeData;\n  if (null == n) return;\n  const {\n    startTimeField: l,\n    endTimeField: u\n  } = r;\n  if (!!(null != l && null == n[l] || null != u && null == n[u])) return;\n  const a = i(r, s, new m(n));\n  if (null == a) return;\n  const {\n    featureIds: p\n  } = e;\n  o(t, p, a);\n}\nclass m {\n  constructor(t) {\n    this.attributeData = t;\n  }\n  getAttribute(t, e) {\n    return l(this.attributeData[e], t);\n  }\n  getAttributeAsTimestamp(t, e) {\n    const r = this.getAttribute(t, e);\n    return \"string\" == typeof r ? new Date(r).getTime() : \"number\" == typeof r || null == r ? r : null;\n  }\n}\nexport { u as TemporalSceneLayerView };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nconst n = \"updating\";\nfunction t(n) {\n  return \"updating\" === n ? null : n;\n}\nfunction u(n) {\n  return \"updating\" === n;\n}\nexport { u as isUpdating, t as unwrapUpdating, n as updating };"],
  "mappings": "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",
  "names": ["t", "e", "i", "i", "t", "e", "n", "o", "a", "u", "n", "t", "u"]
}
