import {
  _
} from "./chunk-2ERGO64O.js";
import "./chunk-RP2GKJCD.js";
import {
  _ as _2
} from "./chunk-3HIWR7QD.js";
import "./chunk-XTCHBO6P.js";
import "./chunk-NE4OJEWH.js";
import "./chunk-JKPO26TR.js";
import {
  c as c3
} from "./chunk-D3AKDIJC.js";
import {
  e as e5
} from "./chunk-HR6RJVBL.js";
import {
  i as i3
} from "./chunk-ONOHIFCT.js";
import {
  b as b2
} from "./chunk-W6GMJ4SS.js";
import "./chunk-IIVUY2T7.js";
import {
  e as e4
} from "./chunk-HBMA4SRU.js";
import {
  a as a4
} from "./chunk-OBYSRKB3.js";
import {
  s as s4,
  t as t3
} from "./chunk-4AU62DQA.js";
import {
  o as o3
} from "./chunk-5NCKEQLF.js";
import "./chunk-SLCHZ6DD.js";
import "./chunk-IJVN5N2Q.js";
import {
  s as s3
} from "./chunk-O7ZVERIH.js";
import "./chunk-VS26W5Y5.js";
import "./chunk-LM2N2I5R.js";
import "./chunk-DM4WHMQY.js";
import {
  R
} from "./chunk-Z3GMSC63.js";
import "./chunk-F35MWZH7.js";
import "./chunk-ED7UGR2X.js";
import {
  f as f3,
  i as i2,
  s as s2,
  u as u4
} from "./chunk-YA5CTHMT.js";
import {
  d as d3
} from "./chunk-UFVMJL32.js";
import "./chunk-HOH445RO.js";
import "./chunk-DY7FJHTG.js";
import {
  y as y2
} from "./chunk-PFMGJTQM.js";
import "./chunk-DWASPXVI.js";
import {
  N
} from "./chunk-7KRERHHR.js";
import "./chunk-T4AP6CTC.js";
import "./chunk-HD65DNIO.js";
import "./chunk-4KWLMXIA.js";
import "./chunk-BIUXKPKA.js";
import "./chunk-N6TJI25E.js";
import "./chunk-634JLXD4.js";
import "./chunk-Y3EDGYWG.js";
import "./chunk-UF6JOUSJ.js";
import "./chunk-T5JGQSO3.js";
import "./chunk-CIW3KHOW.js";
import "./chunk-J55F4AC2.js";
import {
  S as S4
} from "./chunk-IQLBZKUD.js";
import {
  y as y3
} from "./chunk-7MZZCQ64.js";
import "./chunk-6A7CWJED.js";
import "./chunk-DUTZNK67.js";
import "./chunk-IN6BQCWS.js";
import "./chunk-HT2T6PUB.js";
import "./chunk-K64AAM77.js";
import "./chunk-6EUVKE22.js";
import {
  J
} from "./chunk-DTUSTSEJ.js";
import "./chunk-JCWFGRHQ.js";
import "./chunk-JILEJ6R2.js";
import "./chunk-GAW5JHG4.js";
import "./chunk-OEKKQXBD.js";
import "./chunk-S3IO7V4Q.js";
import {
  d as d2
} from "./chunk-DZALMCYL.js";
import {
  u as u3
} from "./chunk-K226GFDN.js";
import {
  o as o2
} from "./chunk-4ZZRP4MA.js";
import {
  c as c2,
  e as e3,
  u as u2
} from "./chunk-7ZJ6P7J7.js";
import "./chunk-FPFZQCEQ.js";
import {
  B,
  e2,
  r
} from "./chunk-WYMXVOAT.js";
import {
  n as n2
} from "./chunk-K7TO5IIO.js";
import "./chunk-A4VVDRCH.js";
import {
  g as g2,
  k
} from "./chunk-CQDYITZC.js";
import "./chunk-5I6J67HP.js";
import {
  l
} from "./chunk-YVULORT6.js";
import "./chunk-PB33BAI3.js";
import {
  E,
  j
} from "./chunk-CVB43GGP.js";
import "./chunk-LLDOZWVV.js";
import {
  S as S3
} from "./chunk-FYAEQPUY.js";
import {
  C,
  c
} from "./chunk-7XMEZQ34.js";
import {
  m as m2
} from "./chunk-BDM2D6IC.js";
import "./chunk-U2ZVAEKG.js";
import "./chunk-EDSMXTFO.js";
import {
  a as a3
} from "./chunk-MNLT652N.js";
import "./chunk-OGZAGPIO.js";
import "./chunk-HJJIIYFF.js";
import {
  j as j3
} from "./chunk-T6GCUITX.js";
import "./chunk-TUIGM7TV.js";
import "./chunk-IHVSZYZS.js";
import "./chunk-6CA6K3O7.js";
import {
  w
} from "./chunk-NYQ5CYNR.js";
import "./chunk-O7UDKFOW.js";
import {
  f as f2
} from "./chunk-TKPMIAIW.js";
import "./chunk-NQOJNTB3.js";
import "./chunk-MFOQYQFG.js";
import "./chunk-NKCPFCP3.js";
import "./chunk-3ZXOUEQG.js";
import "./chunk-AXVPJBVW.js";
import "./chunk-OXEPWRM7.js";
import "./chunk-POILQGXA.js";
import {
  D2 as D,
  W2 as W,
  j as j2,
  o
} from "./chunk-JJS7PR2U.js";
import "./chunk-L5YS4GSA.js";
import "./chunk-PRREDSOB.js";
import {
  i,
  n
} from "./chunk-V5C6HSAM.js";
import {
  F,
  K,
  S as S2,
  U,
  ot,
  t,
  t3 as t2
} from "./chunk-SYATLP3H.js";
import {
  f
} from "./chunk-V6AMQYXE.js";
import {
  P,
  d
} from "./chunk-6WHTZNUH.js";
import {
  V
} from "./chunk-EITGQLII.js";
import "./chunk-TIVJXVMN.js";
import "./chunk-XNUH25NY.js";
import "./chunk-WGAPNV7F.js";
import "./chunk-BXQGM56A.js";
import {
  e
} from "./chunk-4Z5SGKRM.js";
import "./chunk-YPWMP2VK.js";
import "./chunk-23E6RT3O.js";
import "./chunk-RCBGISRX.js";
import "./chunk-2P72IR2Y.js";
import {
  S
} from "./chunk-ANKOCGE2.js";
import {
  y
} from "./chunk-7CJXZOFG.js";
import "./chunk-IRGZKO7V.js";
import "./chunk-5SELS7VU.js";
import {
  a3 as a2,
  g2 as g
} from "./chunk-DDYVXG4F.js";
import "./chunk-ANP42J2U.js";
import {
  b,
  m,
  u
} from "./chunk-HJY2YILU.js";
import "./chunk-7DA6A5LD.js";
import "./chunk-2MMLMOWS.js";
import "./chunk-4323ZVPF.js";
import {
  a,
  s2 as s
} from "./chunk-WYIDUUN2.js";
import {
  O
} from "./chunk-DXLOWWK7.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-JWIQHGQB.js";

// ../../../node_modules/@arcgis/core/rest/support/fileFormat.js
var p = new n({
  PDF: "pdf",
  PNG32: "png32",
  PNG8: "png8",
  JPG: "jpg",
  GIF: "gif",
  EPS: "eps",
  SVG: "svg",
  SVGZ: "svgz"
});
var n3 = p.fromJSON.bind(p);
var g3 = p.toJSON.bind(p);

// ../../../node_modules/@arcgis/core/widgets/Print/FileLink.js
var p2 = class extends S {
  constructor(t6) {
    super(t6), this.state = "pending", this.url = "";
  }
  initialize() {
    this.addHandles(d(() => [this.extension, this.name], () => this._setFormattedFileName(), P));
  }
  _setFormattedFileName() {
    this.name && this.extension && (this.formattedName = this.count ? `${this.name}(${this.count})${this.extension}` : `${this.name}.${this.extension}`);
  }
};
e([y()], p2.prototype, "count", void 0), e([y()], p2.prototype, "error", void 0), e([y()], p2.prototype, "extension", void 0), e([y()], p2.prototype, "formattedName", void 0), e([y()], p2.prototype, "name", void 0), e([y()], p2.prototype, "state", void 0), e([y()], p2.prototype, "url", void 0), p2 = e([a2("esri.widgets.Print.FileLink")], p2);
var a5 = p2;

// ../../../node_modules/@arcgis/core/rest/geoprocessor/GPOptions.js
var c4;
var i4 = c4 = class extends S {
  constructor(e9) {
    super(e9), this.outSpatialReference = null, this.processExtent = null, this.processSpatialReference = null, this.returnColumnName = false, this.returnFeatureCollection = false, this.returnM = false, this.returnZ = false;
  }
  static from(e9) {
    return g(c4, e9);
  }
};
e([y({
  type: f2
})], i4.prototype, "outSpatialReference", void 0), e([y({
  type: w
})], i4.prototype, "processExtent", void 0), e([y({
  type: f2
})], i4.prototype, "processSpatialReference", void 0), e([y({
  nonNullable: true
})], i4.prototype, "returnColumnName", void 0), e([y({
  nonNullable: true
})], i4.prototype, "returnFeatureCollection", void 0), e([y({
  nonNullable: true
})], i4.prototype, "returnM", void 0), e([y({
  nonNullable: true
})], i4.prototype, "returnZ", void 0), i4 = c4 = e([a2("esri.rest.geoprocessor.GPOptions")], i4);
var l2 = i4;

// ../../../node_modules/@arcgis/core/layers/support/MapImage.js
var p3 = class extends f {
  constructor() {
    super(...arguments), this.extent = null, this.height = null, this.href = null, this.opacity = 1, this.rotation = 0, this.scale = null, this.visible = true, this.width = null;
  }
};
e([y({
  type: w
})], p3.prototype, "extent", void 0), e([y()], p3.prototype, "height", void 0), e([y()], p3.prototype, "href", void 0), e([y()], p3.prototype, "opacity", void 0), e([y()], p3.prototype, "rotation", void 0), e([y()], p3.prototype, "scale", void 0), e([y()], p3.prototype, "visible", void 0), e([y()], p3.prototype, "width", void 0), p3 = e([a2("esri.layers.support.MapImage")], p3);
var i5 = p3;

// ../../../node_modules/@arcgis/core/rest/support/ArealUnit.js
var c5 = class extends f {
  constructor(r4) {
    super(r4), this.area = 0, this.units = null;
  }
};
e([y({
  json: {
    write: true
  }
})], c5.prototype, "area", void 0), e([o2(t3)], c5.prototype, "units", void 0), c5 = e([a2("esri.rest.support.ArealUnit")], c5);
var i6 = c5;

// ../../../node_modules/@arcgis/core/rest/support/DataFile.js
var e6 = class extends f {
  constructor(r4) {
    super(r4), this.itemId = null, this.url = null;
  }
};
e([y({
  type: String,
  json: {
    read: {
      source: "itemID"
    },
    write: {
      target: "itemID"
    }
  }
})], e6.prototype, "itemId", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], e6.prototype, "url", void 0), e6 = e([a2("esri.rest.support.DataFile")], e6);
var p4 = e6;

// ../../../node_modules/@arcgis/core/rest/support/LinearUnit.js
var c6 = class extends f {
  constructor(o5) {
    super(o5), this.distance = 0, this.units = null;
  }
};
e([y({
  json: {
    write: true
  }
})], c6.prototype, "distance", void 0), e([o2(s4)], c6.prototype, "units", void 0), c6 = e([a2("esri.rest.support.LinearUnit")], c6);
var i7 = c6;

// ../../../node_modules/@arcgis/core/rest/support/parameterValueUtils.js
var a6 = "multi-value-";
var t4 = new n({
  GPArealUnit: "areal-unit",
  GPBoolean: "boolean",
  GPComposite: "composite",
  GPDataFile: "data-file",
  GPDate: "date",
  GPDouble: "double",
  GPFeatureRecordSetLayer: "feature-record-set-layer",
  Field: "field",
  GPLinearUnit: "linear-unit",
  GPLong: "long",
  GPRasterData: "raster-data",
  GPRasterDataLayer: "raster-data-layer",
  GPRecordSet: "record-set",
  GPString: "string",
  GPValueTable: "value-table",
  "GPMultiValue:GPArealUnit": `${a6}areal-unit`,
  "GPMultiValue:GPBoolean": `${a6}boolean`,
  "GPMultiValue:GPComposite": `${a6}composite`,
  "GPMultiValue:GPDataFile": `${a6}data-file`,
  "GPMultiValue:GPDate": `${a6}date`,
  "GPMultiValue:GPDouble": `${a6}double`,
  "GPMultiValue:GPFeatureRecordSetLayer": `${a6}feature-record-set-layer`,
  "GPMultiValue:Field": `${a6}field`,
  "GPMultiValue:GPLinearUnit": `${a6}linear-unit`,
  "GPMultiValue:GPLong": `${a6}long`,
  "GPMultiValue:GPRasterData": `${a6}raster-data`,
  "GPMultiValue:GPRasterDataLayer": `${a6}raster-data-layer`,
  "GPMultiValue:GPRecordSet": `${a6}record-set`,
  "GPMultiValue:GPString": `${a6}string`
});

// ../../../node_modules/@arcgis/core/rest/support/ParameterValue.js
var a7 = class extends f {
  constructor(r4) {
    super(r4), this.dataType = null, this.paramName = null, this.value = null;
  }
};
e([o2(t4, {
  ignoreUnknown: false
})], a7.prototype, "dataType", void 0), e([y()], a7.prototype, "paramName", void 0), e([y()], a7.prototype, "value", void 0), a7 = e([a2("esri.rest.support.ParameterValue")], a7);
var m3 = a7;

// ../../../node_modules/@arcgis/core/rest/support/RasterData.js
var e7 = class extends f {
  constructor(r4) {
    super(r4), this.format = null, this.itemId = null, this.url = null;
  }
};
e([y()], e7.prototype, "format", void 0), e([y({
  json: {
    read: {
      source: "itemID"
    },
    write: {
      target: "itemID"
    }
  }
})], e7.prototype, "itemId", void 0), e([y()], e7.prototype, "url", void 0), e7 = e([a2("esri.rest.support.RasterData")], e7);
var p5 = e7;

// ../../../node_modules/@arcgis/core/rest/geoprocessor/utils.js
function S5(r4, a11, n4, s10, i11) {
  return __async(this, null, function* () {
    const u6 = {}, m6 = {}, c8 = [];
    return d4(s10, c8, u6), R(c8).then((t6) => {
      const {
        outSpatialReference: c9,
        processExtent: p10,
        processSpatialReference: f5,
        returnColumnName: l5,
        returnFeatureCollection: y5,
        returnM: S7,
        returnZ: d7
      } = n4, {
        path: N4
      } = f3(r4);
      for (const e9 in u6) {
        const [r5, a12] = u6[e9];
        m6[e9] = t6.slice(r5, a12);
      }
      const j8 = c9 ? c9.wkid || c9 : null, g7 = f5 ? f5.wkid || f5 : null, J5 = "execute" === a11 ? {
        returnColumnName: l5 || void 0,
        returnFeatureCollection: y5 || void 0,
        returnM: S7 || void 0,
        returnZ: d7 || void 0
      } : null, O4 = R2(__spreadProps(__spreadValues(__spreadValues(__spreadValues({}, p10 ? {
        context: {
          extent: p10,
          outSR: j8,
          processSR: g7
        }
      } : {
        "env:outSR": j8,
        "env:processSR": g7
      }), s10), J5), {
        f: "json"
      }), null, m6), v = __spreadProps(__spreadValues({}, i11), {
        query: O4
      });
      return U(`${N4}/${a11}`, v);
    });
  });
}
function d4(e9, r4, t6) {
  for (const a11 in e9) {
    const n4 = e9[a11];
    if (n4 && "object" == typeof n4 && n4 instanceof d3) {
      const {
        features: e10
      } = n4;
      t6[a11] = [r4.length, r4.length + e10.length], e10.forEach((e11) => {
        r4.push(e11.geometry);
      });
    }
  }
}
function N2(e9, t6) {
  return __async(this, null, function* () {
    switch (e9) {
      case "areal-unit":
        return i6.fromJSON(t6);
      case "boolean":
      case "double":
      case "long":
      case "string":
      case "value-table":
        return t6;
      case "date":
        return new Date(t6);
      case "data-file":
        return p4.fromJSON(t6);
      case "linear-unit":
        return i7.fromJSON(t6);
      case "feature-record-set-layer":
        if ("url" in t6) return p4.fromJSON(t6);
        if ("layerDefinition" in t6) {
          const e10 = new (0, (yield import("./FeatureLayer-H4DJZSKO.js")).default)(), {
            layerDefinition: a11,
            featureSet: n4
          } = t6;
          return e10.read({
            layerDefinition: a11,
            featureSet: n4
          }, {
            origin: "portal-item"
          }), e10.spatialReference = f2.fromJSON(n4.spatialReference ?? a11.spatialReference ?? a11.extent.spatialReference), e10;
        }
        return d3.fromJSON(t6);
      case "record-set":
        return "url" in t6 ? p4.fromJSON(t6) : d3.fromJSON(t6);
      case "raster-data":
      case "raster-data-layer":
        return "mapImage" in t6 ? i5.fromJSON(t6.mapImage) : p5.fromJSON(t6);
      case "field":
        return y2.fromJSON(t6);
    }
  });
}
function j4(e9) {
  return e9.startsWith(a6);
}
function g4(e9) {
  return e9.replace(a6, "");
}
function J2(e9, r4) {
  return __async(this, null, function* () {
    const t6 = g4(e9), a11 = "composite" === t6 ? r4.map((e10) => N2(t4.fromJSON(e10.dataType), e10.value)) : r4.map((e10) => N2(t6, e10));
    return Promise.all(a11);
  });
}
function O2(e9) {
  return __async(this, null, function* () {
    const r4 = t4.fromJSON(e9.dataType), {
      paramName: t6
    } = e9, a11 = j4(r4) ? yield J2(r4, e9.value) : yield N2(r4, e9.value);
    return new m3({
      dataType: r4,
      paramName: t6,
      value: a11
    });
  });
}
function R2(e9, r4, t6) {
  for (const a11 in e9) {
    const r5 = e9[a11];
    Array.isArray(r5) ? e9[a11] = JSON.stringify(r5.map((e10) => R2({
      item: e10
    }, true).item)) : r5 instanceof Date && (e9[a11] = r5.getTime());
  }
  return s2(e9, r4, t6);
}

// ../../../node_modules/@arcgis/core/rest/geoprocessor/execute.js
function m4(m6, o5, a11, p10) {
  return __async(this, null, function* () {
    return a11 = l2.from(a11 || {}), S5(m6, "execute", a11, o5 ?? {}, p10).then((_0) => __async(this, [_0], function* ({
      data: s10
    }) {
      return {
        results: yield Promise.all(s10.results?.map(O2) ?? []),
        messages: s10.messages?.map((s11) => a4.fromJSON(s11)) ?? []
      };
    }));
  });
}

// ../../../node_modules/@arcgis/core/rest/support/JobInfo.js
var j5;
var d5 = i()({
  esriJobCancelled: "job-cancelled",
  esriJobCancelling: "job-cancelling",
  esriJobDeleted: "job-deleted",
  esriJobDeleting: "job-deleting",
  esriJobTimedOut: "job-timed-out",
  esriJobExecuting: "job-executing",
  esriJobFailed: "job-failed",
  esriJobNew: "job-new",
  esriJobSubmitted: "job-submitted",
  esriJobSucceeded: "job-succeeded",
  esriJobWaiting: "job-waiting"
}, {
  ignoreUnknown: false
});
var h = j5 = class extends f {
  constructor(e9) {
    super(e9), this.jobId = null, this.jobStatus = null, this.messages = null, this.progress = null, this.requestOptions = null, this.sourceUrl = null, this._timer = void 0;
  }
  cancelJob(e9) {
    return __async(this, null, function* () {
      const {
        jobId: s10,
        sourceUrl: o5
      } = this, {
        path: r4
      } = f3(o5), i11 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), e9), {
        query: {
          f: "json"
        }
      });
      this._clearTimer();
      const a11 = `${r4}/jobs/${s10}/cancel`, {
        data: n4
      } = yield U(a11, i11), {
        messages: c8,
        jobStatus: l5,
        progress: p10
      } = j5.fromJSON(n4);
      return this.set({
        messages: c8,
        jobStatus: l5,
        progress: p10
      }), this;
    });
  }
  destroy() {
    clearInterval(this._timer);
  }
  checkJobStatus(e9) {
    return __async(this, null, function* () {
      const {
        path: s10
      } = f3(this.sourceUrl), o5 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), e9), {
        query: {
          f: "json"
        }
      }), r4 = `${s10}/jobs/${this.jobId}`, {
        data: i11
      } = yield U(r4, o5), {
        messages: a11,
        jobStatus: n4,
        progress: c8
      } = j5.fromJSON(i11);
      return this.set({
        messages: a11,
        jobStatus: n4,
        progress: c8
      }), this;
    });
  }
  fetchResultData(e9, s10, o5) {
    return __async(this, null, function* () {
      s10 = l2.from(s10 || {});
      const {
        returnColumnName: r4,
        returnFeatureCollection: i11,
        returnM: a11,
        returnZ: n4,
        outSpatialReference: c8
      } = s10, {
        path: m6
      } = f3(this.sourceUrl), j8 = R2({
        returnColumnName: r4 || null,
        returnFeatureCollection: i11 || null,
        returnM: a11 || null,
        returnZ: n4 || null,
        outSR: c8,
        returnType: "data",
        f: "json"
      }, null), d7 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), o5), {
        query: j8
      }), h2 = `${m6}/jobs/${this.jobId}/results/${e9}`, {
        data: g7
      } = yield U(h2, d7);
      return O2(g7);
    });
  }
  fetchResultImage(e9, s10, o5) {
    return __async(this, null, function* () {
      const {
        path: r4
      } = f3(this.sourceUrl), i11 = __spreadProps(__spreadValues({}, s10.toJSON()), {
        f: "json"
      }), a11 = R2(i11), n4 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), o5), {
        query: a11
      }), c8 = `${r4}/jobs/${this.jobId}/results/${e9}`, {
        data: l5
      } = yield U(c8, n4);
      return O2(l5);
    });
  }
  fetchResultMapImageLayer() {
    return __async(this, null, function* () {
      const {
        path: e9
      } = f3(this.sourceUrl), t6 = e9.indexOf("/GPServer/"), s10 = `${e9.substring(0, t6)}/MapServer/jobs/${this.jobId}`;
      return new (0, (yield import("./MapImageLayer-4C66JOPL.js")).default)({
        url: s10
      });
    });
  }
  waitForJobCompletion() {
    return __async(this, arguments, function* (e9 = {}) {
      const {
        interval: t6 = 1e3,
        signal: s10,
        statusCallback: o5
      } = e9;
      return new Promise((e10, a11) => {
        m(s10, () => {
          this._clearTimer(), a11(u());
        }), this._clearTimer();
        const n4 = setInterval(() => {
          this._timer || a11(u()), this.checkJobStatus(this.requestOptions).then((t7) => {
            const {
              jobStatus: s11
            } = t7;
            switch (this.jobStatus = s11, s11) {
              case "job-succeeded":
                this._clearTimer(), e10(this);
                break;
              case "job-submitted":
              case "job-executing":
              case "job-waiting":
              case "job-new":
                o5 && o5(this);
                break;
              case "job-cancelled":
              case "job-cancelling":
              case "job-deleted":
              case "job-deleting":
              case "job-timed-out":
              case "job-failed":
                this._clearTimer(), a11(this);
            }
          });
        }, t6);
        this._timer = n4;
      });
    });
  }
  _clearTimer() {
    clearInterval(this._timer), this._timer = void 0;
  }
};
e([y()], h.prototype, "jobId", void 0), e([o2(d5, {
  ignoreUnknown: false
})], h.prototype, "jobStatus", void 0), e([y({
  type: [a4]
})], h.prototype, "messages", void 0), e([y()], h.prototype, "progress", void 0), e([y()], h.prototype, "requestOptions", void 0), e([y({
  json: {
    write: true
  }
})], h.prototype, "sourceUrl", void 0), h = j5 = e([a2("esri.rest.support.JobInfo")], h);
var g5 = h;

// ../../../node_modules/@arcgis/core/rest/geoprocessor/submitJob.js
function s5(s10, m6, n4, f5) {
  return __async(this, null, function* () {
    return n4 = l2.from(n4 || {}), S5(s10, "submitJob", n4, m6 ?? {}, f5).then(({
      data: o5
    }) => {
      const r4 = g5.fromJSON(o5);
      return r4.sourceUrl = s10, r4;
    });
  });
}

// ../../../node_modules/@arcgis/core/rest/support/layoutTemplate.js
var t5 = new n({
  MAP_ONLY: "map-only",
  "A3 Landscape": "a3-landscape",
  "A3 Portrait": "a3-portrait",
  "A4 Landscape": "a4-landscape",
  "A4 Portrait": "a4-portrait",
  "Letter ANSI A Landscape": "letter-ansi-a-landscape",
  "Letter ANSI A Portrait": "letter-ansi-a-portrait",
  "Tabloid ANSI B Landscape": "tabloid-ansi-b-landscape",
  "Tabloid ANSI B Portrait": "tabloid-ansi-b-portrait"
});
var r2 = t5.fromJSON.bind(t5);
var o4 = t5.toJSON.bind(t5);

// ../../../node_modules/@arcgis/core/rest/support/printTaskUtils.js
function i8() {
  return {
    layerDefinition: {
      name: "multipointLayer",
      geometryType: "esriGeometryMultipoint",
      drawingInfo: {
        renderer: null
      }
    },
    featureSet: {
      geometryType: "esriGeometryMultipoint",
      features: []
    }
  };
}
function l3() {
  return {
    layerDefinition: {
      name: "polygonLayer",
      geometryType: "esriGeometryPolygon",
      drawingInfo: {
        renderer: null
      }
    },
    featureSet: {
      geometryType: "esriGeometryPolygon",
      features: []
    }
  };
}
function f4() {
  return {
    layerDefinition: {
      name: "pointLayer",
      geometryType: "esriGeometryPoint",
      drawingInfo: {
        renderer: null
      }
    },
    featureSet: {
      geometryType: "esriGeometryPoint",
      features: []
    }
  };
}
function a8() {
  return {
    layerDefinition: {
      name: "polylineLayer",
      geometryType: "esriGeometryPolyline",
      drawingInfo: {
        renderer: null
      }
    },
    featureSet: {
      geometryType: "esriGeometryPolyline",
      features: []
    }
  };
}
function y4(e9, r4 = 15) {
  const n4 = e9.canvas.width, t6 = e9.canvas.height, o5 = e9.getImageData(0, 0, n4, t6).data;
  let i11, l5, f5, a11, y5, u6;
  e: for (l5 = t6; l5--; ) for (i11 = n4; i11--; ) if (o5[4 * (n4 * l5 + i11) + 3] > r4) {
    u6 = l5;
    break e;
  }
  if (!u6) return null;
  e: for (i11 = n4; i11--; ) for (l5 = u6 + 1; l5--; ) if (o5[4 * (n4 * l5 + i11) + 3] > r4) {
    y5 = i11;
    break e;
  }
  e: for (i11 = 0; i11 <= y5; ++i11) for (l5 = u6 + 1; l5--; ) if (o5[4 * (n4 * l5 + i11) + 3] > r4) {
    f5 = i11;
    break e;
  }
  e: for (l5 = 0; l5 <= u6; ++l5) for (i11 = f5; i11 <= y5; ++i11) if (o5[4 * (n4 * l5 + i11) + 3] > r4) {
    a11 = l5;
    break e;
  }
  return {
    x: f5,
    y: a11,
    width: y5 - f5,
    height: u6 - a11
  };
}
function u5(o5, i11) {
  const l5 = i11.color?.clone() ?? new u3([0, 255, 255]), f5 = i11.haloColor?.clone() ?? l5.clone();
  switch (o5) {
    case "envelope":
    case "polygon":
      return l5.a *= i11.fillOpacity ?? 0.25, new S4({
        color: l5,
        outline: new d2({
          color: f5
        }),
        style: "solid"
      });
    case "polyline":
      return new d2({
        color: f5
      });
    default:
      return f5.a = 1, new y3({
        color: f5,
        outline: null
      });
  }
}
function s6(e9, r4) {
  const n4 = e9.allLayerViews.items;
  if (r4 === e9.scale) return n4.filter((e10) => !e10.suspended);
  const t6 = new Array();
  for (const i11 of n4) {
    const e10 = i11.parent;
    e10 && e10 !== i11.view && (g6(e10) || d6(e10)) && !t6.includes(e10) || i11.visible && i11.visibleAtCurrentTimeExtent && c3(i11.layer.effectiveScaleRange, r4) && t6.push(i11);
  }
  return t6;
}
function c7(e9) {
  return "bing-maps" === e9?.type;
}
function m5(e9) {
  return e9 && "blendMode" in e9 && "effect" in e9;
}
function p6(e9) {
  return "csv" === e9?.type;
}
function g6(e9) {
  return "catalog" === e9.layer.type;
}
function d6(e9) {
  return "group" === e9.layer.type;
}
function w2(e9) {
  const r4 = e9.layer;
  if (m5(r4)) {
    const n4 = r4.blendMode;
    if ((!n4 || "normal" === n4) && (r4.effect || "featureEffect" in e9 && e9.featureEffect)) return true;
  }
  return false;
}

// ../../../node_modules/@arcgis/core/rest/support/PrintTemplate.js
var p7 = class extends S {
  constructor(t6) {
    super(t6), this.attributionVisible = true, this.exportOptions = {
      width: 800,
      height: 1100,
      dpi: 96
    }, this.forceFeatureAttributes = false, this.format = "png32", this.includeCharts = false, this.includeTables = false, this.label = null, this.layout = "map-only", this.layoutItem = null, this.layoutOptions = null, this.outScale = 0, this.report = null, this.reportItem = null, this.reportOptions = null, this.scalePreserved = true, this.showLabels = true;
  }
};
e([y()], p7.prototype, "attributionVisible", void 0), e([y()], p7.prototype, "exportOptions", void 0), e([y()], p7.prototype, "forceFeatureAttributes", void 0), e([y()], p7.prototype, "format", void 0), e([y()], p7.prototype, "includeCharts", void 0), e([y()], p7.prototype, "includeTables", void 0), e([y()], p7.prototype, "label", void 0), e([y()], p7.prototype, "layout", void 0), e([y({
  type: S3
})], p7.prototype, "layoutItem", void 0), e([y()], p7.prototype, "layoutOptions", void 0), e([y()], p7.prototype, "outScale", void 0), e([y()], p7.prototype, "report", void 0), e([y({
  type: S3
})], p7.prototype, "reportItem", void 0), e([y()], p7.prototype, "reportOptions", void 0), e([y()], p7.prototype, "scalePreserved", void 0), e([y()], p7.prototype, "showLabels", void 0), p7 = e([a2("esri.rest.support.PrintTemplate")], p7);
var i9 = p7;

// ../../../node_modules/@arcgis/core/rest/support/reportTemplate.js
var e8 = new n({
  "Attribute List Letter ANSI A Landscape": "attribute-list-letter-ansi-a-landscape",
  "Attribute List Letter ANSI A Portrait": "attribute-list-letter-ansi-a-portrait",
  "Attribute List With Group Letter ANSI A Landscape": "attribute-list-with-group-letter-ansi-a-landscape",
  "Attribute List With Group Letter ANSI A Portrait": "attribute-list-with-group-letter-ansi-a-portrait",
  "Page per Feature Letter ANSI A Landscape": "page-per-feature-letter-ansi-a-landscape",
  "Page per Feature Letter ANSI A Portrait": "page-per-feature-letter-ansi-a-portrait"
});
var r3 = e8.fromJSON.bind(e8);
var a9 = e8.toJSON.bind(e8);

// ../../../node_modules/@arcgis/core/rest/print.js
var V2 = {
  Feet: "ft",
  Kilometers: "km",
  Meters: "m",
  Miles: "mi"
};
var F2 = new n({
  esriFeet: "Feet",
  esriKilometers: "Kilometers",
  esriMeters: "Meters",
  esriMiles: "Miles"
});
var N3 = new n({
  esriExecutionTypeSynchronous: "sync",
  esriExecutionTypeAsynchronous: "async"
});
var U2 = /* @__PURE__ */ new Map();
function J3(e9, t6, i11) {
  return __async(this, null, function* () {
    const a11 = yield R3(e9, i11), r4 = yield A(t6, a11);
    if ("sync" === (yield j6(e9, i11))) {
      const {
        results: t7
      } = yield m4(e9, r4, void 0, i11);
      return t7?.[0]?.value;
    }
    const n4 = yield s5(e9, r4, void 0, i11);
    yield n4.waitForJobCompletion({
      interval: t6.updateDelay
    });
    const {
      value: o5
    } = yield n4.fetchResultData("Output_File", null, i11);
    return o5;
  });
}
function R3(e9, i11) {
  return __async(this, null, function* () {
    const a11 = C2(e9), r4 = U2.get(a11) ?? {
      gpServerUrl: a11,
      legendLayerNameMap: {},
      legendLayers: []
    };
    return r4.gpMetadata ??= (yield U(a11, i2({
      f: "json"
    }, i11))).data, r4.cimVersion = r4.gpMetadata.cimVersion, U2.set(a11, r4), r4;
  });
}
function j6(e9, t6) {
  return __async(this, null, function* () {
    return me(yield R3(e9, t6));
  });
}
function k2(e9, t6) {
  return __async(this, null, function* () {
    return (yield R3(e9, t6)).gpMetadata.tasks;
  });
}
function A(t6, i11) {
  return __async(this, null, function* () {
    i11 = i11 || {
      is11xService: false,
      legendLayerNameMap: {},
      legendLayers: []
    };
    const a11 = t6.template || new i9();
    null == a11.showLabels && (a11.showLabels = true);
    const r4 = a11.exportOptions;
    let n4;
    const o5 = o4(a11.layout);
    if (r4) {
      if (n4 = {
        dpi: r4.dpi
      }, "map_only" === o5.toLowerCase() || "" === o5) {
        const e9 = r4.width, t7 = r4.height;
        n4.outputSize = null != e9 && null != t7 ? [e9, t7] : void 0;
      }
    }
    const s10 = a11.layoutOptions;
    let l5;
    if (s10) {
      let e9, t7;
      "Miles" === s10.scalebarUnit || "Kilometers" === s10.scalebarUnit ? (e9 = "Kilometers", t7 = "Miles") : "Meters" !== s10.scalebarUnit && "Feet" !== s10.scalebarUnit || (e9 = "Meters", t7 = "Feet"), l5 = {
        titleText: s10.titleText,
        authorText: s10.authorText,
        copyrightText: s10.copyrightText,
        customTextElements: s10.customTextElements,
        elementOverrides: s10.elementOverrides,
        scaleBarOptions: {
          metricUnit: F2.toJSON(e9),
          metricLabel: e9 ? V2[e9] : void 0,
          nonMetricUnit: F2.toJSON(t7),
          nonMetricLabel: t7 ? V2[t7] : void 0
        }
      };
    }
    let c8 = null;
    s10?.legendLayers && (c8 = s10.legendLayers.map((e9) => {
      const t7 = e9.layerId;
      i11.legendLayerNameMap[t7] = e9.title;
      const a12 = {
        id: t7
      };
      return e9.subLayerIds && (a12.subLayerIds = e9.subLayerIds), a12;
    }));
    const u6 = yield _3(t6, a11, i11);
    if (u6.operationalLayers) {
      const e9 = new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"), t7 = /[\u0600-\u06FF]/, i12 = (i13) => {
        const a12 = i13.text, r5 = i13.font, n5 = r5?.family?.toLowerCase();
        a12 && r5 && ("arial" === n5 || "arial unicode ms" === n5) && (r5.family = e9.test(a12) ? "Arial Unicode MS" : "Arial", "normal" !== r5.style && t7.test(a12) && (r5.family = "Arial Unicode MS"));
      };
      for (const a12 of u6.operationalLayers) if (a12.featureCollection?.layers) for (const e10 of a12.featureCollection.layers) {
        if (e10.layerDefinition?.drawingInfo?.renderer?.symbol) {
          const t8 = e10.layerDefinition.drawingInfo.renderer;
          "esriTS" === t8.symbol.type && i12(t8.symbol);
        }
        if (e10.featureSet?.features) for (const t8 of e10.featureSet.features) t8.symbol && "esriTS" === t8.symbol.type && i12(t8.symbol);
      }
    }
    t6.outSpatialReference && (u6.mapOptions.spatialReference = t6.outSpatialReference.toJSON()), Object.assign(u6, {
      exportOptions: n4,
      layoutOptions: l5 || {}
    }), Object.assign(u6.layoutOptions, {
      legendOptions: {
        operationalLayers: null != c8 ? c8 : i11.legendLayers.slice()
      }
    }), i11.legendLayers.length = 0, U2.set(i11.gpServerUrl, i11);
    const y5 = {
      Web_Map_as_JSON: JSON.stringify(u6),
      Format: g3(a11.format),
      Layout_Template: o5,
      Layout_Item_ID: void 0,
      Report_Template: a9(a11.report),
      Report_Item_ID: void 0
    };
    if (a11.layoutItem) {
      delete y5.Layout_Template;
      const t7 = a11.layoutItem;
      yield t7.load(), "public" !== t7.access && t2 && (yield t2.getCredential(i11.gpServerUrl)), y5.Layout_Item_ID = JSON.stringify({
        id: t7.id
      });
    }
    if (a11.reportItem) {
      delete y5.Report_Template;
      const t7 = a11.reportItem;
      yield t7.load(), "public" !== t7.access && t2 && (yield t2.getCredential(i11.gpServerUrl)), y5.Report_Item_ID = JSON.stringify({
        id: t7.id
      });
    }
    return t6.extraParameters && Object.assign(y5, t6.extraParameters), y5;
  });
}
function _3(e9, t6, i11) {
  return __async(this, null, function* () {
    const a11 = e9.view;
    let r4 = a11.spatialReference;
    const n4 = {
      operationalLayers: yield z(a11, t6, i11)
    };
    t6.includeTables && (n4.tables = yield re(a11));
    let o5 = e9.extent || i11.ssExtent || a11.extent;
    if (r4?.isWrappable && (o5 = o5.clone()._normalize(true), r4 = o5.spatialReference), n4.mapOptions = {
      extent: o5 && o5.toJSON(),
      spatialReference: r4 && r4.toJSON(),
      showAttribution: t6.attributionVisible
    }, i11.ssExtent = null, a11.background && (n4.background = a11.background.toJSON()), a11.rotation && (n4.mapOptions.rotation = -a11.rotation), t6.scalePreserved && (n4.mapOptions.scale = t6.outScale || a11.scale), null != a11.timeExtent) {
      const e10 = null != a11.timeExtent.start ? a11.timeExtent.start.getTime() : null, t7 = null != a11.timeExtent.end ? a11.timeExtent.end.getTime() : null;
      n4.mapOptions.time = [e10, t7];
    }
    return t6.reportOptions && (n4.reportOptions = t6.reportOptions), n4;
  });
}
function C2(e9) {
  let t6 = e9;
  const i11 = t6.lastIndexOf("/GPServer/");
  return i11 > 0 && (t6 = t6.slice(0, i11 + 9)), t6;
}
function z(e9, t6, i11) {
  return __async(this, null, function* () {
    const a11 = [], r4 = {
      layerView: null,
      printTemplate: t6,
      view: e9
    };
    let n4 = 0;
    t6.scalePreserved && (n4 = t6.outScale || e9.scale);
    const o5 = s6(e9, n4);
    for (const s10 of o5) {
      const e10 = s10.layer;
      if (!e10.loaded || "layers" in e10) continue;
      let t7;
      r4.layerView = s10, t7 = w2(s10) ? yield ie(e10, r4, i11) : c7(e10) ? $(e10) : p6(e10) ? yield K2(e10, r4, i11) : "catalog-footprint" === e10?.type ? yield q(e10, r4, i11) : "feature" === e10?.type ? yield B2(e10, r4, i11) : "geojson" === e10?.type ? yield G(e10, r4, i11) : "graphics" === e10?.type ? yield H(e10, r4, i11) : "imagery" === e10?.type ? Q(e10, i11) : "imagery-tile" === e10?.type ? yield X(e10, r4, i11) : "kml" === e10?.type ? yield Y(e10, r4, i11) : "map-image" === e10?.type ? Z(e10, r4, i11) : "map-notes" === e10?.type ? yield ee(r4, i11) : "open-street-map" === e10?.type ? te() : "stream" === e10?.type ? yield ae(e10, r4, i11) : "tile" === e10?.type ? ne(e10, i11) : "vector-tile" === e10?.type ? yield oe(e10, r4, i11) : "web-tile" === e10?.type ? se(e10) : "wms" === e10?.type ? le(e10, i11) : "wmts" === e10?.type ? ce(e10) : yield ie(e10, r4, i11), t7 && (Array.isArray(t7) ? a11.push(...t7) : (t7.id = e10.id, t7.title = i11.legendLayerNameMap[e10.id] || e10.title, t7.opacity = s10.fullOpacity, t7.minScale = e10.minScale || 0, t7.maxScale = e10.maxScale || 0, m5(e10) && e10.blendMode && "normal" !== e10.blendMode && (t7.blendMode = e10.blendMode), a11.push(t7)));
    }
    if (n4) for (const s10 of a11) s10.minScale = 0, s10.maxScale = 0;
    if (e9.graphics?.length) {
      const r5 = yield W2(null, e9.graphics, t6, i11);
      r5 && a11.push(r5);
    }
    return a11;
  });
}
function $(e9) {
  return {
    culture: e9.culture,
    key: e9.key,
    type: "BingMaps" + ("aerial" === e9.style ? "Aerial" : "hybrid" === e9.style ? "Hybrid" : "Road")
  };
}
function q(_0, _1, _22) {
  return __async(this, arguments, function* (e9, {
    layerView: t6,
    printTemplate: i11
  }, a11) {
    if (parseFloat(a11.cimVersion) < 3.1) {
      return W2(e9, yield fe(t6), i11, a11);
    }
    const r4 = e9.parent, n4 = {
      id: (o5 = de(r4, "web-map")).id,
      url: o5.url,
      layerType: o5.layerType,
      customParameters: o5.customParameters,
      dynamicGroupLayer: {
        visibility: false
      },
      footprintLayer: o5.footprintLayer,
      layerDefinition: o5.layerDefinition
    };
    var o5;
    return ue(n4, r4), n4;
  });
}
function K2(e9, t6, i11) {
  return __async(this, null, function* () {
    e9.legendEnabled && i11.legendLayers.push({
      id: e9.id
    });
    const a11 = t6.layerView, r4 = t6.printTemplate;
    if (!(a11.filter || e9.portalItem && "public" !== e9.portalItem.access)) {
      const t7 = de(e9, "web-map");
      return t7.type = "CSV", delete t7.popupInfo, delete t7.layerType, t7.showLabels = r4.showLabels && e9.labelsVisible, t7;
    }
    return W2(e9, yield fe(a11), r4, i11);
  });
}
function W2(e9, t6, i11, a11) {
  return __async(this, null, function* () {
    let r4;
    const n4 = l3(), o5 = a8(), s10 = f4(), u6 = i8(), y5 = f4();
    if (y5.layerDefinition.name = "textLayer", delete y5.layerDefinition.drawingInfo, e9) {
      if ("esri.layers.FeatureLayer" === e9.declaredClass || "esri.layers.StreamLayer" === e9.declaredClass ? n4.layerDefinition.name = o5.layerDefinition.name = s10.layerDefinition.name = u6.layerDefinition.name = a11.legendLayerNameMap[e9.id] || e9.get("arcgisProps.title") || e9.title : "esri.layers.GraphicsLayer" === e9.declaredClass && (t6 = e9.graphics.items), e9.renderer) {
        const t7 = e9.renderer.toJSON(), i12 = n4.layerDefinition.drawingInfo;
        i12 && (i12.renderer = t7);
        const a12 = o5.layerDefinition.drawingInfo;
        a12 && (a12.renderer = t7);
        const r5 = s10.layerDefinition.drawingInfo;
        r5 && (r5.renderer = t7);
        const l5 = u6.layerDefinition.drawingInfo;
        l5 && (l5.renderer = t7);
      }
      if (i11.showLabels && e9.labelsVisible && "function" == typeof e9.write) {
        const t7 = de(e9, "web-map"), i12 = t7.layerDefinition?.drawingInfo?.labelingInfo;
        if (i12) {
          r4 = true;
          const e10 = n4.layerDefinition.drawingInfo;
          e10 && (e10.labelingInfo = i12);
          const t8 = o5.layerDefinition.drawingInfo;
          t8 && (t8.labelingInfo = i12);
          const a12 = s10.layerDefinition.drawingInfo;
          a12 && (a12.labelingInfo = i12);
          const l5 = u6.layerDefinition.drawingInfo;
          l5 && (l5.labelingInfo = i12);
        }
      }
    }
    let p10;
    e9?.renderer || r4 || (delete n4.layerDefinition.drawingInfo, delete o5.layerDefinition.drawingInfo, delete s10.layerDefinition.drawingInfo, delete u6.layerDefinition.drawingInfo);
    const f5 = e9?.fieldsIndex, d7 = e9?.renderer;
    if (f5) {
      const t7 = /* @__PURE__ */ new Set();
      r4 && (yield J(t7, e9)), d7 && "function" == typeof d7.collectRequiredFields && (yield d7.collectRequiredFields(t7, f5)), p10 = Array.from(t7);
      const i12 = f5.fields.map((e10) => e10.toJSON());
      n4.layerDefinition.fields = i12, o5.layerDefinition.fields = i12, s10.layerDefinition.fields = i12, u6.layerDefinition.fields = i12;
    }
    const m6 = t6?.length;
    let g7;
    for (let c8 = 0; c8 < m6; c8++) {
      const e10 = t6[c8] || t6.at(c8);
      if (false !== e10.visible && e10.geometry) {
        if (g7 = e10.toJSON(), g7.hasOwnProperty("popupTemplate") && delete g7.popupTemplate, g7.geometry?.z && delete g7.geometry.z, g7.symbol && (g7.symbol.angle || delete g7.symbol.angle, ge(g7.symbol) ? g7.symbol = yield ye(g7.symbol, a11) : g7.symbol.text && delete g7.attributes), (!i11 || !i11.forceFeatureAttributes) && p10?.length) {
          const e11 = {};
          for (const t7 of p10) g7.attributes?.hasOwnProperty(t7) && (e11[t7] = g7.attributes[t7]);
          g7.attributes = e11;
        }
        "polygon" === e10.geometry.type ? n4.featureSet.features.push(g7) : "polyline" === e10.geometry.type ? o5.featureSet.features.push(g7) : "point" === e10.geometry.type ? g7.symbol?.text ? y5.featureSet.features.push(g7) : s10.featureSet.features.push(g7) : "multipoint" === e10.geometry.type ? u6.featureSet.features.push(g7) : "extent" === e10.geometry.type && (g7.geometry = j3.fromExtent(e10.geometry).toJSON(), n4.featureSet.features.push(g7));
      }
    }
    const h2 = [n4, o5, u6, s10, y5].filter((e10) => e10.featureSet.features.length > 0);
    for (const l5 of h2) {
      const e10 = l5.featureSet.features.every((e11) => e11.symbol);
      if (e10 && (!i11 || !i11.forceFeatureAttributes)) for (const t7 of l5.featureSet.features) delete t7.attributes;
      e10 && delete l5.layerDefinition.drawingInfo, l5.layerDefinition.drawingInfo?.renderer && (yield pe(l5.layerDefinition.drawingInfo.renderer, a11));
    }
    return h2.length ? {
      featureCollection: {
        layers: h2
      },
      showLabels: r4
    } : null;
  });
}
function B2(e9, t6, i11) {
  return __async(this, null, function* () {
    let a11;
    const r4 = e9.renderer, n4 = parseFloat(i11.cimVersion);
    if ("binning" === e9.featureReduction?.type || "cluster" === e9.featureReduction?.type && n4 < 2.9 || "pie-chart" === r4?.type || "dot-density" === r4?.type && n4 < 2.6) return ie(e9, t6, i11);
    e9.legendEnabled && i11.legendLayers.push({
      id: e9.id
    });
    const o5 = t6.layerView, {
      printTemplate: s10,
      view: l5
    } = t6, c8 = "feature-layer" !== e9.source?.type && "ogc-feature" !== e9.source?.type;
    if (o5.filter || c8 || !r4 || "field" in r4 && null != r4.field && !e9.getField(r4.field)) {
      const t7 = yield fe(o5);
      a11 = yield W2(e9, t7, s10, i11);
    } else {
      if (a11 = {
        id: (p10 = de(e9)).id,
        title: p10.title,
        url: p10.url,
        layerType: p10.layerType,
        customParameters: p10.customParameters,
        layerDefinition: p10.layerDefinition,
        charts: s10.includeCharts ? p10.charts : void 0
      }, a11.showLabels = s10.showLabels && e9.labelsVisible, ue(a11, e9), a11.layerDefinition?.drawingInfo?.renderer && (delete a11.layerDefinition.minScale, delete a11.layerDefinition.maxScale, yield pe(a11.layerDefinition.drawingInfo.renderer, i11), "visualVariables" in r4 && r4.visualVariables && r4.visualVariables[0])) {
        const e10 = r4.visualVariables[0];
        if ("size" === e10.type && e10.maxSize && "number" != typeof e10.maxSize && e10.minSize && "number" != typeof e10.minSize) {
          const t8 = N(e10, l5.scale);
          a11.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize = t8.minSize, a11.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize = t8.maxSize;
        }
      }
      const t7 = o3(o5);
      if (t7 && (a11.layerDefinition ??= {}, a11.layerDefinition.definitionExpression = a11.layerDefinition.definitionExpression ? `(${a11.layerDefinition.definitionExpression}) AND (${t7})` : t7), e9.gdbVersion && (a11.layerDefinition ??= {}, a11.layerDefinition.gdbVersion = e9.gdbVersion), o5.hasHighlight?.() && "getHighlightIds" in o5) {
        const t8 = o5;
        a11.selectionObjectIds = t8.getHighlightIds(), a11.selectionSymbol = u5(e9.geometryType, t8.highlightOptions ?? l5.highlightOptions);
      }
    }
    var p10;
    return a11;
  });
}
function G(e9, t6, i11) {
  return __async(this, null, function* () {
    if ("binning" === e9.featureReduction?.type || "cluster" === e9.featureReduction?.type) return ie(e9, t6, i11);
    e9.legendEnabled && i11.legendLayers.push({
      id: e9.id
    });
    return W2(e9, yield fe(t6.layerView), t6.printTemplate, i11);
  });
}
function H(_0, _1, _22) {
  return __async(this, arguments, function* (e9, {
    printTemplate: t6
  }, i11) {
    return W2(e9, null, t6, i11);
  });
}
function Q(e9, t6) {
  e9.legendEnabled && t6.legendLayers.push({
    id: e9.id
  });
  const i11 = {
    layerType: (a11 = de(e9)).layerType,
    customParameters: a11.customParameters
  };
  var a11;
  return i11.bandIds = e9.bandIds, i11.compressionQuality = e9.compressionQuality, i11.format = e9.format, i11.interpolation = e9.interpolation, (e9.mosaicRule || e9.definitionExpression) && (i11.mosaicRule = e9.exportImageServiceParameters.mosaicRule.toJSON()), e9.rasterFunction && (i11.renderingRule = e9.rasterFunction.toJSON()), e9.renderer && (i11.layerDefinition ??= {}, i11.layerDefinition.drawingInfo ??= {}, i11.layerDefinition.drawingInfo.renderer = e9.renderer.toJSON()), ue(i11, e9), i11;
}
function X(e9, t6, i11) {
  return __async(this, null, function* () {
    if ("flow" === e9.renderer?.type) return ie(e9, t6, i11);
    e9.legendEnabled && i11.legendLayers.push({
      id: e9.id
    });
    const a11 = {
      bandIds: (r4 = de(e9)).bandIds,
      customParameters: r4.customParameters,
      interpolation: r4.interpolation,
      layerDefinition: r4.layerDefinition
    };
    var r4;
    return a11.layerType = "ArcGISImageServiceLayer", ue(a11, e9), a11;
  });
}
function Y(e9, t6, i11) {
  return __async(this, null, function* () {
    const a11 = t6.printTemplate;
    if (!e9.portalItem || "public" === e9.portalItem.access) {
      const t7 = de(e9, "web-map");
      return t7.type = "kml", delete t7.layerType, t7.url = K(e9.url), t7;
    }
    const r4 = [], n4 = t6.layerView;
    n4.allVisibleMapImages.forEach((t7, i12) => {
      const a12 = {
        id: `${e9.id}_image${i12}`,
        type: "image",
        title: e9.id,
        minScale: e9.minScale || 0,
        maxScale: e9.maxScale || 0,
        opacity: n4.fullOpacity,
        extent: t7.extent
      };
      "data:image/png;base64," === t7.href.substr(0, 22) ? a12.imageData = t7.href.substr(22) : a12.url = t7.href, r4.push(a12);
    });
    const s10 = [...n4.allVisiblePoints.items, ...n4.allVisiblePolylines.items, ...n4.allVisiblePolygons.items], l5 = __spreadValues({
      id: e9.id
    }, yield W2(null, s10, a11, i11));
    return r4.push(l5), r4;
  });
}
function Z(e9, {
  view: t6
}, i11) {
  let a11;
  const r4 = {
    id: e9.id,
    subLayerIds: []
  };
  let n4 = [];
  const o5 = t6.scale, s10 = (e10) => {
    const t7 = 0 === o5, i12 = 0 === e10.minScale || o5 <= e10.minScale, a12 = 0 === e10.maxScale || o5 >= e10.maxScale;
    if (e10.visible && (t7 || i12 && a12)) if (e10.sublayers) e10.sublayers.forEach(s10);
    else {
      const t8 = e10.toExportImageJSON(), i13 = {
        id: e10.id,
        name: e10.title,
        layerDefinition: {
          drawingInfo: t8.drawingInfo,
          definitionExpression: t8.definitionExpression,
          source: t8.source
        }
      };
      n4.unshift(i13), r4.subLayerIds.push(e10.id);
    }
  };
  var l5;
  return e9.sublayers && e9.sublayers.forEach(s10), n4.length && (n4 = n4.map(({
    id: e10,
    name: t7,
    layerDefinition: i12
  }) => ({
    id: e10,
    name: t7,
    layerDefinition: i12
  })), a11 = {
    layerType: (l5 = de(e9)).layerType,
    customParameters: l5.customParameters
  }, a11.layers = n4, a11.visibleLayers = e9.capabilities?.exportMap?.supportsDynamicLayers ? void 0 : r4.subLayerIds, e9.gdbVersion && (a11.gdbVersion = e9.gdbVersion), ue(a11, e9), e9.legendEnabled && i11.legendLayers.push(r4)), a11;
}
function ee(_0, _1) {
  return __async(this, arguments, function* ({
    layerView: e9,
    printTemplate: t6
  }, i11) {
    const a11 = [], r4 = e9.layer;
    if (null != r4.featureCollections) for (const n4 of r4.featureCollections) {
      const e10 = yield W2(n4, n4.source, t6, i11);
      e10 && a11.push(...e10.featureCollection.layers);
    }
    else if (null != r4.sublayers) for (const n4 of r4.sublayers) {
      const e10 = yield W2(null, n4.graphics, t6, i11);
      e10 && a11.push(...e10.featureCollection.layers);
    }
    return {
      featureCollection: {
        layers: a11
      }
    };
  });
}
function te() {
  return {
    type: "OpenStreetMap"
  };
}
function ie(_0, _1, _22) {
  return __async(this, arguments, function* (e9, {
    printTemplate: t6,
    view: i11
  }, r4) {
    const n4 = {
      type: "image"
    }, o5 = {
      format: "png",
      ignoreBackground: true,
      ignorePadding: true,
      layers: [e9]
    };
    0 !== i11.rotation && (o5.rotation = 0);
    const l5 = r4.ssExtent || i11.state.extent.clone();
    let c8 = 96, u6 = true, y5 = true;
    if (t6.exportOptions) {
      const e10 = t6.exportOptions;
      null != e10.dpi && e10.dpi > 0 && (c8 = e10.dpi), null != e10.width && e10.width > 0 && (u6 = e10.width % 2 == i11.width % 2), null != e10.height && e10.height > 0 && (y5 = e10.height % 2 == i11.height % 2);
    }
    if ("map-only" === t6.layout && t6.scalePreserved && (!t6.outScale || t6.outScale === i11.scale) && 96 === c8 && (!u6 || !y5) && i11.state.extent.equals(i11.extent) && (o5.area = {
      x: 0,
      y: 0,
      width: i11.width,
      height: i11.height
    }, u6 || (o5.area.width -= 1), y5 || (o5.area.height -= 1), !r4.ssExtent)) {
      const e10 = i11.toMap(c2(o5.area.width, o5.area.height));
      l5.ymin = e10.y, l5.xmax = e10.x, r4.ssExtent = l5;
    }
    n4.extent = l5.clone()._normalize(true).toJSON();
    const p10 = yield i11.takeScreenshot(o5);
    return n4.imageData = ot(p10.dataUrl)?.data, n4;
  });
}
function ae(_0, _1, _22) {
  return __async(this, arguments, function* (e9, {
    layerView: t6,
    printTemplate: i11
  }, a11) {
    e9.legendEnabled && a11.legendLayers.push({
      id: e9.id
    });
    return W2(e9, yield fe(t6), i11, a11);
  });
}
function re(e9) {
  return __async(this, null, function* () {
    const t6 = [], i11 = [];
    for (const r4 of e9.map.allTables) "feature" !== r4.type || r4.loaded || i11.push(r4.load());
    i11.length && (yield Promise.allSettled(i11));
    for (const r4 of e9.map.allTables) if ("feature" === r4.type && r4.loaded && r4.isTable && "feature-layer" === r4.source?.type) {
      const e10 = {
        id: (a11 = de(r4)).id,
        title: a11.title,
        customParameters: a11.customParameters,
        layerDefinition: {
          definitionExpression: a11.layerDefinition?.definitionExpression
        },
        url: a11.url
      };
      ue(e10, r4), t6.push(e10);
    }
    var a11;
    return t6.length ? t6 : void 0;
  });
}
function ne(e9, t6) {
  e9.legendEnabled && t6.legendLayers.push({
    id: e9.id
  });
  const i11 = {
    layerType: (a11 = de(e9)).layerType,
    customParameters: a11.customParameters
  };
  var a11;
  return ue(i11, e9), i11;
}
function oe(e9, t6, i11) {
  return __async(this, null, function* () {
    if (e9.serviceUrl && e9.styleUrl) {
      const t7 = u4(e9.styleUrl, e9.apiKey), a11 = u4(e9.serviceUrl, e9.apiKey);
      if (!t7 && !a11 || "2.1.0" !== i11.cimVersion) {
        const i12 = {
          type: "VectorTileLayer"
        };
        return i12.styleUrl = K(e9.styleUrl), i12.token = t7, a11 !== t7 && (i12.additionalTokens = [{
          url: e9.serviceUrl,
          token: a11
        }]), i12;
      }
    }
    return ie(e9, t6, i11);
  });
}
function se(e9) {
  const t6 = e9.urlTemplate?.replace(/\${/g, "{"), i11 = {
    type: "WebTiledLayer",
    urlTemplate: t6,
    credits: e9.copyright
  };
  return e9.subDomains && e9.subDomains.length > 0 && (i11.subDomains = e9.subDomains), i11;
}
function le(e9, t6) {
  let i11;
  const a11 = [], r4 = (e10) => {
    e10.visible && (e10.sublayers ? e10.sublayers.forEach(r4) : e10.name && a11.unshift(e10.name));
  };
  return e9.sublayers && e9.sublayers.forEach(r4), a11.length && (e9.legendEnabled && t6.legendLayers.push({
    id: e9.id,
    subLayerIds: a11
  }), i11 = {
    type: "wms",
    customLayerParameters: e9.customLayerParameters,
    customParameters: e9.customParameters,
    transparentBackground: e9.imageTransparency,
    visibleLayers: a11,
    url: K(e9.url),
    version: e9.version
  }), i11;
}
function ce(e9) {
  const t6 = e9.activeLayer;
  return {
    type: "wmts",
    customLayerParameters: e9.customLayerParameters,
    customParameters: e9.customParameters,
    format: t6.imageFormat,
    layer: t6.id,
    style: t6.styleId,
    tileMatrixSet: t6.tileMatrixSetId,
    url: K(e9.url)
  };
}
function ue(e9, t6) {
  t6.url && (e9.url = K(e9.url || t6.url), e9.token = u4(e9.url, t6.apiKey));
}
function ye(e9, i11) {
  return __async(this, null, function* () {
    i11.canvas || (i11.canvas = document.createElement("canvas"));
    const a11 = 1024;
    i11.canvas.width = a11, i11.canvas.height = a11;
    const o5 = i11.canvas.getContext("2d");
    let s10, l5;
    if (e9.path) {
      const t6 = new Path2D(e9.path);
      t6.closePath(), o5.fillStyle = Array.isArray(e9.color) ? `rgba(${e9.color[0]},${e9.color[1]},${e9.color[2]},${e9.color[3] / 255})` : "rgb(0,0,0)", o5.fill(t6);
      const i12 = y4(o5);
      if (!i12) return null;
      o5.clearRect(0, 0, a11, a11);
      const n4 = u2(e9.size) / Math.max(i12.width, i12.height);
      o5.scale(n4, n4);
      const c8 = a11 / n4, u6 = c8 / 2 - i12.width / 2 - i12.x, y5 = c8 / 2 - i12.height / 2 - i12.y;
      if (o5.translate(u6, y5), Array.isArray(e9.color) && o5.fill(t6), e9.outline?.width && Array.isArray(e9.outline.color)) {
        const a12 = e9.outline;
        o5.lineWidth = u2(a12.width) / n4, o5.lineJoin = "round", o5.strokeStyle = `rgba(${a12.color[0]},${a12.color[1]},${a12.color[2]},${a12.color[3] / 255})`, o5.stroke(t6), i12.width += o5.lineWidth, i12.height += o5.lineWidth;
      }
      i12.width *= n4, i12.height *= n4;
      const p10 = o5.getImageData(a11 / 2 - i12.width / 2, a11 / 2 - i12.height / 2, Math.ceil(i12.width), Math.ceil(i12.height));
      s10 = p10.width, l5 = p10.height, o5.canvas.width = s10, o5.canvas.height = l5, o5.putImageData(p10, 0, 0);
    } else {
      const i12 = "image/svg+xml" === e9.contentType ? "data:image/svg+xml;base64," + e9.imageData : e9.url, a12 = (yield U(i12, {
        responseType: "image"
      })).data;
      s10 = u2(e9.width), l5 = u2(e9.height), o5.canvas.width = s10, o5.canvas.height = l5, o5.drawImage(a12, 0, 0, o5.canvas.width, o5.canvas.height);
    }
    return {
      type: "esriPMS",
      imageData: o5.canvas.toDataURL("image/png").substr(22),
      angle: e9.angle,
      contentType: "image/png",
      height: e3(l5),
      width: e3(s10),
      xoffset: e9.xoffset,
      yoffset: e9.yoffset
    };
  });
}
function pe(e9, t6) {
  return __async(this, null, function* () {
    const i11 = e9.type;
    if ("simple" === i11 && ge(e9.symbol)) e9.symbol = yield ye(e9.symbol, t6);
    else if ("uniqueValue" === i11 || "classBreaks" === i11) {
      ge(e9.defaultSymbol) && (e9.defaultSymbol = yield ye(e9.defaultSymbol, t6));
      const a11 = e9["uniqueValue" === i11 ? "uniqueValueInfos" : "classBreakInfos"];
      if (a11) for (const e10 of a11) ge(e10.symbol) && (e10.symbol = yield ye(e10.symbol, t6));
    }
  });
}
function fe(e9) {
  return __async(this, null, function* () {
    return e9.queryFeatures(e9.createQuery()).then((e10) => e10.features);
  });
}
function de(e9, t6) {
  return e9.write({}, {
    ignorePersistenceEnabled: true,
    origin: t6
  }) ?? {};
}
function me(e9) {
  return e9.gpMetadata?.executionType ? N3.fromJSON(e9.gpMetadata.executionType) : "sync";
}
function ge(e9) {
  return e9 && (e9.path || "image/svg+xml" === e9.contentType || e9.url?.endsWith(".svg"));
}

// ../../../node_modules/@arcgis/core/rest/support/PrintParameters.js
var s7 = class extends S {
  constructor(t6) {
    super(t6), this.extent = null, this.extraParameters = null, this.outSpatialReference = null, this.template = null, this.updateDelay = 1e3, this.view = null;
  }
};
e([y()], s7.prototype, "extent", void 0), e([y()], s7.prototype, "extraParameters", void 0), e([y()], s7.prototype, "outSpatialReference", void 0), e([y()], s7.prototype, "template", void 0), e([y()], s7.prototype, "updateDelay", void 0), e([y()], s7.prototype, "view", void 0), s7 = e([a2("esri.rest.support.PrintParameters")], s7);
var p8 = s7;

// ../../../node_modules/@arcgis/core/views/overlay/BoxOverlayItem.js
var s8 = class extends S {
  constructor(o5) {
    super(o5), this.strokeDash = [], this.strokeWidth = 2, this.strokeColor = [0, 0, 0, 1], this.strokeBackgroundColor = [0, 0, 0, 0], this.fillColor = [0, 0, 0, 0], this.backgroundFillColor = [0, 0, 0, 0.5], this.visible = true, this.isDecoration = false, this.boxWidth = 0, this.boxHeight = 0, this.backgroundWidth = 0, this.backgroundHeight = 0, this.padding = {
      left: 0,
      top: 0,
      right: 0,
      bottom: 0
    };
  }
  get _strokeStyle() {
    return `rgba(${this.strokeColor.join()})`;
  }
  get _strokeBackgroundStyle() {
    return `rgba(${this.strokeBackgroundColor.join()})`;
  }
  get _fillStyle() {
    return `rgba(${this.fillColor.join()})`;
  }
  get _backgroundFillStyle() {
    return `rgba(${this.backgroundFillColor.join()})`;
  }
  render() {
    const {
      backgroundWidth: o5,
      backgroundHeight: t6,
      boxWidth: r4,
      boxHeight: i11,
      padding: s10
    } = this, l5 = s10.left, d7 = s10.top, p10 = this.x ?? l5 + o5 / 2 - r4 / 2, h2 = this.y ?? d7 + t6 / 2 - i11 / 2, a11 = p10 + r4, n4 = h2 + i11;
    return n2("div", {
      classes: {
        "esri-box-overlay-item": true
      },
      styles: {
        left: "0px",
        top: "0px",
        width: "100%",
        height: "100%",
        visibility: this.visible ? "visible" : "hidden"
      }
    }, n2("svg", {
      styles: {
        width: "100%",
        height: "100%"
      }
    }, n2("path", {
      d: `M ${l5} ${d7} L ${o5 + l5} ${d7} L ${o5 + l5} ${t6 + d7} L ${l5} ${t6 + d7} Z M ${p10} ${h2} L ${p10} ${n4} L ${a11} ${n4} L ${a11} ${h2} Z`,
      fill: this._backgroundFillStyle,
      stroke: this._strokeBackgroundStyle,
      "stroke-width": this.strokeWidth
    }), n2("rect", {
      fill: this._fillStyle,
      height: i11,
      stroke: this._strokeStyle,
      "stroke-dasharray": this.strokeDash.join(" ") || void 0,
      "stroke-width": this.strokeWidth,
      width: r4,
      x: p10,
      y: h2
    })));
  }
  renderCanvas() {
  }
};
e([y()], s8.prototype, "strokeDash", void 0), e([y()], s8.prototype, "strokeWidth", void 0), e([y()], s8.prototype, "strokeColor", void 0), e([y()], s8.prototype, "strokeBackgroundColor", void 0), e([y()], s8.prototype, "fillColor", void 0), e([y()], s8.prototype, "backgroundFillColor", void 0), e([y()], s8.prototype, "visible", void 0), e([y()], s8.prototype, "isDecoration", void 0), e([y()], s8.prototype, "boxWidth", void 0), e([y()], s8.prototype, "boxHeight", void 0), e([y()], s8.prototype, "backgroundWidth", void 0), e([y()], s8.prototype, "backgroundHeight", void 0), e([y()], s8.prototype, "x", void 0), e([y()], s8.prototype, "y", void 0), e([y()], s8.prototype, "padding", void 0), e([y({
  readOnly: true
})], s8.prototype, "_strokeStyle", null), e([y({
  readOnly: true
})], s8.prototype, "_strokeBackgroundStyle", null), e([y({
  readOnly: true
})], s8.prototype, "_fillStyle", null), e([y({
  readOnly: true
})], s8.prototype, "_backgroundFillStyle", null), s8 = e([a2("esri.views.overlay.BoxOverlayItem")], s8);
var l4 = s8;

// ../../../node_modules/@arcgis/core/widgets/Print/CustomTemplate.js
var i10 = class extends f {
  constructor(o5) {
    super(o5), this.description = null, this.format = null, this.label = null, this.layout = null, this.layoutItem = null, this.layoutOptions = null, this.layoutTemplateInfo = null;
  }
};
e([y()], i10.prototype, "description", void 0), e([y({
  json: {
    read: n3
  }
})], i10.prototype, "format", void 0), e([y()], i10.prototype, "label", void 0), e([y({
  json: {
    read: r2
  }
})], i10.prototype, "layout", void 0), e([y({
  type: S3
})], i10.prototype, "layoutItem", void 0), e([y()], i10.prototype, "layoutOptions", void 0), e([y()], i10.prototype, "layoutTemplateInfo", void 0), i10 = e([a2("esri.widgets.Print.CustomTemplate")], i10);
var a10 = i10;

// ../../../node_modules/@arcgis/core/widgets/Print/TemplateOptions.js
var s9 = class extends S {
  constructor(t6) {
    super(t6), this.attributionEnabled = true, this.author = null, this.copyright = null, this.customTextElements = null, this.dpi = 96, this.fileName = null, this.forceFeatureAttributes = false, this.format = "pdf", this.height = null, this.includeTables = true, this.layout = "letter-ansi-a-landscape", this.layoutItem = null, this.legendEnabled = true, this.northArrowEnabled = false, this.scale = null, this.scaleEnabled = false, this.title = null, this.width = null;
  }
};
e([y()], s9.prototype, "attributionEnabled", void 0), e([y()], s9.prototype, "author", void 0), e([y()], s9.prototype, "copyright", void 0), e([y()], s9.prototype, "customTextElements", void 0), e([y()], s9.prototype, "dpi", void 0), e([y()], s9.prototype, "fileName", void 0), e([y()], s9.prototype, "forceFeatureAttributes", void 0), e([y()], s9.prototype, "format", void 0), e([y()], s9.prototype, "height", void 0), e([y()], s9.prototype, "includeTables", void 0), e([y()], s9.prototype, "layout", void 0), e([y({
  type: S3
})], s9.prototype, "layoutItem", void 0), e([y()], s9.prototype, "legendEnabled", void 0), e([y()], s9.prototype, "northArrowEnabled", void 0), e([y()], s9.prototype, "scale", void 0), e([y()], s9.prototype, "scaleEnabled", void 0), e([y()], s9.prototype, "title", void 0), e([y()], s9.prototype, "width", void 0), s9 = e([a2("esri.widgets.Print.TemplateOptions")], s9);
var p9 = s9;

// ../../../node_modules/@arcgis/core/widgets/Print/PrintViewModel.js
var z2 = /* @__PURE__ */ new Set(["GISProfessionalStdUT", "GISProfessionalAdvUT"]);
var V3 = /(\/GPServer\/).+/i;
var q2 = new n({
  inch: "inches",
  foot: "feet",
  yard: "yards",
  mile: "miles",
  "nautical-mile": "nautical-miles",
  millimeter: "millimeters",
  centimeter: "centimeters",
  decimeter: "decimeters",
  meter: "meters",
  kilometer: "kilometers"
});
var G2 = V.ofType(a10);
function R4(t6) {
  t6.layoutOptions ??= {}, t6.layoutOptions.customTextElements ??= [];
  const e9 = "date";
  if (!t6.layoutOptions.customTextElements.find((t7) => e9 in t7)) {
    const {
      customTextElements: e10
    } = t6.layoutOptions;
    let o5 = j(Date.now(), E("short-date"));
    "ar" === a3() && (o5 = "" + o5), e10.push({
      date: o5
    });
  }
}
var J4 = class extends m2 {
  constructor(t6) {
    super(t6), this._serviceTemplateCustomTextElements = null, this._layoutToTemplateInfo = new s3(), this._isFreeHand = false, this._freeHandWidth = 0, this._freehandHeight = 0, this._asyncPrintTaskUrl = null, this._layoutInfoTaskUrl = null, this.allowedFormats = "all", this.allowedLayouts = "all", this.browseTemplates = new G2(), this.defaultTemplates = new G2(), this.error = null, this.extraParameters = null, this.includeDefaultTemplates = true, this.portal = C.getDefault(), this.portalTemplateIds = [], this.showPrintAreaEnabled = false, this.printServiceUrl = null, this.printTimeout = 12e4, this.templatesInfo = null, this.updateDelay = 1e3, this.view = null, this.templateCustomTextElements = null, this.templateOptions = new p9();
  }
  initialize() {
    this.addHandles(d(() => this.showPrintAreaEnabled, (t6) => {
      t6 ? this._enablePrintPreview() : (this.removeHandles("overlay-handler"), this.view?.overlay?.removeItem(this._getOverlayItem()));
    }));
  }
  destroy() {
    this.removeHandles("overlay-handler"), this.view && (this._overlayItem && (this.view.overlay?.removeItem(this._overlayItem), this._overlayItem.destroy(), this._overlayItem = null), this.view = null);
  }
  get effectivePrintServiceUrl() {
    return this.printServiceUrl ?? null;
  }
  get effectiveTemplateCustomTextElements() {
    if (!this._serviceTemplateCustomTextElements) return {};
    const t6 = a(this._serviceTemplateCustomTextElements);
    return this.templateCustomTextElements && Object.keys(this.templateCustomTextElements).forEach((e9) => {
      const o5 = t6[e9];
      if (o5) {
        const t7 = this.templateCustomTextElements?.[e9];
        o5.forEach((e10) => {
          const [o6] = Object.entries(e10)[0];
          t7?.forEach((t8) => {
            const [i11, r4] = Object.entries(t8)[0];
            o6 === i11 && (e10[o6] = r4);
          });
        });
      }
    }), Object.freeze(t6);
  }
  get layoutTemplateInfo() {
    const t6 = this.templateOptions.layoutItem?.id ?? this.templateOptions.layout;
    return t6 ? this._layoutToTemplateInfo.get(t6) : null;
  }
  get state() {
    return "loading" === this.loadStatus ? "initializing" : "failed" === this.loadStatus || this.error ? "error" : "loaded" === this.loadStatus && this.view?.ready ? "ready" : "disabled";
  }
  get layoutTemplateNorthArrowInfo() {
    return this.layoutTemplateInfo?.layoutOptions?.mapSurroundInfos ? this.layoutTemplateInfo.layoutOptions.mapSurroundInfos.find((t6) => "CIMMarkerNorthArrow" === t6.type) : null;
  }
  load(t6) {
    return __async(this, null, function* () {
      return this.addResolvingPromise(this._loadResources(t6).catch((t7) => this.error = t7)), this;
    });
  }
  print(t6) {
    return __async(this, null, function* () {
      const {
        view: e9,
        extraParameters: o5,
        updateDelay: i11
      } = this;
      if (!e9) throw new s("print:view-required", "view is not set");
      R4(t6);
      const r4 = this._getOverlayItem(), a11 = t6.scalePreserved || !this.showPrintAreaEnabled ? void 0 : _2(new w(), e9.viewpoint, "MAP_ONLY" === t6.layout ? [t6.exportOptions.width, t6.exportOptions.height] : [r4.boxWidth, r4.boxHeight]), l5 = new p8({
        view: e9,
        template: t6,
        extent: a11,
        extraParameters: o5,
        updateDelay: i11
      });
      try {
        const e10 = !!t6.layoutItem?.id && (this.portalTemplateIds.includes(t6.layoutItem.id) || this.browseTemplates.some((e11) => e11.layoutItem?.id === t6.layoutItem?.id));
        return yield J3(e10 && this._asyncPrintTaskUrl ? this._asyncPrintTaskUrl : this.effectivePrintServiceUrl, l5, {
          timeout: this.printTimeout
        });
      } catch (n4) {
        throw new s("print:export-error", "An error occurred while exporting the web map.", {
          error: n4
        });
      }
    });
  }
  toPrintTemplate({
    attributionEnabled: t6,
    author: e9,
    copyright: o5,
    customTextElements: i11,
    dpi: r4,
    forceFeatureAttributes: a11,
    format: l5,
    height: n4,
    includeTables: p10,
    layout: m6,
    layoutItem: u6,
    legendEnabled: h2,
    northArrowEnabled: c8,
    scale: d7,
    scaleEnabled: y5,
    title: f5,
    width: v
  }) {
    if (!m6) throw new s("print:layout-required", "layout is not set");
    const w3 = new i9({
      attributionVisible: t6,
      forceFeatureAttributes: a11,
      format: l5,
      includeTables: p10,
      layout: m6,
      layoutItem: u6,
      layoutOptions: {
        authorText: e9 || "",
        copyrightText: o5 || "",
        customTextElements: i11,
        titleText: f5 || ""
      },
      outScale: d7 ?? 0,
      scalePreserved: y5
    });
    v && (w3.exportOptions.width = v), n4 && (w3.exportOptions.height = n4), r4 && (w3.exportOptions.dpi = r4), !h2 && w3.layoutOptions && (w3.layoutOptions.legendLayers = []);
    const T = this.layoutTemplateNorthArrowInfo;
    if (T) {
      !(T.visible === c8) && w3.layoutOptions && (w3.layoutOptions.elementOverrides = {
        [T.name]: {
          visible: c8
        }
      });
    }
    return w3;
  }
  fetchLayoutTemplateInfo(t6, e9) {
    return __async(this, null, function* () {
      if (!t6.layoutItem?.id) return;
      const o5 = yield this._fetchPortalLayoutTemplateInfo(t6.layoutItem, e9);
      this._layoutToTemplateInfo.set(t6.layoutItem.id, o5), t6.layoutTemplateInfo = o5;
      const {
        hasLegend: i11,
        mapSurroundInfos: r4,
        customTextElements: s10
      } = o5.layoutOptions, a11 = r4.some(({
        type: t7,
        visible: e10
      }) => "CIMMarkerNorthArrow" === t7 && e10);
      t6.layoutOptions = {
        legend: i11,
        northArrow: a11
      };
      const n4 = a(this._serviceTemplateCustomTextElements) ?? {};
      n4[t6.layoutItem.id] = s10, this._serviceTemplateCustomTextElements = Object.freeze(n4);
    });
  }
  getLayoutTemplateInfo(t6) {
    return this._layoutToTemplateInfo.get(t6);
  }
  addPortalTemplate(t6) {
    return __async(this, null, function* () {
      const e9 = new a10({
        label: t6.title,
        layoutItem: t6
      });
      this.browseTemplates.add(e9);
    });
  }
  removePortalTemplate(t6) {
    t6.layoutItem?.id && this.templateOptions.layoutItem?.id === t6.layoutItem.id && (this.templateOptions.layout = this.defaultTemplates.length || this.browseTemplates.length ? null : this.templatesInfo?.layout?.defaultValue, this.templateOptions.layoutItem = null), this._layoutToTemplateInfo.delete(t6.layoutItem.id), this.browseTemplates.remove(t6);
  }
  _loadResources(t6) {
    return __async(this, null, function* () {
      let e9 = [];
      if (this.printServiceUrl) this._set("effectivePrintServiceUrl", this.printServiceUrl), yield this._updateLayoutInfoTaskUrl(this.effectivePrintServiceUrl);
      else {
        if (this.destroyed) return;
        try {
          yield this.portal.load(t6);
        } catch (l5) {
          throw new s("print:could-not-load-portal", "Cannot load print resource information from portal", {
            error: l5,
            url: this.effectivePrintServiceUrl
          });
        }
        if (this.portal.helperServices) {
          const {
            asyncPrintTask: t7,
            layoutInfoTask: o6,
            printTask: i12
          } = this.portal.helperServices;
          i12 && (this._set("effectivePrintServiceUrl", i12.url), e9 = i12.templates?.map((t8) => a10.fromJSON(t8)) ?? []), this._asyncPrintTaskUrl = t7?.url, yield this._updateLayoutInfoTaskUrl(o6?.url || this.effectivePrintServiceUrl);
        }
      }
      this.defaultTemplates.addMany(e9);
      const o5 = this.effectivePrintServiceUrl?.toLowerCase().split("/");
      if (!o5?.includes("gpserver")) throw new s("print:invalid-print-service-url", "Can't fetch print templates information from provided URL", {
        url: this.effectivePrintServiceUrl
      });
      const [i11, r4, a11] = yield Promise.all([this._getPrintServiceLayouts(t6), this._getPrintServiceTemplates(t6), this._getPortalCustomTemplates(t6)]);
      if (this._processPrintServiceLayouts(i11), this._processPrintServiceTemplates(r4), this._processPortalTemplates(a11), this.templateOptions.layoutItem?.id) {
        const e10 = this.templateOptions.layoutItem.id;
        let o6 = this.defaultTemplates.find((t7) => t7.layoutItem?.id === e10);
        o6 || (o6 = new a10({
          label: this.templateOptions.layoutItem.title,
          layoutItem: this.templateOptions.layoutItem
        })), yield this.fetchLayoutTemplateInfo(o6, t6), this.templateOptions.layout = e10;
      }
      this._updateOverLayItem();
    });
  }
  _updateLayoutInfoTaskUrl(t6, e9) {
    return __async(this, null, function* () {
      if (!t6) return;
      const o5 = (yield k2(t6, e9)).find((t7) => t7.includes("Get Layout Templates Info"));
      o5 && (this._layoutInfoTaskUrl = t6.replace(V3, `$1${encodeURI(o5)}`));
    });
  }
  _getPortalCustomTemplates(t6) {
    return __async(this, null, function* () {
      if (this.printServiceUrl || !this.portal) return [];
      const {
        layoutGroupQuery: e9,
        user: o5
      } = this.portal, i11 = t.test(this.portal.url), r4 = o5?.userLicenseTypeId, s10 = r4 && z2.has(r4);
      if (!e9 || i11 && !s10) return [];
      const a11 = new c({
        query: e9,
        disableExtraQuery: true
      }), l5 = yield this.portal.queryGroups(a11, t6);
      if (!l5.total) return [];
      const n4 = l5.results[0], p10 = new c({
        num: 100,
        query: "type:Layout",
        sortField: n4.sortField,
        sortOrder: n4.sortOrder ?? void 0
      }), m6 = (yield n4.queryItems(p10, t6)).results;
      return m6.length ? m6.map((t7) => new a10({
        label: t7.title,
        layoutItem: t7
      })) : [];
    });
  }
  _fetchPortalLayoutTemplateInfo(t6, o5) {
    return __async(this, null, function* () {
      const {
        id: i11
      } = t6, r4 = this._layoutInfoTaskUrl;
      if (!r4) throw new s("print:invalid-layout-info-task-url", "Can't fetch layout template info", {
        url: r4
      });
      "public" !== t6.access && t2 && (yield t2.getCredential(r4));
      const a11 = {
        Layout_Item_ID: JSON.stringify({
          id: i11
        })
      };
      return (yield this._fetchLayoutTemplateInfos(a11, o5))[0];
    });
  }
  _fetchLayoutTemplateInfos(t6, e9) {
    return __async(this, null, function* () {
      const o5 = this._layoutInfoTaskUrl;
      if (!o5) throw new s("print:invalid-layout-info-task-url", "Can't fetch layout template info", {
        url: o5
      });
      if ("async" === (yield j6(o5))) {
        const i11 = yield s5(o5, t6, void 0, e9 || void 0);
        yield i11.waitForJobCompletion({
          interval: 1e3
        });
        return (yield i11.fetchResultData("Output_JSON")).value;
      }
      return (yield m4(o5, t6, null, e9)).results[0].value;
    });
  }
  _processPortalTemplates(t6) {
    if (t6) {
      this.defaultTemplates.addMany(t6);
      for (const e9 of t6) e9.layoutItem?.id && this.portalTemplateIds.push(e9.layoutItem.id);
    }
  }
  _processPrintServiceTemplates(t6) {
    this._set("templatesInfo", t6);
  }
  _getPrintServiceLayouts(t6) {
    return __async(this, null, function* () {
      let e9 = [];
      try {
        e9 = yield this._fetchLayoutTemplateInfos(void 0, t6);
      } catch {
      }
      return e9;
    });
  }
  _processPrintServiceLayouts(t6) {
    const e9 = {};
    for (const o5 of t6) {
      const {
        layoutTemplate: t7,
        layoutOptions: i11
      } = o5, r4 = r2(t7);
      this._layoutToTemplateInfo.set(r4, o5), e9[r4] = i11.customTextElements;
    }
    this._serviceTemplateCustomTextElements = Object.freeze(e9);
  }
  _getPrintServiceTemplates(t6) {
    return __async(this, null, function* () {
      let e9;
      try {
        ({
          data: e9
        } = yield U(this.effectivePrintServiceUrl, __spreadProps(__spreadValues({}, t6), {
          query: {
            f: "json"
          },
          timeout: this.printTimeout
        })));
      } catch (l5) {
        throw b(l5) ? l5 : new s("print:unavailable-service-info", "Can't fetch templates info from service", {
          error: l5
        });
      }
      const {
        parameters: i11
      } = e9, r4 = i11.find(({
        name: t7
      }) => "Format" === t7), a11 = i11.find(({
        name: t7
      }) => "Layout_Template" === t7);
      return {
        format: this._getFormat(r4),
        layout: this._getLayout(a11)
      };
    });
  }
  _getFormat(t6) {
    const e9 = "all" === this.allowedFormats ? t6.choiceList : t6.choiceList.filter((t7) => this.allowedFormats.includes(n3(t7))), o5 = (e9.length ? e9 : t6.choiceList).map(n3).filter(O), r4 = n3(t6.defaultValue), s10 = o5.includes(r4) ? r4 : o5[0];
    return {
      choiceList: o5,
      defaultValue: s10
    };
  }
  _getLayout(t6) {
    const e9 = t6.choiceList.filter((t7) => "map_only" !== t7.toLowerCase()), o5 = "all" === this.allowedLayouts ? e9 : e9.filter((t7) => this.allowedLayouts.includes(r2(t7))), r4 = (o5.length ? o5 : e9).map(r2).filter(O), s10 = r2(t6.defaultValue), a11 = r4.includes(s10) ? s10 : r4.find((t7) => /(?=.*letter)(?=.*landscape)/i.test(t7)) ?? r4.find((t7) => /(?=.*a4)(?=.*landscape)/i.test(t7)) ?? r4[0];
    return {
      choiceList: r4,
      defaultValue: a11
    };
  }
  _getOverlayItem() {
    return this._overlayItem || (this._overlayItem = new l4({
      strokeDash: [5],
      strokeWidth: 2,
      strokeColor: [30, 144, 255, 255]
    })), this._overlayItem;
  }
  _enablePrintPreview() {
    if (!this.view?.overlay) return;
    const t6 = this.templateOptions, e9 = this._getOverlayItem();
    this.addHandles([d(() => [t6.width, t6.height, t6.scaleEnabled, t6.scale, t6.layout, t6.layoutItem, this.view?.scale, this.view?.size, this.view?.state.paddedViewState.size, this.view?.state.padding], () => this._updateOverLayItem(), P), this.view?.on("drag", ["Shift"], (t7) => this._handleDrag(t7), _.WIDGET), this.view?.on("key-down", ["Escape"], () => this._resetDrag(), _.WIDGET)], "overlay-handler"), this.view.overlay.addItem(e9);
  }
  _updateOverLayItem() {
    if (!this.view) return;
    const t6 = this.templateOptions, e9 = this._getOverlayItem(), o5 = t6.layoutItem?.id ?? t6.layout, i11 = this.view, r4 = i11.spatialReference, [s10, a11] = i11.state.paddedViewState.size, l5 = i11.state.padding;
    let n4 = 0, p10 = 0;
    if ("MAP_ONLY" === o5) null != t6.width && null != t6.height && (n4 = t6.width, p10 = t6.height);
    else if (o5) {
      const {
        webMapFrameSize: e10,
        pageUnits: i12
      } = this._layoutToTemplateInfo.get(o5) ?? {};
      let l6 = false;
      if (e10 && i12) if (this._isFreeHand) {
        const t7 = e10[0] / e10[1];
        n4 = this._freeHandWidth, p10 = this._freehandHeight, n4 > p10 ? p10 = n4 / t7 : n4 = p10 * t7;
      } else {
        const t7 = q2.fromJSON(i12.toLowerCase()), o6 = r4.unit;
        D(t7) === D(o6) ? (n4 = j2(e10[0], t7, o6), p10 = j2(e10[1], t7, o6)) : (l6 = true, n4 = e10[0], p10 = e10[1]);
      }
      if (!this._isFreeHand) if (t6.scaleEnabled && t6.scale) {
        const e11 = l6 ? Math.min(s10 / n4, a11 / p10) : W(r4) * o * t6.dpi;
        n4 *= e11, p10 *= e11;
      } else if (0 === n4 || 0 === p10) n4 = s10, p10 = a11;
      else {
        const t7 = (s10 - 0.1 * s10) / n4, e11 = (a11 - 0.1 * a11) / p10, o6 = Math.min(t7, e11);
        n4 *= o6, p10 *= o6;
      }
    }
    const {
      scaleEnabled: m6,
      scale: u6
    } = t6, h2 = m6 && u6 ? u6 / this.view.scale : 1;
    e9.boxWidth = n4 * h2 || s10, e9.boxHeight = p10 * h2 || a11, l5 && (e9.padding = l5), e9.backgroundWidth = s10 ?? 0, e9.backgroundHeight = a11 ?? 0;
  }
  _resetDrag() {
    this._isFreeHand = false, this._updateOverLayItem();
  }
  _handleDrag(t6) {
    switch (t6.action) {
      case "start":
        this._start();
        break;
      case "update":
        this._update(t6);
        break;
      case "end":
        this._end();
    }
    t6.stopPropagation();
  }
  _start() {
    this._isFreeHand = true;
  }
  _update(t6) {
    const e9 = this._getOverlayItem(), {
      x: o5,
      y: i11
    } = t6, {
      x: r4,
      y: s10
    } = t6.origin;
    o5 > r4 ? (e9.x = r4, e9.boxWidth = o5 - r4) : (e9.x = o5, e9.boxWidth = r4 - o5), i11 > s10 ? (e9.y = s10, e9.boxHeight = i11 - s10) : (e9.y = i11, e9.boxHeight = s10 - i11);
  }
  _end() {
    const t6 = this._getOverlayItem();
    if (!this.view || null == t6.x || null == t6.y) return;
    const e9 = this.view, o5 = e9.toMap(c2(t6.x + 0.5 * t6.boxWidth, t6.y + 0.5 * t6.boxHeight));
    t6.x = null, t6.y = null, e9.goTo({
      center: o5
    }), this._freeHandWidth = t6.boxWidth, this._freehandHeight = t6.boxHeight, "MAP_ONLY" === this.templateOptions.layout && (this.templateOptions.width = this._freeHandWidth, this.templateOptions.height = this._freehandHeight), this.templateOptions.scale = this.view.scale, this._updateOverLayItem();
  }
};
e([y()], J4.prototype, "_serviceTemplateCustomTextElements", void 0), e([y()], J4.prototype, "_layoutToTemplateInfo", void 0), e([y()], J4.prototype, "allowedFormats", void 0), e([y()], J4.prototype, "allowedLayouts", void 0), e([y({
  type: G2
})], J4.prototype, "browseTemplates", void 0), e([y({
  type: G2
})], J4.prototype, "defaultTemplates", void 0), e([y()], J4.prototype, "error", void 0), e([y()], J4.prototype, "extraParameters", void 0), e([y()], J4.prototype, "includeDefaultTemplates", void 0), e([y({
  readOnly: true
})], J4.prototype, "effectivePrintServiceUrl", null), e([y()], J4.prototype, "effectiveTemplateCustomTextElements", null), e([y()], J4.prototype, "layoutTemplateInfo", null), e([y({
  type: C
})], J4.prototype, "portal", void 0), e([y()], J4.prototype, "portalTemplateIds", void 0), e([y()], J4.prototype, "showPrintAreaEnabled", void 0), e([y()], J4.prototype, "printServiceUrl", void 0), e([y()], J4.prototype, "printTimeout", void 0), e([y({
  readOnly: true
})], J4.prototype, "state", null), e([y({
  readOnly: true
})], J4.prototype, "templatesInfo", void 0), e([y()], J4.prototype, "updateDelay", void 0), e([y()], J4.prototype, "view", void 0), e([y()], J4.prototype, "templateCustomTextElements", void 0), e([y({
  type: p9
})], J4.prototype, "templateOptions", void 0), e([y()], J4.prototype, "layoutTemplateNorthArrowInfo", null), J4 = e([a2("esri.widgets.Print.PrintViewModel")], J4);
var Q2 = J4;

// ../../../node_modules/@arcgis/core/widgets/Print.js
var O3 = V.ofType(a5);
var I = "MAP_ONLY";
var k3;
!function(e9) {
  e9.layout = "layoutTab", e9.mapOnly = "mapOnlyTab", e9.export = "exportTab";
}(k3 || (k3 = {}));
var $2 = "esri-print";
var L = `${$2}__advanced-options-button`;
var S6 = {
  base: $2,
  headerTitle: `${$2}__header-title`,
  layoutTabList: `${$2}__layout-tab-list`,
  layoutTab: `${$2}__layout-tab`,
  layoutSection: `${$2}__layout-section`,
  mapOnlySection: `${$2}__map-only-section`,
  panelItemsCentered: `${$2}__panel-items--centered`,
  loader: `${$2}__loader`,
  advancedOptionsButton: L,
  advancedOptionsButtonContainer: `${L}-container`,
  advancedOptionsButtonTitle: `${L}-title`,
  advancedOptionsButtonIconOpened: `${L}-icon--opened`,
  advancedOptionsButtonIconClosed: `${L}-icon--closed`,
  advancedOptionsButtonIconClosed_RTL: `${L}-icon--closed-rtl`,
  swapButton: `${$2}__swap-button`,
  printButton: `${$2}__export-button`,
  templateSelectContainer: `${$2}__template-select-container`,
  templateSelectBlock: `${$2}__template-select-block`,
  templateSelectIcon: `${$2}__template-select-icon`,
  formSectionContainer: `${$2}__form-section-container`,
  formCheckboxLabel: `${$2}__form-checkbox-label`,
  advancedOptionsSection: `${$2}__advanced-options-section`,
  advancedOptionsContainer: `${$2}__advanced-options-container`,
  browseTemplateButtonContainer: `${$2}__browse-template-button-container`,
  exportedFilesContainer: `${$2}__export-panel-container`,
  exportedFilesTitle: `${$2}__export-title`,
  exportedFile: `${$2}__exported-file`,
  exportedFileLink: `${$2}__exported-file-link`,
  exportedFileLinkTitle: `${$2}__exported-file-link-title`,
  exportedFilesEmpty: `${$2}__exported-files-empty`,
  printWidgetContainer: `${$2}__container`,
  content: `${$2}__content`,
  panelContainer: `${$2}__panel-container`,
  scaleInfoContainer: `${$2}__scale-info-container`,
  scaleInputContainer: `${$2}__scale-input-container`,
  scaleInput: `${$2}__scale-input`,
  sizeContainer: `${$2}__size-container`,
  panelError: `${$2}__panel--error`,
  exportedFileError: `${$2}__exported-file--error`,
  exportedFileLoader: `${$2}__exported-file--loader`,
  exportSection: `${$2}__export-section`,
  exportSectionCentered: `${$2}__export-section--centered`,
  templateButtonContainer: `${$2}__template-button-container`,
  templateDoneButton: `${$2}__template-done-button`,
  templateSelectFlowItemContainer: `${$2}__template-select-flow-item-container`,
  templateSelectFlowItemContent: `${$2}__template-select-flow-item-content`,
  templateSelectFlowItemListHeading: `${$2}__template-select-flow-item-list-heading`
};
function M(e9, t6, l5, i11) {
  const a11 = l5 / t6, o5 = i11 / t6;
  return {
    width: Math.round(e9 * a11),
    height: Math.round(e9 * o5)
  };
}
function E2(e9) {
  return !isNaN(e9) && e9 > 0;
}
function F3(e9) {
  return e9?.toUpperCase() === I;
}
function j7(e9) {
  const {
    state: t6,
    extension: l5
  } = e9;
  switch (t6) {
    case "pending":
      return "spinner";
    case "error":
      return "exclamation-mark-circle";
    default:
      return l5?.toLowerCase()?.includes("pdf") ? "file-pdf" : "file";
  }
}
function P2(e9, t6) {
  return !!t6 && e9.some((e10) => e10.layoutItem?.id === t6 || e10.layout === t6);
}
var A2 = new n({
  inch: "inches",
  foot: "feet",
  yard: "yards",
  mile: "miles",
  "nautical-mile": "nautical-miles",
  millimeter: "millimeters",
  centimeter: "centimeters",
  decimeter: "decimeters",
  meter: "meters",
  kilometer: "kilometers"
});
var B3 = class extends B {
  constructor(e9, t6) {
    super(e9, t6), this._activeTabFocusRequested = false, this._awaitingServerResponse = false, this._exportedFileNameMap = {}, this._selectedTab = k3.layout, this._pendingExportScroll = false, this._rootNode = null, this._selectedLayout = null, this._abortController = null, this._showTemplates = false, this.browseTemplateButtonOnClick = null, this.exportedLinks = new O3(), this.headingLevel = 3, this.messagesCommon = null, this.messagesUnits = null, this.viewModel = new Q2(), this._onInput = (e10) => {
      this._selectedTab === k3.layout ? this.templateOptions.title = e10.target.value : this._selectedTab === k3.mapOnly && (this.templateOptions.fileName = e10.target.value);
    }, this._removeLink = (e10) => {
      const t7 = e10.currentTarget["data-item"];
      t7 && this.exportedLinks.remove(t7);
    }, this._handleLinkClick = (e10) => {
      const t7 = e10.currentTarget["data-item"];
      if (!t7 || "ready" !== t7.state || !t7.url) return;
      const l5 = u4(this.viewModel.effectivePrintServiceUrl), i11 = t7.url, a11 = document.createElement("a");
      if (a11.target = "_blank", a11.href = i11, a11.rel = "noreferrer", a11.download = t7.formattedName ?? "", !l5) return a11.click(), void e10.stopPropagation();
      e10.preventDefault();
      const o5 = new URL(i11);
      o5.searchParams.set("token", l5), a11.href = o5.href, a11.click(), a11.href = i11;
    }, this._focusOnTabChange = this._focusOnTabChange.bind(this);
  }
  initialize() {
    this.addHandles([d(() => [this.templateOptions.format, this.viewModel.templatesInfo?.format.defaultValue], ([e10, t7]) => {
      if (t7 && !e10) return void (this.templateOptions.format = t7);
      if (!e10 || !t7 || !this.viewModel.templatesInfo) return;
      if (this.viewModel.templatesInfo.format.choiceList.includes(e10)) return;
      const l6 = this.viewModel.templatesInfo.format.choiceList.find((t8) => t8.toUpperCase().includes(`(${e10.toUpperCase()})`));
      this.templateOptions.format = l6 ?? t7;
    }), d(() => [this.templateOptions.layout, this.viewModel.templatesInfo?.layout.defaultValue], (_0) => __async(this, [_0], function* ([e10, t7]) {
      if (this._selectedTab = F3(e10) ? k3.mapOnly : k3.layout, this._selectedTab !== k3.layout) return;
      const {
        includeDefaultTemplates: l6,
        viewModel: a11,
        _selectedLayout: o5
      } = this, {
        portalTemplateIds: n4,
        browseTemplates: s10,
        templatesInfo: r4
      } = a11, c8 = a11.defaultTemplates.filter(({
        layoutItem: e11
      }) => n4.includes(e11?.id)), p10 = a11.defaultTemplates.filter(({
        layoutItem: e11
      }) => !n4.includes(e11?.id)), d7 = l6 && p10.length;
      if (e10) {
        (d7 ? P2(p10, e10) : r4?.layout.choiceList.includes(e10)) || P2(c8, e10) || P2(s10, e10) || (this.templateOptions.layout = null, this.templateOptions.layoutItem = null);
      } else {
        o5 && ((d7 ? P2(p10, o5) : r4?.layout.choiceList.includes(o5)) || P2(c8, o5) || P2(s10, o5)) ? yield this._applyTemplate(o5) : (this.templateOptions.layout = null, this.templateOptions.layoutItem = null), this.templateOptions.layout || d7 || !t7 || (yield this._applyTemplate(t7));
      }
      this._selectedLayout = this.templateOptions.layout;
      const u6 = !!this.templateOptions.layout && this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];
      this.templateOptions.customTextElements = u6 ? a(u6) : null;
    })), d(() => this.templateOptions.dpi, (e10) => {
      e10 <= 0 && (this.templateOptions.dpi = 1);
    }), d(() => this.viewModel.view?.scale, (e10) => {
      !e10 || this.templateOptions.scaleEnabled && this.templateOptions.scale || (this.templateOptions.scale = e10);
    })]);
    const {
      height: e9,
      width: t6
    } = this.templateOptions;
    this.templateOptions.width = t6 || 800, this.templateOptions.height = e9 || 1100;
    const l5 = setTimeout(() => {
      this._awaitingServerResponse = true, this.scheduleRender();
    }, 500);
    this.viewModel.load().then(() => {
      clearTimeout(l5), this._awaitingServerResponse = false;
    });
  }
  loadDependencies() {
    return r({
      action: () => import("./calcite-action-M3FHAAKV.js"),
      block: () => import("./calcite-block-PSHTVVZX.js"),
      button: () => import("./calcite-button-TT4KT5XH.js"),
      checkbox: () => import("./calcite-checkbox-ZPWECFBW.js"),
      combobox: () => import("./calcite-combobox-XTDI5CG6.js"),
      "combobox-item": () => import("./calcite-combobox-item-SJ5IB5U6.js"),
      flow: () => import("./calcite-flow-TTW7IFPM.js"),
      "flow-item": () => import("./calcite-flow-item-4IHVAYF2.js"),
      icon: () => import("./calcite-icon-FE3MORNT.js"),
      input: () => import("./calcite-input-WHALBGAT.js"),
      label: () => import("./calcite-label-NSQ5QQOX.js"),
      list: () => import("./calcite-list-QRFMTME5.js"),
      "list-item": () => import("./calcite-list-item-MF2DTJRA.js"),
      loader: () => import("./calcite-loader-UGV3HF5I.js"),
      switch: () => import("./calcite-switch-OIFS4TEC.js"),
      chip: () => import("./calcite-chip-2PD2DVVA.js")
    });
  }
  destroy() {
    this.viewModel.destroy();
  }
  get allowedFormats() {
    return this.viewModel.allowedFormats;
  }
  set allowedFormats(e9) {
    this.viewModel.allowedFormats = e9;
  }
  get allowedLayouts() {
    return this.viewModel.allowedLayouts;
  }
  set allowedLayouts(e9) {
    this.viewModel.allowedLayouts = e9;
  }
  get error() {
    return this.viewModel.error;
  }
  get extraParameters() {
    return this.viewModel.extraParameters;
  }
  set extraParameters(e9) {
    this.viewModel.extraParameters = e9;
  }
  get icon() {
    return "print";
  }
  set icon(e9) {
    this._overrideIfSome("icon", e9);
  }
  get includeDefaultTemplates() {
    return this.viewModel.includeDefaultTemplates;
  }
  set includeDefaultTemplates(e9) {
    this.viewModel.includeDefaultTemplates = e9;
  }
  get label() {
    return this.messages?.widgetLabel ?? "";
  }
  set label(e9) {
    this._overrideIfSome("label", e9);
  }
  get portal() {
    return this.viewModel.portal;
  }
  set portal(e9) {
    this.viewModel.portal = e9;
  }
  get showPrintAreaEnabled() {
    return this.viewModel.showPrintAreaEnabled;
  }
  set showPrintAreaEnabled(e9) {
    this.viewModel.showPrintAreaEnabled = e9;
  }
  get printServiceUrl() {
    return this.viewModel.printServiceUrl;
  }
  set printServiceUrl(e9) {
    this.viewModel.printServiceUrl = e9;
  }
  get templateCustomTextElements() {
    return this.viewModel.templateCustomTextElements;
  }
  set templateCustomTextElements(e9) {
    this.viewModel.templateCustomTextElements = e9;
  }
  get templateOptions() {
    return this.viewModel.templateOptions;
  }
  set templateOptions(e9) {
    this.viewModel.templateOptions = e9;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e9) {
    this.viewModel.view = e9;
  }
  render() {
    const {
      messages: e9,
      templateOptions: t6,
      viewModel: l5,
      view: i11
    } = this, {
      attributionEnabled: a11,
      author: o5,
      copyright: n4,
      dpi: s10,
      format: r4,
      height: c8,
      layout: p10,
      legendEnabled: d7,
      northArrowEnabled: m6,
      scaleEnabled: h2,
      scale: b3,
      width: y5
    } = t6, w3 = "ready" !== l5.state || this._awaitingServerResponse || !p10, T = this._renderTitleOrFileNameSection(), C3 = n2("div", {
      class: S6.formSectionContainer
    }, n2("calcite-label", null, e9.fileFormatTitle, n2("calcite-combobox", {
      clearDisabled: true,
      label: e9.formatDefaultOption,
      maxItems: 6,
      placeholder: e9.formatDefaultOption,
      selectionMode: "single-persist",
      onCalciteComboboxChange: ({
        target: e10
      }) => {
        this.templateOptions.format = e10.selectedItems[0].value;
      }
    }, l5.templatesInfo?.format?.choiceList.sort().map((e10, t7) => n2("calcite-combobox-item", {
      key: `file-format-${t7}`,
      selected: e10 === this.templateOptions.format,
      textLabel: g3(e10),
      value: e10
    }))))), O4 = n2("calcite-label", {
      layout: "inline"
    }, n2("calcite-switch", {
      checked: this.showPrintAreaEnabled,
      onCalciteSwitchChange: (e10) => {
        this.showPrintAreaEnabled = !!e10.target.checked;
      }
    }), e9.printPreview), I2 = n2("div", null, n2("div", {
      class: S6.formSectionContainer
    }, n2("calcite-label", null, e9.template, n2("div", {
      class: S6.templateSelectContainer,
      onclick: () => {
        this._showTemplates = true;
      }
    }, n2("calcite-block", {
      class: S6.templateSelectBlock,
      description: this._getPageSizeLabel(p10),
      heading: this._getTemplateLabel()
    }), n2("calcite-icon", {
      class: S6.templateSelectIcon,
      icon: g2() ? "chevron-left" : "chevron-right",
      scale: "s"
    })))), O4), $3 = n2("div", {
      class: S6.formSectionContainer
    }, n2("calcite-label", null, e9.dpi, n2("calcite-input", {
      bind: this,
      "data-input-name": "dpi",
      min: 1,
      tabIndex: 0,
      type: "number",
      value: `${s10}`,
      onCalciteInputInput: this._handleDPIChange
    }))), L2 = n2("div", {
      class: this.classes(S6.scaleInfoContainer, S6.formSectionContainer)
    }, n2("calcite-label", {
      layout: "inline"
    }, n2("calcite-checkbox", {
      bind: this,
      checked: h2,
      "data-option-name": "scaleEnabled",
      tabIndex: 0,
      onCalciteCheckboxChange: this._toggleInputValue
    }), e9.scale), n2("div", {
      class: S6.scaleInputContainer
    }, n2("calcite-input", {
      "aria-label": e9.scaleLabel,
      "aria-valuenow": `${b3}`,
      bind: this,
      class: S6.scaleInput,
      "data-input-name": "scale",
      disabled: !h2,
      tabIndex: 0,
      type: "number",
      value: `${b3}`,
      onCalciteInputInput: this._updateInputValue
    }), n2("calcite-button", {
      appearance: "outline",
      "aria-label": e9.reset,
      bind: this,
      disabled: !h2,
      iconStart: "refresh",
      kind: "neutral",
      onclick: this._resetToCurrentScale,
      tabIndex: 0
    }))), M2 = n2("div", {
      "aria-labelledby": `${this.id}__advancedOptionsForLayout`,
      class: S6.advancedOptionsContainer,
      key: "advanced-section-for-layout"
    }, L2, this.viewModel.layoutTemplateInfo?.layoutOptions?.hasAuthorText ?? 1 ? n2("div", {
      class: S6.formSectionContainer,
      key: "author-info"
    }, n2("calcite-label", null, e9.author, n2("calcite-input", {
      bind: this,
      "data-input-name": "author",
      tabIndex: 0,
      value: o5 ?? "",
      onCalciteInputInput: this._updateInputValue
    }))) : null, this.viewModel.layoutTemplateInfo?.layoutOptions?.hasCopyrightText ?? 1 ? n2("div", {
      class: S6.formSectionContainer,
      key: "copyright-text"
    }, n2("calcite-label", null, e9.copyright, n2("calcite-input", {
      bind: this,
      "data-input-name": "copyright",
      tabIndex: 0,
      value: n4 ?? "",
      onCalciteInputInput: this._updateInputValue
    }))) : null, $3, this._renderCustomTextElementSection(), this.viewModel.layoutTemplateInfo?.layoutOptions?.hasLegend ?? 1 ? n2("div", {
      class: S6.formSectionContainer,
      key: "legend-info"
    }, n2("calcite-label", {
      layout: "inline"
    }, n2("calcite-checkbox", {
      bind: this,
      checked: d7,
      "data-option-name": "legendEnabled",
      tabIndex: 0,
      onCalciteCheckboxChange: this._toggleInputValue
    }), e9.legend)) : null, this.viewModel.layoutTemplateNorthArrowInfo ? n2("div", {
      class: S6.formSectionContainer,
      key: "north-arrow"
    }, n2("calcite-label", {
      layout: "inline"
    }, n2("calcite-checkbox", {
      bind: this,
      checked: m6,
      "data-option-name": "northArrowEnabled",
      tabIndex: 0,
      onCalciteCheckboxChange: this._toggleInputValue
    }), e9.northArrow)) : null), E3 = n2("div", {
      "aria-labelledby": `${this.id}__advancedOptionsForMapOnly`,
      class: S6.advancedOptionsContainer
    }, L2, $3, n2("div", {
      class: S6.formSectionContainer
    }, n2("calcite-label", {
      layout: "inline"
    }, n2("calcite-checkbox", {
      bind: this,
      checked: a11,
      "data-option-name": "attributionEnabled",
      tabIndex: 0,
      onCalciteCheckboxChange: this._toggleInputValue
    }), e9.attribution)), this._renderCustomTextElementSection()), F4 = this.exportedLinks.toArray(), j8 = this._renderExportedLink(F4), P3 = {
      [S6.exportSectionCentered]: !F4.length
    }, A3 = this._selectedTab === k3.layout ? n2("section", {
      "aria-labelledby": `${this.id}__layoutTab`,
      class: S6.layoutSection,
      id: `${this.id}__layoutContent`,
      key: "esri-print__layoutContent",
      role: "tabpanel"
    }, n2("div", {
      class: S6.panelContainer
    }, this.viewModel.layoutTemplateInfo?.layoutOptions?.hasTitleText ?? 1 ? T : null, I2, this._selectedTab === k3.layout ? C3 : null, n2("calcite-block", {
      "aria-label": e9.advancedOptions,
      class: this.classes(S6.panelContainer, S6.advancedOptionsSection),
      collapsible: true,
      disabled: !p10,
      heading: e9.advancedOptions,
      id: "advancedOptionsForLayout",
      key: "advanced-options-for-layout"
    }, M2))) : this._selectedTab === k3.mapOnly ? n2("section", {
      "aria-labelledby": `${this.id}__mapOnlyTab`,
      class: S6.mapOnlySection,
      id: `${this.id}__mapOnlyContent`,
      key: "esri-print__mapOnlyContent",
      role: "tabpanel"
    }, n2("div", {
      class: S6.panelContainer
    }, T, C3, n2("div", null, n2("div", {
      class: this.classes(S6.sizeContainer, S6.formSectionContainer)
    }, n2("calcite-label", null, e9.width, n2("calcite-input", {
      bind: this,
      "data-input-name": "width",
      tabIndex: 0,
      type: "number",
      value: `${y5}`,
      onCalciteInputInput: this._updateInputValue
    })), n2("calcite-label", null, e9.height, n2("calcite-input", {
      bind: this,
      "data-input-name": "height",
      tabIndex: 0,
      type: "number",
      value: `${c8}`,
      onCalciteInputInput: this._updateInputValue
    })), n2("button", {
      "aria-label": e9.swap,
      bind: this,
      class: this.classes(e4.widgetButton, S6.swapButton, i3.swap),
      onclick: this._switchInput,
      tabIndex: 0,
      type: "button"
    })), O4), n2("calcite-block", {
      "aria-label": e9.advancedOptions,
      class: this.classes(S6.panelContainer, S6.advancedOptionsSection),
      collapsible: true,
      heading: e9.advancedOptions,
      id: "advancedOptionsForMapOnly",
      key: "advanced-options-for-map-only"
    }, E3))) : n2("section", {
      "aria-labelledby": `${this.id}__exportTab`,
      class: this.classes(S6.exportSection, P3),
      id: `${this.id}__exportContent`,
      key: "esri-print__exportContent",
      role: "tabpanel"
    }, n2("div", {
      class: S6.panelContainer
    }, n2("div", {
      afterUpdate: this._scrollExportIntoView,
      bind: this,
      class: S6.exportedFilesContainer
    }, 0 === F4.length ? n2("div", {
      class: S6.exportedFilesEmpty
    }, n2("calcite-icon", {
      icon: "file",
      scale: "l"
    }), n2("div", null, n2(e5, {
      class: S6.exportedFilesTitle,
      level: this.headingLevel
    }, e9.noExportedFiles), n2("div", null, e9.exportHint))) : j8))), B4 = {
      [e4.buttonDisabled]: w3 || !p10 && !r4
    }, D3 = !i11 || "2d" !== i11.type, U3 = n2("div", {
      class: S6.panelError
    }, D3 ? e9.sceneViewError : e9.serviceError), N4 = F4.some(({
      state: e10
    }) => "pending" === e10), V4 = n2("div", {
      class: S6.content,
      key: "panel"
    }, n2("div", null, n2("ul", {
      bind: this,
      class: S6.layoutTabList,
      onclick: this._toggleLayoutPanel,
      onkeydown: this._handleLayoutPanelKeyDown,
      role: "tablist"
    }, n2("li", {
      afterCreate: this._focusOnTabChange,
      afterUpdate: this._focusOnTabChange,
      "aria-selected": `${this._selectedTab === k3.layout}`,
      class: S6.layoutTab,
      "data-tab-id": k3.layout,
      id: `${this.id}__layoutTab`,
      role: "tab",
      tabIndex: 0
    }, e9.layoutTab), n2("li", {
      afterCreate: this._focusOnTabChange,
      afterUpdate: this._focusOnTabChange,
      "aria-selected": `${this._selectedTab === k3.mapOnly}`,
      class: S6.layoutTab,
      "data-tab-id": k3.mapOnly,
      id: `${this.id}__mapOnlyTab`,
      role: "tab",
      tabIndex: 0
    }, e9.mapOnlyTab), n2("li", {
      afterCreate: this._focusOnTabChange,
      afterUpdate: this._focusOnTabChange,
      "aria-selected": `${this._selectedTab === k3.export}`,
      class: S6.layoutTab,
      "data-tab-id": k3.export,
      id: `${this.id}__exportedFilesTab`,
      role: "tab",
      tabIndex: 0
    }, N4 ? n2("calcite-loader", {
      inline: true,
      label: "loading",
      scale: "s"
    }) : null, e9.exportsTab)), A3), this._selectedTab !== k3.export ? n2("button", {
      "aria-label": e9.exportDescription,
      bind: this,
      class: this.classes(S6.printButton, e4.button, B4),
      disabled: w3,
      onclick: this._handlePrintMap,
      tabIndex: 0,
      type: "button"
    }, e9.export) : null), R5 = n2("calcite-flow", {
      key: "root-flow"
    }, n2("calcite-flow-item", {
      bind: this,
      key: "root-flow-item"
    }, n2("div", {
      class: S6.printWidgetContainer
    }, n2("header", {
      class: S6.headerTitle
    }, e9.export), this.error || D3 || !i11 ? U3 : V4)), this._renderChooseTemplateFlowItem()), z3 = "initializing" === l5.state, H2 = z3 ? this._renderLoader() : R5, W3 = {
      [S6.panelItemsCentered]: z3
    };
    return n2("div", {
      bind: this,
      class: this.classes(S6.base, e4.widget, e4.panel, W3)
    }, H2);
  }
  _getPageSizeLabel(e9) {
    if (!e9) return;
    const t6 = this.viewModel.getLayoutTemplateInfo(e9);
    if (!t6) return;
    const l5 = A2.fromJSON(t6.pageUnits.toLowerCase());
    return `${l(t6.pageSize[0])} x ${l(t6.pageSize[1])} ${b2(this.messagesUnits, l5, "abbr")}`;
  }
  _getTemplateLabel() {
    const {
      messages: e9,
      includeDefaultTemplates: t6,
      templateOptions: l5,
      viewModel: i11
    } = this, {
      layout: a11
    } = l5, o5 = a11 ? (t6 ? i11.defaultTemplates.find(({
      layoutItem: e10,
      layout: t7
    }) => a11 === e10?.id || a11 === t7) : null) ?? i11.browseTemplates.find(({
      layoutItem: e10
    }) => a11 === e10?.id) : null;
    return o5?.label?.replaceAll("_", " ") ?? e9[a11] ?? a11?.replaceAll("_", " ") ?? e9.selectTemplate;
  }
  _renderChooseTemplateFlowItem() {
    if (!this._showTemplates) return null;
    const {
      includeDefaultTemplates: e9,
      messages: t6,
      viewModel: l5
    } = this, {
      defaultTemplates: i11,
      templatesInfo: a11,
      browseTemplates: o5,
      portalTemplateIds: n4
    } = l5, s10 = t.test(this.portal?.url), r4 = o5.length ? o5.toArray().sort((e10, t7) => (e10.label ?? "") > (t7.label ?? "") ? 1 : -1).map((e10, i12) => {
      const a12 = e10.layoutItem?.id ?? e10.layout, o6 = this._getPageSizeLabel(a12), n5 = a12 === this.templateOptions.layout;
      return n2("calcite-list-item", {
        description: o6,
        key: `browse-template-${i12}`,
        label: e10?.label?.replaceAll("_", " ") ?? t6.untitled,
        selected: n5,
        title: e10.description ?? "",
        value: a12
      }, !o6 && n5 && e10.layoutItem?.id ? n2("calcite-loader", {
        inline: true,
        key: `browse-template-loader-${i12}`,
        label: "loading",
        scale: "s",
        slot: "content-end"
      }) : null, n2("calcite-action", {
        icon: "trash",
        onclick: () => l5.removePortalTemplate(e10),
        slot: "actions-end",
        text: "delete"
      }));
    }) : null, c8 = i11.length && e9 ? i11.toArray().filter(({
      label: e10,
      layoutItem: t7
    }) => !F3(e10) && n4.includes(t7?.id)).map((e10, l6) => {
      const i12 = e10.layoutItem?.id ?? e10.layout, a12 = this._getPageSizeLabel(i12), o6 = i12 === this.templateOptions.layout;
      return n2("calcite-list-item", {
        description: a12,
        key: `portal-template-${i12}-${o6}`,
        label: e10?.label?.replaceAll("_", " ") ?? t6.untitled,
        selected: o6,
        title: e10.description ?? "",
        value: i12
      }, !a12 && o6 && e10.layoutItem?.id ? n2("calcite-loader", {
        inline: true,
        key: `portal-template-loader-${l6}`,
        label: "loading",
        scale: "s",
        slot: "content-end"
      }) : null);
    }) : null, d7 = i11.length && e9 ? i11.toArray().filter(({
      label: e10,
      layoutItem: t7
    }) => !F3(e10) && !n4.includes(t7?.id)).sort((e10, t7) => (e10.label ?? "") > (t7.label ?? "") ? 1 : -1).map((e10, l6) => {
      const i12 = e10.layoutItem?.id ?? e10.layout, a12 = this._getPageSizeLabel(i12), o6 = i12 === this.templateOptions.layout;
      return n2("calcite-list-item", {
        description: a12,
        key: `default-template-${l6}`,
        label: e10?.label?.replaceAll("_", " ") ?? t6.untitled,
        selected: o6,
        title: e10.description ?? "",
        value: i12
      }, !a12 && o6 && e10.layoutItem?.id ? n2("calcite-loader", {
        inline: true,
        key: `default-template-loader-${l6}`,
        label: "loading",
        scale: "s",
        slot: "content-end"
      }) : null);
    }) : null, u6 = !a11?.layout?.choiceList.length || e9 && d7?.length ? null : a11.layout.choiceList.map((e10) => ({
      label: t6[e10] ?? e10.replaceAll("_", " "),
      value: e10
    })).sort((e10, t7) => e10.label > t7.label ? 1 : 0).map(({
      label: e10,
      value: t7
    }, l6) => n2("calcite-list-item", {
      description: this._getPageSizeLabel(t7),
      key: `service-template-${l6}`,
      label: e10,
      selected: t7 === this.templateOptions.layout,
      value: t7
    })), m6 = (r4?.length ?? 0) + (c8?.length ?? 0) + (d7?.length ?? 0) + (u6?.length ?? 0) > 15;
    return n2("calcite-flow-item", {
      bind: this,
      closable: false,
      heading: t6.chooseTemplate,
      key: "template-flow-item",
      onCalciteFlowItemBack: (e10) => {
        e10.preventDefault(), this._showTemplates = false;
      }
    }, n2("div", {
      class: S6.templateSelectFlowItemContainer
    }, n2("div", {
      class: S6.templateSelectFlowItemContent
    }, this.browseTemplateButtonOnClick ? n2("calcite-button", {
      appearance: "outline",
      class: S6.browseTemplateButtonContainer,
      key: "browse-template-button",
      onclick: this.browseTemplateButtonOnClick
    }, "Browse Templates") : null, n2("calcite-list", {
      filterEnabled: m6,
      key: "template-list",
      selectionMode: "single-persist",
      onCalciteListChange: ({
        target: e10
      }) => this._applyTemplate(e10.selectedItems[0].value)
    }, r4?.length ? n2("div", {
      key: "my-templates"
    }, n2("div", {
      class: S6.templateSelectFlowItemListHeading
    }, t6.myTemplates, n2("calcite-chip", {
      appearance: "outline",
      kind: "neutral",
      scale: "s",
      value: t6.beta
    }, t6.beta)), r4) : null, c8?.length ? n2("div", {
      key: "org-templates"
    }, n2("div", {
      class: S6.templateSelectFlowItemListHeading
    }, t6.organizationTemplates, s10 ? n2("calcite-chip", {
      appearance: "outline",
      kind: "neutral",
      scale: "s",
      value: t6.beta
    }, t6.beta) : null), c8) : null, r4?.length || c8?.length ? d7?.length ? n2("div", {
      key: "default-templates"
    }, n2("div", {
      class: S6.templateSelectFlowItemListHeading
    }, t6.defaultTemplates), d7) : null : d7, r4?.length || c8?.length ? u6?.length ? n2("div", {
      key: "service-templates"
    }, n2("div", {
      class: S6.templateSelectFlowItemListHeading
    }, t6.defaultTemplates), u6) : null : u6)), n2("div", {
      class: S6.templateButtonContainer
    }, n2("calcite-button", {
      class: S6.templateDoneButton,
      onclick: () => this._showTemplates = false
    }, this.messagesCommon.done))));
  }
  _renderCustomTextElementSection() {
    const {
      customTextElements: e9
    } = this.templateOptions;
    return e9 ? n2("div", {
      class: S6.formSectionContainer,
      key: "custom-text-elements"
    }, e9.map((e10, t6) => {
      const [l5, i11] = Object.entries(e10)[0];
      return "date" === l5 ? null : n2("calcite-label", {
        key: `custom-text-elements-${l5}-${t6}`
      }, l5, n2("calcite-input", {
        bind: this,
        "data-input-custom": true,
        "data-input-name": l5,
        value: i11 ?? "",
        onCalciteInputInput: this._updateInputValue
      }));
    })) : null;
  }
  _applyTemplate(e9) {
    return __async(this, null, function* () {
      if (this._abortController && (this._abortController.abort(), this._abortController = null), !e9) return;
      const t6 = this.viewModel.defaultTemplates.find(({
        layoutItem: t7
      }) => e9 === t7?.id) ?? this.viewModel.browseTemplates.find(({
        layoutItem: t7
      }) => e9 === t7?.id);
      if (!t6) return this.templateOptions.layout = e9, void (this.templateOptions.layoutItem = null);
      const {
        layoutItem: l5
      } = t6, a11 = t6.format ?? this.templateOptions.format, o5 = l5?.id ?? t6.layout ?? this.templateOptions.layout;
      if (this.templateOptions.layout = o5, !t6.layoutOptions) try {
        this._abortController = new AbortController(), yield this.viewModel.fetchLayoutTemplateInfo(t6, {
          signal: this._abortController.signal
        });
      } catch (p10) {
        return;
      } finally {
        this._abortController = null;
      }
      const n4 = t6.layoutOptions?.legend ?? this.templateOptions.legendEnabled, s10 = t6.layoutOptions?.northArrow ?? this.templateOptions.northArrowEnabled, r4 = o5 ? this.viewModel.effectiveTemplateCustomTextElements[o5] : null, c8 = r4 ? a(r4) : null;
      this.templateOptions.set({
        customTextElements: c8,
        format: a11,
        layout: o5,
        layoutItem: l5,
        legendEnabled: n4,
        northArrowEnabled: s10
      });
    });
  }
  _renderTitleOrFileNameSection() {
    const {
      title: e9,
      fileName: t6,
      titlePlaceHolder: l5,
      fileNamePlaceHolder: i11
    } = this.messages, a11 = this._selectedTab === k3.layout ? e9 : t6, o5 = this._selectedTab === k3.layout ? l5 : i11, n4 = this._selectedTab === k3.layout ? this.templateOptions.title : this.templateOptions.fileName;
    return n2("div", {
      class: S6.formSectionContainer,
      key: a11
    }, n2("calcite-label", null, a11, n2("calcite-input", {
      placeholder: o5,
      value: n4 ?? "",
      onCalciteInputInput: this._onInput
    })));
  }
  _focusOnTabChange(e9) {
    if (!this._activeTabFocusRequested) return;
    const t6 = e9.getAttribute("data-tab-id");
    ("layoutTab" === t6 && this._selectedTab === k3.layout || "mapOnlyTab" === t6 && this._selectedTab === k3.mapOnly || "exportTab" === t6 && this._selectedTab === k3.export) && (e9.focus(), this._activeTabFocusRequested = false);
  }
  _renderLoader() {
    const e9 = {
      [S6.loader]: this._awaitingServerResponse
    };
    return n2("div", {
      class: this.classes(e9),
      key: "loader"
    });
  }
  _createFileLink(e9, t6) {
    const l5 = t6 || this.messages.untitled, i11 = e9.format.toLowerCase(), a11 = i11.includes("png") ? "png" : i11, o5 = l5 + a11;
    return void 0 !== this._exportedFileNameMap[o5] ? this._exportedFileNameMap[o5]++ : this._exportedFileNameMap[o5] = 0, new a5({
      name: l5,
      extension: a11,
      count: this._exportedFileNameMap[o5]
    });
  }
  _resetToCurrentScale() {
    this.templateOptions.scale = this.viewModel.view?.scale;
  }
  _updateCustomTextElementValue(e9, t6, l5) {
    e9.find((e10) => {
      const [l6] = Object.entries(e10)[0];
      return l6 === t6;
    })[t6] = l5;
  }
  _updateInputValue(e9) {
    const t6 = e9.target, l5 = t6.getAttribute("data-input-name"), i11 = !!t6["data-input-custom"], {
      templateOptions: a11
    } = this;
    if (i11) return void this._updateCustomTextElementValue(a11.customTextElements, l5, t6.value);
    let o5;
    if ("number" === t6.type) {
      const e10 = Number(t6.value);
      if (!E2(e10)) {
        const e11 = a11[l5];
        return void (t6.value = `${e11}`);
      }
      o5 = e10;
    } else o5 = t6.value;
    a11[l5] = o5;
  }
  _handleDPIChange(e9) {
    const {
      templateOptions: t6
    } = this, l5 = t6.dpi;
    this._updateInputValue(e9);
    const i11 = t6.dpi, {
      height: a11,
      width: o5
    } = M(i11, l5, t6.width, t6.height);
    t6.height = a11, t6.width = o5;
  }
  _handlePrintMap() {
    this._pendingExportScroll = true;
    const {
      templateOptions: e9
    } = this, t6 = this.viewModel.toPrintTemplate(e9), l5 = this._selectedTab === k3.layout ? t6.layoutOptions?.titleText : e9.fileName, i11 = this._createFileLink(t6, l5);
    this.exportedLinks.add(i11), this.emit("submit", {
      link: i11
    }), this._selectedTab = k3.export, this.viewModel.print(t6).then((e10) => {
      i11.set({
        url: e10 && e10.url,
        state: "ready"
      });
    }).catch((e10) => {
      i11.set({
        error: e10,
        state: "error"
      });
    }).then(() => {
      this.emit("complete", {
        link: i11
      }), this.scheduleRender();
    });
  }
  _switchInput() {
    [this.templateOptions.width, this.templateOptions.height] = [this.templateOptions.height, this.templateOptions.width];
  }
  _scrollExportIntoView() {
    if (!this._pendingExportScroll) return;
    this._pendingExportScroll = false;
    const e9 = this._rootNode;
    if (!e9) return;
    const {
      clientHeight: t6,
      scrollHeight: l5
    } = e9, i11 = l5 - t6;
    i11 > 0 && (e9.scrollTop = i11);
  }
  _toggleInputValue(e9) {
    const t6 = e9.target, l5 = t6.getAttribute("data-option-name");
    this.templateOptions[l5] = t6.checked, "scaleEnabled" === l5 && this._resetToCurrentScale();
  }
  _renderExportedLink(e9) {
    const t6 = this.messages, l5 = e9.map((e10) => {
      const {
        error: l6,
        url: i11,
        state: a11
      } = e10, o5 = e10.formattedName ?? "", r4 = "error" === a11, c8 = "pending" === a11, p10 = "ready" === a11;
      let d7 = i11 || null;
      d7 && (d7 = S2(d7));
      const u6 = F(i11, location.href);
      let m6;
      m6 = c8 ? t6.pending : p10 ? t6.ready : t6.errorMessage;
      const h2 = r4 ? "print-task:cim-symbol-unsupported" === l6?.name ? t6.exportWebMapCIMError : t6.exportWebMapError : "";
      return n2("calcite-list-item", {
        "aria-label": m6,
        class: S6.exportedFile,
        "data-item": e10,
        description: c8 ? t6.generatingExport : h2 || (u6 ? t6.ready : t6.linkReady),
        key: o5,
        label: o5,
        title: h2,
        onCalciteListItemSelect: this._handleLinkClick
      }, c8 ? n2("calcite-loader", {
        class: S6.exportedFileLoader,
        inline: true,
        key: `${o5}-loader`,
        label: t6.generatingExport,
        scale: "m",
        slot: "content-start"
      }) : n2("calcite-icon", {
        icon: j7(e10),
        key: `${o5}-start-icon`,
        scale: "s",
        slot: "content-start"
      }), p10 ? n2("calcite-icon", {
        "aria-label": `${o5}. ${t6.linkReady}`,
        icon: u6 ? "download-to" : "launch",
        key: `${o5}-end-icon`,
        scale: "s",
        slot: "content-end"
      }) : null, c8 ? null : n2("calcite-action", {
        "aria-label": `${h2}`,
        "data-item": e10,
        icon: "x",
        key: `${o5}-action`,
        onclick: this._removeLink,
        slot: "actions-end",
        text: `${h2}`
      }));
    });
    return n2("calcite-list", {
      filterEnabled: e9?.length > 10
    }, l5);
  }
  _toggleLayoutPanel(e9) {
    const t6 = e9.target;
    this._toggleTab(t6.getAttribute("data-tab-id"));
  }
  _toggleTab(e9, t6 = true) {
    if (this._selectedTab = e9, this._selectedTab === k3.mapOnly) this.templateOptions.layout = I, this.templateOptions.layoutItem = null, this.templateOptions.customTextElements = null;
    else if (this._selectedTab === k3.layout) {
      const e10 = this._selectedLayout ?? (this.includeDefaultTemplates && this.viewModel.defaultTemplates.length ? null : this.viewModel.templatesInfo?.layout?.defaultValue);
      e10 ? this._applyTemplate(e10) : (this.templateOptions.layout = null, this.templateOptions.layoutItem = null, this.templateOptions.customTextElements = null);
    }
    t6 && (this._activeTabFocusRequested = true);
  }
  _handleLayoutPanelKeyDown(e9) {
    const {
      key: t6
    } = e9, l5 = e9.target.getAttribute("data-tab-id");
    if (k(t6)) return this._toggleTab(l5), e9.preventDefault(), void e9.stopPropagation();
    if ("ArrowLeft" === t6 || "ArrowRight" === t6) {
      switch (l5) {
        case k3.layout:
          this._toggleTab("ArrowLeft" === t6 ? k3.export : k3.mapOnly);
          break;
        case k3.mapOnly:
          this._toggleTab("ArrowLeft" === t6 ? k3.layout : k3.export);
          break;
        case k3.export:
          this._toggleTab("ArrowLeft" === t6 ? k3.mapOnly : k3.layout);
      }
      e9.preventDefault(), e9.stopPropagation();
    }
  }
};
e([y()], B3.prototype, "_showTemplates", void 0), e([y()], B3.prototype, "allowedFormats", null), e([y()], B3.prototype, "allowedLayouts", null), e([y()], B3.prototype, "browseTemplateButtonOnClick", void 0), e([y()], B3.prototype, "error", null), e([y({
  type: O3
})], B3.prototype, "exportedLinks", void 0), e([y()], B3.prototype, "extraParameters", null), e([y()], B3.prototype, "headingLevel", void 0), e([y()], B3.prototype, "icon", null), e([y()], B3.prototype, "includeDefaultTemplates", null), e([y()], B3.prototype, "label", null), e([y(), e2("esri/widgets/Print/t9n/Print")], B3.prototype, "messages", void 0), e([y(), e2("esri/t9n/common")], B3.prototype, "messagesCommon", void 0), e([y(), e2("esri/core/t9n/Units")], B3.prototype, "messagesUnits", void 0), e([y()], B3.prototype, "portal", null), e([y()], B3.prototype, "showPrintAreaEnabled", null), e([y()], B3.prototype, "printServiceUrl", null), e([y()], B3.prototype, "templateCustomTextElements", null), e([y()], B3.prototype, "templateOptions", null), e([y()], B3.prototype, "view", null), e([y({
  type: Q2
})], B3.prototype, "viewModel", void 0), B3 = e([a2("esri.widgets.Print")], B3);
var D2 = B3;
export {
  D2 as default
};
//# sourceMappingURL=Print-YM7RLFER.js.map
