{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/widgets/LayerList/LayerListViewModel.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport t from \"../../core/Collection.js\";\nimport s from \"../../core/Evented.js\";\nimport { watch as i, initial as r } from \"../../core/reactiveUtils.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/Logger.js\";\nimport \"../../core/RandomLCG.js\";\nimport { subclass as o } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport l from \"./ListItem.js\";\nimport { getItemLayers as n, findLayerListMode as d } from \"./support/layerListUtils.js\";\nconst m = {\n    view: \"view\",\n    viewLayers: \"view-layers\",\n    mapLayers: \"map-layers\",\n    layerViews: \"layer-views\",\n    layerListMode: \"layer-list-mode\"\n  },\n  c = \"hide\",\n  h = t.ofType(l);\nlet p = class extends s.EventedAccessor {\n  constructor(e) {\n    super(e), this.checkPublishStatusEnabled = !1, this.listItemCreatedFunction = null, this.listModeDisabled = !1, this.operationalItems = new h(), this.view = null;\n  }\n  initialize() {\n    this.addHandles([i(() => !0 === this.view?.ready, () => this._viewHandles(), r), i(() => [this.listItemCreatedFunction, this.checkPublishStatusEnabled, this.listModeDisabled], () => this._recompileList())], m.view);\n  }\n  destroy() {\n    this._removeAllItems(), this.view = null;\n  }\n  get state() {\n    const {\n      view: e\n    } = this;\n    return e?.ready ? \"ready\" : e ? \"loading\" : \"disabled\";\n  }\n  get totalItems() {\n    return this.operationalItems.flatten(e => e.children).length;\n  }\n  triggerAction(e, t) {\n    e && !e.disabled && this.emit(\"trigger-action\", {\n      action: e,\n      item: t\n    });\n  }\n  moveListItem(e, t, s, i) {\n    const r = e?.layer;\n    if (!r || \"subtype-sublayer\" === r.type || \"sublayer\" === r.type) return;\n    const a = this.view?.map?.layers,\n      o = t ? n(t) : a,\n      l = s ? n(s) : a;\n    if (!o || !l) return;\n    const {\n        operationalItems: d\n      } = this,\n      m = t?.children || d,\n      c = s?.children || d,\n      h = l.length - i;\n    e.parent = s || null, m.remove(e), o.remove(r), c.includes(e) || c.add(e, h), l.includes(r) || l.add(r, h), this._compileList();\n  }\n  _createLayerViewHandles(e) {\n    this.removeHandles(m.layerViews), this._compileList(), e && this.addHandles(e.on(\"change\", () => this._compileList()), m.layerViews);\n  }\n  _createMapLayerHandles(e) {\n    this.removeHandles(m.mapLayers), this._compileList(), e && this.addHandles(e.on(\"change\", () => this._compileList()), m.mapLayers);\n  }\n  _createListItem(e) {\n    const {\n      view: t,\n      listItemCreatedFunction: s,\n      checkPublishStatusEnabled: i,\n      listModeDisabled: r\n    } = this;\n    return new l({\n      checkPublishStatusEnabled: i,\n      listModeDisabled: r,\n      layer: e,\n      listItemCreatedFunction: s,\n      view: t\n    });\n  }\n  _removeAllItems() {\n    this.operationalItems.destroyAll();\n  }\n  _getViewableLayers(e) {\n    return e ? this.listModeDisabled ? e : e.filter(e => d(e) !== c) : void 0;\n  }\n  _watchLayersListMode(e) {\n    this.removeHandles(m.layerListMode), e && !this.listModeDisabled && this.addHandles(i(() => e.filter(e => \"listMode\" in e).map(e => e.listMode).toArray(), () => this._compileList()), m.layerListMode);\n  }\n  _compileList() {\n    const e = this.view?.map?.layers;\n    this._watchLayersListMode(e);\n    const t = this._getViewableLayers(e);\n    t?.length ? (this._createNewItems(t), this._removeItems(t), this._sortItems(t)) : this._removeAllItems();\n  }\n  _createNewItems(e) {\n    const {\n      operationalItems: t\n    } = this;\n    e.forEach(e => {\n      t.some(t => t.layer === e) || t.add(this._createListItem(e));\n    });\n  }\n  _removeItems(e) {\n    const {\n        operationalItems: t\n      } = this,\n      s = [];\n    t.forEach(t => {\n      t && e && e.includes(t.layer) || s.push(t);\n    }), t.destroyMany(s);\n  }\n  _sortItems(e) {\n    const {\n      operationalItems: t\n    } = this;\n    t.sort((t, s) => {\n      const i = e.indexOf(t.layer),\n        r = e.indexOf(s.layer);\n      return i > r ? -1 : i < r ? 1 : 0;\n    });\n  }\n  _recompileList() {\n    this._removeAllItems(), this._compileList();\n  }\n  _viewHandles() {\n    const {\n      view: e\n    } = this;\n    this.removeHandles([m.mapLayers, m.layerViews, m.viewLayers]), e?.ready ? this.addHandles([i(() => this.view?.map?.allLayers, e => this._createMapLayerHandles(e), r), i(() => this.view?.allLayerViews, e => this._createLayerViewHandles(e), r)], m.viewLayers) : this._removeAllItems();\n  }\n};\ne([a()], p.prototype, \"checkPublishStatusEnabled\", void 0), e([a()], p.prototype, \"listItemCreatedFunction\", void 0), e([a({\n  nonNullable: !0\n})], p.prototype, \"listModeDisabled\", void 0), e([a({\n  type: h\n})], p.prototype, \"operationalItems\", void 0), e([a({\n  readOnly: !0\n})], p.prototype, \"state\", null), e([a()], p.prototype, \"totalItems\", null), e([a()], p.prototype, \"view\", void 0), p = e([o(\"esri.widgets.LayerList.LayerListViewModel\")], p);\nconst y = p;\nexport { y as default };"],
  "mappings": "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",
  "names": ["e", "a", "o", "d", "m", "c", "h", "t", "y"]
}
