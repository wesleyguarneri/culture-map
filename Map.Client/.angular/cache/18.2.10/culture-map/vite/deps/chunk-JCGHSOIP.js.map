{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/enums.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SClientMaterialUtil.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SClientNodeLoader.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SFrameTask.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/ValidatedNode.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SIndex.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SLodHandling.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SMaterialUtil.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SNodeLoader.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SStreamDataController.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SViewportQueries.js", "../../../../../../node_modules/@arcgis/core/layers/graphics/controllers/I3SOnDemandController.js", "../../../../../../node_modules/@arcgis/core/views/3d/layers/i3s/I3SOverrides.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nvar e, s;\n!function (e) {\n  e[e.KTX2 = 1] = \"KTX2\", e[e.Basis = 2] = \"Basis\", e[e.DDS_S3TC = 4] = \"DDS_S3TC\", e[e.PNG = 8] = \"PNG\", e[e.JPG = 16] = \"JPG\", e[e.KTX_ETC2 = 32] = \"KTX_ETC2\";\n}(e || (e = {})), function (e) {\n  e[e.None = 0] = \"None\", e[e.Color = 1] = \"Color\", e[e.MetallicRoughness = 2] = \"MetallicRoughness\", e[e.Normal = 4] = \"Normal\", e[e.Occlusion = 8] = \"Occlusion\", e[e.Emissive = 16] = \"Emissive\", e[e.AlphaMask = 32] = \"AlphaMask\", e[e.ColorTextures = 19] = \"ColorTextures\", e[e.GeometryTextures = 36] = \"GeometryTextures\", e[e.GeometryTexturesPBR = 44] = \"GeometryTexturesPBR\", e[e.AllTextures = 37] = \"AllTextures\", e[e.AllTexturesPBR = 63] = \"AllTexturesPBR\";\n}(s || (s = {}));\nexport { e as TextureEncoding, s as TextureUsage };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../../../Color.js\";\nimport o from \"../../../../core/Error.js\";\nimport { loadImageAsync as t } from \"../../../../support/requestUtils.js\";\nimport { EncodedMeshTexture as r } from \"../../glTF/internal/resourceUtils.js\";\nimport { TextureUsage as s, TextureEncoding as a } from \"./enums.js\";\nimport { CullFaceOptions as l } from \"../../webgl-engine/lib/basicInterfaces.js\";\nimport { downsampleImage as n } from \"../../webgl-engine/lib/textureUtils.js\";\nimport { useSchematicPBR as i, defaultSchematicMRRFactors as u } from \"../../webgl-engine/materials/pbrUtils.js\";\nasync function c(o) {\n  const t = [],\n    r = [];\n  if (null == o) {\n    return {\n      material: {\n        alphaMode: \"opaque\",\n        alphaCutoff: .1,\n        doubleSided: !0,\n        cullFace: 0,\n        normalTextureId: -1,\n        emissiveTextureId: -1,\n        occlusionTextureId: -1,\n        emissiveFactor: [0, 0, 0],\n        metallicRoughness: {\n          baseColorFactor: [1, 1, 1, 1],\n          baseColorTextureId: -1,\n          metallicRoughnessTextureId: -1,\n          metallicFactor: 0,\n          roughnessFactor: .6000000238418579\n        },\n        wrapTextures: !1,\n        hasParametersFromSource: !0\n      },\n      requiredTextures: t,\n      textureData: r\n    };\n  }\n  const a = d(o);\n  \"auto\" === o.alphaMode && console.warn('alphaMode \"auto\" not supported by I3S PBRMaterial - defaulting to \"blend\".');\n  const n = i({\n      normalTexture: o.normalTexture,\n      emissiveTexture: a ? o.emissiveTexture : null,\n      emissiveFactor: a ? e.toUnitRGB(o.emissiveColor) : null,\n      occlusionTexture: a ? o.occlusionTexture : null,\n      metallicRoughnessTexture: a ? o.metallicRoughnessTexture : null,\n      metallicFactor: a ? o.metallic : null,\n      roughnessFactor: a ? o.roughness : null\n    }),\n    c = n ? u[0] : a ? o.metallic : 0,\n    g = n ? u[1] : a ? o.roughness : 0;\n  return {\n    material: {\n      alphaMode: \"auto\" === o.alphaMode ? \"blend\" : o.alphaMode,\n      alphaCutoff: o.alphaCutoff,\n      doubleSided: o.doubleSided,\n      cullFace: o.doubleSided ? l.None : l.Back,\n      normalTextureId: await m(o.normalTexture, t, r, s.Normal),\n      emissiveTextureId: a ? await m(o.emissiveTexture, t, r, s.Emissive) : -1,\n      occlusionTextureId: a ? await m(o.occlusionTexture, t, r, s.Occlusion) : -1,\n      emissiveFactor: a && null != o.emissiveColor ? e.toUnitRGB(o.emissiveColor) : [0, 0, 0],\n      metallicRoughness: {\n        baseColorFactor: null != o.color ? e.toUnitRGBA(o.color) : [1, 1, 1, 1],\n        baseColorTextureId: await m(o.colorTexture, t, r, s.Color),\n        metallicRoughnessTextureId: a ? await m(o.metallicRoughnessTexture, t, r, s.MetallicRoughness) : -1,\n        metallicFactor: c,\n        roughnessFactor: g\n      },\n      wrapTextures: !0,\n      hasParametersFromSource: n\n    },\n    requiredTextures: t,\n    textureData: r\n  };\n}\nasync function m(e, s, l, i) {\n  if (null == e) return -1;\n  const u = l.length,\n    c = e.data,\n    m = e.url;\n  if (null != c) {\n    if (c instanceof HTMLImageElement || c instanceof HTMLCanvasElement) {\n      const e = n(c);\n      return l.push({\n        id: u,\n        usage: i,\n        data: e,\n        encoding: a.PNG,\n        downsampled: !1\n      }), s.push({\n        id: u,\n        usage: i,\n        encodings: [{\n          name: void 0,\n          encoding: a.PNG\n        }]\n      }), u;\n    }\n    if (c instanceof HTMLVideoElement) return -1;\n    if (c instanceof ImageData) throw new o(\"ImageData textures not supported yet for client side I3S nodes\");\n    if (c instanceof r) throw new o(\"EncodedMeshTexture textures not supported yet for client side I3S nodes\");\n  } else if (null != m) {\n    const e = new Image();\n    e.src = m;\n    const o = await t(e, e.src, !1, void 0),\n      r = n(o);\n    return l.push({\n      id: u,\n      usage: i,\n      data: r,\n      encoding: a.PNG,\n      downsampled: !1\n    }), s.push({\n      id: u,\n      usage: i,\n      encodings: [{\n        name: void 0,\n        encoding: a.PNG\n      }]\n    }), u;\n  }\n  return -1;\n}\nfunction d(e) {\n  return e.hasOwnProperty(\"metallicRoughnessTexture\");\n}\nexport { c as convertMeshMaterialToPBRMaterial };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Error.js\";\nimport { assertIsSome as t } from \"../../../../core/maybe.js\";\nimport { MinPriority as o } from \"../../../../core/MemCache.js\";\nimport { throwIfAborted as r } from \"../../../../core/promiseUtils.js\";\nimport { generateUUID as n } from \"../../../../core/uuid.js\";\nimport { normalFromMat4 as s } from \"../../../../core/libs/gl-matrix-2/math/mat3.js\";\nimport { create as i } from \"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";\nimport { e as a } from \"../../../../chunks/vec32.js\";\nimport { ONES as l } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { projectBoundingSphere as d } from \"../../../../geometry/projection/projectBoundingSphere.js\";\nimport { isRelativeVertexSpace as u } from \"../../../../geometry/support/meshVertexSpaceUtils.js\";\nimport { k as c } from \"../../../../chunks/sphere.js\";\nimport { convertMeshMaterialToPBRMaterial as m } from \"./I3SClientMaterialUtil.js\";\nclass h {\n  constructor(e, t, o, r) {\n    this._uid = e, this._worker = r, this._id2Meta = new Map(), this._oid2Meta = new Map(), this._indexSR = t.indexSR, this._vertexSR = t.vertexSR, this._renderSR = t.renderSR, this._localMode = t.localMode, this._memCache = o.newCache(`sl-client-mesh-data-${this._uid}`);\n  }\n  get uid() {\n    return this._uid;\n  }\n  get worker() {\n    return this._worker;\n  }\n  get indexSR() {\n    return this._indexSR;\n  }\n  get renderSR() {\n    return this._renderSR;\n  }\n  createMeshNodeInfo(e, t) {\n    const o = `mesh${t}`,\n      r = e.extent,\n      n = r.spatialReference,\n      s = this._indexSR,\n      i = p(r, e.origin);\n    d(i, n, i, s);\n    return {\n      type: \"mesh\",\n      id: o,\n      version: M(e),\n      oid: t,\n      mbs: i,\n      componentNodeIds: [],\n      unloadedMesh: e,\n      nodeIndex: null,\n      loadMeshPromise: null\n    };\n  }\n  addMeshNode(t, o) {\n    if (null != this.getMeshNodeIndex(o.oid)) throw new e(`I3SClientNodeLoader: client side mesh for feature oid=${o.oid} already exists`);\n    o.nodeIndex = t, this._id2Meta.set(o.id, o), this._oid2Meta.set(o.oid, o);\n  }\n  getMeshNodeIndex(e) {\n    const t = this._oid2Meta.get(e);\n    return null == t || \"mesh\" !== t.type ? null : t.nodeIndex;\n  }\n  getMeshNodeInfo(e) {\n    const t = this._oid2Meta.values();\n    for (const o of t) if (\"mesh\" === o.type && o.id === e) return o;\n    return null;\n  }\n  removeNode(e) {\n    const t = this._id2Meta.get(e);\n    null != t && (this._id2Meta.delete(e), \"mesh\" === t.type && this._oid2Meta.delete(t.oid));\n  }\n  async loadNodeJSON(t) {\n    const o = this._id2Meta.get(t);\n    if (null == o) throw new e(`I3SClientNodeLoader::loadNodeJSON unable to find node ${t}`);\n    switch (o.type) {\n      case \"mesh\":\n        return this._loadMeshNodeJSON(o);\n      case \"mesh-component\":\n        return f(o);\n      default:\n        throw new e(`I3SClientNodeLoader::loadNodeJSON unable to handle node ${t}`);\n    }\n  }\n  async _loadMeshNodeJSON(e) {\n    const t = e.id,\n      o = (await this._getMeshData(e)).loadedMesh;\n    if (null == o.components || 0 === o.components.length) return {\n      id: t,\n      version: null,\n      mbs: e.mbs,\n      obb: null,\n      sharedResource: null,\n      geometryData: null,\n      attributeData: null,\n      featureData: null,\n      children: null\n    };\n    const r = [],\n      n = o.components;\n    for (let s = 0; s < n.length; ++s) {\n      const o = `${t}-component${s}`,\n        n = {\n          type: \"mesh-component\",\n          id: o,\n          mbs: e.mbs,\n          componentIndex: s,\n          meshNodeInfo: e,\n          textureData: new Map()\n        };\n      this._id2Meta.set(n.id, n), e.componentNodeIds.push(o), r.push({\n        id: n.id,\n        href: null,\n        mbs: n.mbs,\n        obb: null\n      });\n    }\n    return {\n      id: t,\n      version: null,\n      mbs: e.mbs,\n      obb: null,\n      sharedResource: null,\n      geometryData: null,\n      attributeData: null,\n      featureData: null,\n      children: r\n    };\n  }\n  updateNodeIndex(e, t, o) {\n    const r = this._id2Meta.get(e);\n    r && \"mesh\" === r.type && (r.nodeIndex = o);\n  }\n  async loadNodeData(o, n) {\n    const s = this._id2Meta.get(o);\n    if (null == s || \"mesh-component\" !== s.type) throw new e(`Failed to load client node data for node ${o} (unexpected node info)`);\n    const i = s.meshNodeInfo,\n      a = await this._getMeshData(i),\n      l = a.loadedMesh,\n      d = i.oid;\n    if (null == l.components) throw new e(`Failed to load client node data for node ${o} (unexpected null reference)`);\n    const u = l.components[s.componentIndex],\n      {\n        material: c,\n        requiredTextures: h,\n        textureData: f\n      } = await m(u.material);\n    if (null != f) for (const e of f) null != e && s.textureData.set(e.id, e);\n    const p = {\n        params: {\n          material: c\n        },\n        type: \"ArrayBufferView\"\n      },\n      {\n        vertexSpace: g,\n        origin: M,\n        transform: S\n      } = l,\n      _ = [M.x, M.y, M.z ?? 0];\n    a.projectionPromise || (t(this._worker, \"SceneLayerWorker is needed to project mesh\"), a.projectionPromise = this._worker.project({\n      positions: l.vertexAttributes.position,\n      localMatrix: S?.localMatrix,\n      vertexSpace: g.toJSON(),\n      origin: _,\n      inSpatialReference: l.spatialReference.toJSON(),\n      outSpatialReference: this._vertexSR.toJSON(),\n      localMode: this._localMode\n    }, n));\n    const {\n      projected: w,\n      original: b,\n      projectedOrigin: N\n    } = await a.projectionPromise;\n    l.vertexAttributes.position = b;\n    const {\n      transformed: v,\n      original: D\n    } = await x(u, a, this._worker, n);\n    l.vertexAttributes.normal = D, r(n);\n    const {\n      geometryBuffer: I,\n      geometryDescriptor: R\n    } = y(w, u.faces, v, l.vertexAttributes.uv, l.vertexAttributes.color, d);\n    return {\n      geometryData: {\n        featureDataPosition: N,\n        featureIds: [],\n        geometries: [p]\n      },\n      attributeDataInfo: {\n        attributeData: {},\n        loadedAttributes: []\n      },\n      geometryBuffer: I,\n      geometryDescriptor: R,\n      requiredTextures: h,\n      textureData: f,\n      normalReferenceFrame: this._vertexSR.isGeographic ? \"east-north-up\" : \"vertex-reference-frame\"\n    };\n  }\n  async loadAttributes(e, t, o) {\n    const r = e.numFeatures,\n      n = {};\n    for (const {\n      field: {\n        name: s\n      }\n    } of t) n[s] = new Array(r);\n    return n;\n  }\n  async loadTextures(e, t, o) {\n    const r = e.id,\n      n = this._id2Meta.get(r);\n    if (null == n || \"mesh-component\" !== n.type) throw new Error(`Failed to load textures for node ${e.id} (unexpected node info)`);\n    const s = [];\n    for (const i of t) s.push(n.textureData.get(i.id) || null);\n    return s;\n  }\n  async _getMeshData(e) {\n    const t = e.version,\n      r = this._memCache.get(t);\n    if (null == r) {\n      if (null != e.loadMeshPromise) return e.loadMeshPromise;\n      const r = async (r, n) => {\n        const s = e.unloadedMesh.clone();\n        try {\n          await s.load();\n        } catch (l) {\n          n(l);\n        }\n        const i = s.memoryUsage,\n          a = {\n            loadedMesh: s,\n            projectionPromise: null,\n            normalsTransformPromise: null,\n            usedMemoryInBytes: i\n          };\n        this._memCache.put(t, a, i, o), e.loadMeshPromise = null, r(a);\n      };\n      return e.loadMeshPromise = new Promise((e, t) => r(e, t)), e.loadMeshPromise;\n    }\n    return r;\n  }\n}\nasync function f(e) {\n  return {\n    id: e.id,\n    version: e.meshNodeInfo.version,\n    mbs: e.mbs,\n    obb: null,\n    sharedResource: null,\n    geometryData: null,\n    attributeData: null,\n    featureData: null,\n    children: null,\n    isEmpty: !1\n  };\n}\nfunction p(e, t) {\n  const {\n      spatialReference: o\n    } = e,\n    r = [1, -1],\n    n = [.5 * e.width, .5 * e.height, e.hasZ ? .5 * (e.zmax - e.zmin) : 0],\n    s = o.isGeographic ? o.metersPerUnit : 1,\n    i = e.center;\n  let a = 0;\n  if (e.hasZ) for (let l = 0; l < 2; ++l) for (let e = 0; e < 2; ++e) for (let o = 0; o < 2; ++o) {\n    const d = (i.x + r[l] * n[0] - t.x) * s,\n      u = (i.y + r[e] * n[1] - t.y) * s,\n      c = i.z + r[o] * n[2] - t.z;\n    a = Math.max(d * d + u * u + c * c, a);\n  } else for (let l = 0; l < 2; ++l) for (let e = 0; e < 2; ++e) {\n    const o = (i.x + r[l] * n[0] - t.x) * s,\n      d = (i.y + r[e] * n[1] - t.y) * s;\n    a = Math.max(o * o + d * d, a);\n  }\n  return c([t.x, t.y, t.z], Math.sqrt(a));\n}\nasync function x(e, o, r, n) {\n  const {\n      transform: d,\n      vertexAttributes: u\n    } = o.loadedMesh,\n    c = \"source\" === e.shading ? u.normal : null;\n  if (!(null != c && null != d && (0 !== d.rotationAngle || !a(d.scale, l)))) return {\n    transformed: c,\n    original: u.normal\n  };\n  if (!o.normalsTransformPromise) {\n    t(r, \"SceneLayerWorker is needed to transform mesh normals\");\n    const e = i();\n    s(e, d.localMatrix), o.normalsTransformPromise = r.transformNormals({\n      normalMatrix: e,\n      normals: c\n    }, n);\n  }\n  return o.normalsTransformPromise;\n}\nfunction y(e, t, o, r, n, s) {\n  const i = 1,\n    a = t.length / 3,\n    l = 3 * a;\n  let d = 0,\n    u = 0,\n    c = !1,\n    m = 0,\n    h = !1,\n    f = 0,\n    p = !1,\n    x = 0,\n    y = 0,\n    M = 0;\n  d += S, d += S, u = d, d += 3 * l * _, null != o && (c = !0, m = d, d += 3 * l * _), null != r && (h = !0, f = d, d += 2 * l * _), null != n && (p = !0, x = d, d += 4 * l * w), y = d, d += i * b, M = d, d += 2 * i * S;\n  const N = new ArrayBuffer(d),\n    v = new Uint8Array(N);\n  g(v, 0, l), g(v, S, i);\n  const D = new Float32Array(N, u),\n    I = null != o ? new Float32Array(N, m) : null,\n    R = null != r ? new Float32Array(N, f) : null,\n    j = null != n ? new Uint8Array(N, x) : null;\n  for (let g = 0; g < a; ++g) {\n    const s = 3 * g;\n    for (let i = 0; i < 3; ++i) {\n      const a = t[s + i],\n        l = 3 * a,\n        d = 9 * g + 3 * i;\n      if (D[d] = e[l], D[d + 1] = e[l + 1], D[d + 2] = e[l + 2], null != I && (I[d] = o[l], I[d + 1] = o[l + 1], I[d + 2] = o[l + 2]), null != R) {\n        const e = 2 * a,\n          t = 6 * g + 2 * i;\n        R[t] = r[e], R[t + 1] = r[e + 1];\n      }\n      if (null != j) {\n        const e = 4 * a,\n          t = 12 * g + 4 * i;\n        j[t] = n[e], j[t + 1] = n[e + 1], j[t + 2] = n[e + 2], j[t + 3] = n[e + 3];\n      }\n    }\n  }\n  g(v, y, s), g(v, y + S, s / 2 ** 32), g(v, M, 0), g(v, M + S, a - 1);\n  return {\n    geometryBuffer: N,\n    geometryDescriptor: {\n      isDraco: !1,\n      isLegacy: !0,\n      color: p,\n      normal: c,\n      uv0: h,\n      uvRegion: !1,\n      featureIndex: !0\n    }\n  };\n}\nfunction g(e, t, o) {\n  e[t] = 255 & o, e[t + 1] = 255 & o >> 8, e[t + 2] = 255 & o >> 16, e[t + 3] = 255 & o >> 24;\n}\nfunction M(e) {\n  const t = e.metadata.displaySource?.source;\n  if (null == t || !Array.isArray(t) || !t.length || t[0] instanceof File) return n();\n  const o = t;\n  let r = \"\";\n  for (const n of o) r += n.makeHash();\n  return r + JSON.stringify(e.transform?.toJSON() ?? \"\") + (u(e.vertexSpace) ? JSON.stringify(e.vertexSpace.origin) : \"\") + JSON.stringify(e.spatialReference);\n}\nconst S = 4,\n  _ = 4,\n  w = 1,\n  b = 8;\nexport { h as I3SClientNodeLoader, p as createSphereFromExtent, _ as sizeOfFloat32, S as sizeOfInt32, b as sizeOfUInt64, w as sizeOfUInt8, x as transformNormals };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../../../chunks/tslib.es6.js\";\nimport s from \"../../../../core/Accessor.js\";\nimport { removeUnordered as t } from \"../../../../core/arrayUtils.js\";\nimport { makeHandle as e } from \"../../../../core/handleUtils.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/Logger.js\";\nimport { subclass as n } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { TaskPriority as i } from \"../../../support/Scheduler.js\";\nlet a = class extends s {\n  constructor() {\n    super(), this.referenceCount = 0, this.callbacks = new Array(), this.runIndex = 0;\n  }\n  get running() {\n    return this.callbacks.some(r => r.running);\n  }\n  runTask(r) {\n    this._sort();\n    const s = this.callbacks,\n      t = {\n        numIndexLoading: 0,\n        numNodesLoading: 0\n      };\n    for (let e = 0; e < s.length && !r.done; ++e) s[e].priority = s[e].runTask(r, t), this.runIndex = e;\n  }\n  _sort() {\n    const r = this.callbacks;\n    let s = r.length;\n    for (let t = this.runIndex; t > 0; t--) {\n      const e = r[t - 1];\n      let o = t;\n      for (; o < r.length && e.priority <= r[o].priority && (o !== s || e.priority < r[o].priority);) r[o - 1] = r[o], o++;\n      r[o - 1] = e, s = o - 1;\n    }\n    this.runIndex = 0;\n  }\n  add(r) {\n    this._sort(), r.priority = 1 / 0, this.callbacks.unshift(r), this.notifyChange(\"running\");\n  }\n  remove(r) {\n    t(this.callbacks, r), this.runIndex = this.callbacks.length, this._sort(), this.notifyChange(\"running\");\n  }\n};\nr([o({\n  readOnly: !0\n})], a.prototype, \"running\", null), a = r([n(\"esri.views.3d.layers.i3s.I3SFrameTask\")], a);\nclass l {\n  constructor(r, s) {\n    this.task = r, this.handle = s;\n  }\n}\nconst c = new Map();\nfunction h(r, s) {\n  let t = c.get(r);\n  if (null == t) {\n    const s = new a(),\n      e = r.registerTask(i.I3S_CONTROLLER, s);\n    t = new l(s, e), c.set(r, t);\n  }\n  return t.task.add(s), e(() => {\n    if (null == t) return;\n    t.task.remove(s);\n    t.task.callbacks.length > 0 || (c.delete(r), t.handle.remove(), t.task.destroy()), t = null;\n  });\n}\nexport { h as addCallback };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nclass s {\n  constructor(s, t, i, e, h, o, r, c) {\n    this.id = s, this.mbs = t, this.obb = i, this.version = e, this.resources = h, this.children = o, this.lodSelection = r, this.numFeatures = c;\n  }\n}\nexport { s as ValidatedNode };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport has from \"../../../../core/has.js\";\nimport e from \"../../../../core/PooledArray.js\";\nimport { isAbortError as t } from \"../../../../core/promiseUtils.js\";\nimport { projectBoundingSphere as i } from \"../../../../geometry/projection/projectBoundingSphere.js\";\nimport { k as n, a as s, u as o, c as r } from \"../../../../chunks/sphere.js\";\nimport { i3sPatchingEnabled as a } from \"../../../../support/featureFlags.js\";\nimport { LodMetric as l, NodeBase as d, Node as h, NodeFilterImpact as u, NodeIMModificationImpact as c, NodeTraversalState as g } from \"./I3SNode.js\";\nimport { invalidateMbs as _, addWraparound as f } from \"./I3SUtil.js\";\nimport { ValidatedNode as m } from \"./ValidatedNode.js\";\nimport { ElevationRange as v } from \"../../support/ElevationRange.js\";\nimport { Obb as p } from \"../../support/orientedBoundingBox.js\";\nclass N {\n  constructor(e, t, i, n, s) {\n    this.childOffset = e, this.childCount = t, this.visibilityCache = i, this.ref = n, this.node = s, this.useAsHole = 0, this.filterImpact = u.NotChecked, this.traversalState = null, this.parent = -1;\n  }\n  invalidateBounds() {\n    this.node?.invalidateServiceBVsInRenderSR(), this.ref?.invalidateServiceBVsInRenderSR();\n  }\n}\nclass b {\n  constructor(e = new Array(), t = new Array()) {\n    this.nodes = e, this.children = t, this.lastTraversed = 0, this.numNodesWithLoadedChildren = 0;\n  }\n}\nclass I {\n  get _useNodePages() {\n    return this._pageSize > 0;\n  }\n  constructor(t, i, n, s, o, r, d, h, u, c, g, _, f, m, v, p) {\n    this.viewingMode = t, this._layer = i, this._streamDataController = s, this._clientNodeLoader = o, this._viewportQueries = r, this._logger = d, this.holeFilling = h, this._isLoaded = u, this._isReloading = c, this._isSelected = g, this._enable = _, this._needsUpdate = f, this._canRequest = m, this._computeVisibilityObb = v, this._computeNodeFiltering = p, this._dirty = !0, this._nodePages = new Map(), this._clientNodePage = null, this._pageSize = 0, this._rootIndex = 0, this._lodMetric = l.None, this._lodConversion = e => e, this._isEditable = !1, this._urlPrefix = \"\", this._loadingNodes = new Set(), this._loadingPages = new Set(), this._failedNodes = new Set(), this._failedPages = new Set(), this._indexMissing = 1, this._maxUnloadedPrio = Number.NEGATIVE_INFINITY, this._maxProcessingPrio = Number.POSITIVE_INFINITY, this._version = R(0), this._visibilityCacheVersion = R(0), this._maxLevel = 1, this._featureEstimate = {\n      estimate: 0,\n      leavesReached: !1\n    }, this._unloadedMemoryEstimate = 0, this._missingPagesAndNodes = new e({\n      deallocator: null\n    }), this._prefetchNodes = new e({\n      deallocator: null\n    }), this._updates = new P(this._missingPagesAndNodes), this._imModificationUncategorized = new e({\n      deallocator: null\n    }), this.ignoreServiceObb = !1, this.progressiveLoadPenalty = 0, this._pageQueue = new Array(), this._newPages = new Array(), this.needNodeElevationRange = !1, this.layerHasModifications = !1, this._layerHasFilter = !1, this._frameNumber = 0, this._traverseDescendantsQueue = [0], this._traverseDescendantsNestingLevel = 0, this._isEditable = a() && null != i.associatedLayer?.infoFor3D, i.serviceUpdateTimeStamp?.lastUpdate && (this._lastUpdate = `${i.serviceUpdateTimeStamp.lastUpdate}`), this._maxLodLevel = this._viewportQueries ? this._viewportQueries.maxLodLevel : 1, this._init(n);\n  }\n  _init(e) {\n    if (\"page\" === e.type) {\n      const t = e.rootPage;\n      switch (this._urlPrefix = e.urlPrefix, this._pageSize = e.pageSize, e.lodMetric) {\n        case \"maxScreenThreshold\":\n          this._lodMetric = l.MaxScreenThreshold;\n          break;\n        case \"maxScreenThresholdSQ\":\n          this._lodMetric = l.MaxScreenThreshold, this._lodConversion = k;\n      }\n      if (this._isEditable) {\n        this._rootIndex = -1;\n        const i = M(e.rootIndex, e.pageSize),\n          n = t.nodes[i],\n          s = {\n            nodes: [{\n              index: this._rootIndex,\n              children: [e.rootIndex],\n              mesh: void 0,\n              obb: n.obb,\n              lodThreshold: n.lodThreshold\n            }]\n          };\n        this._addPage(E(this._rootIndex, this._pageSize), s), this.getNode(-1).serviceObbInIndexSR = void 0;\n      } else this._rootIndex = e.rootIndex;\n      this._addPage(E(e.rootIndex, this._pageSize), t), this._updateParentsAndLevel();\n    } else if (\"node\" === e.type) {\n      this._urlPrefix = e.urlPrefix;\n      const t = new b();\n      if (this._nodePages.set(0, t), this._isEditable) {\n        this._clientNodePage = new b();\n        const t = {\n          id: \"-1\",\n          version: null,\n          mbs: e.rootNode.mbs,\n          obb: e.rootNode.obb,\n          sharedResource: null,\n          geometryData: null,\n          attributeData: null,\n          featureData: null,\n          children: [{\n            id: \"root\",\n            href: \"../root\",\n            mbs: e.rootNode.mbs,\n            obb: e.rootNode.obb\n          }]\n        };\n        this._rootIndex = this._makeClientRefNode(new d(t.id, null), -1);\n        const i = this._validateNode(t.id, t);\n        i && this._addNode(i, this._rootIndex);\n      } else this._rootIndex = this._makeRefNode(new d(e.rootNode.id, null), -1);\n      const i = this._validateNode(e.rootNode.id, e.rootNode);\n      i && this._addNode(i, 0);\n    }\n  }\n  addClientNodeToIndex(e, t) {\n    const i = -1,\n      n = new d(e, t),\n      s = this._makeClientRefNode(n, i);\n    return this._linkChildToParentNode(i, s), this.requestUpdate(), s;\n  }\n  removeClientNodeFromIndex(e, t, i) {\n    this._destroyClientRefNode(e, t, i), this.requestUpdate();\n  }\n  _loadPage(e) {\n    this._loadingPages.add(e);\n    const i = this._urlPrefix + e;\n    this._streamDataController.request(i, \"json\").then(t => {\n      this._pageQueue.push({\n        pageIndex: e,\n        page: t\n      });\n    }).catch(i => {\n      this._loadingPages.delete(e), t(i) || (this._failedPages.add(e), this._logger.error(\"#loadPage()\", this._layer, `Error when loading page ${e}`, i));\n    });\n  }\n  _addQueuedPages(e) {\n    for (; this._pageQueue.length > 0 && !e.done;) {\n      const {\n        pageIndex: t,\n        page: i\n      } = this._pageQueue.shift();\n      this._addPage(t, i), this._loadingPages.delete(t), e.madeProgress(), this.needNodeElevationRange && this._newPages.push(t);\n    }\n    this._updateParentsAndLevel();\n  }\n  _invalidateElevationRangeForNewPages(e) {\n    if (this.needNodeElevationRange) for (; this._newPages.length > 0 && !e.done;) {\n      const e = this._nodePages.get(this._newPages.shift());\n      e?.nodes.forEach(e => {\n        let t = e.parent;\n        for (; null != t && t !== this._rootIndex;) {\n          const e = this.getNode(t);\n          e && !Number.isNaN(e?.elevationRangeMin) && (e.invalidateElevationRange(), this.invalidateBoundingVolumeCache(t)), t = this.getParentIndex(t);\n        }\n      });\n    }\n  }\n  _addPage(e, t) {\n    const i = [],\n      s = [],\n      o = t.nodes.map((t, o) => {\n        const r = i.length,\n          a = t.children ? t.children.length : 0;\n        s.push(this._rootIndex);\n        for (let e = 0; e < a; e++) i.push(t.children[e]);\n        const l = `${t.index}`,\n          d = p.fromJSON(t.obb),\n          u = n(d.center, d.radius),\n          c = t.mesh?.attribute,\n          g = t.mesh?.geometry,\n          _ = t.mesh?.material,\n          f = {\n            hasSharedResource: !1,\n            isEmpty: null == g,\n            attributes: null != c?.resource ? `${c.resource}` : void 0,\n            geometry: null != g?.resource ? `${g.resource}` : void 0,\n            texture: null != _?.resource ? `${_.resource}` : void 0,\n            geometryDefinition: g ? g.definition : -1,\n            materialDefinition: _ ? _.definition : -1\n          },\n          m = new h(l, V(o, e, this._pageSize), u, a, 0, f, this._lastUpdate, this._lodMetric, this._lodConversion(t.lodThreshold), g ? g.featureCount : null);\n        return m.serviceObbInIndexSR = d, m.visibilityObbInRenderSR = this._computeVisibilityObb(m), m.vertexCount = g ? g.vertexCount : 0, new N(r, a, x(this._visibilityCacheVersion), null, m);\n      }),\n      r = new b(o, i);\n    -1 === e ? this._clientNodePage = r : this._nodePages.set(e, r);\n  }\n  _updateParentsAndLevel() {\n    const e = new Array(),\n      t = (t, i, n) => {\n        const s = this._getPage(t);\n        if (null != s) {\n          const o = M(t, this._pageSize),\n            r = s.nodes[o];\n          r.parent = null != i ? i : -1;\n          const a = r.node;\n          null != a && (a.level = n, e.push(t));\n        }\n      };\n    for (t(this._rootIndex, null, 0); e.length;) {\n      const i = e.pop(),\n        n = this.getNode(i);\n      if (null != n) for (let e = 0; e < n.childCount; e++) {\n        t(this.getChildIndex(n.index, e), i, n.level + 1), this._maxLevel = Math.max(this._maxLevel, n.level + 1);\n      }\n    }\n  }\n  _getPage(e) {\n    const t = E(e, this._pageSize);\n    return this._getPageFromPageIndex(t);\n  }\n  _getPageFromPageIndex(e) {\n    return e < 0 ? this._clientNodePage : this._nodePages.get(e);\n  }\n  _getNodeInternal(e) {\n    const t = this._getPage(e);\n    return null == t ? null : (t.lastTraversed = this._frameNumber, t.nodes[M(e, this._pageSize)]);\n  }\n  _addNode(e, t) {\n    e.children && this.populateChildren(t, e.children);\n    const i = this.getParent(t),\n      n = null != i ? i.level + 1 : 0;\n    this._maxLevel = Math.max(this._maxLevel, e.children ? n + 1 : n);\n    const {\n        lodMetric: s,\n        maxError: o\n      } = A(e.lodSelection),\n      r = this._getNodeInternal(t),\n      a = new h(e.id, t, e.mbs, r.childCount, n, e.resources, e.version, s, o, e.numFeatures);\n    r.node = a, e.obb && (a.serviceObbInIndexSR = p.fromJSON(e.obb)), a.visibilityObbInRenderSR = this._computeVisibilityObb(a);\n    const l = r.ref;\n    return null != l && (null == l.serviceMbsInIndexSR && (l.serviceMbsInIndexSR = e.mbs), a.shareServiceBVsInRenderSRWith(l), l.visibilityObbInRenderSR = a.visibilityObbInRenderSR), a;\n  }\n  _makeRefNode(e, t) {\n    const i = this._nodePages.get(0);\n    if (t < -1) return this._makeClientRefNode(e, t);\n    if (null == i) return -1;\n    const n = i.nodes.length,\n      s = new N(0, 0, x(this._visibilityCacheVersion), e, null);\n    return i.nodes.push(s), s.parent = t, e.invalidateServiceBVsInRenderSR(), n;\n  }\n  _makeClientRefNode(e, t) {\n    const i = this._clientNodePage;\n    if (null == i) return -1;\n    if (t >= 0) throw new Error(\"I3SIndex::client side nodes can not be made children of service side nodes.\");\n    const n = -(i.nodes.length + 1),\n      s = new N(0, 0, x(this._visibilityCacheVersion), e, null);\n    return i.nodes.push(s), s.parent = t, e.invalidateServiceBVsInRenderSR(), n;\n  }\n  _linkChildToParentNode(e, t) {\n    const i = this._clientNodePage;\n    if (null == i || e >= 0) return;\n    const n = M(e, this._pageSize),\n      s = M(t, this._pageSize),\n      o = i.nodes[n],\n      r = o.childOffset;\n    i.children.splice(o.childOffset + o.childCount, 0, t);\n    const a = 1;\n    o.childCount += a, null != o.node && (o.node.childCount += a);\n    for (const l of i.nodes) l.childOffset > r && (l.childOffset += a);\n    i.nodes[s].parent = e, this._updateParentBoundingInformation(e);\n  }\n  _destroyClientRefNode(e, t, i) {\n    const n = this._clientNodePage;\n    if (null == n) return;\n    const s = this.getParentIndex(e);\n    if (null == s) return;\n    const o = new Set(),\n      r = new Map(),\n      a = e => {\n        const i = M(e, this._pageSize),\n          s = n.nodes[i];\n        if (s.childCount > 0) for (let t = s.childOffset; t < s.childOffset + s.childCount; ++t) a(n.children[t]);\n        const r = s.node?.id ?? s.ref?.id;\n        if (null == r) throw new Error(\"Node has no id\");\n        t(r, e), o.add(s);\n      };\n    a(e);\n    const l = n.nodes,\n      d = n.children,\n      h = n.nodes.map(() => -1),\n      u = [],\n      c = [];\n    for (let g = 0; g < l.length; ++g) {\n      const e = l[g];\n      if (o.has(e)) continue;\n      const t = u.length,\n        n = V(g, -1, this._pageSize),\n        s = V(t, -1, this._pageSize);\n      if (e.node && (e.node.index = s), h[g] = s, u.push(e), n !== s) {\n        const t = e.node?.id ?? e.ref?.id;\n        if (null == t) throw new Error(\"Node has no id\");\n        i(t, n, s), r.set(n, s);\n      }\n    }\n    for (let g = 0; g < u.length; ++g) {\n      const e = V(g, -1, this._pageSize),\n        t = u[g],\n        i = c.length;\n      for (let n = t.childOffset; n < t.childOffset + t.childCount; ++n) {\n        const t = d[n];\n        if (t >= 0) c.push(t);else {\n          const i = M(t, this._pageSize),\n            n = l[i];\n          if (o.has(n)) continue;\n          const s = h[i];\n          c.push(s), n.parent = e;\n        }\n      }\n      t.childOffset = i, t.childCount = c.length - i, t.node && (t.node.childCount = t.childCount);\n    }\n    n.nodes = u, n.children = c, this._updateParentBoundingInformation(h[M(s, this._pageSize)]);\n  }\n  _updateParentBoundingInformation(e) {\n    let t = e;\n    do {\n      let e = null;\n      const n = this._clientNodeLoader.indexSR,\n        a = this._clientNodeLoader.renderSR,\n        l = this._getNodeInternal(t);\n      if (null == l) return;\n      for (let r = 0; r < l.childCount; r++) {\n        const l = this.getChildIndex(t, r),\n          d = this._getNodeInternal(l),\n          h = null != d ? d.ref || d.node : null;\n        if (null != h && h.serviceMbsInIndexSR[3] > 0) if (null == e) e = s(h.serviceMbsInIndexSR, D);else {\n          const t = F,\n            s = z,\n            r = T;\n          i(h.serviceMbsInIndexSR, n, t, a), i(e, n, s, a), o(t, s, r), i(r, a, e, n);\n        }\n      }\n      const d = l.ref || l.node;\n      null != d && (null != e ? (d.serviceMbsInIndexSR ??= r(), s(e, d.serviceMbsInIndexSR)) : _(d.serviceMbsInIndexSR), d.invalidateServiceBVsInRenderSR(), d.geometryObbInRenderSR = null), this.invalidateNodeVisibilityCacheInternal(l), t = this.getParentIndex(t);\n    } while (null != t);\n  }\n  populateChildren(e, t) {\n    const i = this._getNodeInternal(e),\n      n = this._getPage(e);\n    i.childOffset = n.children.length, i.childCount = t.length;\n    for (let s = 0; s < t.length; s++) {\n      const i = this._makeRefNode(t[s], e);\n      n.children.push(i);\n    }\n  }\n  getNode(e) {\n    const t = this._getNodeInternal(e);\n    return null != t ? t.node : null;\n  }\n  getIndexById(e) {\n    let t;\n    return this._forAllNodes((i, n) => {\n      (null != i.node && i.node.id === e || null != i.ref && i.ref.id === e) && (t = n);\n    }), t;\n  }\n  getNodeById(e) {\n    const t = this.getIndexById(e);\n    return null != t && t >= 0 ? this.getNode(t) : null;\n  }\n  getChildIndex(e, t) {\n    const i = this._getPage(e);\n    if (null == i) return -1;\n    const n = i.nodes[M(e, this._pageSize)];\n    return i.children[n.childOffset + t];\n  }\n  getParentIndex(e) {\n    const t = this._getPage(e);\n    return null != t && e !== this._rootIndex ? t.nodes[M(e, this._pageSize)].parent : null;\n  }\n  getParent(e) {\n    const t = this.getParentIndex(e);\n    return null != t ? this.getNode(t) : null;\n  }\n  isLeaf(e) {\n    const t = this._getNodeInternal(e);\n    return null != t && 0 === t.childCount;\n  }\n  get rootNode() {\n    return this.getNode(this._rootIndex);\n  }\n  get isEditable() {\n    return this._isEditable;\n  }\n  removeAllGeometryObbs() {\n    this._forAllNodes(e => {\n      null != e.node && (e.node.geometryObbInRenderSR = null);\n    });\n  }\n  invalidateVisibilityCache() {\n    this._visibilityCacheVersion = R(this._visibilityCacheVersion);\n  }\n  invalidateNodeVisibilityCache(e) {\n    const t = this._getNodeInternal(e);\n    null != t && this.invalidateNodeVisibilityCacheInternal(t);\n  }\n  invalidateNodeVisibilityCacheInternal(e) {\n    e.visibilityCache = x(this._visibilityCacheVersion);\n  }\n  invalidateBoundingVolumeCache(e) {\n    const t = this._getNodeInternal(e);\n    null != t && (t?.invalidateBounds(), this.invalidateNodeVisibilityCacheInternal(t));\n  }\n  updateElevationChanged(e) {\n    const t = this._getNodeInternal(e);\n    if (null == t) return;\n    if (!this.needNodeElevationRange) return void this.invalidateBoundingVolumeCache(e);\n    const i = null != t.node ? t.node : t.ref;\n    null != i && i.invalidateElevationRange();\n  }\n  invalidateGeometryVisibility(e) {\n    const t = this._getNodeInternal(e),\n      i = t?.node;\n    i && (i.geometryObbInRenderSR = null, i.invalidateServiceBVsInRenderSR());\n  }\n  invalidateVisibilityObbs() {\n    null != this.rootNode && this.traverse(this.rootNode, e => (e.visibilityObbInRenderSR = this._computeVisibilityObb(e), e.geometryObbInRenderSR = null, !0));\n  }\n  _isElevationRangeUpToDate(e) {\n    if (!this.needNodeElevationRange) return !0;\n    const t = e?.node ?? e?.ref;\n    return !t || t.elevationRangeValid;\n  }\n  updateElevationRange(e) {\n    this._updateElevationRangeInternal(e, null);\n  }\n  _updateElevationRangeInternal(e, t) {\n    const i = this._getNodeInternal(e);\n    if (!i) return !1;\n    const n = i?.node ?? i?.ref;\n    if (!n) return !1;\n    if (n.elevationRangeValid) return t?.expandElevationRange(n), !0;\n    const s = new v();\n    let o = !1;\n    for (let l = 0; l < i.childCount; l++) {\n      const t = this.getChildIndex(e, l),\n        i = this._updateElevationRangeInternal(t, s);\n      o = o || !i;\n    }\n    if (0 === i.childCount || o) {\n      const e = !i.node?.resources.isEmpty;\n      this._viewportQueries.expandElevationRange(n, e, s);\n    }\n    const r = n.elevationRangeMin,\n      a = n.elevationRangeMax;\n    return r === s.elevationRangeMin && a === s.elevationRangeMax ? (t?.expandElevationRange(n), !0) : (i.node?.setElevationRange(s), i.ref?.setElevationRange(s), this.invalidateBoundingVolumeCache(e), t?.expandElevationRange(n), !0);\n  }\n  isNodeVisible(e) {\n    const t = this._getNodeInternal(e);\n    if (null == t) return !0;\n    const i = t.ref;\n    if (null != i && !i.serviceMbsInIndexSR) return !0;\n    if (this._isElevationRangeUpToDate(t) && C(t.visibilityCache, this._visibilityCacheVersion)) return w(t.visibilityCache);\n    const n = t.node,\n      s = this._viewportQueries;\n    if (n) {\n      const e = s.ensureElevationAgnosticBoundingVolume(n),\n        i = s.isElevationAgnosticBoundingVolumeVisible(e);\n      let o = i;\n      if (this.needNodeElevationRange && i) {\n        const t = s.getNodeObbInRenderSRIndependentOfElevationOffset(n);\n        null != t && (o = s.isObbVisibleIndependentOfElevation(e, t));\n      }\n      if (!o) return t.visibilityCache = S(!1, this._visibilityCacheVersion), !1;\n    }\n    if (this._layerHasFilter && this._computeNodeFiltering && (null != n || null != i) && t.filterImpact === u.NotChecked) {\n      const e = null != n ? n.serviceMbsInIndexSR : null != i ? i.serviceMbsInIndexSR : null;\n      t.filterImpact = null != e ? this._computeNodeFiltering(e) : u.Unmodified;\n    }\n    const o = null != n && t.filterImpact === u.Culled;\n    let r = !(null != n && n.imModificationImpact === c.Culled) && !o;\n    if (r) {\n      const t = !n || i && !n.visibilityObbInRenderSR ? i ?? null : n;\n      if (null != t) {\n        this.needNodeElevationRange && this.updateElevationRange(e);\n        r = s.isNodeVisible(t);\n      }\n    }\n    return t.visibilityCache = S(r, this._visibilityCacheVersion), r;\n  }\n  isGeometryVisible(e) {\n    if (!this.isNodeVisible(e)) return !1;\n    const t = this._getNodeInternal(e);\n    return !!(null == t?.node?.geometryObbInRenderSR || this.layerHasModifications && t.node.imModificationImpact === c.NotChecked) || this._viewportQueries.isGeometryVisible(t.node);\n  }\n  _traverseCoverage(e, t, i, n, s) {\n    const o = this._getPage(e);\n    if (null == o || 0 === t.childCount) return;\n    const r = t.childOffset + t.childCount,\n      a = new Array();\n    for (let l = t.childOffset; l < r; ++l) {\n      const e = o.children[l],\n        t = this._getNodeInternal(e);\n      null != t?.node && this.isGeometryVisible(e) && a.push(t);\n    }\n    n /= a.length;\n    for (const l of a) {\n      const e = l.node.index;\n      this._isLoaded(e) || this._isReloading(e) ? (s.delta = Math.max(s.delta, i), s.coverage += n) : this._traverseCoverage(e, l, i + 1, n, s);\n    }\n  }\n  useNodeAsHole(e) {\n    if (\"off\" === this.holeFilling) return !1;\n    const t = this._getNodeInternal(e);\n    if (null == t) return !1;\n    if (\"always\" === this.holeFilling) return !0;\n    if (C(t.useAsHole, this._version)) return w(t.useAsHole);\n    const i = {\n      delta: 0,\n      coverage: 0\n    };\n    this._traverseCoverage(e, t, 0, 1, i);\n    const n = i.delta * i.coverage <= .5;\n    return t.useAsHole = S(n, this._version), n;\n  }\n  get maxLevel() {\n    return this._maxLevel;\n  }\n  get dirty() {\n    return this._dirty;\n  }\n  destroy() {\n    this._updates.add.prune(), this._updates.update.prune();\n  }\n  requestUpdate() {\n    this._dirty = !0, this._indexMissing = 1, this._version = R(this._version);\n  }\n  imModificationsChanged(e) {\n    this.layerHasModifications = e, this._forAllNodes(({\n      node: e\n    }) => {\n      null != e && (e.imModificationImpact = c.NotChecked, e.visibilityObbInRenderSR = this._computeVisibilityObb(e), e.hasModifications && this.invalidateGeometryVisibility(e.index));\n    }), this.invalidateVisibilityCache();\n  }\n  layerFilterChanged(e) {\n    this._layerHasFilter = e, this._forAllNodes(e => {\n      if (null != e) {\n        e.filterImpact = u.NotChecked;\n        const t = e.node;\n        null != t && this.invalidateNodeVisibilityCache(t.index);\n      }\n    }), this.invalidateVisibilityCache();\n  }\n  update(e, t, i) {\n    if (!this._dirty) return;\n    this._pageQueue.length > 0 && this._addQueuedPages(t), this._invalidateElevationRangeForNewPages(t), this._maxUnloadedPrio = Number.NEGATIVE_INFINITY, this._maxProcessingPrio = Number.NEGATIVE_INFINITY, this._missingPagesAndNodes.clear(), this._prefetchNodes.clear(), this._updates.reset(e), y.clear();\n    let n = !0;\n    const s = new L(),\n      o = new L(),\n      r = this._imModificationUncategorized;\n    r.clear();\n    const a = new Set();\n    let l = 0;\n    const d = (a, d, h) => {\n      const u = E(a, this._pageSize);\n      if (null == d) {\n        let e = this._entryPriority(a);\n        return e === 1 / 0 && (e = this._entryPriority(h)), y.set(u, Math.max(e, y.get(u) || 0)), this._loadingPages.has(u) || this._failedPages.has(u) || (this._missingPagesAndNodes.push(u), ++l), void (this._maxProcessingPrio = Math.max(this._maxProcessingPrio, e));\n      }\n      const g = d.node;\n      if (this._updateNodeFeatureEstimate(g, o), null == g) {\n        const e = this._entryPriority(a);\n        return this._loadingNodes.has(a) || this._failedNodes.has(a) || (this._missingPagesAndNodes.push(a), y.set(a, e)), void (this._maxProcessingPrio = Math.max(this._maxProcessingPrio, e));\n      }\n      const _ = this._getPage(a);\n      if (0 === this._missingPagesAndNodes.length && !this._useNodePages) for (let e = 0; e < d.childCount; e++) {\n        const t = _.children[d.childOffset + e],\n          i = this._getNodeInternal(t);\n        null == i || i.node || this._loadingNodes.has(t) || this._failedNodes.has(t) || (y.set(t, this._entryPriority(t)), this._prefetchNodes.push(t));\n      }\n      if (g.failed || g.resources.isEmpty) return void (n && d.childCount > 0 && this._isSelected(g) && (n = !1));\n      if (this._isLoaded(a)) {\n        if (s.known += g.memory, ++s.knownNodes, this._isSelected(g) ? d.childCount > 0 && (n = !1) : (s.unremoved += g.memory, n = !1), this._needsUpdate(g)) {\n          const e = this._entryPriority(a);\n          y.set(a, e), this._maxProcessingPrio = Math.max(this._maxProcessingPrio, e), this._updates.update.push(a);\n        }\n        return;\n      }\n      if (g.memory && (s.known += g.memory, ++s.knownNodes), !this._isSelected(g)) return void (this._isReloading(a) && this._updates.remove.push(a));\n      if (d.childCount > 0 && (n = !1), g.memory ? (s.missing += g.memory, s.known += g.memory, ++s.knownNodes) : ++s.missingNodes, e.includes(g.index)) return this._maxProcessingPrio = Math.max(this._maxProcessingPrio, this._entryPriority(a)), void (this._updates.cancel = this._updates.cancel.filter(e => e !== g.index));\n      if (!t.done && this._enable(g)) return void t.madeProgress();\n      const f = this._entryPriority(a);\n      y.set(a, f), this._maxProcessingPrio = Math.max(this._maxProcessingPrio, f), this._updates.add.push(a), this.layerHasModifications && i && null != g && g.imModificationImpact === c.NotChecked && r.push(a);\n    };\n    this.traverseVisible(d, a), this._frameNumber++, this._missingPagesAndNodes.sort((e, t) => e - t), this._missingPagesAndNodes.filterInPlace((e, t) => t < 1 || this._missingPagesAndNodes.data[t - 1] !== e), this._missingPagesAndNodes.sort((e, t) => y.get(e) - y.get(t)), this._missingPagesAndNodes.length > 0 && (this._maxUnloadedPrio = y.get(this._missingPagesAndNodes.back()), this._prefetchNodes.clear()), this._removeUnusedNodePages(a, l);\n    const h = this._updates.add;\n    h.length > 0 && this.layerHasModifications && (r.length > 0 && i?.(r), h.filterInPlace(e => {\n      const t = this._getNodeInternal(e),\n        i = null == t?.node || t.node.imModificationImpact !== c.Culled;\n      return i || this.invalidateNodeVisibilityCache(e), i;\n    })), this._unloadedMemoryEstimate = s.missing - s.unremoved, s.knownNodes > 3 && s.missingNodes > 0 && (this._unloadedMemoryEstimate += s.known / s.knownNodes * s.missingNodes), this._unloadedMemoryEstimate = .8 * Math.max(0, this._unloadedMemoryEstimate), this._featureEstimate.estimate = this._computeFeatureEstimate(o), this._featureEstimate.leavesReached = n, this._updates.add.filterInPlace(e => y.get(e) >= this._maxUnloadedPrio).sort((e, t) => y.get(e) - y.get(t)), this._updates.update.sort((e, t) => y.get(e) - y.get(t)), this._indexMissing = this._loadingPages.size + this._loadingNodes.size + this._missingPagesAndNodes.length, this._dirty = this._indexMissing > 0, y.clear();\n  }\n  checkFeatureTarget(e, t) {\n    const i = this._viewportQueries.updateScreenSpaceErrorBias(t);\n    let n = t,\n      s = t,\n      o = i,\n      r = 10;\n    for (; r--;) {\n      const i = new L();\n      this._updateFeatureEstimate(n, i);\n      if (this._computeFeatureEstimate(i) <= e) {\n        if (n >= t || i.missingNodes > 0 || 0 === r) break;\n        o = n, n = .5 * (n + s);\n      } else s = n, n = .5 * (n + o);\n    }\n    return this._version = R(this._version), this._viewportQueries.updateScreenSpaceErrorBias(i), Math.min(t, n);\n  }\n  _removeUnusedNodePages(e, t) {\n    if (!this._useNodePages) return;\n    const i = e.size,\n      n = this._nodePages,\n      s = n.size + this._loadingPages.size + t;\n    if (s > B && s > i) {\n      const t = new Array();\n      for (const [i, s] of n) 0 !== s.numNodesWithLoadedChildren || e.has(i) || t.push([s.lastTraversed, i]);\n      t.sort((e, t) => e[0] - t[0]).some(e => {\n        const t = e[1];\n        return this._deleteNodePage(t), n.size <= B;\n      });\n    }\n  }\n  _updateFeatureEstimate(e, t) {\n    this._version = R(this._version), this._viewportQueries.updateScreenSpaceErrorBias(e), this.traverseVisible((e, i) => this._updateNodeFeatureEstimate(null != i ? i.node : void 0, t));\n  }\n  _updateNodeFeatureEstimate(e, t) {\n    null == e || e.failed || null == e.numFeatures || this._isSelected(e) && (null != e.numFeatures ? (t.missing += e.numFeatures, t.known += e.numFeatures, ++t.knownNodes) : ++t.missingNodes);\n  }\n  _computeFeatureEstimate(e) {\n    let t = e.known - e.unremoved;\n    return e.knownNodes > 3 && e.missingNodes > 0 && (t += e.known / e.knownNodes * e.missingNodes), Math.max(0, t);\n  }\n  load() {\n    return this._load(this._missingPagesAndNodes);\n  }\n  prefetch() {\n    return this._prefetchNodes.sort((e, t) => y.get(e) - y.get(t)), this._load(this._prefetchNodes);\n  }\n  _load(e) {\n    if (0 === e.length || !this._canRequest()) return !1;\n    for (; e.length > 0 && this._canRequest();) {\n      const t = e.pop();\n      this._useNodePages && t >= 0 ? this._loadPage(t) : this._loadNode(t);\n    }\n    return !0;\n  }\n  get isLoading() {\n    return this._indexMissing > 0;\n  }\n  get isPrefetching() {\n    return this._prefetchNodes.length > 0;\n  }\n  get indexLoading() {\n    return this._loadingPages.size + this._loadingNodes.size;\n  }\n  get indexMissing() {\n    return this._indexMissing;\n  }\n  get unloadedMemoryEstimate() {\n    return this._unloadedMemoryEstimate;\n  }\n  get updates() {\n    return this._updates;\n  }\n  get featureEstimate() {\n    return this._featureEstimate;\n  }\n  get maxPriority() {\n    return Math.max(this._maxProcessingPrio, this._maxUnloadedPrio);\n  }\n  nodeTraversalState(e) {\n    if (null == e) return null;\n    const t = e.index,\n      i = this._getNodeInternal(t);\n    if (!i) return null;\n    let n = i?.traversalState;\n    if (n && C(n.version, this._version)) return n;\n    const s = this._viewportQueries.getLodLevel(e),\n      o = this._viewportQueries.hasLOD(e);\n    let r = !0;\n    if (o) {\n      const e = this.getParentIndex(t);\n      if (null != e) {\n        const t = this._getNodeInternal(e),\n          i = t?.traversalState;\n        r = !!i && s > i.lodLevel;\n      } else r = s > 0;\n    } else r = 0 === e.childCount;\n    return n ? (n.lodLevel = s, n.isChosen = r, n.version = S(!0, this._version), n) : (n = new g(o, r, s, S(!0, this._version)), i.traversalState = n, n);\n  }\n  async _loadNode(e) {\n    this._loadingNodes.add(e);\n    const i = this._getNodeInternal(e).ref;\n    if (null == i) return void this._failedNodes.add(e);\n    const n = i.id,\n      s = this._urlPrefix + n,\n      o = () => {\n        this._loadingNodes.delete(e), 0 === this._missingPagesAndNodes.length && 0 === this._loadingNodes.size && this.requestUpdate();\n      };\n    let r = null;\n    try {\n      r = e >= 0 ? await this._streamDataController.request(s, \"json\") : await this._clientNodeLoader.loadNodeJSON(n);\n    } catch (d) {\n      return o(), void (t(d) || (this._logger.error(\"#loadNode()\", this._layer, \"Error loading node: \" + s), this._failedNodes.add(e)));\n    }\n    o();\n    const a = this._validateNode(n, r);\n    if (null == a) return;\n    a.obb && this.invalidateNodeVisibilityCache(e);\n    const l = this._addNode(a, e);\n    this.nodeTraversalState(l);\n  }\n  _validateNode(e, t) {\n    if (null == t || \"object\" != typeof t || t.id !== e) return this._logger.error(\"#validateNode()\", this._layer, `Invalid node. Wrong type or wrong id \"${e}\"`), null;\n    if (!Array.isArray(t.mbs)) return this._logger.error(\"#validateNode()\", this._layer, `Invalid bounding volume on node ${e}.`), null;\n    t.sharedResource && \"./shared\" !== t.sharedResource.href && \"./shared/\" !== t.sharedResource.href && this._logger.warn(\"#validateNode()\", this._layer, `Invalid shared resource href on node \"${e}\"`);\n    const i = t.geometryData;\n    null == i || Array.isArray(i) && 0 === i.length || Array.isArray(i) && 1 === i.length && \"./geometries/0\" === i[0].href || this._logger.warn(\"#validateNode()\", this._layer, `Invalid geometry data on node \"${e}\"`);\n    const n = t.attributeData,\n      s = this._layer.attributeStorageInfo;\n    null == n || Array.isArray(n) && !n.some((e, t) => e.href !== `./attributes/${s?.[t]?.key ?? `f_${t}`}/0`) || this._logger.warn(\"#validateNode()\", this._layer, `Invalid attribute data on node \"${e}\"`), t.featureData && t.featureData.length > 1 && this._logger.warn(\"#validateNode()\", this._layer, `Node ${e} has ${t.featureData.length} bundles. Only the first bundle will be loaded.`);\n    const o = t.hasOwnProperty(\"obb\") && !this.ignoreServiceObb ? t.obb : void 0,\n      r = t.featureData && 1 === t.featureData.length && t.featureData[0].featureRange ? t.featureData[0].featureRange[1] - t.featureData[0].featureRange[0] + 1 : void 0,\n      a = t => {\n        if (null == t) return null;\n        const i = t => this._logger.error(\"#validateNode()\", this._layer, `Invalid node reference on node ${e}: ${t}`);\n        if (\"number\" == typeof t.id) i(`id ${t.id} is a number instead of a string.`);else if (\"string\" != typeof t.id || !Array.isArray(t.mbs)) return i(\"Missing or invalid id.\"), null;\n        if (!Array.isArray(t.mbs)) return i(`Invalid bounding volume on reference ${t.id}.`), null;\n        t.href && t.href !== \"../\" + t.id && this._logger.error(\"#validateNode()\", this._layer, `Invalid node href on node \"${e}\"`);\n        const n = new d(`${t.id}`, t.mbs);\n        return n.serviceObbInIndexSR = !this.ignoreServiceObb && t.hasOwnProperty(\"obb\") && t.obb ? p.fromJSON(t.obb) : null, n.visibilityObbInRenderSR = this._computeVisibilityObb(n), n;\n      },\n      l = Array.isArray(t.children) ? t.children.map(a).filter(e => null != e) : null,\n      h = t.featureData?.length ?? !1,\n      u = !0 === t.isEmpty;\n    return new m(e, t.mbs, o, \"string\" == typeof t.version ? t.version : null, {\n      isEmpty: !h && u,\n      hasSharedResource: null != t.sharedResource,\n      attributes: t.attributeData ? e : void 0,\n      texture: t.textureData && t.textureData.length > 0 ? e : void 0,\n      geometry: null != t.geometryData ? e : void 0\n    }, l, Array.isArray(t.lodSelection) ? t.lodSelection : null, r);\n  }\n  resetFailedNodes() {\n    this._failedNodes.clear(), this._failedPages.clear(), this._forAllNodes(e => {\n      null != e.node && (e.node.failed = !1);\n    });\n  }\n  _entryPriority(e) {\n    const t = this._getNodeInternal(e),\n      i = this.getParentIndex(e);\n    if (null == t || null == i && null == t.node) return null == i ? 1 / 0 : this._entryPriority(i);\n    let n = 0;\n    if (t.node && null != i) {\n      const e = this._getNodeInternal(i).traversalState;\n      null != e && (n = e.lodLevel);\n    }\n    let s = this.progressiveLoadPenalty;\n    for (let r = e; null != r; r = this.getParentIndex(r)) if (this._isLoaded(r)) {\n      s = 0;\n      break;\n    }\n    const o = null != t.ref ? this._viewportQueries.distToPOI(t.ref) : null != t.node ? this._viewportQueries.distToPOI(t.node) : 0;\n    return -o - n * (o + this.progressiveLoadPenalty) + s;\n  }\n  traverseVisible(e, t) {\n    const i = this._getNodeInternal(this._rootIndex);\n    null != i ? this._traverseVisible(this._rootIndex, null, i, e, t) : e(this._rootIndex, null, null);\n  }\n  _traverseVisible(e, t, i, n, s) {\n    const o = E(e, this._pageSize);\n    if (s && s.add(o), i.node && 0 === i.childCount) return void (this.isGeometryVisible(e) && n(e, i, t));\n    if (!this.isNodeVisible(e)) return;\n    if (n(e, i, t), null == i.node) return;\n    const r = this.nodeTraversalState(i.node);\n    if (r?.nodeHasLOD && r.lodLevel === this._maxLodLevel) return;\n    const a = this._getPageFromPageIndex(o);\n    for (let l = 0; l < i.childCount; l++) {\n      const t = a.children[i.childOffset + l],\n        o = this._getNodeInternal(t);\n      if (o) this._traverseVisible(t, e, o, n, s);else {\n        if (s) {\n          const e = E(t, this._pageSize);\n          s.add(e);\n        }\n        n(t, null, e);\n      }\n    }\n  }\n  traverse(e, t) {\n    t(e) && this.traverseDescendants(e, t);\n  }\n  traverseDescendants(e, t) {\n    ++this._traverseDescendantsNestingLevel;\n    const i = e.index,\n      n = this._pageSize,\n      s = E(i, n),\n      o = this._getPageFromPageIndex(s);\n    if (null == o) return;\n    const r = this._frameNumber,\n      a = this._nodePages;\n    o.lastTraversed = r;\n    const l = M(i, n),\n      d = o.nodes[l],\n      {\n        childCount: h\n      } = d;\n    if (0 === h) return;\n    const u = 1 === this._traverseDescendantsNestingLevel ? this._traverseDescendantsQueue : [0];\n    let c = 0;\n    const g = [];\n    {\n      const {\n          childOffset: e,\n          childCount: t\n        } = d,\n        {\n          children: i\n        } = o;\n      u.length = 2 ** Math.ceil(Math.log2(c + t));\n      for (let n = e; n < e + t; ++n) {\n        const e = i[n];\n        e >= 0 ? (u[c] = e, ++c) : g.push(e);\n      }\n    }\n    if (g.length > 0) {\n      const e = this._clientNodePage;\n      if (e) {\n        const i = e.children;\n        let n = 0;\n        for (; n < g.length;) {\n          const s = g[n];\n          ++n;\n          const o = -s - 1,\n            r = e.nodes[o],\n            a = r.node;\n          if (!a) continue;\n          if (!t(a)) continue;\n          const {\n            childCount: l\n          } = r;\n          if (0 === l) continue;\n          const {\n              childOffset: d\n            } = r,\n            h = d + l;\n          for (let e = d; e < h; ++e) g.push(i[e]);\n        }\n      }\n    }\n    if (c > 0) {\n      let e = 0;\n      if (n > 0) {\n        let i = s * n,\n          l = o,\n          d = l.nodes;\n        for (; e < c;) {\n          const s = u[e];\n          let o;\n          if (++e, i <= s && s < i + n) o = l;else {\n            const e = s / n | 0,\n              t = a.get(e);\n            if (void 0 === t) continue;\n            o = t, o.lastTraversed = r, l = o, d = l.nodes, i = n * e;\n          }\n          const h = d[s - i],\n            g = h.node;\n          if (null == g) continue;\n          if (!1 === t(g)) continue;\n          const {\n            childCount: _\n          } = h;\n          if (0 === _) continue;\n          const f = c + _;\n          for (u.length < f && (u.length = 2 ** Math.ceil(Math.log2(c + _))); u.length < c + _;) u.length += u.length;\n          const m = o.children,\n            {\n              childOffset: v\n            } = h,\n            p = v + _;\n          for (let e = v; e < p; ++e) u[c] = m[e], ++c;\n        }\n      } else {\n        const i = a.get(0);\n        if (i) for (; e < c;) {\n          const n = u[e];\n          ++e;\n          const s = i.nodes[n],\n            o = s.node;\n          if (!o) continue;\n          if (!t(o)) continue;\n          const {\n            childCount: r\n          } = s;\n          if (0 === r) continue;\n          u.length = Math.max(u.length, 2 ** Math.ceil(Math.log2(c + r)));\n          const a = i.children,\n            {\n              childOffset: l\n            } = s,\n            d = l + r;\n          for (let e = l; e < d; ++e) u[c] = a[e], ++c;\n        }\n      }\n    }\n    --this._traverseDescendantsNestingLevel;\n  }\n  updateChildrenLoaded(e, t) {\n    let i = this.getNode(e);\n    for (; null != i;) {\n      const e = i.childrenLoaded,\n        n = e + t;\n      i.childrenLoaded = n;\n      const s = 0 === e ? 1 : 0 === n ? -1 : 0,\n        o = i.index;\n      if (0 !== s) {\n        this._getPage(o).numNodesWithLoadedChildren += s;\n      }\n      i = this.getParent(o);\n    }\n  }\n  checkChildrenLoadedInvariant() {\n    if (null == this.rootNode) return !0;\n    const e = [],\n      t = i => {\n        let n = this._isLoaded(i.index) || this._isReloading(i.index) ? 1 : 0;\n        return this.traverseDescendants(i, e => (n += t(e), !1)), i.childrenLoaded !== n && e.push(i.index), n;\n      };\n    return t(this.rootNode), e.length && this._logger.error(\"childrenLoaded invariant broken at following nodes: \" + e.join(\",\")), e.length > 0;\n  }\n  updateElevationInfo(e, t) {\n    this.needNodeElevationRange = t && !!e && (\"relative-to-ground\" === e.mode || \"relative-to-scene\" === e.mode || \"on-the-ground\" === e.mode), this._viewportQueries.updateElevationInfo(e), this.invalidateAllElevationRanges();\n  }\n  invalidateAllElevationRanges() {\n    this._forAllNodes(e => {\n      e?.invalidateBounds(), e.node?.invalidateElevationRange(), e.ref?.invalidateElevationRange();\n    });\n  }\n  _forAllNodes(e) {\n    if (null != this._clientNodePage) {\n      const t = this._clientNodePage;\n      for (let i = 0; i < t.nodes.length; i++) e(t.nodes[i], -(i + 1));\n    }\n    for (const [t, i] of this._nodePages) {\n      const n = t * this._pageSize;\n      for (let t = 0; t < i.nodes.length; t++) e(i.nodes[t], n + t);\n    }\n  }\n  clearCaches() {\n    if (this._useNodePages) {\n      const e = this._nodePages,\n        t = new Set();\n      this.traverseVisible(e => t.add(E(e, this._pageSize)));\n      for (const [i, n] of e) if (0 !== n.numNodesWithLoadedChildren || t.has(i)) for (const e of n.nodes) e.traversalState = null;else this._deleteNodePage(i);\n    }\n  }\n  _deleteNodePage(e) {\n    this._nodePages.delete(e);\n  }\n  get test() {}\n}\nconst y = new Map();\nclass P {\n  constructor(t) {\n    this.missing = t, this.update = new e({\n      deallocator: null\n    }), this.add = new e({\n      deallocator: null\n    }), this.remove = new e({\n      deallocator: null\n    }), this.cancel = [];\n  }\n  reset(e) {\n    this.add.clear(), this.update.clear(), this.cancel = e;\n  }\n}\nfunction x(e) {\n  return f(e, -2);\n}\nfunction R(e) {\n  return f(e, 2);\n}\nfunction S(e, t) {\n  return t + (e ? 1 : 0);\n}\nfunction C(e, t) {\n  return (-2 & e) === t;\n}\nfunction w(e) {\n  return !(1 & ~e);\n}\nfunction E(e, t) {\n  return e < 0 ? -1 : t > 0 ? e / t | 0 : 0;\n}\nfunction M(e, t) {\n  return e < 0 ? -e - 1 : 0 === t ? e : e % t;\n}\nfunction V(e, t, i) {\n  return -1 === t ? -(e + 1) : 0 === i ? e : t * i + e;\n}\nconst O = [[\"maxScreenThreshold\", l.MaxScreenThreshold], [\"screenSpaceRelative\", l.ScreenSpaceRelative], [\"removedFeatureDiameter\", l.RemovedFeatureDiameter], [\"distanceRangeFromDefaultCamera\", l.DistanceRangeFromDefaultCamera]];\nfunction A(e) {\n  if (e) for (let t = 0; t < e.length; t++) for (const i of O) if (i[0] === e[t].metricType) return {\n    lodMetric: i[1],\n    maxError: e[t].maxError\n  };\n  return {\n    lodMetric: l.None,\n    maxError: 0\n  };\n}\nclass L {\n  constructor() {\n    this.known = 0, this.knownNodes = 0, this.missing = 0, this.missingNodes = 0, this.unremoved = 0;\n  }\n}\nfunction k(e) {\n  return Math.sqrt(e * (4 / Math.PI));\n}\nconst D = r(),\n  F = r(),\n  z = r(),\n  T = r(),\n  B = has(\"esri-mobile\") ? 100 : 300;\nexport { I as I3SIndex, A as selectErrorMetric };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nvar a;\n!function (a) {\n  a[a.FadeIn = 0] = \"FadeIn\", a[a.FadeOut = 1] = \"FadeOut\";\n}(a || (a = {}));\nexport { a as FadeDirection };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/PooledArray.js\";\nimport { NodeState as i } from \"./I3SNode.js\";\nimport { FadeDirection as s } from \"../support/I3SLayerView.js\";\nclass o {\n  constructor(e) {\n    this._layerView = e, this._lodGlobalDirty = !1;\n  }\n  startNodeLoading(e, i, s) {\n    this._maxLodLevel = s.maxLodLevel, this._index = i, this._removeNodes = e;\n  }\n  shouldLoadNode(e) {\n    if (null == e) return !1;\n    const i = this._index.nodeTraversalState(e);\n    return !!this._isChosenMaxLOD(i) || !!i.isChosen && this._childrenRequireLoading(e);\n  }\n  setLodGlobalDirty() {\n    this._lodGlobalDirty = !0;\n  }\n  get requiresLODGlobalHandling() {\n    return null != this._index && !0 === this._lodGlobalDirty;\n  }\n  lodGlobalHandling(e) {\n    if (!this.requiresLODGlobalHandling) return !1;\n    this._lodGlobalDirty = !1;\n    const i = this._layerView.view.resourceController.memoryController.usedMemory,\n      s = Math.max(0, Math.floor(10 * (i - 1)));\n    t.clear(), this._lodGlobalHandling(this._index.rootNode, s, !1, !!this._layerView.nodeCrossfadingEnabled);\n    const o = t.length;\n    this._removeNodes(t, e);\n    const d = t.length < o;\n    return 0 !== t.length && (this._lodGlobalDirty = !0), t.clear(), d;\n  }\n  _lodGlobalHandling(e, o, d, l) {\n    if (null == e) return !1;\n    const n = e.index,\n      r = this._index,\n      a = this._layerView,\n      h = r.nodeTraversalState(e),\n      u = this._isChosenMaxLOD(h),\n      _ = e.resources.isEmpty;\n    if (u && _) return e.childrenLoaded > 0 && this._removeChildrenRecursive(e), !0;\n    const c = a.isNodeLoaded(n);\n    if (l && c && u) {\n      const i = !d && this.hasNoVisibleChildren(e);\n      a.fadeNode(n, s.FadeIn, !i);\n    }\n    const x = c && (!a.isNodeFullyFadedIn || a.isNodeFullyFadedIn(n));\n    if (c && (a.updateNodeState(n, u ? i.Leaf : i.Hole), u)) return x && this._removeChildrenRecursive(e), x;\n    const L = e.childCount > 0;\n    let y = L;\n    if (L) for (let i = 0; i < e.childCount; i++) {\n      const e = r.getChildIndex(n, i),\n        s = r.getNode(e);\n      if (null != s) {\n        !r.isGeometryVisible(e) || this._lodGlobalHandling(s, o, d || x, l) || (y = !1);\n      } else r.isNodeVisible(e) && (y = !1);\n    }\n    const m = c && !u && (y || t.length < o);\n    m && t.push(n), !l || m || !c || d || y || a.fadeNode(n, s.FadeIn, !1);\n    const N = e.resources.isEmpty;\n    return y || x && !m || N;\n  }\n  _removeChildrenRecursive(e) {\n    this._index.traverseDescendants(e, e => ((this._layerView.isNodeLoaded(e.index) || this._layerView.isNodeReloading(e.index)) && t.push(e.index), e.childrenLoaded > 0));\n  }\n  hasNoVisibleChildren(e) {\n    let i = !0;\n    return this._index.traverseDescendants(e, e => !(!i || !this._index.isNodeVisible(e.index)) && (this._layerView.isNodeLoaded(e.index) ? (i = !1, !1) : e.childrenLoaded > 0)), i;\n  }\n  _childrenRequireLoading(e) {\n    let i = !1,\n      s = !0;\n    return this._index.traverseDescendants(e, e => {\n      if (!s || !this._index.isNodeVisible(e.index)) return !1;\n      const o = this._index.nodeTraversalState(e);\n      return this._isChosenMaxLOD(o) && this._index.isGeometryVisible(e.index) && (i = !0), this._layerView.isNodeLoaded(e.index) ? (s = !1, !1) : e.childrenLoaded > 0;\n    }), s && i;\n  }\n  _isChosenMaxLOD(e) {\n    return e.isChosen && (!e.nodeHasLOD || e.lodLevel === this._maxLodLevel);\n  }\n}\nconst t = new e({\n  deallocator: null\n});\nexport { o as default };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport has from \"../../../../core/has.js\";\nimport { clamp as e } from \"../../../../core/mathUtils.js\";\nimport { TextureEncoding as o, TextureUsage as r } from \"./enums.js\";\nimport { RenderTexture as a } from \"../../webgl-engine/core/material/RenderTexture.js\";\nimport { defaultMaskAlphaCutoff as s } from \"../../webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";\nimport { getEllipsoidMode as t } from \"../../webgl-engine/core/shaderLibrary/util/EllipsoidMode.js\";\nimport { TextureEncodingMimeType as l, CullFaceOptions as n, AlphaDiscardMode as i } from \"../../webgl-engine/lib/basicInterfaces.js\";\nimport { Texture as u } from \"../../webgl-engine/lib/Texture.js\";\nimport { useSchematicPBRI3S as c, useSchematicPBR as m, defaultSchematicMRRFactors as d, defaultAdvancedMRRFactors as g } from \"../../webgl-engine/materials/pbrUtils.js\";\nimport { TextureWrapMode as p } from \"../../../webgl/enums.js\";\nfunction h(e, o, a) {\n  const s = new Map(),\n    t = (e, o) => {\n      if (null == e) return -1;\n      const r = s.get(e.id);\n      if (r) return r.usage |= o, r.id;\n      const a = s.size;\n      return s.set(e.id, {\n        id: a,\n        usage: o\n      }), a;\n    },\n    l = o.pbrMetallicRoughness,\n    i = l?.baseColorFactor,\n    u = o.emissiveFactor,\n    p = has(\"disable-feature:diffuse-rendering-i3s\") || a ? c({\n      normalTexture: o.normalTexture,\n      emissiveTexture: o.emissiveTexture,\n      emissiveFactor: o.emissiveFactor,\n      occlusionTexture: o.occlusionTexture,\n      metallicRoughnessTexture: l?.metallicRoughnessTexture,\n      metallicFactor: l?.metallicFactor,\n      roughnessFactor: l?.roughnessFactor\n    }) : m({\n      normalTexture: o.normalTexture,\n      emissiveTexture: o.emissiveTexture,\n      emissiveFactor: o.emissiveFactor,\n      occlusionTexture: o.occlusionTexture,\n      metallicRoughnessTexture: l?.metallicRoughnessTexture,\n      metallicFactor: l?.metallicFactor,\n      roughnessFactor: l?.roughnessFactor\n    }),\n    h = p ? d[0] : l?.metallicFactor ?? g[0],\n    x = p ? d[1] : l?.roughnessFactor ?? g[1],\n    F = \"mask\" === o.alphaMode ? r.Color | r.AlphaMask : r.Color,\n    b = {\n      baseColorFactor: i ? [i[0], i[1], i[2], i[3]] : [1, 1, 1, 1],\n      baseColorTextureId: t(l?.baseColorTexture, F),\n      metallicRoughnessTextureId: t(l?.metallicRoughnessTexture, r.MetallicRoughness),\n      metallicFactor: h,\n      roughnessFactor: x\n    },\n    C = {\n      alphaMode: o.alphaMode,\n      alphaCutoff: o.alphaCutoff,\n      doubleSided: o.doubleSided,\n      cullFace: \"none\" === o.cullFace ? n.None : \"back\" === o.cullFace ? n.Back : \"front\" === o.cullFace ? n.Front : n.None,\n      normalTextureId: t(o.normalTexture, r.Normal),\n      emissiveTextureId: t(o.emissiveTexture, r.Emissive),\n      occlusionTextureId: t(o.occlusionTexture, r.Occlusion),\n      emissiveFactor: u ? [u[0], u[1], u[2]] : [0, 0, 0],\n      metallicRoughness: b,\n      wrapTextures: !1,\n      hasParametersFromSource: p\n    },\n    P = [];\n  return s.forEach(({\n    usage: o\n  }, r) => {\n    const a = null != e && e[r] && e[r].formats,\n      s = a ? T(a.map(({\n        name: e,\n        format: o\n      }) => ({\n        name: e,\n        encoding: f[o]\n      }))) : [];\n    P.push({\n      id: r,\n      usage: o,\n      encodings: s\n    });\n  }), {\n    material: C,\n    textures: P\n  };\n}\nfunction T(e) {\n  return e.sort((e, o) => e.encoding - o.encoding);\n}\nconst f = {\n    ktx2: o.KTX2,\n    basis: o.Basis,\n    dds: o.DDS_S3TC,\n    png: o.PNG,\n    jpg: o.JPG,\n    \"ktx-etc2\": o.KTX_ETC2\n  },\n  x = {\n    [l.KTX2_ENCODING]: o.Basis,\n    [l.BASIS_ENCODING]: o.Basis,\n    [l.DDS_ENCODING]: o.DDS_S3TC,\n    \"image/png\": o.PNG,\n    \"image/jpg\": o.JPG,\n    \"image/jpeg\": o.JPG,\n    \"image/ktx\": o.KTX_ETC2\n  };\nfunction F(o) {\n  const a = o?.materialDefinitions ? Object.keys(o.materialDefinitions)[0] : null,\n    s = o?.textureDefinitions ? Object.keys(o.textureDefinitions)[0] : null,\n    t = a ? o.materialDefinitions?.[a] : null,\n    l = s ? o.textureDefinitions?.[s] : null,\n    i = b();\n  if (null != t) {\n    const o = t.params;\n    o.diffuse && (i.metallicRoughness.baseColorFactor = [o.diffuse[0], o.diffuse[1], o.diffuse[2], 1]), null != o.doubleSided && (i.doubleSided = o.doubleSided, i.cullFace = o.doubleSided ? n.None : n.Back), \"none\" !== o.cullFace && \"front\" !== o.cullFace && \"back\" !== o.cullFace || (i.cullFace = \"none\" === o.cullFace ? n.None : \"back\" === o.cullFace ? n.Back : n.Front), o.transparency && (i.metallicRoughness.baseColorFactor[3] = e(1 - o.transparency, 0, 1)), (o.useVertexColorAlpha || i.metallicRoughness.baseColorFactor[3] < 1) && (i.alphaMode = \"blend\");\n  }\n  const u = [];\n  if (null != l) {\n    const e = 0;\n    !l.wrap || \"repeat\" !== l.wrap[0] && \"repeat\" !== l.wrap[1] || (i.wrapTextures = !0);\n    let o = r.Color;\n    \"rgba\" === l.channels && (i.alphaMode = \"blend\", o |= r.AlphaMask);\n    const a = l.images.length - 1,\n      s = l.images[a],\n      t = e => e?.split(\"/\").pop(),\n      n = Array.isArray(l.encoding) ? T(l.encoding.map((e, o) => ({\n        name: t(s.href[o]),\n        encoding: x[e] || 0\n      }))) : [{\n        name: t(s.href),\n        encoding: x[l.encoding] || 0\n      }];\n    u.push({\n      id: e,\n      usage: o,\n      encodings: n\n    }), i.metallicRoughness.baseColorTextureId = e;\n  }\n  return {\n    material: i,\n    textures: u\n  };\n}\nconst b = () => ({\n  alphaMode: \"opaque\",\n  alphaCutoff: s,\n  doubleSided: !0,\n  cullFace: n.None,\n  normalTextureId: -1,\n  emissiveTextureId: -1,\n  occlusionTextureId: -1,\n  emissiveFactor: [0, 0, 0],\n  metallicRoughness: {\n    baseColorFactor: [.8, .8, .8, 1],\n    baseColorTextureId: -1,\n    metallicRoughnessTextureId: -1,\n    metallicFactor: 0,\n    roughnessFactor: .6\n  },\n  wrapTextures: !1,\n  hasParametersFromSource: !0\n});\nfunction C(e, o, a, s) {\n  if (null == e?.data) return null;\n  const t = e.data,\n    l = s.renderingContext.parameters.maxMaxAnisotropy,\n    n = l > 1,\n    i = a || !o.wrapTextures ? P : S,\n    c = N(e.encoding),\n    m = e.usage & r.Color ? \"opaque\" === o.alphaMode ? 3 : 4 : 3;\n  return new u(t, {\n    mipmap: n,\n    maxAnisotropy: l,\n    encoding: c,\n    wrap: i,\n    components: m,\n    noUnpackFlip: !0\n  });\n}\nconst P = {\n    s: p.CLAMP_TO_EDGE,\n    t: p.CLAMP_TO_EDGE\n  },\n  S = {\n    s: p.REPEAT,\n    t: p.REPEAT\n  };\nfunction M(o, l, n, u, c, m) {\n  const p = m.rendererTextureUsage,\n    h = e => w(u, n, e & p),\n    T = l.metallicRoughness.baseColorFactor,\n    f = e(l.metallicRoughness.baseColorFactor[3], 0, 1);\n  o.baseColor = [T[0], T[1], T[2], f], o.hasParametersFromSource = !!l.hasParametersFromSource, o.usePBR = m.usePBR, o.mrrFactors = [l.metallicRoughness.metallicFactor, l.metallicRoughness.roughnessFactor, l.hasParametersFromSource ? d[2] : g[2]], o.emissiveFactor = l.emissiveFactor, o.isIntegratedMesh = m.isIntegratedMesh, o.textureAlphaCutoff = \"mask\" === l.alphaMode ? l.alphaCutoff : s, o.alphaDiscardMode = \"opaque\" === l.alphaMode ? i.Opaque : \"mask\" === l.alphaMode ? i.Mask : i.MaskBlend;\n  const x = [],\n    F = h(r.Color | r.AlphaMask);\n  null != F && (o.baseColorTexture = new a(c, F), x.push(o.baseColorTexture.loadPromise));\n  const b = h(r.MetallicRoughness);\n  null != b && (o.metallicRoughnessTexture = new a(c, b), x.push(o.metallicRoughnessTexture.loadPromise));\n  const C = h(r.Emissive);\n  null != C && (o.emissionTexture = new a(c, C), x.push(o.emissionTexture.loadPromise));\n  const P = h(r.Occlusion);\n  null != P && (o.occlusionTexture = new a(c, P), x.push(o.occlusionTexture.loadPromise));\n  const S = h(r.Normal);\n  return null != S && (o.normalTexture = new a(c, S), x.push(o.normalTexture.loadPromise)), o.commonMaterialParameters.hasSlicePlane = m.slicePlaneEnabled, o.commonMaterialParameters.doubleSided = l.doubleSided, o.commonMaterialParameters.cullFace = l.cullFace, o.ellipsoidMode = t(m.viewSpatialReference), Promise.all(x);\n}\nfunction R(e) {\n  const r = !!e.compressedTextureS3TC,\n    a = !!e.compressedTextureETC,\n    s = has(\"disable-feature:i3s-basis\") ? 0 : o.Basis | o.KTX2,\n    t = o.JPG | o.PNG,\n    l = s | o.DDS_S3TC;\n  return t | (r ? l : 0) | (a ? s : 0);\n}\nfunction D(e, o) {\n  if (null != o) return e.find(e => !!(e.encoding & o));\n}\nfunction w(e, o, a) {\n  if (null == e || a === r.None) return null;\n  for (let r = 0; r < e.length; r++) {\n    const s = e[r];\n    if (null != s && s.usage & a) {\n      const e = o[r];\n      return null != e ? e.id : null;\n    }\n  }\n  return null;\n}\nfunction N(e) {\n  switch (e) {\n    case o.KTX2:\n      return l.KTX2_ENCODING;\n    case o.Basis:\n      return l.BASIS_ENCODING;\n    case o.DDS_S3TC:\n      return l.DDS_ENCODING;\n    case o.PNG:\n      return \"image/png\";\n    case o.JPG:\n      return \"image/jpeg\";\n    case o.KTX_ETC2:\n      return \"image/ktx\";\n    default:\n      return \"\";\n  }\n}\nexport { M as configureMaterial, C as createTexture, b as defaultMaterial, h as getMaterialAndTextures, F as getMaterialAndTexturesFromShared, R as getSupportedEncodings, D as selectEncoding };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { result as e, assertResult as t } from \"../../../../core/asyncUtils.js\";\nimport has from \"../../../../core/has.js\";\nimport { clone as r } from \"../../../../core/lang.js\";\nimport { throwIfAbortError as i } from \"../../../../core/promiseUtils.js\";\nimport { makeAbsolute as o } from \"../../../../core/urlUtils.js\";\nimport { TextureEncoding as n } from \"./enums.js\";\nimport { readBinaryAttribute as s, createGeometryDescriptor as a } from \"./I3SBinaryReader.js\";\nimport { getMaterialAndTextures as u, getMaterialAndTexturesFromShared as l, selectEncoding as f } from \"./I3SMaterialUtil.js\";\nclass d {\n  constructor(e, t, r, i, o, n) {\n    if (this._streamDataController = t, this._logger = r, this._defaultGeometrySchema = i, this._requiredAttributes = o, this._options = n, this._logLayer = e, this._layerUrl = e.parsedUrl.path, this._geometryDefinitions = e.geometryDefinitions, e.materialDefinitions) {\n      const t = e.textureSetDefinitions;\n      this._materialAndTextures = e.materialDefinitions.map(r => u(t, r, \"integrated-mesh\" === e.type));\n    }\n  }\n  _load(e, t, r) {\n    return this._streamDataController.request(e, t, r);\n  }\n  _loadAttribute(e, t, r) {\n    const i = `${this._layerUrl}/nodes/${e.resources.attributes}/attributes/${t.key}/0`;\n    return this._load(i, \"binary\", r).then(e => s(t, e));\n  }\n  async loadAttributes(e, t, r) {\n    const o = await Promise.allSettled(t.map(t => this._loadAttribute(e, t.attributeStorageInfo, r))),\n      n = {};\n    for (let s = 0; s < t.length; ++s) {\n      const r = o[s],\n        a = t[s];\n      if (\"fulfilled\" === r.status) {\n        const e = r.value;\n        n[a.name] = e;\n      } else {\n        const t = r.reason;\n        i(t), this._logger.error(\"#loadAttributes\", this._logLayer, `Failed to load attributeData for '${a.name}' on node '${e.id}'`, t);\n      }\n    }\n    return n;\n  }\n  async loadNodeData(r, i) {\n    const o = null != this._requiredAttributes && r.resources.attributes ? e(this.loadAttributes(r, this._requiredAttributes, i)) : null,\n      {\n        bufferDefinition: n,\n        bufferIndex: s\n      } = _(this._geometryDefinitions, r),\n      u = !!r.resources.geometry,\n      f = u ? e(this._loadGeometry(r.resources.geometry, s, i)) : null,\n      d = r.resources.hasSharedResource ? await this._loadShared(r, i) : null,\n      y = r.resources.materialDefinition,\n      b = this._materialAndTextures && null != y && y >= 0 ? this._materialAndTextures[y] : null != d ? l(d) : null,\n      D = b?.material,\n      p = b?.textures ?? [],\n      x = `${r.id}`,\n      A = !u && this._options.loadFeatureData,\n      w = A ? await this._loadFeatureData(x, i) : null,\n      T = A ? m(w) : c(D),\n      $ = null == T ? h(w) : null,\n      j = p.length > 0 ? e(this.loadTextures(r, p, i)) : null;\n    let I = null,\n      S = null;\n    if (f) {\n      I = t(await f);\n      const e = g(this._defaultGeometrySchema, d);\n      S = a(n, e);\n    }\n    const U = j ? t(await j) : null,\n      q = o ? t(await o) : {},\n      B = q ? {\n        attributeData: q,\n        loadedAttributes: this._requiredAttributes\n      } : null;\n    if (null != T) return {\n      geometryData: T,\n      attributeDataInfo: B,\n      geometryBuffer: I,\n      geometryDescriptor: S,\n      requiredTextures: p,\n      textureData: U\n    };\n    if (null != $) return {\n      pointData: $,\n      attributeDataInfo: B,\n      geometryBuffer: I,\n      geometryDescriptor: S,\n      requiredTextures: p,\n      textureData: U\n    };\n    throw new Error();\n  }\n  static _addAbsoluteHrefTexture(e, t) {\n    const r = e.textureDefinitions;\n    if (null != r) for (const i of Object.keys(r)) for (const e of r[i].images) Array.isArray(e.href) ? e.hrefConcat = e.href.map(e => o(e, t)) : e.hrefConcat = o(e.href, t);\n  }\n  static _fixTextureEncodings(e) {\n    const t = e.textureDefinitions;\n    if (null != t) for (const r in t) {\n      const e = t[r];\n      if (Array.isArray(e.encoding)) for (let t = 0; t < e.encoding.length; t++) {\n        const r = e.encoding[t];\n        \"data:\" === r.substring(0, 5) && (e.encoding[t] = r.substring(5));\n      } else {\n        const t = e.encoding;\n        \"data:\" === t.substring(0, 5) && (e.encoding = t.substring(5));\n      }\n    }\n  }\n  async _loadShared(e, t) {\n    if (null == e.resources.geometry) return {};\n    const r = `${this._layerUrl}/nodes/${e.resources.geometry}/shared`,\n      i = await this._load(r, \"json\", t);\n    return d._fixTextureEncodings(i), d._addAbsoluteHrefTexture(i, r), i;\n  }\n  _loadTexture(e, t, r, i, o, s) {\n    let a = !1;\n    return o === n.DDS_S3TC || o === n.KTX2 || o === n.Basis ? this._load(e, \"binary\", s).then(e => ({\n      id: t,\n      usage: r,\n      data: e,\n      encoding: o,\n      downsampled: a\n    })) : this._load(e, \"image\", s).then(e => {\n      let n = e;\n      const s = 4096,\n        u = 2;\n      if (i && e.width * e.height >= s) {\n        const t = Math.ceil(e.width / u),\n          r = Math.ceil(e.height / u),\n          i = document.createElement(\"canvas\");\n        i.width = t, i.height = r;\n        i.getContext(\"2d\").drawImage(e, 0, 0, t, r), n = i, a = !0;\n      }\n      return {\n        id: t,\n        usage: r,\n        data: n,\n        encoding: o,\n        downsampled: a\n      };\n    });\n  }\n  loadTextures(e, t, r) {\n    const i = !!this._options.uncompressedTextureDownsamplingEnabled,\n      o = this._options.textureUsageMask;\n    return Promise.all(t.map(t => {\n      if (!(t.usage & o)) return null;\n      const n = f(t.encodings, this._options.textureEncodings);\n      if (null == n) return this._logger.error(\"#loadTextures\", this._logLayer, `No known encoding for texture found on node ${e.id}`), Promise.reject();\n      const s = e.resources.texture || e.id,\n        a = `${this._layerUrl}/nodes/${s}/textures/${n.name}`;\n      return this._loadTexture(a, t.id, t.usage, i, n.encoding, r);\n    }));\n  }\n  _loadFeatureData(e, t) {\n    const r = `${this._layerUrl}/nodes/${e}/features/0`;\n    return this._load(r, \"json\", t);\n  }\n  _loadGeometry(e, t, r) {\n    const i = `${this._layerUrl}/nodes/${e}/geometries/${t}`;\n    return this._load(i, \"binary\", r);\n  }\n}\nfunction c(e) {\n  return {\n    featureIds: [],\n    geometries: [{\n      type: \"ArrayBufferView\",\n      params: {\n        material: e\n      }\n    }],\n    featureDataPosition: [0, 0, 0]\n  };\n}\nfunction m(e) {\n  if (!e) return null;\n  for (const t of e.featureData) {\n    const e = t.geometries;\n    if (null != e) for (const r of e) return {\n      featureIds: [t.id],\n      featureDataPosition: t.position,\n      geometries: [r]\n    };\n  }\n  return null;\n}\nfunction h(e) {\n  if (!e) return null;\n  const t = new Array();\n  for (const r of e.featureData) null != r.position && t.push({\n    featureIds: [r.id],\n    featureDataPosition: r.position,\n    geometries: []\n  });\n  return t;\n}\nfunction g(e, t) {\n  if (!e || !t?.materialDefinitions) return e;\n  const i = Object.keys(t.materialDefinitions)[0];\n  return !t.materialDefinitions[i].params.vertexRegions && e.vertexAttributes.region && delete (e = r(e)).vertexAttributes.region, e;\n}\nfunction _(e, t) {\n  const r = {\n      bufferDefinition: null,\n      bufferIndex: 0\n    },\n    i = t.resources.geometryDefinition;\n  if (null == e || null == i || i < 0) return r;\n  const o = i >= 0 ? e[i].geometryBuffers : null;\n  if (null == o) return r;\n  for (let n = 0; n < o.length; n++) {\n    const e = o[n];\n    if (null == e.compressedAttributes) r.bufferIndex = n, r.bufferDefinition = o[n];else if (\"draco\" === e.compressedAttributes.encoding && !has(\"disable-feature:i3s-draco\")) return r.bufferIndex = n, r.bufferDefinition = e, r;\n  }\n  return r;\n}\nexport { d as default };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { onAbortOrThrow as e, always as t } from \"../../../../core/promiseUtils.js\";\nclass r {\n  constructor(e, t, r) {\n    this._requester = e, this._customParameters = t, this._apiKey = r, this._activeRequests = new Set();\n  }\n  get busy() {\n    return this._requester.busy;\n  }\n  request(r, s, o) {\n    const a = new AbortController(),\n      l = e(o, () => a.abort()),\n      i = {\n        signal: a.signal,\n        query: {\n          ...this._customParameters,\n          token: this._apiKey\n        }\n      },\n      n = this._requester.request(r, s, i),\n      u = {\n        response: n,\n        abortController: a,\n        abortHandle: l\n      };\n    return this._activeRequests.add(u), t(n, () => {\n      u.abortController = null, u.abortHandle?.remove(), u.abortHandle = null, this._activeRequests.delete(u);\n    }), n;\n  }\n  cancelAll() {\n    this._activeRequests.forEach(e => {\n      e.abortController?.abort(), e.abortController = null, e.abortHandle?.remove();\n    }), this._activeRequests.clear();\n  }\n}\nexport { r as I3SStreamDataController };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { n as e, z as t, m as i, r as s, c as n, H as r, w as o, j as a, F as c, a as u, p as l, l as h, q as d, f as m, g as _ } from \"../../../../chunks/vec32.js\";\nimport { create as p } from \"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";\nimport { c as f, h as v } from \"../../../../chunks/vec42.js\";\nimport { create as g } from \"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";\nimport { getReferenceEllipsoid as b } from \"../../../../geometry/ellipsoidUtils.js\";\nimport { getSphericalPCPF as R } from \"../../../../geometry/spatialReferenceEllipsoidUtils.js\";\nimport { projectBoundingSphere as S } from \"../../../../geometry/projection/projectBoundingSphere.js\";\nimport { getProjector as M } from \"../../../../geometry/projection/projectors.js\";\nimport { create as x, fromMatrix as C, intersectsSphere as I, createPoints as P } from \"../../../../geometry/support/frustum.js\";\nimport { signedDistance as E, getNormal as D } from \"../../../../geometry/support/plane.js\";\nimport { isPlateCarree as F } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { g as O, w as B } from \"../../../../chunks/sphere.js\";\nimport { makeDehydratedPoint as V } from \"../../../../layers/graphics/dehydratedPoint.js\";\nimport { ViewingMode as j } from \"../../../ViewingMode.js\";\nimport { evaluateElevationAlignmentAtPoint as A } from \"../graphics/elevationAlignmentUtils.js\";\nimport { ElevationContext as L } from \"../graphics/ElevationContext.js\";\nimport { createContextWithoutExpressionSupport as y, extractExpressionInfo as w } from \"../graphics/featureExpressionInfoUtils.js\";\nimport { LodMetric as G } from \"./I3SNode.js\";\nimport { isValidMbs as N, intersectBoundingRectWithMbs as U, MbsIntersectResult as q } from \"./I3SUtil.js\";\nimport { Obb as z, computeOffsetObb as T } from \"../../support/orientedBoundingBox.js\";\nconst k = 1e5;\nclass H {\n  get _frustumMbsCenter() {\n    return this._frustumMbs;\n  }\n  get _frustumMbsRadius() {\n    return this._frustumMbs[3];\n  }\n  get _frustumPlanes() {\n    return this._frustum;\n  }\n  constructor(e, t, i, s, n, r, o, a, c = {}) {\n    this._indexSR = e, this._renderCoordsHelper = t, this._clippingArea = n, this._elevationProvider = r, this._viewingMode = o, this._options = c, this._frustum = x(), this._frustumMbs = g(), this._useFrustumCulling = !1, this._poi = p(), this._elevationContext = null, this.minDistance = 1 / 0, this.maxDistance = 0, this.maxLodLevel = 2, this._tmpObb = new z(), this._tmp1 = p(), this._tmp2 = p(), this._tmp3 = p(), this._tmp0 = p(), this._screenspaceErrorBias = c.screenspaceErrorBias || 1, this._progressiveLoadFactor = c.progressiveLoadFactor || 1, this.updateCamera(i, s);\n    const u = this._renderCoordsHelper.spatialReference;\n    this._renderSR = u, this._renderSRSphericalPCPF = R(u), this._isGlobalMode = u === this._renderSRSphericalPCPF, this.updateElevationInfo(a), this._tmpPoint = V(0, 0, 0, e), this._isECEFOBBInLocalMode = this._indexSR.isWGS84 && (u.isWebMercator || F(u)), this._indexSREllipsoidRadius = b(this._indexSR).radius, this._indexSRSphericalPCPF = R(e), this._projectorIndexSRToIndexSRSphericalPCPF = M(this._indexSR, this._indexSRSphericalPCPF);\n  }\n  updateElevationInfo(e) {\n    null != e ? (this._elevationContext = L.fromElevationInfo(e), this._elevationContext.updateFeatureExpressionInfoContext(y(w(e, !1)))) : this._elevationContext = null;\n  }\n  updateCamera(n, r) {\n    if (this._useFrustumCulling = r, r) {\n      C(n.viewMatrix, n.projectionMatrix, this._frustum, X);\n      {\n        const r = n.eye,\n          o = Z;\n        e(o, n.viewForward);\n        const a = Y;\n        t(a, X[4], r);\n        const c = .5 * i(a, a) / i(o, a),\n          u = this._frustumMbs;\n        s(u, r, o, c);\n        const l = 1 + c;\n        u[3] = l;\n      }\n    }\n    this._screenSizeFactor = 1 / (n.perScreenPixelRatio / 2), this._camPos = n.eye, this.minDistance = 1 / 0, this.maxDistance = 0;\n  }\n  setPointOfInterest(e) {\n    this._poi = e;\n  }\n  updateScreenSpaceErrorBias(e) {\n    const t = this._screenspaceErrorBias;\n    return this._screenspaceErrorBias = e, t;\n  }\n  updateClippingArea(e) {\n    this._clippingArea = e;\n  }\n  expandElevationRange(e, t, i) {\n    if (null == this._elevationContext) return;\n    const s = e.serviceMbsInIndexSR;\n    if (!s) return;\n    const n = \"relative-to-scene\" === this._elevationContext.mode ? \"scene\" : \"ground\";\n    if (this._elevationProvider.getSphereElevationBounds) {\n      const e = this._elevationProvider.getSphereElevationBounds(s, this._indexSR, n);\n      return void (e && i.expandElevationRange(e));\n    }\n    const r = s[0],\n      o = s[1],\n      a = s[2],\n      c = this._elevationProvider.getElevation(r, o, a, this._indexSR, n);\n    c && i.expandElevationRangeValues(c, c);\n    const u = t ? null : this._elevationProvider.getRootElevationBounds?.();\n    u && i.expandElevationRange(u);\n  }\n  getServiceMbsInRenderSR(e) {\n    const t = e.serviceMbsInRenderSR;\n    if (N(t)) return t;\n    e.serviceMbsInIndexSR && f(t, e.serviceMbsInIndexSR);\n    const i = e.elevationRangeMin;\n    if (this._elevationContext && Number.isFinite(i)) {\n      let s = 0,\n        n = 0;\n      const r = e.elevationRangeMax;\n      switch (this._elevationContext.mode) {\n        case \"relative-to-ground\":\n        case \"relative-to-scene\":\n          s = this._elevationContext.geometryZWithOffset(t[2], this._renderCoordsHelper) + i - t[2], n = r - i;\n          break;\n        case \"on-the-ground\":\n          s = i - t[2], n = r - i;\n      }\n      t[2] += s + .5 * n, t[3] += .5 * n;\n    } else this._elevationContext && t[3] < k && (this._tmpPoint.x = t[0], this._tmpPoint.y = t[1], this._tmpPoint.z = t[2], t[2] = A(this._tmpPoint, this._elevationProvider, this._elevationContext, this._renderCoordsHelper));\n    return S(t, this._indexSR, t, this._renderSR), t;\n  }\n  getAndUpdateVisibilityObbInRenderSR(e) {\n    {\n      const t = e.visibilityObbInRenderSR;\n      if (t) return t;\n    }\n    const t = .01 * this._indexSREllipsoidRadius,\n      {\n        serviceMbsInIndexSR: i,\n        serviceObbInIndexSR: s\n      } = e;\n    if (null == s || !i || !s.isValid || this._isECEFOBBInLocalMode && (s.halfSizeX > t || s.halfSizeY > t || s.halfSizeZ > t)) return null;\n    {\n      let t = e.serviceObbInRenderSR;\n      if (null == t) t = new z(), e.serviceObbInRenderSR = t;else if (t.isValid) return t;\n      const n = i[3];\n      let r = 0,\n        o = 0;\n      const a = s.centerZ,\n        c = this._renderCoordsHelper,\n        u = this._elevationContext;\n      if (u && e.elevationRangeValid) {\n        const t = e.elevationRangeMin,\n          i = e.elevationRangeMax;\n        switch (u.mode) {\n          case \"relative-to-ground\":\n          case \"relative-to-scene\":\n            r = u.geometryZWithOffset(a, c) + t - a, o = i - t;\n            break;\n          case \"on-the-ground\":\n            r = t - a, o = i - t;\n        }\n      } else if (u && n < k) {\n        const e = this._tmpPoint;\n        e.x = s.centerX, e.y = s.centerY, e.z = a, r = A(e, this._elevationProvider, u, c) - a;\n      }\n      const l = o > 0,\n        h = l ? this._tmpObb : t;\n      return s.transform(h, this._indexSR, this._renderSR, r, this._renderSRSphericalPCPF, this._indexSRSphericalPCPF, this._projectorIndexSRToIndexSRSphericalPCPF), l && T(h, 0, o, this._viewingMode, t), t;\n    }\n  }\n  getNodeObbInRenderSRIndependentOfElevationOffset(e) {\n    {\n      const t = e.visibilityObbInRenderSR ?? e.serviceObbInRenderSR ?? null;\n      if (t?.isValid) return t;\n    }\n    const t = e.serviceObbInIndexSR;\n    return t ? (t.transform(ee, this._indexSR, this._renderSR, void 0, this._renderSRSphericalPCPF, this._indexSRSphericalPCPF, this._projectorIndexSRToIndexSRSphericalPCPF), ee) : null;\n  }\n  ensureElevationAgnosticBoundingVolume(e) {\n    return -1 === e.elevationAgnosticBoundingVolume[3] && e.level > 0 && (this._viewingMode === j.Global ? this._updateElevationAgnosticBoundingVolumeGlobal(e) : this._updateElevationAgnosticBoundingVolumeLocal(e)), e.elevationAgnosticBoundingVolume;\n  }\n  _updateElevationAgnosticBoundingVolumeGlobal(t) {\n    const s = this.getNodeObbInRenderSRIndependentOfElevationOffset(t),\n      o = t.elevationAgnosticBoundingVolume;\n    let a,\n      c = -1;\n    if (s) {\n      const t = te;\n      s.getCenter(t), e(t, t), a = t, s.getCorners(ie);\n      for (const s of ie) {\n        e(s, s);\n        const n = i(s, t);\n        if (n <= 0) return void (o[3] = -1);\n        const r = Math.sqrt(1 - n * n);\n        c = Math.max(c, r);\n      }\n    } else {\n      const i = t.serviceMbsInRenderSR;\n      if (!N(i)) return void (o[3] = -1);\n      {\n        const t = n(te, O(i)),\n          s = i[3],\n          u = r(t);\n        if (u < s) return void (o[3] = -1);\n        c = s / u, e(t, t), a = t;\n      }\n    }\n    v(o, a);\n    const u = .001;\n    o[3] = c + u;\n  }\n  _updateElevationAgnosticBoundingVolumeLocal(e) {\n    const t = e.elevationAgnosticBoundingVolume,\n      i = this.getNodeObbInRenderSRIndependentOfElevationOffset(e);\n    if (i) {\n      const e = i.getCenter(te);\n      e[2] = 0, v(t, e);\n      let s = 0;\n      const n = se;\n      i.getCorners(ie);\n      for (const t of ie) {\n        t[2] = 0;\n        const e = o(n, t);\n        s = Math.max(s, e);\n      }\n      t[3] = Math.sqrt(s);\n    } else {\n      const i = e.serviceMbsInRenderSR;\n      if (N(i)) {\n        const e = n(te, O(i));\n        e[2] = 0, v(t, e), t[3] = i[3];\n      }\n    }\n  }\n  isNodeVisible(e) {\n    const t = this.getServiceMbsInRenderSR(e);\n    if (!this._isMBSinClippingArea(t)) return !1;\n    if (!this._useFrustumCulling) return !0;\n    const i = this.getAndUpdateVisibilityObbInRenderSR(e);\n    return i ? i.doesIntersectFrustumConservativeApproximation(this._frustum) : I(this._frustum, B(t));\n  }\n  isElevationAgnosticBoundingVolumeVisible(e) {\n    return !this._useFrustumCulling || -1 === e[3] || (this._viewingMode === j.Global ? this._isConeVisibleInFrustum(e) : this._isCylinderVisibleInFrustum(e));\n  }\n  _isConeVisibleInFrustum(n) {\n    if (!this._isConeVisibleInFrustumMbs(n)) return !1;\n    const r = n[3];\n    if (-1 === r || r > .9) return !0;\n    const o = this._frustumPlanes,\n      c = this._frustumMbsCenter,\n      u = n,\n      l = i(u, c),\n      h = this._frustumMbsRadius,\n      d = l - h,\n      m = l + h;\n    if (d <= 0) return !0;\n    const _ = a(K, u, d),\n      p = a(Q, u, m),\n      f = r / Math.sqrt(1 - r * r);\n    for (const v of o) {\n      const n = D(v),\n        r = e($, n),\n        o = i(r, u);\n      if (Math.abs(1 - o) < .01) continue;\n      const c = ne;\n      a(c, u, o), t(c, c, r), e(c, c);\n      const l = re;\n      s(l, _, c, d * f);\n      if (E(v, l) <= 0) continue;\n      s(l, p, c, m * f);\n      if (E(v, l) <= 0) continue;\n      return !1;\n    }\n    return !0;\n  }\n  _isConeVisibleInFrustumMbs(e) {\n    const t = e[3];\n    if (t > .9) return !0;\n    const s = this._frustumMbsRadius,\n      n = this._frustumMbsCenter,\n      o = r(n);\n    if (o <= s) return !0;\n    const u = e,\n      l = i(u, n);\n    {\n      const e = a(J, u, l);\n      if (c(e, n) < s) return !0;\n    }\n    const h = l / o;\n    if (l <= 0) {\n      return -h < s;\n    }\n    const d = Math.sqrt(1 - h * h);\n    if (d < t) return !0;\n    const m = s / o;\n    return d * Math.sqrt(1 - m * m) - m * h < t;\n  }\n  isObbVisibleIndependentOfElevation(e, t) {\n    if (!this._useFrustumCulling) return !0;\n    if (-1 === e[3]) return !0;\n    const s = this._frustumMbsRadius,\n      n = this._frustumMbsCenter,\n      r = this._frustumPlanes,\n      o = ie;\n    if (t.getCorners(o), this._viewingMode === j.Global) {\n      const t = e,\n        c = i(t, n),\n        u = c - s,\n        l = c + s;\n      if (u <= 0) return !0;\n      for (const e of r) {\n        let s = !0;\n        for (const n of o) {\n          const r = i(n, t),\n            o = oe;\n          if (a(o, n, u / r), E(e, o) <= 0) {\n            s = !1;\n            break;\n          }\n          const c = oe;\n          if (a(c, n, l / r), E(e, c) <= 0) {\n            s = !1;\n            break;\n          }\n        }\n        if (s) return !1;\n      }\n    } else {\n      const e = n[2] - s,\n        t = n[2] + s;\n      for (const i of r) {\n        let s = !0;\n        const n = D(i),\n          r = n[0],\n          a = n[1],\n          c = n[2],\n          u = i[3];\n        for (const i of o) {\n          const n = r * i[0] + a * i[1] + u;\n          if (n + c * e <= 0 || n + c * t <= 0) {\n            s = !1;\n            break;\n          }\n        }\n        if (s) return !1;\n      }\n    }\n    return !0;\n  }\n  _isCylinderVisibleInFrustum(e) {\n    const t = this._frustumMbsCenter,\n      i = this._frustumMbsRadius,\n      s = n(J, t);\n    s[2] = 0;\n    const r = e[3];\n    return c(s, e) <= r + i;\n  }\n  isGeometryVisible(e) {\n    if (!this._useFrustumCulling) return !0;\n    const t = e.geometryObbInRenderSR;\n    return t?.doesIntersectFrustumConservativeApproximation(this._frustum) ?? this.isNodeVisible(e);\n  }\n  _isMBSinClippingArea(e) {\n    return null == this._clippingArea || U(this._clippingArea, e) !== q.OUTSIDE;\n  }\n  _screenSpaceDiameterMbs(e, t) {\n    const i = this.getServiceMbsInRenderSR(e),\n      s = Math.sqrt(u(O(i), this._camPos)),\n      n = s - i[3];\n    return this._updateMinMaxDistance(s), n < 0 ? .5 * Number.MAX_VALUE : t / n * this._screenSizeFactor;\n  }\n  calcCameraDistance(e) {\n    return this.calcCameraDistanceToCenter(e) - this.getServiceMbsInRenderSR(e)[3];\n  }\n  calcCameraDistanceToCenter(e) {\n    const t = this.getServiceMbsInRenderSR(e),\n      i = l(O(t), this._camPos);\n    return this._updateMinMaxDistance(i), i;\n  }\n  calcAngleDependentLoD(e) {\n    const t = this.getServiceMbsInRenderSR(e),\n      i = t[3],\n      s = (Math.abs(t[0] * (t[0] - this._camPos[0]) + t[1] * (t[1] - this._camPos[1]) + t[2] * (t[2] - this._camPos[2])) / h(O(t)) + i) / l(O(t), this._camPos);\n    return Math.min(1, s);\n  }\n  hasLOD(e) {\n    return e.lodMetric !== G.None;\n  }\n  _getDistanceGlobeMode(e, t) {\n    const s = h(O(t)),\n      n = h(e) - s;\n    a(this._tmp0, e, i(e, O(t)) / d(e));\n    const r = u(O(t), this._tmp0),\n      o = t[3];\n    if (r <= o * o) return Math.abs(n);\n    {\n      const r = a(this._tmp0, O(t), 1 / s),\n        c = s,\n        u = o * o / 2 / c,\n        d = a(this._tmp1, r, c - u),\n        p = e,\n        f = m(this._tmp2, p, d),\n        v = m(this._tmp2, f, a(this._tmp3, r, i(r, f))),\n        g = _(this._tmp2, d, a(this._tmp2, v, o / h(v)));\n      let b = l(p, g);\n      if (n >= 2e5) {\n        const e = m(this._tmp1, p, g);\n        let t = i(e, r) / h(e);\n        t < .08 && (t = 1e-4), b /= t;\n      }\n      return b;\n    }\n  }\n  _getDistance(e, t) {\n    return this._isGlobalMode ? this._getDistanceGlobeMode(e, t) : W(e, t);\n  }\n  _updateMinMaxDistance(e) {\n    e > 0 ? (this.minDistance = Math.min(this.minDistance, e), this.maxDistance = Math.max(this.maxDistance, e)) : (this.minDistance = 0, this.maxDistance = Math.max(this.maxDistance, -e));\n  }\n  getLodLevel(e) {\n    if (e.lodMetric === G.None) return 0;\n    if (0 === e.childCount) return this.maxLodLevel;\n    if (this._useFrustumCulling && this._progressiveLoadFactor < 1) {\n      const t = this._progressiveLoadFactor * this._screenspaceErrorBias,\n        i = this._screenspaceErrorBias;\n      return this.evaluateLODmetric(e, t) ? this.evaluateLODmetric(e, i) ? 2 : 1 : 0;\n    }\n    return this.evaluateLODmetric(e, this._screenspaceErrorBias) ? this.maxLodLevel : 0;\n  }\n  evaluateLODmetric(e, t) {\n    switch (e.lodMetric) {\n      case G.ScreenSpaceRelative:\n        {\n          const i = this.getServiceMbsInRenderSR(e),\n            s = this._getDistance(this._camPos, i),\n            n = 2 * s / this._screenSizeFactor,\n            r = s + i[3];\n          return this._updateMinMaxDistance(r), e.maxError * t <= n;\n        }\n      case G.MaxScreenThreshold:\n        {\n          let i = this._screenSpaceDiameterMbs(e, e.serviceMbsInIndexSR[3] * t);\n          return this._options.angleDependentLoD && (i *= this.calcAngleDependentLoD(e)), i < e.maxError;\n        }\n      case G.RemovedFeatureDiameter:\n        return this._screenSpaceDiameterMbs(e, e.maxError) * t < 10;\n      case G.DistanceRangeFromDefaultCamera:\n        return this.calcCameraDistance(e) > e.maxError * t;\n    }\n    return !1;\n  }\n  distToPOI(e) {\n    const t = this.getServiceMbsInRenderSR(e);\n    return l(O(t), this._poi) - t[3];\n  }\n  distCameraToPOI() {\n    return l(this._camPos, this._poi);\n  }\n}\nfunction W(e, t) {\n  const i = e[0] - t[0],\n    s = e[1] - t[1],\n    n = e[2] - t[2],\n    r = i * i + s * s,\n    o = t[3];\n  if (r <= o * o) return Math.abs(n);\n  const a = Math.sqrt(r) - o;\n  return Math.sqrt(n * n + a * a);\n}\nconst Z = p(),\n  X = P(),\n  Y = p(),\n  J = p(),\n  K = p(),\n  Q = p(),\n  $ = p(),\n  ee = new z(),\n  te = p(),\n  ie = [p(), p(), p(), p(), p(), p(), p(), p()],\n  se = p(),\n  ne = p(),\n  re = p(),\n  oe = p();\nexport { H as default };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport has from \"../../../core/has.js\";\nimport i from \"../../../core/Logger.js\";\nimport s from \"../../../core/PooledArray.js\";\nimport { EsriPromiseMixin as r } from \"../../../core/Promise.js\";\nimport { isAbortError as a } from \"../../../core/promiseUtils.js\";\nimport { watch as d, initial as o, sync as n } from \"../../../core/reactiveUtils.js\";\nimport { property as l } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/RandomLCG.js\";\nimport { subclass as h } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { projectBoundingRect as u } from \"../../../geometry/projection/projectBoundingRect.js\";\nimport { create as _ } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { PromiseQueue as c } from \"../../support/PromiseQueue.js\";\nimport { viewingModeFromString as p } from \"../../../views/ViewingMode.js\";\nimport { I3SClientNodeLoader as g } from \"../../../views/3d/layers/i3s/I3SClientNodeLoader.js\";\nimport { addCallback as m } from \"../../../views/3d/layers/i3s/I3SFrameTask.js\";\nimport { I3SIndex as y } from \"../../../views/3d/layers/i3s/I3SIndex.js\";\nimport f from \"../../../views/3d/layers/i3s/I3SLodHandling.js\";\nimport { NodeState as x, CacheState as b } from \"../../../views/3d/layers/i3s/I3SNode.js\";\nimport N from \"../../../views/3d/layers/i3s/I3SNodeLoader.js\";\nimport { I3SStreamDataController as w } from \"../../../views/3d/layers/i3s/I3SStreamDataController.js\";\nimport { getVertexCrs as v, getIndexCrs as C, findIntersectingNodes as L } from \"../../../views/3d/layers/i3s/I3SUtil.js\";\nimport D from \"../../../views/3d/layers/i3s/I3SViewportQueries.js\";\nimport { FadeDirection as V } from \"../../../views/3d/layers/support/I3SLayerView.js\";\nimport { toBoundingRect as I } from \"../../../views/3d/support/extentUtils.js\";\nimport { ClientType as A, maxDownloadSlots as S } from \"../../../views/3d/support/index.js\";\nimport { minQuality as M } from \"../../../views/3d/support/MemoryController.js\";\nimport { noBudget as F } from \"../../../views/support/Scheduler.js\";\nconst O = 100,\n  P = 2,\n  U = 1e4,\n  q = 1e-4,\n  G = 1.2,\n  Q = 500,\n  j = 1.5;\nlet T = class extends r(t) {\n  get isMeshPyramid() {\n    return \"mesh-pyramids\" === this.layer.profile || \"MeshPyramid\" === this.layer.store?.lodType;\n  }\n  get isGraphics3D() {\n    return \"points\" === this.layer.profile;\n  }\n  get useMaximumNumberOfFeatures() {\n    return !this.isMeshPyramid && (null == this.layer.priority || \"High\" === this.layer.priority);\n  }\n  get indexStreamController() {\n    const e = this.layerView.view.resourceController.createStreamDataRequester(A.I3S_INDEX);\n    return new w(e, this.layer.customParameters, this.layer.apiKey);\n  }\n  get dataStreamController() {\n    const e = this.layerView.view.resourceController.createStreamDataRequester(A.I3S_DATA);\n    return new w(e, this.layer.customParameters, this.layer.apiKey);\n  }\n  get crsVertex() {\n    return v(this.layer);\n  }\n  get crsIndex() {\n    return C(this.layer);\n  }\n  get layer() {\n    return this.layerView.i3slayer;\n  }\n  get running() {\n    return this.updating;\n  }\n  get rootNodeVisible() {\n    if (this._index) {\n      const e = this._index.rootNode;\n      if (e) return this._updateViewData(), this._index.isNodeVisible(e.index);\n    }\n    return !0;\n  }\n  get index() {\n    return this._index;\n  }\n  get requiredAttributes() {\n    return this._requiredAttributes;\n  }\n  constructor(e) {\n    super(e), this.screenSizeFactor = 0, this.featureTarget = 5e4, this.fixedFeatureTarget = !1, this.updating = !0, this.updatingProgress = 1, this.leavesReached = !1, this.worker = null, this._featureLOD = 1, this._stableFeatureLOD = !1, this._isIdle = !1, this._cameraDirty = !0, this._invisibleDirty = !1, this._idleStateCallbacks = null, this._newLoadingNodes = new s({\n      deallocator: null\n    }), this._modificationsNodeFilteringArray = new s(), this._downloadingCount = 0, this._loadingNodes = new Map(), this._updatingNodes = new Map(), this._progressMaxNumNodes = 1, this._requiredAttributes = new Array(), this._requiredAttributesDirty = !0, this._updatesDisabled = !1, this.disableIDBCache = !1, this._disableMemCache = !1, this._restartNodeLoading = !1, this._fields = null, this._attributeStorageInfo = null, this._idleQueue = new c(), this._elevationUpdateNodes = new s({\n      deallocator: null\n    }), this._errorCount = 0;\n  }\n  initialize() {\n    const {\n      layerView: e,\n      layer: t\n    } = this;\n    this._disableMemCache = !e.loadCachedGPUData || !e.addCachedGPUData, this._lodHandling = new f(e), this._defaultGeometrySchema = t.store.defaultGeometrySchema, this.disableIDBCache = has(\"disable-feature:idb-cache\"), \"fields\" in t && (this._fields = t.fields, this._attributeStorageInfo = t.attributeStorageInfo), this.addResolvingPromise(Promise.all([t.indexInfo, t.when(), e.when()]).then(([s]) => {\n      if (this.destroyed || !e || e.destroyed || !s) return;\n      const {\n          view: r,\n          clientGeometry: a\n        } = e,\n        {\n          resourceController: l\n        } = r;\n      if (this._setClippingArea(r.clippingArea), this.addHandles([d(() => r?.pointsOfInterest?.focus?.renderLocation, e => this._pointOfInterestChanged(e), o), d(() => r.quality, () => this._setCameraDirty(), n), d(() => e.contentVisible, e => {\n        const t = e ? () => this._updateIdleState(!0) : () => this._updateViewData(),\n          i = e ? () => this._updateIdleState(!1) : () => {};\n        e && null != this._index && this._index.invalidateAllElevationRanges(), this._idleStateCallbacks ? (e || this.cancelNodeLoading(), this.restartNodeLoading(), this._idleStateCallbacks.idleBegin = t, this._idleStateCallbacks.idleEnd = i) : this._idleStateCallbacks = l.scheduler.registerIdleStateCallbacks(t, i);\n      }, o), m(e.view.resourceController.scheduler, this), d(() => e.uncompressedTextureDownsamplingEnabled, () => this.restartNodeLoading()), d(() => [this.featureTarget, this.fixedFeatureTarget], () => {\n        this._setCameraDirty(), this._stableFeatureLOD = !1;\n      }), d(() => r.state?.contentCamera, () => this._setCameraDirty()), d(() => t.elevationInfo, e => this._elevationInfoChanged(e)), d(() => e.lodFactor, () => this._setCameraDirty()), d(() => e.availableFields, () => this._requiredFieldsChange()), d(() => e.holeFilling, e => null != this._index && (this._index.holeFilling = e))]), this._viewportQueries = new D(this.crsIndex, r.renderCoordsHelper, r.state.contentCamera, !r.state.fixedContentCamera || this.isGraphics3D, this._clippingArea, this.isMeshPyramid ? r.basemapTerrain : r.elevationProvider, p(r.viewingMode), this.layer.elevationInfo, {\n        progressiveLoadFactor: this._getProgressiveLoadFactor(),\n        screenspaceErrorBias: this._lod,\n        angleDependentLoD: this._lod < .5\n      }), this._clientNodeLoader = new g(this.layer.uid, {\n        indexSR: this.crsIndex,\n        vertexSR: this.crsVertex,\n        renderSR: r.renderCoordsHelper.spatialReference,\n        localMode: \"local\" === r.viewingMode\n      }, r.resourceController.memoryController, this.worker), this._index = new y(p(r.viewingMode), t, s, this.indexStreamController, this._clientNodeLoader, this._viewportQueries, i.getLogger(this), e.holeFilling, t => e.isNodeLoaded(t), t => e.isNodeReloading(t), e => this._shouldLoadNode(e), e => this._enableFromGPUCache(e, x.Leaf), e => this._needsUpdate(e), () => !this.indexStreamController.busy, t => e.computeVisibilityObb?.(t) ?? null, e?.computeNodeFiltering ? t => e.computeNodeFiltering(t) : void 0), this._index.updateElevationInfo(this.layer.elevationInfo, this.isMeshPyramid || this.isGraphics3D), this._index.imModificationsChanged(!!e.hasModifications), this._index.layerFilterChanged(!!e.hasGeometryFilter), null != a) {\n        for (const e of a) this._addMesh(e.mesh, e.oid);\n        this.addHandles(a.on(\"change\", e => {\n          for (const t of e.removed) this._removeMesh(t.oid);\n          for (const t of e.added) this._addMesh(t.mesh, t.oid);\n        }));\n      }\n      this._startNodeLoading();\n    }));\n  }\n  updateNodeModificationStatus(e) {\n    const t = this._index,\n      i = this.layerView;\n    null != t && i?.updateNodeModificationStatus && (this._modificationsNodeFilteringArray.clear(), e.forAll(e => {\n      const i = t.getNode(e);\n      null != i && this._modificationsNodeFilteringArray.push(i);\n    }), i.updateNodeModificationStatus(this._modificationsNodeFilteringArray), this._invisibleDirty = !0);\n  }\n  destroy() {\n    this.cancelNodeLoading(), this._idleStateCallbacks && (this._isIdle = !1, this._idleStateCallbacks.remove(), this._idleStateCallbacks = null), this._nodeLoader = null, E.prune(), null != k && (k.hide(), k = null);\n  }\n  get viewportQueries() {\n    return this._viewportQueries;\n  }\n  _getRequiredAttributes() {\n    if (null == this._attributeStorageInfo || !this._fields || !this.layerView.availableFields) return [];\n    const e = this._attributeStorageInfo,\n      t = this._fields,\n      i = this.layer.objectIdField;\n    return this.layerView.availableFields.map(i => {\n      const s = H(e, i),\n        r = H(t, i);\n      return s >= 0 && r >= 0 ? {\n        index: s,\n        name: t[r].name,\n        field: t[r],\n        attributeStorageInfo: e[s]\n      } : null;\n    }).filter(e => null != e && e.name !== i);\n  }\n  _requiredFieldsChange() {\n    const e = this._getRequiredAttributes();\n    R(this._requiredAttributes, e) || (this._requiredAttributes = e, this._requiredAttributesDirty = !1, this.restartNodeLoading());\n  }\n  requestUpdate() {\n    this._requiredAttributesDirty = !0, this.restartNodeLoading();\n  }\n  _setClippingArea(e) {\n    const t = _();\n    I(e, t, this.layerView.view.renderSpatialReference) ? this._clippingArea = t : this._clippingArea = null;\n  }\n  _pointOfInterestChanged(e) {\n    null != this._viewportQueries && (this._viewportQueries.setPointOfInterest(e), null != this._index && (this._index.progressiveLoadPenalty = z.distancePenalty * this._viewportQueries.distCameraToPOI(), this._index.requestUpdate()));\n  }\n  updateClippingArea(e) {\n    this._setClippingArea(e), null != this._viewportQueries && null != this._index && (this._viewportQueries.updateClippingArea(this._clippingArea), this._index.invalidateVisibilityCache()), this._setCameraDirty();\n  }\n  _setCameraDirty() {\n    this._cameraDirty = !0, this._lodHandling.setLodGlobalDirty(), this._evaluateUpdating();\n  }\n  _addMesh(e, t) {\n    if (null == this._index) return;\n    const i = this._clientNodeLoader.createMeshNodeInfo(e, t),\n      s = this._index.addClientNodeToIndex(i.id, i.mbs);\n    this._clientNodeLoader.addMeshNode(s, i), this._evaluateUpdating(), this.notifyChange(\"rootNodeVisible\");\n  }\n  _removeMesh(e) {\n    const t = this._clientNodeLoader.getMeshNodeIndex(e);\n    if (null != t) {\n      if (null == this._index) throw new Error(\"delayed removal of client side i3s node geometry not supported yet.\");\n      {\n        const e = (e, t) => {\n            this.layerView.removeNode(t), this._clientNodeLoader.removeNode(e), this.layerView.deleteCachedNodeData && null != e && this.layerView.deleteCachedNodeData(e), this.layerView.deleteCachedGPUData?.(this.layerView.loadCachedGPUData?.(t));\n          },\n          i = (e, t, i) => {\n            this._clientNodeLoader.updateNodeIndex(e, t, i), this.layerView.updateNodeIndex && this.layerView.updateNodeIndex(t, i);\n          };\n        this._index.removeClientNodeFromIndex(t, e, i), this.notifyChange(\"rootNodeVisible\");\n      }\n    }\n  }\n  updateElevationChanged(e, t) {\n    const i = this._index;\n    if (null == i?.rootNode || null == t) return null;\n    this.crsIndex.equals(t) || (u(e, t, B, this.crsIndex), e = B);\n    const s = this._elevationUpdateNodes;\n    return s.clear(), L(e, i.rootNode, i, e => s.push(e.index)), s.length && (s.forAll(e => i.updateElevationChanged(e)), this._setCameraDirty()), s;\n  }\n  removeAllGeometryObbs() {\n    null != this._index && this._index.removeAllGeometryObbs();\n  }\n  getRenderMbs(e) {\n    return null != this._viewportQueries ? this._viewportQueries.getServiceMbsInRenderSR(e) : null;\n  }\n  _elevationInfoChanged(e) {\n    null != this._index && (this._index.updateElevationInfo(e, this.isMeshPyramid || this.isGraphics3D), this._setCameraDirty());\n  }\n  restartNodeLoading() {\n    this._restartNodeLoading = !0, this.cancelNodeLoading(), this._evaluateUpdating();\n  }\n  schedule(e, t) {\n    return this._idleQueue.push(e, t);\n  }\n  reschedule(e, t) {\n    return this._idleQueue.unshift(e, t);\n  }\n  get _isIntegratedMesh() {\n    return \"integrated-mesh\" === this.layer.type;\n  }\n  get unloadedMemoryEstimate() {\n    return null != this._index && this.layerView.contentVisible ? this._index.unloadedMemoryEstimate * this._lodDropFactor : 0;\n  }\n  async _loadNodeData(e, t) {\n    return e.index < 0 ? this._clientNodeLoader.loadNodeData(e.id, t) : this._nodeLoader.loadNodeData(e, t);\n  }\n  async _loadAttributes(e, t, i) {\n    return (e.index < 0 ? this._clientNodeLoader : this._nodeLoader).loadAttributes(e, t, i);\n  }\n  get indexDepth() {\n    return null != this._index ? this._index.maxLevel : 0;\n  }\n  set disableMemCache(e) {\n    this.layerView.loadCachedGPUData && this.layerView.addCachedGPUData ? this._disableMemCache = e : this._disableMemCache = !0;\n  }\n  runTask(e, t) {\n    return this.layerView.contentVisible ? this.layerView.visible && null != this._index ? (this._processWithErrorLogging(e, t), this._index.maxPriority) : -1 / 0 : (this._updateViewData(), this._evaluateUpdating(), -1 / 0);\n  }\n  _processWithErrorLogging(e, t) {\n    try {\n      this._process(e, t);\n    } catch (s) {\n      this._errorCount < 50 ? i.getLogger(this).error(`Error during processing: ${s} at ${s.stack}`) : 50 === this._errorCount && i.getLogger(this).error(\"Too many errors for this layer. Further errors will not be displayed.\"), this._errorCount++;\n    }\n  }\n  _process(e, t) {\n    this._restartNodeLoading && this._startNodeLoading(), null != this._nodeLoader && null != this._index && (this._updateViewData(), this._invisibleDirty && this._removeInvisibleNodes(e) && (this._invisibleDirty = !1), this._isIntegratedMesh && (e.enabled = !1), e.run(() => this._processIndex(e)), this._updateFeatureLOD(), e.run(() => this._processCache(e)), this._isIntegratedMesh && (e.enabled = !0), e.run(() => this._processNodes(e, t)), this._idleQueue.runTask(e), e.run(() => this._prefetchIndex()), t.numIndexLoading += this._index.indexLoading, t.numNodesLoading += this._downloadingCount, e.run(() => this._lodHandling.lodGlobalHandling(e)), this._evaluateUpdating());\n  }\n  _processIndex(e) {\n    if (null == this._index) return !1;\n    if (this._index.dirty) {\n      this._newLoadingNodes.clear(), this._index.update(Array.from(this._loadingNodes.keys()), e, e => this.updateNodeModificationStatus(e)), this._disableMemCache || (this._newLoadingNodes.pushArray(this._index.updates.add.data, this._index.updates.add.length), this._newLoadingNodes.pushArray(this._index.updates.missing.data, this._index.updates.missing.length));\n      const t = this._index.featureEstimate.leavesReached;\n      this._index.isLoading || t === this._get(\"leavesReached\") || this._set(\"leavesReached\", t);\n    }\n    return this._index.load();\n  }\n  _prefetchIndex() {\n    return !(null == this._index || this._loadingNodes.size > 0 || this._index.updates.add.length > 0) && this._index.prefetch();\n  }\n  _updateFeatureLOD() {\n    if (!this.useMaximumNumberOfFeatures || null == this._index || null == this._viewportQueries) return;\n    const e = !this._index.isLoading,\n      t = this.featureTarget * this._baseLOD,\n      i = this._index.featureEstimate;\n    if (i.estimate = i.estimate || t / 2, this._index.indexMissing > Q) {\n      if (this._featureLOD <= q) return;\n      this._featureLOD /= j, this._stableFeatureLOD = !1;\n    } else if (e && i.estimate < t) {\n      if (i.leavesReached || this._featureLOD >= U || this._stableFeatureLOD) return;\n      const e = Math.min(10, Math.max(t / i.estimate, 1.001));\n      this._featureLOD *= e;\n      const s = this._lod,\n        r = this._index.checkFeatureTarget(t, s);\n      r !== s && (this._featureLOD = r / this._baseLOD, this._stableFeatureLOD = !0);\n    } else {\n      if (!(i.estimate > t * G || e && i.estimate > t)) return;\n      if (this._featureLOD <= q) return;\n      this._featureLOD /= 1 + .25 * (i.estimate / t - 1), this._stableFeatureLOD = !1;\n    }\n    this._featureLOD = Math.min(U, Math.max(q, this._featureLOD)), this._viewportQueries.updateScreenSpaceErrorBias(this._lod), this._index.requestUpdate();\n  }\n  _processCache(e) {\n    const t = this._index;\n    if (null == t) return !1;\n    for (; this._newLoadingNodes.length > 0 && !e.done;) {\n      const i = this._newLoadingNodes.pop();\n      for (let s = t.getParent(i); null != s && !this.layerView.isNodeLoaded(s.index); s = t.getParent(s.index)) if (this._enableFromGPUCache(s, x.Hole)) {\n        e.madeProgress();\n        break;\n      }\n    }\n    return e.hasProgressed;\n  }\n  _processNodes(e, t) {\n    if (null == this._index) return !1;\n    let i = (this._isIdle ? O : P) - this._loadingNodes.size;\n    const s = this._index.updates;\n    for (s.cancel.forEach(this._cancelNode, this), s.cancel = []; s.remove.length > 0 && !e.done;) this.layerView.removeNode(s.remove.pop()), e.madeProgress();\n    for (; s.update.length > 0 && !e.done;) {\n      const t = this._index.getNode(s.update.pop());\n      null != t && (this._updateLoadedNode(t), e.madeProgress());\n    }\n    for (; s.add.length > 0 && !e.done && i > 0;) {\n      --i;\n      const r = this._index.getNode(s.add.back());\n      if (null == r || r.cacheState !== b.Cached && !this._hasNodeLoadToken(t)) break;\n      s.add.pop(), this._loadNode(r), e.madeProgress();\n    }\n    return e.hasProgressed;\n  }\n  _cancelAllNodes() {\n    this._loadingNodes.forEach(e => e.abort()), this._loadingNodes.clear(), this._updatingNodes.forEach(e => e.abort()), this._updatingNodes.clear();\n  }\n  _cancelNode(e) {\n    const t = this._loadingNodes.get(e);\n    t && (t.abort(), this._loadingNodes.delete(e));\n  }\n  _hasNodeLoadToken(e) {\n    return !(!this._isIdle && e.numNodesLoading + this._loadingNodes.size >= P) && this._downloadingCount < S && !this.dataStreamController.busy;\n  }\n  _evaluateUpdating() {\n    let e = !1,\n      t = 0;\n    if (this.layerView) {\n      if (this.layerView.contentVisible) {\n        const i = (null != this._index ? this._index.indexMissing : 0) + 3 * (null != this._index ? this._index.updates.add.length : 0) + 2 * this._loadingNodes.size;\n        e = !!(i > 0 || this._updatingNodes.size > 0 || this._restartNodeLoading || this._cameraDirty || this._idleQueue.running || this._lodHandling && this._lodHandling.requiresLODGlobalHandling || null != this._index && this._index.isPrefetching), 0 === i && (this._progressMaxNumNodes = 1), this._progressMaxNumNodes = Math.max(i, this._progressMaxNumNodes), t = 1 - i / this._progressMaxNumNodes;\n      } else e = this._cameraDirty, t = e ? 0 : 1;\n      this.updating = e, this.updatingProgress = t;\n    }\n  }\n  _updateViewData() {\n    if (!this._cameraDirty || null == this._index || null == this._viewportQueries) return;\n    const e = this.layerView.view,\n      {\n        contentCamera: t,\n        fixedContentCamera: i\n      } = e.state;\n    this.screenSizeFactor = 1 / (t.perScreenPixelRatio / 2), this._viewportQueries.updateCamera(t, !i || this.isGraphics3D), this._viewportQueries.setPointOfInterest(e.pointsOfInterest.focus.renderLocation), this._viewportQueries.updateScreenSpaceErrorBias(this._lod), this._index.invalidateVisibilityCache(), this._index.progressiveLoadPenalty = z.distancePenalty * this._viewportQueries.distCameraToPOI(), this._index.requestUpdate(), this._stableFeatureLOD = !1, this._invisibleDirty = !0, this._cameraDirty = !1, this.notifyChange(\"rootNodeVisible\");\n  }\n  _getProgressiveLoadFactor() {\n    return this.layerView.view.quality < 1 ? 1 : this.layerView.progressiveLoadFactor;\n  }\n  get _lod() {\n    return this._featureLOD * this._baseLOD;\n  }\n  get _baseLOD() {\n    const e = this.layerView.lodFactor;\n    return this.fixedFeatureTarget ? 1 : (e > 0 ? e : 1) * this.layerView.view.quality;\n  }\n  get _lodDropFactor() {\n    if (this.fixedFeatureTarget) return 1;\n    return (Math.min(this.layerView.view.quality, .5) - M) / (.5 - M);\n  }\n  isGeometryVisible(e) {\n    return !!this._index?.isGeometryVisible(e.index);\n  }\n  updateVisibility(e) {\n    this._index?.invalidateNodeVisibilityCache(e);\n  }\n  invalidateGeometryVisibility(e) {\n    this._index?.invalidateGeometryVisibility(e);\n  }\n  invalidateVisibilityObbs() {\n    this._index?.invalidateVisibilityObbs();\n  }\n  modificationsChanged() {\n    this._index?.imModificationsChanged(!!this.layerView.hasModifications), this._invisibleDirty = !0;\n  }\n  _shouldLoadNode(e) {\n    return !(!this._lodHandling.shouldLoadNode(e) || this._shouldDropNode(e)) && !(null == this._index || !this._index.isGeometryVisible(e.index));\n  }\n  _shouldDropNode(e) {\n    if (null == this._viewportQueries) return !1;\n    const t = this._lodDropFactor;\n    if (t >= 1 || !this._lodHandling.hasNoVisibleChildren(e)) return !1;\n    return Math.abs(this._viewportQueries.calcCameraDistanceToCenter(e)) - this._viewportQueries.minDistance > (this._viewportQueries.maxDistance - this._viewportQueries.minDistance) * t;\n  }\n  _startNodeLoading() {\n    this._restartNodeLoading = !1;\n    const e = this._index;\n    if (this._updatesDisabled || null == e || null == this._viewportQueries) return;\n    this._updateViewData(), this._requiredAttributesDirty && (this._requiredAttributes = this._getRequiredAttributes(), this._requiredAttributesDirty = !1);\n    const t = {\n      textureEncodings: this.layerView.supportedTextureEncodings,\n      uncompressedTextureDownsamplingEnabled: this.layerView.uncompressedTextureDownsamplingEnabled,\n      textureUsageMask: this.layerView.rendererTextureUsage,\n      loadFeatureData: this.useMaximumNumberOfFeatures\n    };\n    this._nodeLoader = new N(this.layer, this.dataStreamController, i.getLogger(this), this._defaultGeometrySchema, this._requiredAttributes, t), e.requestUpdate(), this._lodHandling.startNodeLoading((e, t) => this._removeNodes(e, t, $.fadeout), e, {\n      maxLodLevel: this._viewportQueries.maxLodLevel\n    }), this._evaluateUpdating();\n  }\n  isNodeLoading() {\n    return null != this._nodeLoader && null != this._index;\n  }\n  cancelNodeLoading() {\n    this.isNodeLoading() && (this.indexStreamController.cancelAll(), this.dataStreamController.cancelAll(), this._idleQueue.cancelAll(), this._cancelAllNodes(), this._nodeLoader = null, this._evaluateUpdating());\n  }\n  _removeInvisibleNodes(e) {\n    const t = this._index;\n    if (null == t || null == this._viewportQueries) return !1;\n    E.clear(), this.layerView.getLoadedNodeIndices(E);\n    const i = 0 === this._viewportQueries.maxDistance,\n      s = i ? () => !1 : e => this._shouldDropNode(e);\n    return E.filterInPlace(e => {\n      const i = t.getNode(e);\n      return null == i || !t.isGeometryVisible(e) || s(i);\n    }), E.length > 0 && this._lodHandling.setLodGlobalDirty(), this._removeNodes(E, e, $.pop), !(i && this._lodDropFactor < 1) && (0 === E.length || (E.clear(), !1));\n  }\n  markNodeToRemove(e) {\n    E.push(e);\n  }\n  removeMarkedNodes() {\n    this._removeNodes(E, F, $.pop);\n  }\n  _removeNodes(e, t, i) {\n    if (0 !== e.length && !t.done) for (null != this._index && this._index.requestUpdate(); e.length > 0 && !t.done;) {\n      const s = e.pop(),\n        r = this._index;\n      i === $.fadeout && this.layerView.nodeFadeoutEnabled && null != r && r.isGeometryVisible(s) ? this.layerView.fadeNode(s, V.FadeOut, !0) : this.layerView.removeNode(s), t.madeProgress();\n    }\n  }\n  _needsUpdate(e) {\n    if (e.resources.isEmpty || this._updatingNodes.has(e.index)) return !1;\n    const t = this.layerView.getLoadedAttributes(e.index);\n    return null != t && t !== this._requiredAttributes;\n  }\n  async _updateLoadedNode(e) {\n    const t = new AbortController();\n    this._updatingNodes.set(e.index, t), this._evaluateUpdating();\n    try {\n      const i = R(this.layerView.getLoadedAttributes(e.index), this._requiredAttributes);\n      let s = null;\n      s = i ? this.layerView.getAttributeData(e.index) : await this._loadAttributes(e, this._requiredAttributes, t.signal), await this.schedule(() => this.layerView.updateAttributes(e.index, {\n        loadedAttributes: this._requiredAttributes,\n        attributeData: s\n      }, t.signal), t.signal);\n    } catch (i) {\n      if (!a(i)) return this.layerView.updateAttributes(e.index, {\n        loadedAttributes: this._requiredAttributes,\n        attributeData: {}\n      }, t.signal);\n    }\n    this._updatingNodes.delete(e.index), this._evaluateUpdating();\n  }\n  _loadNode(e) {\n    if (this._loadingNodes.has(e.index)) return void i.getLogger(this).error(\"already loading node \" + e.index);\n    const t = new AbortController();\n    this._loadingNodes.set(e.index, t), this._evaluateUpdating(), this._loadAndAddNode(e, t.signal).then(i => {\n      i && null != this._index && this._loadingNodes.get(e.index) === t && (this._loadingNodes.delete(e.index), this._index.requestUpdate());\n    }).catch(e => {\n      if (!a(e)) throw e;\n    }).finally(() => {\n      this._loadingNodes.get(e.index) === t && this._loadingNodes.delete(e.index), this._evaluateUpdating();\n    });\n  }\n  _loadAndAddNode(e, t) {\n    return e.cacheState === b.Uncached ? this._loadUncached(e, t).then(() => !1) : this._loadCached(e, t).then(t => !t && (e.cacheState = b.Uncached, !0)).catch(t => !a(t) && (e.cacheState = b.Uncached, !0));\n  }\n  _enableFromGPUCache(e, t) {\n    if (this._disableMemCache || null == this._index) return !1;\n    if (t === x.Hole && !this._index.useNodeAsHole(e.index)) return !0;\n    const i = this._loadCachedGPUData(e);\n    return !!i && (this.layerView.addCachedGPUData(e, i, t), this._nodeAdded(), !0);\n  }\n  _loadCachedGPUData(e) {\n    const t = this.layerView.loadCachedGPUData(e.index);\n    return null != t?.attributeInfo && R(t.attributeInfo.loadedAttributes, this._requiredAttributes) ? t : (this.layerView.deleteCachedGPUData(t), null);\n  }\n  _nodeAdded() {\n    null != this._index && this._index.requestUpdate(), this._lodHandling.setLodGlobalDirty(), this._evaluateUpdating();\n  }\n  updateLoadStatus(e, t) {\n    const i = this._index;\n    null != i && i.updateChildrenLoaded(e, t ? 1 : -1);\n  }\n  async _loadCached(e, t) {\n    if (this._enableFromGPUCache(e, x.Leaf)) return !0;\n    const i = this.layerView;\n    if (this.disableIDBCache || !i.loadCachedNodeData || !i.addCachedNodeData) return !1;\n    const s = (t, i) => this._nodeLoader.loadTextures(e, t, i),\n      r = (t, i) => this._clientNodeLoader.loadTextures(e, t, i),\n      a = e.index >= 0 ? s : r,\n      d = await this.schedule(() => i.loadCachedNodeData(e, t, a), t);\n    if (null == d) return !1;\n    const o = this._requiredAttributes,\n      n = await this.reschedule(() => this._loadAttributes(e, o, t), t);\n    return await this.reschedule(() => i.addCachedNodeData(e, d, {\n      loadedAttributes: o,\n      attributeData: n\n    }, t), t), this._nodeAdded(), !0;\n  }\n  _loadUncached(e, t) {\n    return this._downloadingCount++, this._loadNodeData(e, t).catch(e => {\n      throw this._downloadingCount--, e;\n    }).then(i => (this._downloadingCount--, this.schedule(() => this.layerView.addNode(e, i, t), t))).then(() => {\n      this._nodeAdded(), e.cacheState = b.Cached;\n    }).catch(t => {\n      if (!a(t)) throw i.getLogger(this).error(\"#loadNodeData()\", this.layer, `Failed to load node '${e.id}'`, t), e.failed = !0, null != this._index && this._index.requestUpdate(), t;\n    });\n  }\n  _updateIdleState(e) {\n    e !== this._isIdle && (this._isIdle = e, this._evaluateUpdating(), e && this._index && null != this._index && this._index.resetFailedNodes());\n  }\n  get test() {}\n  notifyLODUpdate() {\n    this._lodHandling.setLodGlobalDirty(), this._evaluateUpdating(), null != this._index && this._index.requestUpdate();\n  }\n  geometryFilterChanged(e) {\n    const t = this._index;\n    null != t && t.layerFilterChanged(e), this._setCameraDirty();\n  }\n};\ne([l({\n  readOnly: !0\n})], T.prototype, \"isMeshPyramid\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"isGraphics3D\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"useMaximumNumberOfFeatures\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"indexStreamController\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"dataStreamController\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"crsVertex\", null), e([l({\n  readOnly: !0\n})], T.prototype, \"crsIndex\", null), e([l()], T.prototype, \"screenSizeFactor\", void 0), e([l()], T.prototype, \"featureTarget\", void 0), e([l()], T.prototype, \"fixedFeatureTarget\", void 0), e([l()], T.prototype, \"layerView\", void 0), e([l()], T.prototype, \"layer\", null), e([l()], T.prototype, \"updating\", void 0), e([l({\n  readOnly: !0\n})], T.prototype, \"running\", null), e([l()], T.prototype, \"updatingProgress\", void 0), e([l({\n  readOnly: !0\n})], T.prototype, \"leavesReached\", void 0), e([l({\n  constructOnly: !0\n})], T.prototype, \"worker\", void 0), e([l({\n  readOnly: !0,\n  dependsOn: []\n})], T.prototype, \"rootNodeVisible\", null), T = e([h(\"esri.layers.graphics.controllers.I3SOnDemandController\")], T);\nconst E = new s({\n  deallocator: null\n});\nlet k;\nfunction R(e, t) {\n  return null != e && e.length === t.length && e.every(e => H(t, e.name) >= 0);\n}\nfunction H(e, t) {\n  const i = t.toLowerCase();\n  for (let s = 0; s < e.length; s++) if (e[s].name.toLowerCase() === i) return s;\n  return -1;\n}\nconst z = {\n    factorIM: .2,\n    factor3dObject: .05,\n    distancePenalty: 10\n  },\n  B = _();\nvar $;\n!function (e) {\n  e[e.pop = 0] = \"pop\", e[e.fadeout = 1] = \"fadeout\";\n}($ || ($ = {}));\nconst K = T;\nexport { K as default };", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../request.js\";\nimport i from \"../../../../core/Accessor.js\";\nimport { splitIntoChunks as r } from \"../../../../core/arrayUtils.js\";\nimport { resultOrAbort as s, result as o } from \"../../../../core/asyncUtils.js\";\nimport { estimateStringByteSize as n, estimateNumberByteSize as a } from \"../../../../core/byteSizeEstimations.js\";\nimport d from \"../../../../core/Collection.js\";\nimport { makeHandle as c } from \"../../../../core/handleUtils.js\";\nimport \"../../../../core/has.js\";\nimport h from \"../../../../core/Logger.js\";\nimport { destroyMaybe as l, abortMaybe as u } from \"../../../../core/maybe.js\";\nimport { whenOrAbort as m, createResolver as g } from \"../../../../core/promiseUtils.js\";\nimport p from \"../../../../core/ReactiveSet.js\";\nimport { watch as y, initial as f } from \"../../../../core/reactiveUtils.js\";\nimport { property as b } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport { subclass as _ } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { equals as v } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { formatNumber as O } from \"../../../../intl/number.js\";\nimport { getMaximumQuerySize as j, queryAllJSON as C } from \"../../../../layers/support/featureQueryAll.js\";\nimport { assetMapFromAssetMapsJSON as w, extractMesh as I } from \"../../../../rest/support/meshFeatureSet.js\";\nimport { direct3DObjectFeatureLayerDisplayEnabled as F, i3sPatchingEnabled as A, sceneLayerEditingEnabled as L } from \"../../../../support/featureFlags.js\";\nimport { isTimeoutError as x } from \"../../../../support/requestUtils.js\";\nimport { ViewingMode as S } from \"../../../ViewingMode.js\";\nimport E from \"../FeatureLayerView3D.js\";\nlet G = class extends i {\n  constructor(e) {\n    super(e), this._warnMaximumChangedObjectsExceeded = !1, this._maximumNumberOfEditOVerrides = V, this._original3DOFLDefinitionExpression = null, this._interactiveEditingSessions = new d(), this.geometryOverrides = new d(), this._clientGeometryCache = new Map(), this._associatedLayerView = null, this._attributeChangedObjectIds = new p(), this._geometryChangedObjectIds = new p(), this._pendingFetchChangedObjectIds = null, this._pendingFetchAbortController = new AbortController(), this._featureIdLocks = new Map();\n  }\n  initialize() {\n    this._memCache = this.memoryController.newCache(`i3s-attribute-overrides-${this.layer.uid}`), this._pendingFetchChangedObjectIds = this._fetchChangedObjectIds(this._pendingFetchAbortController?.signal), this._pendingFetchChangedObjectIds.finally(() => {\n      this._pendingFetchAbortController = null, this._pendingFetchChangedObjectIds = null;\n    }), this.is3DOFL && null != this._associatedLayer && (F() ? this._associatedLayer.load().then(e => {\n      this.destroyed || (this._original3DOFLDefinitionExpression = e.definitionExpression, this.addHandles(y(() => this._definitionExpression, t => e.definitionExpression = t, f)), this._associatedLayerView = new E({\n        layer: this._associatedLayer,\n        view: this.view\n      }));\n    }) : A());\n  }\n  destroy() {\n    this.is3DOFL && null != this._associatedLayer && (F() ? null != this._associatedLayerView && (this._associatedLayer.definitionExpression = this._original3DOFLDefinitionExpression) : A()), this._set(\"layer\", null), this._memCache = l(this._memCache), this._pendingFetchAbortController = u(this._pendingFetchAbortController), this._pendingFetchChangedObjectIds = null, this._featureIdLocks.clear();\n  }\n  get is3DOFL() {\n    return L() && null != this._associatedLayer?.infoFor3D;\n  }\n  get sortedGeometryChangedObjectIds() {\n    return this.is3DOFL ? [...this._geometryChangedObjectIds].sort((e, t) => e - t) : [];\n  }\n  get _associatedLayer() {\n    return null == this.layer ? null : this.layer.associatedLayer;\n  }\n  get hasGeometryChanges() {\n    return this._geometryChangedObjectIds.size > 0;\n  }\n  get _definitionExpression() {\n    const e = this.sortedGeometryChangedObjectIds;\n    return 0 === e.length ? \"1 = 0\" : `OBJECTID IN (${e.join(\",\")})`;\n  }\n  get updating() {\n    if (!this.is3DOFL) return !1;\n    if (this._pendingFetchChangedObjectIds) return !0;\n    if (F()) {\n      return !(null != this._associatedLayerView) || null != this._associatedLayerView && this._associatedLayerView.updating;\n    }\n    return !1;\n  }\n  get isEmpty() {\n    return null == this._pendingFetchChangedObjectIds && 0 === this._attributeChangedObjectIds.size && 0 === this._geometryChangedObjectIds.size;\n  }\n  featureHasGeometryChanges(e) {\n    return this._geometryChangedObjectIds.has(e);\n  }\n  featureHasAttributeChanges(e) {\n    return this._attributeChangedObjectIds.has(e);\n  }\n  createInteractiveEditSession(e) {\n    this._attributeChangedObjectIds.add(e);\n    const t = this._interactiveEditingSessions,\n      i = new D(e, () => {\n        t.remove(i);\n      });\n    return t.unshift(i), i;\n  }\n  async applyAttributeOverrides(e, t, i, r = []) {\n    if (this._pendingFetchChangedObjectIds && (await m(this._pendingFetchChangedObjectIds, i)), null == t) return;\n    const {\n      attributeData: s,\n      loadedAttributes: o\n    } = t;\n    if (null == o || null == s || 0 === this._attributeChangedObjectIds.size) return;\n    const n = new Set();\n    for (const d of o) n.add(d.index);\n    for (const d of r) n.has(d.index) || (o.push(d), s[d.name] = new Array(e.length));\n    const a = await this._lockFeatureIds(e);\n    try {\n      const t = {\n          attributeData: s,\n          loadedAttributes: o\n        },\n        r = this._getOverridesFromCache(e, t, this._attributeChangedObjectIds),\n        {\n          objectIds: n,\n          fieldNames: a\n        } = r;\n      if (0 === n.length || 0 === a.length) return;\n      const d = await this._queryAttributeOverridesFromAssociatedLayer(n, a, i);\n      if (null == d) return;\n      this._processOverridesFromAssociatedLayer(e, d, a, t);\n    } finally {\n      a.remove();\n    }\n  }\n  updateGeometry(e, t) {\n    this._geometryChangedObjectIds.add(e);\n    const i = this._clientGeometryCache.get(e);\n    if (null != i && (this.geometryOverrides.remove(i), this._clientGeometryCache.delete(e)), null != t) {\n      const i = {\n        oid: e,\n        mesh: t\n      };\n      this.geometryOverrides.add(i), this._clientGeometryCache.set(e, i);\n    }\n  }\n  updateAttributeValue(e, t, i) {\n    this._attributeChangedObjectIds.add(e), this._cacheAttributeValue(e, t, i);\n  }\n  featureAdded(e) {\n    this.is3DOFL && A() && this._geometryChangedObjectIds.add(e), this._attributeChangedObjectIds.add(e);\n  }\n  _cacheAttributeValue(e, t, i) {\n    this._memCache.put(this._getAttributeCacheKey(e, t), i, this._memCacheAttributeValueSize(i));\n  }\n  _getOverridesFromCache(e, {\n    loadedAttributes: t,\n    attributeData: i\n  }, r) {\n    const s = new Set(),\n      o = new Array();\n    for (const a of t) o[a.index] = i[a.name];\n    const n = new Set();\n    for (let a = 0; a < e.length; a++) {\n      const i = e[a];\n      if (r.has(i)) for (const e of t) {\n        const t = this._attributeFromCache(i, e.index);\n        void 0 === t ? (s.add(i), n.add(e.name)) : o[e.index][a] = t;\n      }\n    }\n    return {\n      objectIds: Array.from(s),\n      fieldNames: Array.from(n)\n    };\n  }\n  _attributeFromCache(e, t) {\n    const i = this._fromInteractiveEditingSession(e, t);\n    if (void 0 !== i) return i;\n    const r = this._getAttributeCacheKey(e, t);\n    return this._memCache.get(r);\n  }\n  _fromInteractiveEditingSession(e, t) {\n    if (null != this._interactiveEditingSessions) for (const i of this._interactiveEditingSessions) {\n      if (i.objectId !== e) continue;\n      const r = i.getAttribute(t);\n      if (void 0 !== r) return r;\n    }\n  }\n  _getAttributeCacheKey(e, t) {\n    return `${e}-${t}`;\n  }\n  async _queryAttributeOverridesFromAssociatedLayer(e, t, i) {\n    if (0 === e.length) return null;\n    this._logWarningIfMaximumObjectsExceeded();\n    const {\n      associatedLayer: r\n    } = this.layer;\n    if (null == r) return null;\n    const s = r.createQuery(),\n      {\n        objectIdField: o\n      } = r,\n      n = [o, ...t];\n    s.where = \"1=1\", s.returnGeometry = !1, s.outFields = n, s.cacheHint = !0;\n    const a = await this._executeBatchQuery(r, e, s, i),\n      d = [];\n    for (const c of a) if (c.ok) for (const e of c.value.features) d.push(e);\n    return d;\n  }\n  async _queryGeometryOverridesFromAssociatedLayer(e, t) {\n    if (0 === e.length || !this.is3DOFL || !A()) return null;\n    const i = this.layer.associatedLayer,\n      r = i.infoFor3D,\n      {\n        spatialReference: s\n      } = i,\n      {\n        state: {\n          viewingMode: o\n        },\n        spatialReference: n\n      } = this.view,\n      a = o === S.Global,\n      d = s.isGeographic;\n    if (a && !d) return h.getLogger(this).warn(\"unsupported-pcs-edits-in-global-view\", this.layer.title, k(s, n, this.view.viewingMode, $.Mode)), null;\n    if (!a && d) return h.getLogger(this).warn(\"unsupported-gcs-edits-in-local-view\", this.layer.title, k(s, n, this.view.viewingMode, $.Mode)), null;\n    if (!(v(s, n) || a && n.isWebMercator && s.isWGS84)) return h.getLogger(this).warn(\"unsupported-mismatched-spatial-reference-edits\", this.layer.title, k(s, n, this.view.viewingMode, $.SpatialReference)), null;\n    this._logWarningIfMaximumObjectsExceeded();\n    const {\n        objectIdField: c,\n        globalIdField: l\n      } = i,\n      u = [c, ...(null != l ? [l] : [])],\n      m = i.createQuery();\n    m.where = \"1=1\", m.returnGeometry = !0, m.outFields = u, m.cacheHint = !0, m.returnZ = i.hasZ, m.returnM = i.hasM;\n    const g = await this._executeBatchQuery(i, e, m, t),\n      p = [];\n    for (const h of g) {\n      if (!h.ok) continue;\n      const e = h.value,\n        {\n          assetMaps: t,\n          features: i,\n          globalIdFieldName: o\n        } = e;\n      if (null == t) continue;\n      const n = w(r, t);\n      for (const a of i) {\n        const e = I(a, o, s, r, n),\n          t = a;\n        null != e ? (t.geometry = e, p.push(t)) : t.geometry = null;\n      }\n    }\n    return p;\n  }\n  _logWarningIfMaximumObjectsExceeded() {\n    if (!this._warnMaximumChangedObjectsExceeded) return;\n    this._warnMaximumChangedObjectsExceeded = !1;\n    let e = `The number of edited objects that are not yet cached in the scene service exceeds the maximum limit. Attribute changes will only be available for the first ${O(this._maximumNumberOfEditOVerrides)} objects. Please consider re-caching the scene service`;\n    const t = this.layer.portalItem;\n    e += t?.loaded ? ` (${t.portal.url}/home/item.html?id=${t.id}#settings)` : ` (${this.layer.parsedUrl.path})`, h.getLogger(this).warn(\"#queryOverrides()\", this.layer.title, `${e}.`);\n  }\n  async _executeBatchQuery(e, t, i, o) {\n    if (0 === t.length) return [];\n    const n = j(e);\n    t = [...t].sort((e, t) => e - t);\n    const a = r(t, n).map(t => {\n      const r = i.clone();\n      return r.objectIds = t, s(C(e, r, {\n        signal: o\n      }));\n    });\n    return Promise.all(a);\n  }\n  _processOverridesFromAssociatedLayer(e, t, i, {\n    loadedAttributes: r,\n    attributeData: s\n  }) {\n    const o = this._associatedLayer;\n    if (null == o) return;\n    const n = o.objectIdField,\n      a = i.map(t => (t in s || (s[t] = new Array(e.length)), s[t])),\n      d = new Map(r.map(e => [e.name, e.index])),\n      c = i.map(e => d.get(e)),\n      h = new Map(Array.from(e, (e, t) => [e, t]));\n    for (const l of t) {\n      const e = l.attributes[n];\n      for (let t = 0; t < i.length; t++) {\n        const r = c[t],\n          s = h.get(e),\n          o = l.attributes[i[t]];\n        a[t][s] = o, this._cacheAttributeValue(e, r, o);\n      }\n    }\n  }\n  _memCacheAttributeValueSize(e) {\n    return \"string\" == typeof e ? n(e) : a();\n  }\n  async _fetchChangedObjectIds(e) {\n    const i = this.layer;\n    await i.load({\n      signal: e\n    }), this._geometryChangedObjectIds.clear(), this._attributeChangedObjectIds.clear();\n    const {\n      associatedLayer: r\n    } = i;\n    if (null == r || !r.capabilities?.operations?.supportsChangeTracking) return;\n    const s = this._getFetchChangedObjectIdsServerGen();\n    if (null == s) return;\n    const n = r.layerId,\n      a = this.is3DOFL,\n      d = {\n        f: \"json\",\n        returnIdsOnly: !0,\n        layers: `[${n}]`,\n        returnUpdates: !0,\n        returnDeletes: a,\n        returnInserts: a,\n        layerServerGens: JSON.stringify([{\n          id: n,\n          serverGen: s\n        }])\n      };\n    if (a) {\n      const e = r.infoFor3D;\n      d.fieldsToCompare = JSON.stringify({\n        fields: [...Object.values(e.transformFieldRoles), e.sourceHashField]\n      });\n    }\n    const c = await o(t(`${r.url}/extractChanges`, {\n      method: \"post\",\n      query: d,\n      timeout: M,\n      signal: e\n    }));\n    if (!c.ok && x(c.error)) {\n      const e = this.layer.title;\n      h.getLogger(this).warn(\"extractChanges:timeout\", e, `${e} could not obtain edited features that are not cached in the scene service. Display of features may not be up to date with the latest edits. Consider re-caching the scene service.`);\n    }\n    if (c.ok && 1 === c.value.data?.edits?.length) {\n      const t = c.value.data.edits[0],\n        i = t?.objectIds,\n        s = t?.fieldUpdates,\n        o = i?.adds ?? [],\n        n = i?.updates ?? [],\n        d = i?.deletes ?? [],\n        h = [...o, ...n, ...d],\n        l = a ? [...o, ...(s ?? n), ...d] : [],\n        u = Math.min(this._maximumNumberOfEditOVerrides, h.length);\n      u < h.length && (this._warnMaximumChangedObjectsExceeded = !0);\n      const m = h.sort((e, t) => e - t);\n      for (let e = 0; e < u; ++e) {\n        const t = m[e];\n        this._attributeChangedObjectIds.add(t);\n      }\n      for (const e of l) this._geometryChangedObjectIds.add(e);\n      if (this.is3DOFL && A() && this._geometryChangedObjectIds.size > 0) {\n        const t = await this._queryGeometryOverridesFromAssociatedLayer(Array.from(this._geometryChangedObjectIds), e);\n        if (null != t) for (const e of t) null != e.geometry && this.updateGeometry(e.attributes[r.objectIdField], e.geometry);\n      }\n    }\n  }\n  _getFetchChangedObjectIdsServerGen() {\n    const e = this.layer;\n    if (null != e.serviceUpdateTimeStamp?.lastUpdate) return e.serviceUpdateTimeStamp.lastUpdate;\n    const t = e.associatedLayer;\n    return null != t?.serverGens?.minServerGen ? t.serverGens.minServerGen : null;\n  }\n  async _lockFeatureIds(e) {\n    const t = this._featureIdLocks;\n    let i = !0;\n    for (; i;) {\n      const r = new Array();\n      for (const i of e) {\n        const e = t.get(i);\n        e && r.push(e);\n      }\n      0 === r.length ? i = !1 : await Promise.all(r);\n    }\n    const r = g(),\n      s = r.promise;\n    for (const o of e) t.set(o, s);\n    return c(() => {\n      for (const i of e) t.delete(i);\n      r.resolve();\n    });\n  }\n  get test() {}\n};\ne([b({\n  constructOnly: !0\n})], G.prototype, \"view\", void 0), e([b({\n  constructOnly: !0\n})], G.prototype, \"layer\", void 0), e([b({\n  readOnly: !0\n})], G.prototype, \"is3DOFL\", null), e([b()], G.prototype, \"_interactiveEditingSessions\", void 0), e([b({\n  readOnly: !0\n})], G.prototype, \"sortedGeometryChangedObjectIds\", null), e([b({\n  readOnly: !0\n})], G.prototype, \"geometryOverrides\", void 0), e([b()], G.prototype, \"_clientGeometryCache\", void 0), e([b()], G.prototype, \"_associatedLayer\", null), e([b()], G.prototype, \"_associatedLayerView\", void 0), e([b({\n  constructOnly: !0\n})], G.prototype, \"memoryController\", void 0), e([b()], G.prototype, \"_attributeChangedObjectIds\", void 0), e([b()], G.prototype, \"_geometryChangedObjectIds\", void 0), e([b()], G.prototype, \"hasGeometryChanges\", null), e([b()], G.prototype, \"_pendingFetchChangedObjectIds\", void 0), e([b()], G.prototype, \"_pendingFetchAbortController\", void 0), e([b()], G.prototype, \"_definitionExpression\", null), e([b()], G.prototype, \"updating\", null), e([b()], G.prototype, \"isEmpty\", null), G = e([_(\"esri.views.3d.layers.i3s.I3SOverrides\")], G);\nclass D {\n  constructor(e, t) {\n    this.objectId = e, this._remove = t, this._updates = new Map(), this._isActive = !0;\n  }\n  getAttribute(e) {\n    return this._updates.get(e);\n  }\n  setAttribute(e, t) {\n    this.isActive && this._updates.set(e, t);\n  }\n  remove() {\n    this.isActive && (this._isActive = !1, this._remove());\n  }\n  get isActive() {\n    return this._isActive;\n  }\n}\nconst M = 1e4,\n  V = 5e4;\nvar $;\nfunction k(e, t, i, r) {\n  return `Displaying the edits of a SceneLayer with a${r === $.Mode ? e.isGeographic ? \" geographic \" : \" projected \" : \" \"}spatial reference (wkid:${e.wkid}) in ${i} viewing mode${r === $.SpatialReference ? ` with spatial reference (wkid:${t.wkid}) ` : \" \"}is not supported. No geometry edits will be displayed for this layer.\\nPlease consider re-caching the scene service or changing the ${r === $.Mode ? \"viewing mode\" : \"view spatial reference\"} to display edits.`;\n}\n!function (e) {\n  e[e.Mode = 0] = \"Mode\", e[e.SpatialReference = 1] = \"SpatialReference\";\n}($ || ($ = {}));\nexport { G as I3SOverrides };"],
  "mappings": "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",
  "names": ["e", "s", "c", "o", "t", "r", "a", "d", "n", "u", "g", "e", "m", "s", "l", "i", "h", "e", "t", "o", "r", "n", "s", "i", "p", "a", "f", "l", "d", "u", "c", "g", "M", "S", "_", "w", "b", "N", "v", "D", "x", "I", "R", "y", "G", "m", "j", "a", "S", "r", "s", "t", "e", "o", "l", "c", "h", "I", "s", "t", "i", "e", "h", "o", "r", "c", "N", "e", "t", "i", "n", "s", "o", "b", "I", "r", "d", "h", "u", "c", "g", "_", "f", "m", "v", "p", "P", "k", "M", "a", "l", "V", "x", "A", "D", "F", "z", "T", "C", "w", "S", "y", "L", "O", "a", "o", "e", "i", "s", "t", "d", "l", "n", "r", "a", "h", "u", "_", "c", "x", "L", "y", "m", "N", "h", "e", "o", "a", "s", "t", "r", "l", "i", "u", "p", "n", "x", "F", "b", "C", "P", "T", "f", "S", "c", "N", "m", "M", "w", "R", "D", "d", "e", "t", "r", "i", "o", "n", "h", "s", "a", "_", "u", "f", "y", "b", "F", "D", "p", "x", "A", "w", "T", "m", "c", "$", "j", "I", "S", "g", "U", "q", "B", "r", "e", "t", "s", "o", "a", "l", "i", "n", "u", "k", "H", "e", "t", "i", "s", "n", "r", "o", "a", "c", "I", "u", "G", "d", "L", "X", "Z", "Y", "P", "l", "h", "V", "z", "m", "_", "K", "p", "f", "v", "$", "U", "O", "F", "g", "b", "O", "P", "U", "q", "G", "Q", "j", "T", "n", "S", "e", "r", "i", "t", "o", "s", "a", "l", "h", "H", "I", "E", "k", "R", "u", "z", "B", "d", "$", "C", "K", "G", "S", "e", "V", "s", "a", "t", "n", "r", "i", "D", "_2", "o", "d", "c", "l", "k", "$", "u", "m", "g", "p", "h", "y", "b", "_", "M"]
}
