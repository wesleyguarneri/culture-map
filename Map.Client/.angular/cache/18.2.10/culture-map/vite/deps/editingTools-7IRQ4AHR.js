import {
  i as i8,
  o as o10,
  s as s5
} from "./chunk-KKP76EHB.js";
import {
  i as i6,
  p as p7
} from "./chunk-NGSE7GKF.js";
import {
  i as i7
} from "./chunk-XL7IZWA5.js";
import {
  P as P4,
  r as r10
} from "./chunk-W24CYY6Q.js";
import {
  w as w4
} from "./chunk-ILXHSVN4.js";
import {
  e as e13
} from "./chunk-EYQ4PV23.js";
import {
  E as E5,
  E2 as E6,
  F as F5,
  F2 as F7,
  d as d8
} from "./chunk-TO7VTJYA.js";
import "./chunk-BZ5ZVZXL.js";
import "./chunk-6PMC7Z2K.js";
import {
  F as F4,
  G as G4,
  R as R5,
  T,
  V as V2,
  h as h8,
  k,
  u as u9,
  x as x8
} from "./chunk-HUMP672Y.js";
import {
  h as h9,
  r as r8
} from "./chunk-ZYQL5F6K.js";
import "./chunk-Y5NSUEIF.js";
import "./chunk-Q6IZWY56.js";
import {
  l as l9
} from "./chunk-JBQJ3BUL.js";
import "./chunk-I5SWBGDW.js";
import {
  F2 as F6,
  c2 as c6,
  l as l10
} from "./chunk-LHQMQT36.js";
import {
  S as S5
} from "./chunk-YY43ZHCK.js";
import "./chunk-3FSYWRTQ.js";
import {
  Ei,
  H as H2,
  Hi,
  I as I2,
  Si,
  Ui,
  _i,
  ci,
  g as g4,
  gi,
  hi,
  li,
  v as v6
} from "./chunk-JGFBAWMN.js";
import "./chunk-5P5DJEOE.js";
import {
  A as A5,
  I,
  P as P5,
  a as a7,
  a2 as a8,
  b as b3,
  c as c7,
  d as d7,
  f as f7,
  g as g3,
  i as i5,
  j as j5,
  k as k2,
  l as l11,
  m as m5,
  n as n5,
  n2 as n6,
  o as o9,
  p as p6,
  q as q3,
  r as r9,
  s as s4,
  t as t7,
  t2 as t8,
  u as u10,
  u2 as u11,
  v as v5,
  x as x9
} from "./chunk-FP2KUV22.js";
import {
  j as j4
} from "./chunk-XJ3IF5WI.js";
import "./chunk-2VS3JZZD.js";
import "./chunk-WMR65EYY.js";
import "./chunk-PPQDPHZN.js";
import "./chunk-Z4AXZULQ.js";
import "./chunk-473Y3NGA.js";
import "./chunk-KD2H36E3.js";
import {
  o as o8
} from "./chunk-WUXIJQPM.js";
import {
  d as d6
} from "./chunk-4JZL2LJM.js";
import {
  c as c4,
  m as m3,
  u as u8
} from "./chunk-KYB3KTOZ.js";
import {
  R as R4
} from "./chunk-UNG626D3.js";
import "./chunk-OZB3UTFI.js";
import {
  f as f6
} from "./chunk-FW2XFDFF.js";
import "./chunk-B4LRUYYJ.js";
import {
  e as e12
} from "./chunk-6VVHYTZ7.js";
import "./chunk-UOKMPU6Y.js";
import {
  l as l7
} from "./chunk-V6LWWR2Z.js";
import {
  G as G3
} from "./chunk-RK23OHNG.js";
import "./chunk-QXRVL2BR.js";
import {
  A as A4,
  C as C2,
  D as D3,
  G as G2,
  M as M3,
  O as O2
} from "./chunk-SR7MLPR2.js";
import {
  x as x7
} from "./chunk-2RBDM2DS.js";
import {
  x as x6
} from "./chunk-MNNI2X2N.js";
import {
  e as e9
} from "./chunk-2SHZAJ7S.js";
import {
  R as R3,
  g as g2,
  y as y5
} from "./chunk-SBMU7RBF.js";
import "./chunk-QRVAQWLH.js";
import "./chunk-TMPIWG43.js";
import {
  l as l8
} from "./chunk-EU7GCI2A.js";
import {
  u as u7
} from "./chunk-WE6VW4MG.js";
import {
  x as x5
} from "./chunk-HKVPB4XN.js";
import {
  c as c5
} from "./chunk-DC55WDRO.js";
import {
  D,
  F as F3,
  e as e10,
  ee,
  f as f5,
  h as h7,
  t as t6,
  w2
} from "./chunk-ZYJAXFRJ.js";
import {
  D as D2,
  M as M2,
  S as S4,
  U,
  j as j3,
  n as n4,
  p as p4,
  v as v4,
  w as w3,
  z as z4
} from "./chunk-VRZ6RXNW.js";
import {
  m as m4
} from "./chunk-GN4ES4ZM.js";
import "./chunk-CGERANZG.js";
import "./chunk-XLRVEQZV.js";
import "./chunk-T35SJNQV.js";
import "./chunk-2CPAIFT3.js";
import {
  E as E3,
  E2 as E4,
  Y,
  Z as Z2,
  e as e11
} from "./chunk-Q666VSL3.js";
import "./chunk-P3B4Y6UN.js";
import "./chunk-TJIA4U42.js";
import "./chunk-T3EGKTN6.js";
import "./chunk-ZFPMGEAK.js";
import {
  p as p5
} from "./chunk-4SCJM64G.js";
import "./chunk-DABQKFI5.js";
import "./chunk-67V5AGVJ.js";
import "./chunk-2CASBEEF.js";
import "./chunk-NYQFHEZN.js";
import "./chunk-AV4NBVPL.js";
import "./chunk-UHYV4RE2.js";
import {
  a as a6
} from "./chunk-ZEJV2HHS.js";
import "./chunk-7RD4KVUX.js";
import "./chunk-S2OEQYU7.js";
import "./chunk-APWDCJIJ.js";
import "./chunk-NEPAFG4J.js";
import "./chunk-E7VVOB2F.js";
import "./chunk-DOYOAB3G.js";
import "./chunk-DDIAZD6H.js";
import "./chunk-7YXVUZL6.js";
import {
  f as f4,
  o as o7
} from "./chunk-6YVA5E7L.js";
import "./chunk-4KGPH7OX.js";
import "./chunk-TLAW3ACJ.js";
import {
  d as d5
} from "./chunk-GFPWBDCO.js";
import "./chunk-MQUE5HQL.js";
import "./chunk-TKHURHLF.js";
import "./chunk-U7YHNT5S.js";
import "./chunk-UW23RIEM.js";
import "./chunk-R6CAUNOR.js";
import "./chunk-6BPYXCCQ.js";
import "./chunk-TMIIQZKR.js";
import "./chunk-ROVEMBDA.js";
import "./chunk-ZIDRXKSJ.js";
import {
  J as J3,
  W as W2,
  Z
} from "./chunk-DBK2ELNZ.js";
import "./chunk-JMV2M56E.js";
import "./chunk-S2UCXOWF.js";
import "./chunk-VI6HLZLR.js";
import "./chunk-MYKOM3G6.js";
import "./chunk-6FZS4YUQ.js";
import "./chunk-JRZPZOI3.js";
import "./chunk-YNX4ZC52.js";
import "./chunk-GW7WMRYJ.js";
import "./chunk-LWAFK7Z6.js";
import "./chunk-Z52R7W33.js";
import {
  it,
  mt,
  st,
  wt
} from "./chunk-O7OCS6XP.js";
import "./chunk-BFWLPS7M.js";
import "./chunk-67LE7VNQ.js";
import "./chunk-ZVEHH7XL.js";
import "./chunk-BJM7H6OC.js";
import "./chunk-5MM5MT6Q.js";
import "./chunk-SCLVG2SO.js";
import "./chunk-557LD7Q2.js";
import "./chunk-B64VDY5O.js";
import "./chunk-MAG65NGG.js";
import "./chunk-X5UPCJEP.js";
import "./chunk-2ONAF54K.js";
import {
  t as t4
} from "./chunk-4IQCDSYS.js";
import {
  t as t5,
  u as u6
} from "./chunk-F2TT4B6M.js";
import "./chunk-M4YLDDTR.js";
import "./chunk-WTF7K3GK.js";
import "./chunk-2ERGO64O.js";
import "./chunk-RP2GKJCD.js";
import "./chunk-JKPO26TR.js";
import "./chunk-B6VSQC7C.js";
import "./chunk-6YA72G7G.js";
import "./chunk-QL5HR3YL.js";
import "./chunk-UOIZXQPU.js";
import "./chunk-3JEG7JG5.js";
import "./chunk-W6GMJ4SS.js";
import {
  a as a5,
  h as h6,
  i as i4,
  o as o6,
  y as y4
} from "./chunk-IIVUY2T7.js";
import "./chunk-GT3AQDRW.js";
import "./chunk-5APMY2AQ.js";
import "./chunk-GHUJU3NS.js";
import {
  y2 as y3
} from "./chunk-ZUHJZKEM.js";
import "./chunk-B4EEJXBQ.js";
import "./chunk-6PFH6TN3.js";
import "./chunk-Q7ENCKPJ.js";
import "./chunk-7HBD4CJ3.js";
import "./chunk-K2LTET4M.js";
import "./chunk-WG5JLPNN.js";
import "./chunk-25PMMPR7.js";
import "./chunk-7XAWCQ7R.js";
import "./chunk-RASN5P76.js";
import "./chunk-5L3YXBNN.js";
import "./chunk-IFUKJDOU.js";
import "./chunk-LD5YIQXD.js";
import "./chunk-J7KF6IEI.js";
import "./chunk-GOKBAMCG.js";
import "./chunk-E3P3LIVT.js";
import "./chunk-HUX6Y26H.js";
import "./chunk-LN4EMOLP.js";
import "./chunk-A6XTYETO.js";
import "./chunk-4TJAOUC3.js";
import "./chunk-CILAEMQM.js";
import "./chunk-TEOUFCJA.js";
import "./chunk-GTZOXRB5.js";
import "./chunk-3WPOFZBT.js";
import "./chunk-PPMHRAOP.js";
import "./chunk-75N5YDQB.js";
import "./chunk-XGDLE7WK.js";
import "./chunk-QMUS26QM.js";
import "./chunk-GDEAPZ64.js";
import "./chunk-TCQSUQ7Y.js";
import "./chunk-GOOZVNO4.js";
import "./chunk-JUTKZ3GO.js";
import "./chunk-5RHKQDDL.js";
import "./chunk-BG32AOSQ.js";
import "./chunk-PEZTN5WV.js";
import "./chunk-FHW2TG7X.js";
import "./chunk-33LKI2Y7.js";
import "./chunk-YCQXFVJL.js";
import "./chunk-ZAP7ZEWR.js";
import {
  h as h5
} from "./chunk-YAGNWBGU.js";
import "./chunk-DE6MQ5XE.js";
import "./chunk-LQTSBE7P.js";
import "./chunk-GCFUJXGH.js";
import "./chunk-MBMY7SS6.js";
import "./chunk-ICUHXX2J.js";
import "./chunk-VIIVMRRO.js";
import "./chunk-ZKSEQXDM.js";
import "./chunk-675UQNXB.js";
import "./chunk-DXGCBLDW.js";
import "./chunk-Z3FHX4FD.js";
import "./chunk-SUUOAZQT.js";
import "./chunk-TGHJVD7I.js";
import "./chunk-OZG2NNUW.js";
import "./chunk-KTRZHJ2M.js";
import "./chunk-KOIKSJSQ.js";
import "./chunk-VUVXW4AC.js";
import "./chunk-LKHUGH5W.js";
import "./chunk-QZVEEM53.js";
import "./chunk-ACZYDHB3.js";
import "./chunk-JXVDTUGR.js";
import "./chunk-HAO4WCNW.js";
import "./chunk-X2OAE75B.js";
import "./chunk-UCPBGEQD.js";
import "./chunk-SIZK72CP.js";
import {
  s as s3
} from "./chunk-SLCHZ6DD.js";
import "./chunk-WBOVDU4O.js";
import "./chunk-TQYVLRAH.js";
import {
  y as y2,
  z as z3
} from "./chunk-6A3XUATG.js";
import {
  e as e8
} from "./chunk-ZVFENZUF.js";
import "./chunk-N3S77FRG.js";
import "./chunk-YYETZJJB.js";
import "./chunk-MD2IQSSQ.js";
import "./chunk-YZBHNRVB.js";
import "./chunk-C7VF4AR2.js";
import "./chunk-IJVN5N2Q.js";
import "./chunk-P7OSFLIX.js";
import "./chunk-ZDC4PV4Y.js";
import "./chunk-L3F4XA4B.js";
import "./chunk-DLRYNII2.js";
import "./chunk-66QAJ2MI.js";
import "./chunk-WN3YAMRZ.js";
import "./chunk-NWICVENM.js";
import "./chunk-OUP4PSAG.js";
import "./chunk-A4RKV2C7.js";
import "./chunk-WU7FVYT7.js";
import "./chunk-SYYDVGKY.js";
import "./chunk-6HBAAUBO.js";
import "./chunk-YLE5AYZV.js";
import {
  a as a4
} from "./chunk-CZQYBYHB.js";
import "./chunk-Q5ZRUB2Y.js";
import "./chunk-62WUYJJN.js";
import "./chunk-JNWMZ6EJ.js";
import {
  _ as _3,
  b as b2,
  l as l6,
  o as o5,
  u as u5,
  v as v3
} from "./chunk-VS26W5Y5.js";
import "./chunk-LM2N2I5R.js";
import {
  h as h4
} from "./chunk-PVO5NM6Q.js";
import "./chunk-YFQ32AQX.js";
import "./chunk-L4AYSXFJ.js";
import "./chunk-POQ3T5EH.js";
import {
  r as r7
} from "./chunk-DM4WHMQY.js";
import {
  a as a3,
  d as d4,
  j as j2,
  m as m2,
  r as r6,
  u as u4,
  x as x4
} from "./chunk-6MR4UDDL.js";
import "./chunk-KQDYTHCF.js";
import "./chunk-KE2YMCJC.js";
import {
  n as n2
} from "./chunk-L7ZKWTWL.js";
import {
  e as e7
} from "./chunk-O2DTA3XK.js";
import "./chunk-3UOXF3CT.js";
import "./chunk-PA7WZX2U.js";
import "./chunk-GPUGMSHU.js";
import "./chunk-AIS5CSUZ.js";
import "./chunk-52UEU7LG.js";
import "./chunk-WJKYGQOY.js";
import "./chunk-GY52WOQZ.js";
import "./chunk-GAYJ4YPJ.js";
import "./chunk-PPMDUJ4E.js";
import "./chunk-ZTT6ENBS.js";
import "./chunk-MFZTGYUJ.js";
import "./chunk-R5ZE5A4K.js";
import "./chunk-24CN3HDP.js";
import "./chunk-SZWWBMQN.js";
import "./chunk-ZE47C44H.js";
import {
  l as l4,
  x as x3
} from "./chunk-5GIS2C3K.js";
import "./chunk-XCOHDMBF.js";
import "./chunk-ZR5BOILP.js";
import "./chunk-QCBC3RJX.js";
import "./chunk-HOH445RO.js";
import "./chunk-R3F4JMNC.js";
import "./chunk-7B5YPLFX.js";
import "./chunk-RDQF44TE.js";
import {
  l as l5
} from "./chunk-KKD7A2GN.js";
import "./chunk-ZWCV4HKG.js";
import {
  E as E2,
  F as F2,
  J as J2,
  S as S3,
  c as c3,
  f as f3,
  j
} from "./chunk-N4KQPPPI.js";
import "./chunk-4OGGMTIH.js";
import "./chunk-NQVBBKAN.js";
import {
  E,
  F,
  G,
  R as R2,
  q as q2
} from "./chunk-TCPN7AEH.js";
import "./chunk-4MMTPKY4.js";
import {
  n as n3,
  r as r5
} from "./chunk-DY7FJHTG.js";
import {
  c as c2
} from "./chunk-Q4KYZS3X.js";
import "./chunk-KVKFHRJ3.js";
import "./chunk-VWML4J2J.js";
import "./chunk-JYODC3YQ.js";
import {
  e as e6,
  o as o4,
  t as t3
} from "./chunk-BQZBOYBD.js";
import "./chunk-TYQXPPSP.js";
import "./chunk-TRSGUVSM.js";
import "./chunk-U3MA63JX.js";
import "./chunk-WYKKCLBI.js";
import "./chunk-PFMGJTQM.js";
import "./chunk-PQ4T66BG.js";
import "./chunk-SWPHGZYB.js";
import "./chunk-DWASPXVI.js";
import "./chunk-T2S5VXNP.js";
import "./chunk-4U5GUJRA.js";
import "./chunk-HD65DNIO.js";
import "./chunk-4KWLMXIA.js";
import "./chunk-BIUXKPKA.js";
import "./chunk-N6TJI25E.js";
import "./chunk-634JLXD4.js";
import "./chunk-Y3EDGYWG.js";
import "./chunk-UF6JOUSJ.js";
import "./chunk-T5JGQSO3.js";
import "./chunk-CIW3KHOW.js";
import {
  P as P3,
  R,
  i as i2
} from "./chunk-J55F4AC2.js";
import "./chunk-IQLBZKUD.js";
import "./chunk-7MZZCQ64.js";
import "./chunk-IMVP5ADD.js";
import "./chunk-H7WPOTQH.js";
import "./chunk-HEWCRCJC.js";
import "./chunk-6A7CWJED.js";
import "./chunk-DUTZNK67.js";
import "./chunk-IN6BQCWS.js";
import "./chunk-OUKUASAF.js";
import "./chunk-V5RMUGJJ.js";
import "./chunk-D2NB6D6N.js";
import "./chunk-UWJIHV6Q.js";
import "./chunk-M2NS3MSU.js";
import {
  h as h3
} from "./chunk-HMNBB7ED.js";
import "./chunk-3RRMLFFN.js";
import "./chunk-DR5TVNEL.js";
import "./chunk-HT2T6PUB.js";
import "./chunk-K64AAM77.js";
import "./chunk-6EUVKE22.js";
import "./chunk-A3NNJ7XA.js";
import "./chunk-OKJHJ3CY.js";
import {
  b,
  c,
  d as d3,
  f as f2,
  l as l3,
  p as p3,
  x as x2
} from "./chunk-XTVPEVHA.js";
import "./chunk-DTUSTSEJ.js";
import "./chunk-JCWFGRHQ.js";
import "./chunk-JILEJ6R2.js";
import "./chunk-GAW5JHG4.js";
import "./chunk-OEKKQXBD.js";
import "./chunk-S3IO7V4Q.js";
import "./chunk-DZALMCYL.js";
import {
  u as u3
} from "./chunk-K226GFDN.js";
import "./chunk-4ZZRP4MA.js";
import {
  i as i3,
  x
} from "./chunk-7ZJ6P7J7.js";
import "./chunk-FPFZQCEQ.js";
import "./chunk-VDB6Y4TZ.js";
import "./chunk-WYMXVOAT.js";
import "./chunk-K7TO5IIO.js";
import "./chunk-A4VVDRCH.js";
import "./chunk-CQDYITZC.js";
import "./chunk-5I6J67HP.js";
import "./chunk-YVULORT6.js";
import {
  h
} from "./chunk-PB33BAI3.js";
import "./chunk-CVB43GGP.js";
import "./chunk-LLDOZWVV.js";
import "./chunk-7XMEZQ34.js";
import "./chunk-BDM2D6IC.js";
import "./chunk-U2ZVAEKG.js";
import "./chunk-EDSMXTFO.js";
import "./chunk-MNLT652N.js";
import "./chunk-OGZAGPIO.js";
import "./chunk-HJJIIYFF.js";
import "./chunk-ONPREQKF.js";
import "./chunk-7RMVJCDW.js";
import "./chunk-GTY5NXA4.js";
import {
  m2 as m
} from "./chunk-T6GCUITX.js";
import {
  a as a2
} from "./chunk-TUIGM7TV.js";
import {
  w
} from "./chunk-IHVSZYZS.js";
import "./chunk-6CA6K3O7.js";
import "./chunk-NYQ5CYNR.js";
import {
  _
} from "./chunk-O7UDKFOW.js";
import {
  f
} from "./chunk-TKPMIAIW.js";
import "./chunk-NQOJNTB3.js";
import "./chunk-MFOQYQFG.js";
import "./chunk-NKCPFCP3.js";
import {
  M,
  e as e5,
  h as h2
} from "./chunk-3ZXOUEQG.js";
import {
  A as A3,
  H,
  J,
  P as P2,
  _ as _2,
  e as e4,
  g,
  o as o3,
  p as p2,
  q,
  r as r4,
  s as s2,
  u as u2,
  v as v2,
  z as z2
} from "./chunk-AXVPJBVW.js";
import {
  n,
  r as r3,
  t as t2
} from "./chunk-OXEPWRM7.js";
import {
  e as e3
} from "./chunk-POILQGXA.js";
import {
  $,
  L,
  W2 as W,
  z
} from "./chunk-JJS7PR2U.js";
import "./chunk-L5YS4GSA.js";
import "./chunk-PRREDSOB.js";
import "./chunk-V5C6HSAM.js";
import "./chunk-SYATLP3H.js";
import "./chunk-V6AMQYXE.js";
import {
  A as A2,
  C,
  P,
  d as d2,
  p,
  v
} from "./chunk-6WHTZNUH.js";
import {
  V
} from "./chunk-EITGQLII.js";
import "./chunk-TIVJXVMN.js";
import {
  d
} from "./chunk-XNUH25NY.js";
import {
  o as o2
} from "./chunk-WGAPNV7F.js";
import "./chunk-BXQGM56A.js";
import {
  e as e2
} from "./chunk-4Z5SGKRM.js";
import "./chunk-YPWMP2VK.js";
import "./chunk-23E6RT3O.js";
import "./chunk-RCBGISRX.js";
import "./chunk-2P72IR2Y.js";
import {
  A,
  S as S2,
  i3 as i,
  r
} from "./chunk-ANKOCGE2.js";
import {
  y
} from "./chunk-7CJXZOFG.js";
import "./chunk-IRGZKO7V.js";
import "./chunk-5SELS7VU.js";
import {
  a3 as a
} from "./chunk-DDYVXG4F.js";
import "./chunk-ANP42J2U.js";
import {
  s
} from "./chunk-HJY2YILU.js";
import {
  e,
  l as l2,
  o,
  r as r2,
  t
} from "./chunk-7DA6A5LD.js";
import {
  l,
  u
} from "./chunk-2MMLMOWS.js";
import "./chunk-4323ZVPF.js";
import "./chunk-WYIDUUN2.js";
import {
  O,
  S
} from "./chunk-DXLOWWK7.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-JWIQHGQB.js";

// ../../../node_modules/@arcgis/core/views/interactive/SegmentLabels.js
var G5 = 3025;
var M4 = {
  default: 15,
  far: 25
};
var A6 = class extends S2 {
  constructor(t9) {
    super(t9), this.context = null, this.stagedVertex = null, this.visible = true, this.edgeDistance = "default", this._messagesUnits = null, this._labelInfos = [], this._nextLabelIndex = 0;
  }
  initialize() {
    const t9 = d((t10) => __async(this, null, function* () {
      const e17 = yield h("esri/core/t9n/Units");
      s(t10), this._messagesUnits = e17;
    }));
    this.addHandles([d2(() => [null != this.context && this.getCameraOrExtent(this.context), this.visible, this._edgeDistancePixels, this.stagedVertex, this._messagesUnits], () => this._update()), ...["vertex-add", "vertex-update", "vertex-remove"].map((t10) => v(() => this.context?.editGeometryOperations, t10, () => this._update())), e(() => t9.abort()), d2(() => this._colors, (t10) => this._updateStyle(t10))]);
  }
  destroy() {
    for (this._nextLabelIndex = 0; this._labelInfos.length; ) this._destroyLabel(this._labelInfos.pop());
  }
  get updating() {
    return null == this._messagesUnits;
  }
  get test() {
  }
  get _edgeDistancePixels() {
    return M4[this.edgeDistance];
  }
  get _colors() {
    const t9 = this.context?.view.effectiveTheme.textColor ?? u3.fromArray([255, 255, 255]);
    return {
      textColor: t9,
      backgroundColor: R2(G(t9, q2.Low), 0.6)
    };
  }
  _update() {
    if (this.destroyed) return;
    this._nextLabelIndex = 0;
    const {
      context: t9,
      stagedVertex: e17
    } = this;
    if (!t9) return this._destroyUnusedLabels();
    const {
      editGeometryOperations: o12
    } = t9, {
      components: s6,
      geometry: r14,
      coordinateHelper: i13
    } = o12.data;
    if (!r14) return this._destroyUnusedLabels();
    const n11 = s6.length;
    for (let l17 = 0; l17 < n11; ++l17) {
      const s7 = R6(r14, o12, e17, i13, l17);
      if (s7.length < 2 || !q4(s7, t9.view, t9.elevationInfo, i13.spatialReference)) continue;
      const a14 = 1 === n11 && !a2(s7);
      let c10 = T2, p12 = X;
      this.toScreenPointArray(t9, s7[0], c10);
      for (let e18 = 1; e18 < s7.length; ++e18) {
        const o13 = s7[e18 - 1], r15 = s7[e18];
        this.toScreenPointArray(t9, r15, p12), this._addLabel(t9, o13, c10, r15, p12, a14), [c10, p12] = [p12, c10];
      }
    }
    this._destroyUnusedLabels();
  }
  _updateStyle({
    textColor: t9,
    backgroundColor: e17
  }) {
    const o12 = this._nextLabelIndex, s6 = this._labelInfos;
    for (let r14 = 0; r14 < o12; ++r14) {
      const {
        label: o13
      } = s6[r14];
      o13.textColor = t9, o13.backgroundColor = e17;
    }
  }
  _addLabel(t9, e17, o12, s6, r14, i13) {
    const {
      label: n11
    } = this._getOrCreateLabel(t9);
    if (!this.visible || b2(o12, r14) < G5) return void (n11.visible = false);
    const {
      spatialReference: l17
    } = t9.editGeometryOperations.data, a14 = u8(e17, s6, l17), c10 = this._messagesUnits, h11 = e9(t9.view);
    n11.text = null != c10 && null != a14 ? x6(c10, a14, h11) : "", n11.visible = true;
    const m8 = r14[0] - o12[0], d9 = r14[1] - o12[1];
    i13 ? o5(F8, -d9, m8) : o5(F8, d9, -m8), v3(F8, F8), l6(F8, F8, this._edgeDistancePixels), _3(H3, o12, r14, 0.5), u5(H3, H3, F8), n11.position = [H3[0], H3[1]], Math.abs(F8[0]) > Math.abs(F8[1]) ? n11.anchor = F8[0] > 0 ? "left" : "right" : n11.anchor = -F8[1] < 0 ? "top" : "bottom";
  }
  _getOrCreateLabel(t9) {
    const e17 = this._labelInfos.length > this._nextLabelIndex, {
      textColor: o12,
      backgroundColor: s6
    } = this._colors;
    if (e17) {
      const t10 = this._labelInfos[this._nextLabelIndex++], {
        label: e18
      } = t10;
      return e18.textColor = o12, e18.backgroundColor = s6, t10;
    }
    const r14 = new x7({
      anchor: "center",
      fontSize: 8,
      textColor: o12,
      backgroundColor: s6
    });
    t9.view.overlay?.items.add(r14);
    const i13 = {
      label: r14
    };
    return this._labelInfos.push(i13), this._nextLabelIndex = this._labelInfos.length, i13;
  }
  _destroyUnusedLabels() {
    for (; this._labelInfos.length > this._nextLabelIndex; ) this._destroyLabel(this._labelInfos.pop());
  }
  _destroyLabel({
    label: t9
  }) {
    this.context?.view.overlay?.items.remove(t9), t9.destroy();
  }
};
function R6(t9, e17, o12, s6, r14) {
  const i13 = [];
  if (e17.data.components[r14].iterateVertices((t10) => {
    i13.push(s6.toXYZ(t10.pos, c3.get()));
  }), 0 === r14 && null != o12 && i13.push(s6.toXYZ(o12, c3.get())), i13.length < 2) return i13;
  const n11 = i13[0], l17 = i13[i13.length - 1];
  return "polygon" === t9.type && i13.length > 2 && !H(n11, l17) && i13.push(n11), i13;
}
function q4(t9, e17, o12, s6) {
  if ("2d" === e17.type) return true;
  const r14 = $(s6) ?? 1, i13 = L(s6), n11 = (t10) => x4(e17, t10, s6, o12, j2) ?? 0;
  for (let l17 = 1; l17 < t9.length; ++l17) {
    const e18 = t9[l17 - 1], o13 = t9[l17], s7 = (o13[0] - e18[0]) * r14, a14 = (o13[1] - e18[1]) * r14, c10 = (n11(o13) - n11(e18)) * i13;
    if (Math.abs(c10) / Math.sqrt(s7 * s7 + a14 * a14) > z5) return false;
  }
  return true;
}
e2([y()], A6.prototype, "context", void 0), e2([y()], A6.prototype, "stagedVertex", void 0), e2([y()], A6.prototype, "visible", void 0), e2([y()], A6.prototype, "edgeDistance", void 0), e2([y()], A6.prototype, "updating", null), e2([y()], A6.prototype, "_messagesUnits", void 0), e2([y()], A6.prototype, "_edgeDistancePixels", null), e2([y()], A6.prototype, "_colors", null), A6 = e2([a("esri.views.interactive.SegmentLabels")], A6);
var z5 = h2(5);
var F8 = n3();
var H3 = n3();
var T2 = i3();
var X = i3();

// ../../../node_modules/@arcgis/core/views/3d/interactive/SegmentLabels3D.js
var a9 = class extends A6 {
  getCameraOrExtent({
    view: e17
  }) {
    return e17.state.camera;
  }
  toScreenPointArray({
    view: e17,
    elevationInfo: t9,
    editGeometryOperations: o12
  }, s6, a14 = i3()) {
    const {
      spatialReference: m8
    } = o12.data.coordinateHelper;
    return l8(s6, m8, t9, e17, c8), e17.state.camera.projectToScreen(c8, a14), a14;
  }
};
a9 = e2([a("esri.views.3d.interactive.SegmentLabels3D")], a9);
var c8 = n();

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/meshFastUpdateUtils.js
function a10(a14) {
  const t9 = a14.graphic;
  return t9 ? [d2(() => "visible" in a14 ? a14.visible : a14.displaying, (s6) => {
    s6 && t9.notifyMeshTransformChanged({
      action: a6.EnableFastUpdates
    });
  }, __spreadValues({}, A2)), e(() => t9.notifyMeshTransformChanged({
    action: a6.DisableFastUpdates
  }))] : [];
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/draw/DrawGraphicTool3D.js
var z6 = class extends E5 {
  constructor(e17) {
    super(e17), this._activeVertexVisualElement = null, this._createGraphicState = null, this._outlineVisualElement = null, this._verticesVisualElement = null, this._verticalLineVisualElement = null, this._settings = new j4({
      getTheme: () => this.view.effectiveTheme
    }), this.geometryType = null, this.type = "draw-3d";
  }
  initialize() {
    const {
      mode: e17,
      offset: t9,
      unit: i13
    } = this.elevationInfo;
    this.internalGraphicsLayer.elevationInfo = new h3({
      mode: e17,
      offset: t9,
      unit: i13
    });
  }
  normalizeCtorArgs(e17) {
    if (!e17.elevationInfo) {
      const t9 = e17.hasZ ?? true;
      return __spreadProps(__spreadValues({}, e17), {
        elevationInfo: u4(t9)
      });
    }
    return e17;
  }
  initializeGraphic(e17) {
    const {
      view: t9
    } = this, s6 = this._createGraphicState = new e13({
      graphic: e17
    });
    return o([t9.maskOccludee(e17), t9.trackGraphicState(s6), d2(() => ({
      element: this._outlineVisualElement,
      isDraped: s6.isDraped
    }), ({
      element: e18,
      isDraped: t10
    }) => {
      e18 && (e18.isDraped = t10);
    }, A2), i(() => {
      k(this.tooltipInfos.mesh, this.geometryToPlace);
    }), this._setupLoadingIndicator(s6), ...a10(s6)]);
  }
  makeDrawOperation() {
    const {
      geometryType: e17
    } = this, t9 = "circle" !== e17 && "rectangle" !== e17;
    return new F6({
      view: this.view,
      manipulators: this.manipulators,
      geometryType: F5(e17),
      drawingMode: this.mode,
      hasZ: this.hasZ,
      defaultZ: this.defaultZ,
      snapToSceneEnabled: this.snapToScene,
      drawSurface: new l10(this.view, this.elevationInfo, [this.internalGraphicsLayer]),
      elevationDrawSurface: new c6(this.elevationInfo, this.defaultZ, this.view, this.internalGraphicsLayer),
      hasM: false,
      elevationInfo: this.elevationInfo,
      snappingManager: this.snappingManager,
      snappingVisualizer: new R4(),
      segmentLabels: t9 ? new a9() : null,
      labelOptions: this.sketchOptions.labels,
      isDraped: this._createGraphicState ? this._createGraphicState.isDraped : "on-the-ground" === r6(this.hasZ, this.elevationInfo),
      cursor: this.cursor,
      constraintsEnabled: true
    });
  }
  onActiveVertexChanged(e17) {
    const {
      view: n11
    } = this;
    if (this._activeVertexVisualElement) return this._activeVertexVisualElement.vertices = [e17], this._activeVertexVisualElement.recreate(), this._updateVerticalLineVisualElement(e17), e();
    const a14 = this._settings, c10 = a14.manipulators.vertex, m8 = new d6({
      view: n11,
      spatialReference: n11.spatialReference,
      vertices: [e17],
      elevationInfo: this.internalGraphicsLayer.elevationInfo,
      size: c10.size,
      outlineSize: c10.outlineSize,
      renderOccluded: c10.renderOccluded,
      attached: false,
      isDecoration: true
    });
    this._activeVertexVisualElement = m8;
    const p12 = a14.visualElements.zVerticalLine, h11 = new G3({
      view: n11,
      extensionType: p12.extensionType,
      innerWidth: 1,
      attached: false,
      writeDepthEnabled: false,
      renderOccluded: h5.OccludeAndTransparent,
      isDecoration: true
    });
    this._verticalLineVisualElement = h11;
    const u14 = o([d2(() => a14.visualElements.zVerticalLine, (e18) => e18.apply(h11), P), d2(() => ({
      selectedColor: E(a14.colors.selected),
      outlineColor: E(a14.manipulators.vertex.outlineColor)
    }), ({
      selectedColor: e18,
      outlineColor: t9
    }) => {
      m8.color = e18, m8.outlineColor = t9;
    }, P), e(() => {
      this._activeVertexVisualElement = u(this._activeVertexVisualElement), this._verticalLineVisualElement = u(this._verticalLineVisualElement);
    })]);
    return m8.attached = true, this._updateVerticalLineVisualElement(e17), u14;
  }
  _updateVerticalLineVisualElement(e17) {
    const t9 = this._verticalLineVisualElement;
    if (!t9) return;
    const {
      renderCoordsHelper: i13,
      elevationProvider: s6
    } = this.view;
    o3(A7, e17[0], e17[1], e17[2]), U2.setFromElevationInfo(this.elevationInfo), A7[2] = f4(A7, s6, U2, i13);
    i13.toRenderCoords(A7, this.view.spatialReference, A7) ? (t9.setStartEndFromWorldDownAtLocation(A7), t9.attached = true) : t9.attached = false;
  }
  onOutlineChanged(e17) {
    if (this._outlineVisualElement) return this._outlineVisualElement.geometry = e17, e();
    const t9 = this.internalGraphicsLayer.elevationInfo, {
      view: n11
    } = this, a14 = this._settings, c10 = new w4({
      view: n11,
      geometry: e17,
      elevationInfo: t9,
      isDraped: this._createGraphicState ? this._createGraphicState.isDraped : "on-the-ground" === r6(this.hasZ, t9),
      attached: false,
      isDecoration: true
    });
    this._outlineVisualElement = c10;
    const m8 = o([d2(() => a14.visualElements.lineObjects.outline, (e18) => e18.apply(c10), P), d2(() => a14.visualElements.lineObjects.shadowStyle, (e18) => e18.apply(c10), P), e(() => {
      this._outlineVisualElement = u(this._outlineVisualElement);
    })]);
    return c10.attached = true, c10.laserlineEnabled = true, m8;
  }
  onRegularVerticesChanged(e17) {
    if (this._verticesVisualElement) return this._verticesVisualElement.vertices = e17, e();
    const {
      view: n11
    } = this, a14 = this._settings, c10 = a14.manipulators.vertex, m8 = new d6({
      view: n11,
      spatialReference: n11.spatialReference,
      vertices: e17,
      elevationInfo: this.internalGraphicsLayer.elevationInfo,
      size: c10.size,
      outlineSize: c10.outlineSize,
      renderOccluded: c10.renderOccluded,
      attached: false,
      isDecoration: true
    }), p12 = o([d2(() => ({
      color: E(a14.manipulators.vertex.color),
      outlineColor: E(a14.manipulators.vertex.outlineColor)
    }), ({
      color: e18,
      outlineColor: t9
    }) => {
      m8.color = e18, m8.outlineColor = t9;
    }, P), e(() => {
      this._verticesVisualElement = u(this._verticesVisualElement);
    })]);
    return m8.attached = true, this._verticesVisualElement = m8, p12;
  }
  updateGraphicGeometry(e17) {
    if ("mesh" !== this.geometryType || "point" !== e17?.type) super.updateGraphicGeometry(e17);
    else {
      const t9 = this.geometryToPlace;
      t9?.centerAt(e17), k(this.tooltipInfos.mesh, t9);
      const i13 = this._graphic;
      t9 && i13.geometry === t9 || (i13.geometry = t9);
    }
  }
  _setupLoadingIndicator(e17) {
    const {
      drawOperation: t9
    } = this;
    if (!this.geometryToPlace) return t9.loading = false, null;
    t9.loading = true;
    const r14 = e(() => {
      t9.loading = false;
    });
    let o12;
    const l17 = () => o12 && cancelAnimationFrame(o12);
    return o([p(() => e17.displaying, () => {
      l17(), o12 = requestAnimationFrame(() => r14.remove());
    }, __spreadProps(__spreadValues({}, A2), {
      once: true
    })), e(l17), r14]);
  }
};
e2([y({
  constructOnly: true
})], z6.prototype, "elevationInfo", void 0), e2([y({
  constructOnly: true
})], z6.prototype, "geometryType", void 0), e2([y()], z6.prototype, "type", void 0), e2([y({
  constructOnly: true
})], z6.prototype, "view", void 0), z6 = e2([a("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")], z6);
var U2 = new o7();
var A7 = n();

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/geometryUtils.js
function n7(o12) {
  const n11 = r11(o12);
  return r5(Math.cos(n11), Math.sin(n11));
}
function r11(t9) {
  if (null == t9 || "polyline" !== t9.type && "polygon" !== t9.type) return 0;
  const n11 = "polyline" === t9.type ? t9.paths : t9.rings, r14 = e3();
  for (const o12 of n11) for (let t10 = 0; t10 < o12.length - 1; t10++) {
    const n12 = o12[t10], e17 = o12[t10 + 1], i13 = n12[0] - e17[0], l17 = n12[1] - e17[1];
    if (i13 * i13 + l17 * l17 > r14) return Math.atan2(e17[1] - n12[1], e17[0] - n12[0]);
  }
  return 0;
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/tooltipUtils3D.js
function m6(r14, c10, a14) {
  function l17() {
    const t9 = a14(), o12 = t9.sketchOptions.tooltips.effectiveEnabled ? t9.activeTooltipInfo : null;
    return __spreadProps(__spreadValues({}, t9), {
      activeTooltipInfo: o12
    });
  }
  let p12 = false;
  function m8({
    activeTooltipInfo: t9,
    sketchOptions: o12
  }) {
    p12 = true, t9 && (t9.sketchOptions = o12, v7(t9, c10)), r14.info = t9, p12 = false;
  }
  return o([d2(l17, m8, A2), d2(() => {
    const t9 = l17(), {
      activeTooltipInfo: o12
    } = t9;
    if (o12) return {
      context: t9,
      activeTooltipInfo: o12,
      key: o12.key,
      geometry: t6(c10)
    };
  }, (t9, o12) => {
    t9 && !p12 && o12 && o12.key !== t9.key && f8(t9.activeTooltipInfo, c10, t9.context);
  }, C), c10.on("committed", () => m8(l17())), T(r14)]);
}
function f8(t9, o12, {
  callbacks: e17
}) {
  const i13 = t6(o12);
  switch (i13?.type) {
    case "mesh":
      u12(t9, i13.origin, o12, e17), "orientation" in t9 && "scale" in t9 && k(t9, i13, e17);
      break;
    case "point":
      u12(t9, i13, o12, e17);
  }
}
function u12(t9, o12, e17, i13) {
  const {
    dx: n11,
    dy: s6,
    dz: c10
  } = V2(t9, o12);
  0 === n11 && 0 === s6 && 0 === c10 || (i13.onMoveStart?.(), e17.operations?.move(n11, s6, c10, E3.NEW_STEP), i13.onMove?.(n11, s6, c10), i13.onMoveStop?.());
}
function v7(t9, o12) {
  const e17 = t6(o12);
  if (!t9 || !e17 || "mesh" !== e17.type && "point" !== e17.type) return;
  const i13 = "mesh" === e17.type, r14 = i13 ? e17.origin : e17;
  t9.setLocationFromPoint(r14), y6(t9, r14, o12), "transform-mesh" === t9.type && i13 && R5(t9, e17), t9.clearInputValues();
}
function y6(t9, o12, e17) {
  t9.elevation.actual = R3(o12), t9.elevation.visible = !!e17.operations?.data.coordinateHelper.hasZ(), t9.elevation.readOnly = false, t9.elevation.showAsZ = true;
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/GrabbingState.js
var N;
!function(N3) {
  N3[N3.NONE = 0] = "NONE", N3[N3.ANY = 1] = "ANY", N3[N3.Z = 2] = "Z", N3[N3.XY = 4] = "XY";
}(N || (N = {}));

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatorState.js
var a11 = class {
  constructor() {
    this.grabbingState = N.NONE, this.zManipulator = null, this.firstSelected = null, this.numSelected = 0, this.firstGrabbedXY = null;
  }
  update(a14) {
    this.grabbingState = N.NONE, this.zManipulator = null, this.numSelected = 0, this.firstSelected = null, this.firstGrabbedXY = null, a14.forEachManipulator((a15, s6) => {
      if (s6 === A5.TRANSLATE_Z && (this.zManipulator = a15), a15 instanceof ee && (a15.selected && (0 === this.numSelected && (this.firstSelected = a15), this.numSelected++), null == this.firstGrabbedXY && a15.grabbing && s6 === A5.TRANSLATE_XY && (this.firstGrabbedXY = a15)), a15.grabbing) switch (this.grabbingState |= N.ANY, s6) {
        case A5.TRANSLATE_Z:
          this.grabbingState |= N.Z;
          break;
        case A5.TRANSLATE_XY:
          this.grabbingState |= N.XY;
      }
    });
  }
};

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/lineObjectVisualElementUtils.js
function y7(t9) {
  const {
    object: n11
  } = t9, a14 = S6(t9), l17 = [a14, M5(t9, a14.visualElement)];
  return n11.maskOccludee && l17.push(n11.maskOccludee()), {
    visualElement: a14.visualElement,
    remove: () => r2(l17)
  };
}
function S6(e17) {
  const {
    view: a14,
    object: l17
  } = e17, s6 = t6(l17), r14 = new w4({
    view: a14,
    geometry: D4(s6) ? s6 : null,
    elevationInfo: l17.elevationInfo,
    attached: false,
    isDecoration: true
  }), c10 = new j4({
    getTheme: () => a14.effectiveTheme
  }), m8 = () => {
    r14.attached = l17.visible;
  }, u14 = o([d2(() => c10.visualElements.lineObjects.outline, (e18) => e18.apply(r14), P), d2(() => c10.visualElements.lineObjects.shadowStyle, (e18) => e18.apply(r14), P), d2(() => l17.visible, m8), d2(() => l17.isDraped, (e18) => {
    r14.isDraped = e18;
  }, P), l17.on("committed", () => {
    const e18 = t6(l17);
    r14.geometry = D4(e18) ? e18 : null;
  }), l2(r14)]);
  return m8(), {
    visualElement: r14,
    remove: () => u14.remove()
  };
}
function M5(r14, c10) {
  const {
    object: m8,
    view: u14
  } = r14, p12 = [], v8 = m8.elevationInfo, j8 = "on-the-ground" === v8.mode || !v8.offset && "absolute-height" !== v8.mode, y8 = new a11(), S11 = new j4({
    getTheme: () => u14.effectiveTheme
  }), M8 = S11.visualElements, L5 = new G3({
    view: u14,
    extensionType: M8.zVerticalLine.extensionType,
    innerWidth: 1,
    attached: false,
    writeDepthEnabled: false,
    renderOccluded: h5.OccludeAndTransparent,
    isDecoration: true
  }), A11 = h2(M8.heightPlaneAngleCutoff), x11 = new c5({
    view: u14,
    attached: false,
    angleCutoff: A11,
    isDecoration: true
  }), C5 = r7(1);
  p12.push(d2(() => ({
    lineShadowStyle: S11.visualElements.lineObjects.shadowStyle,
    pointShadowStyle: S11.visualElements.pointObjects.shadowStyle,
    alpha: C5.value
  }), ({
    lineShadowStyle: e17,
    pointShadowStyle: t9,
    alpha: n11
  }) => {
    e17.apply(c10, n11), t9.apply(L5, n11);
  }, P));
  const V5 = r7(1);
  p12.push(d2(() => ({
    heightPlane: S11.visualElements.heightPlane,
    alpha: V5.value
  }), ({
    heightPlane: e17,
    alpha: t9
  }) => e17.apply(x11, t9), P));
  const P8 = () => {
    y8.update(r14);
    const e17 = t6(m8);
    if (!m8.visible || j8 && (m8.isDraped || !D4(e17) || !e17.hasZ)) return c10.laserlineEnabled = false, L5.attached = false, void (x11.attached = false);
    c10.laserlineEnabled = true;
    const t9 = y8.grabbingState & N.XY ? M8.laserlineAlphaMultiplier : 1;
    C5.value = t9;
    const n11 = y8.grabbingState & N.Z ? M8.laserlineAlphaMultiplier : 1;
    V5.value = n11, T3(L5, y8), O3(r14, c10, x11, y8);
  };
  p12.push(d2(() => S11.visualElements.zVerticalLine, (e17) => e17.apply(L5), P)), p12.push(m8.on("committed", P8), d2(() => m8.visible, P8), c10.events.on("attachment-origin-changed", P8), l2(L5), l2(x11));
  const U5 = [], X3 = () => {
    r2(U5), U5.length = 0, r14.forEachManipulator((e17) => U5.push(e17.events.on("grab-changed", P8))), r14.forEachManipulator((e17) => U5.push(e17.events.on("select-changed", P8))), P8();
  };
  return X3(), p12.push(r14.onManipulatorsChanged(X3), t(() => o(U5))), o(p12);
}
function T3(e17, t9) {
  const n11 = 1 === t9.numSelected ? t9.firstSelected : t9.numSelected > 1 && null != t9.firstGrabbedXY ? t9.firstGrabbedXY : null;
  null != n11 ? (e17.setStartEndFromWorldDownAtLocation(n11.renderLocation), e17.attached = true) : e17.attached = false;
}
function O3(e17, t9, n11, a14) {
  if (a14.numSelected > 0) {
    o3(L2, 0, 0, 0);
    let t10 = 0;
    e17.forEachManipulator((e18, n12) => {
      n12 === A5.TRANSLATE_XY && e18.selected && e18 instanceof ee && (u2(L2, L2, e18.renderLocation), t10++);
    }), t10 > 0 ? (n11.heightManifoldTarget = g(L2, L2, 1 / t10), n11.attached = true) : n11.attached = false;
  } else {
    const a15 = t9.attachmentOrigin;
    null != a15 && e17.view.renderCoordsHelper.toRenderCoords(a15, L2) ? (n11.heightManifoldTarget = L2, n11.attached = true) : n11.attached = false;
  }
}
function D4(e17) {
  return null != e17 && ("polygon" === e17.type || "polyline" === e17.type);
}
var L2 = n();

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/originGeometryVisualElementUtils.js
function P6(t9) {
  const o12 = [], n11 = S7(t9, o12);
  return I3(t9, o12, n11), {
    visualElement: n11,
    remove: () => r2(o12)
  };
}
function I3(e17, o12, s6) {
  const {
    view: c10,
    object: m8
  } = e17, f9 = new j4({
    getTheme: () => c10.effectiveTheme
  }), E8 = new G3({
    view: c10,
    extensionType: f9.visualElements.zVerticalLine.extensionType,
    innerWidth: 1,
    attached: false,
    writeDepthEnabled: false,
    renderOccluded: h5.OccludeAndTransparent,
    isDecoration: true
  });
  o12.push(d2(() => f9.visualElements.zVerticalLine, (e18) => e18.apply(E8), P));
  const P8 = new c5({
    view: c10,
    intersectsLineInfinite: true,
    attached: false,
    isDecoration: true
  }), I5 = h2(f9.visualElements.heightPlaneAngleCutoff), S11 = new c5({
    view: c10,
    attached: false,
    angleCutoff: I5,
    isDecoration: true
  }), A11 = m8.elevationInfo, L5 = o7.fromElevationInfo(A11), M8 = "on-the-ground" === A11.mode || !A11.offset && "absolute-height" !== A11.mode, R8 = new a11(), O5 = r7(1);
  o12.push(d2(() => ({
    heightPlane: f9.visualElements.heightPlane,
    alpha: O5.value
  }), ({
    heightPlane: e18,
    alpha: t9
  }) => e18.apply(S11, t9), P));
  const z8 = r7(1);
  o12.push(d2(() => ({
    shadowStyle: f9.visualElements.pointObjects.shadowStyle,
    alpha: z8.value
  }), ({
    shadowStyle: e18,
    alpha: t9
  }) => e18.apply(P8, t9), P));
  const B3 = () => {
    R8.update(e17);
    let t9 = V3(t6(m8));
    const o13 = M8 && (m8.isDraped || null == t9 || !t9.hasZ);
    let n11 = true;
    if (o13 || null == t9) n11 = false;
    else {
      d4(m8.elevationInfo) && (t9 = t9.clone(), t9.z = 0);
      const e18 = f4(t9, c10.elevationProvider, L5, c10.renderCoordsHelper);
      o3(U3, t9.x, t9.y, e18), n2(U3, t9.spatialReference, U3, c10.renderCoordsHelper.spatialReference), E8.setStartEndFromWorldDownAtLocation(U3), P8.intersectsWorldUpAtLocation = U3;
    }
    const i13 = R8.grabbingState & N.Z ? f9.visualElements.laserlineAlphaMultiplier : 1;
    O5.value = i13;
    const l17 = P3(C3);
    !o13 && m8.visible && s6.calculateMapBounds(l17) && n2(R(l17, U3), c10.spatialReference, U3, c10.renderCoordsHelper.spatialReference) ? (S11.heightManifoldTarget = U3, S11.attached = true) : S11.attached = false;
    const r14 = R8.grabbingState & N.XY ? f9.visualElements.laserlineAlphaMultiplier : 1;
    z8.value = r14;
    const j8 = n11 && m8.visible && !o13;
    P8.attached = j8, E8.attached = j8;
  };
  o12.push(d2(() => [m8.visible, m8.isDraped], B3), m8.on("committed", B3)), e17.forEachManipulator((e18) => {
    o12.push(e18.events.on("grab-changed", B3));
  }), o12.push(l2(P8)), o12.push(l2(E8)), o12.push(l2(S11)), B3();
}
function S7(e17, o12) {
  const {
    view: n11,
    object: i13
  } = e17, l17 = new x5({
    view: n11,
    geometry: V3(t6(i13)),
    elevationInfo: i13.elevationInfo,
    isDecoration: true
  });
  return A8(e17, l17, o12), o12.push(l2(l17)), l17;
}
function V3(e17) {
  return null == e17 ? null : "point" === e17.type ? e17 : "mesh" === e17.type ? e17.anchor.clone() : null;
}
function A8(e17, t9, o12) {
  const {
    view: n11,
    object: r14
  } = e17, a14 = () => {
    t9.attached = r14.visible;
  }, s6 = new j4({
    getTheme: () => n11.effectiveTheme
  });
  L3(e17, t9, o12), s6.visualElements.pointObjects.outline.apply(t9), o12.push(d2(() => r14.visible, a14, P));
}
function L3(e17, t9, n11) {
  const {
    view: i13,
    object: l17
  } = e17;
  let r14 = null;
  const a14 = (e18) => {
    null != r14 && (r14.remove(), r14 = null), l17.isDraped && null != e18 && (r14 = M6(i13, e18, () => {
      t9.geometry = e18;
    }));
  }, s6 = () => {
    const e18 = V3(t6(l17));
    null != e18 && d4(l17.elevationInfo) && (e18.z = 0), a14(e18), t9.geometry = e18;
  };
  n11.push(l17.on("committed", s6), t(() => r14)), s6();
}
function M6(e17, t9, o12) {
  const n11 = e17.elevationProvider.spatialReference;
  c2(t9, U3, n11);
  const i13 = U3[0], l17 = U3[1];
  return e17.elevationProvider.on("elevation-change", (e18) => {
    w(e18.extent, i13, l17) && o12();
  });
}
var U3 = n();
var C3 = i2();

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/visualElementUtils.js
function l12(l17) {
  switch (t6(l17.object)?.type) {
    case "point":
    case "mesh":
      return P6(l17);
    case "polygon":
    case "polyline":
      return y7(l17);
    default:
      return null;
  }
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYObjectManipulation.js
var l13 = class extends t8 {
  constructor(t9) {
    super(), this._view = t9.view, this._tool = t9.tool, this._object = t9.object, this._manipulator = this._object.createManipulator?.({
      selectable: true,
      cursor: "move"
    }), this.forEachManipulator((t10) => this._tool.manipulators.add(t10));
  }
  destroy() {
    this.forEachManipulator((t9) => {
      this._tool.manipulators.remove(t9), t9.destroy();
    }), this._tool = null, this._view = null, this._manipulator = null;
  }
  forEachManipulator(t9) {
    this._manipulator && t9(this._manipulator, A5.TRANSLATE_XY);
  }
  createManipulatedObjectDragPipeline(t9) {
    return n6(this._object, t9, (t10) => this.createDragPipeline(t10));
  }
  createDragPipeline(e17) {
    if (!this._manipulator) return e();
    const o12 = this._view;
    return p4(this._manipulator, (t9, r14, a14, l17, p12) => {
      const h11 = this._object.operations?.data.spatialReference, u14 = r14.next((t10) => h11 ? t10 : null).next(M3(p12, o12, this._object, h11)).next(v4()).next(j3());
      e17(t9, u14, a14, l17, p12);
    });
  }
};

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TranslateXYTooltipInfo.js
var i9 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "translate-xy", this.distance = h6;
  }
};
e2([y()], i9.prototype, "type", void 0), e2([y()], i9.prototype, "distance", void 0), i9 = e2([a("esri.views.interactive.tooltip.infos.TranslateXYTooltipInfo")], i9);

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TranslateZTooltipInfo.js
var i10 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "translate-z", this.distance = h6;
  }
  clear() {
    this.distance = h6;
  }
};
e2([y()], i10.prototype, "type", void 0), e2([y()], i10.prototype, "distance", void 0), i10 = e2([a("esri.views.interactive.tooltip.infos.TranslateZTooltipInfo")], i10);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/move/MoveTool3D.js
var L4 = class {
  constructor(t9) {
    this.objects = t9, this.type = "move-start";
  }
};
var N2 = class {
  constructor(t9, o12, e17) {
    this.dx = t9, this.dy = o12, this.objects = e17, this.type = "move";
  }
};
var q5 = class {
  constructor(t9) {
    this.objects = t9, this.type = "move-stop";
  }
};
var B = Symbol("manipulators");
var J4 = Symbol("tooltips");
var K = class extends n4 {
  constructor(t9) {
    super(t9), this._infos = /* @__PURE__ */ new Map(), this.events = new o2(), this.objects = new V(), this.enableZ = true, this.sketchOptions = new l9(), this.type = "move-3d", this._latestTooltipInfo = null, this._translateTooltipInfo = null, this._translateXYTooltipInfo = null, this._translateZTooltipInfo = null, this._updatingHandles = new h4(), this._moveManipulation = null;
  }
  initialize() {
    const {
      view: t9
    } = this;
    this.tooltip = new h9({
      view: t9
    }), this.addHandles([this.objects.on("change", (t10) => {
      t10.removed.forEach((t11) => this.removeHandles(t11)), this._updateObjectInfos(t10), this._setupFastTransformUpdates(t10.added), this._refreshManipulators();
    }), this.objects.on("change", () => this._connectTooltips())]);
    const o12 = this.objects.toArray();
    this._updateObjectInfos({
      added: o12,
      removed: []
    }), this._setupFastTransformUpdates(o12), this._refreshManipulators(), this._connectTooltips(), this.finishToolCreation();
  }
  destroy() {
    this.tooltip = u(this.tooltip), this._moveManipulation = u(this._moveManipulation), this._set("view", null), this._updatingHandles.destroy();
  }
  onInputEvent(t9) {
    if (!this.destroyed && !G4(t9, this.tooltip)) return super.onInputEvent(t9);
  }
  get updating() {
    return this._updatingHandles.updating;
  }
  get _shouldShowMovePointTooltip() {
    const {
      objects: t9
    } = this;
    if (1 !== t9.length) return false;
    const o12 = t6(t9.at(0))?.type;
    return "point" === o12 || "mesh" === o12;
  }
  get activeTooltipInfo() {
    return this._shouldShowMovePointTooltip ? this._movePointTooltipInfo : this._latestTooltipInfo;
  }
  reset() {
  }
  _updateObjectInfos({
    added: t9,
    removed: o12
  }) {
    for (const e17 of t9) {
      if (r10(e17) !== P4.SUPPORTED) continue;
      const t10 = new Q(e17);
      this._infos.set(e17, t10);
    }
    for (const e17 of o12) this._infos.delete(e17);
  }
  _setupFastTransformUpdates(t9) {
    for (const o12 of t9) {
      const t10 = this._infos.get(o12);
      this.addHandles(a10(t10.object), o12);
    }
  }
  _refreshManipulators() {
    if (this.removeHandles(B), this._moveManipulation = u(this._moveManipulation), this.manipulators.removeAll(), 0 === this._infos.size) return;
    const t9 = Array.from(this._infos.values());
    this._createManipulators(t9), this._createVisualElements(t9), this._updateMoveManipulation(t9);
  }
  _createManipulators(t9) {
    for (const o12 of t9) {
      const e17 = o12.object;
      o12.manipulationXY = new l13({
        tool: this,
        view: this.view,
        object: e17
      }), o12.manipulationXY.forEachManipulator((t10) => {
        this.addHandles([t10.events.on("immediate-click", (t11) => {
          this.events.emit("immediate-click", __spreadProps(__spreadValues({}, t11), {
            object: e17
          })), t11.stopPropagation();
        }), t10.events.on("grab-changed", ({
          action: t11
        }) => {
          "start" === t11 ? this._showTooltip(c7.XY) : this._hideTooltip();
        })], B);
      }), this.addHandles(o12.manipulationXY.createDragPipeline((o13, e18, i13, n11) => this._buildDragEventPipeline(t9, c7.XY, o13, e18, i13, n11)), B);
    }
    this._createMoveManipulation(t9);
  }
  _createMoveManipulation(t9) {
    const o12 = new u11({
      tool: this,
      view: this.view,
      snapToScene: false,
      xyAvailable: true,
      xyAxisAvailable: true,
      zAvailable: true,
      radius: 1 === t9.length ? u11.radiusForSymbol(t9[0].object.graphic?.symbol) : a7
    });
    this._moveManipulation = o12, o12.elevationInfo = {
      mode: "absolute-height",
      offset: 0
    }, o12.forEachManipulator((t10) => {
      this.addHandles(t10.events.on("immediate-click", (e18) => {
        const i14 = this.objects.at(0);
        !o12.zManipulation.hasManipulator(t10) && 1 === this.objects.length && i14 && this.events.emit("immediate-click", __spreadProps(__spreadValues({}, e18), {
          object: i14
        })), e18.stopPropagation();
      }), B);
    });
    const e17 = (t10) => (o13) => {
      this.addHandles([o13.events.on("focus-changed", ({
        action: o14
      }) => {
        "focus" === o14 ? this._showTooltip(t10) : this._hideTooltip();
      }), o13.events.on("grab-changed", () => {
        this._latestTooltipInfo && (this._latestTooltipInfo.distance = h6);
      })], B);
    };
    this._moveManipulation.xyManipulation.forEachManipulator(e17(c7.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(e17(c7.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(e17(c7.Z));
    const i13 = () => this._updateMoveManipulation(t9);
    for (const a14 of t9) this.addHandles([a14.object.on("committed", i13), d2(() => a14.object.visible, i13)], B);
    const n11 = t9[t9.length - 1];
    this.addHandles(n11.object.on("committed", () => this._updateMoveManipulationAngle(n11)), B);
    const {
      object: s6
    } = n11, {
      operations: l17
    } = s6;
    if (l17) {
      const e18 = s6.graphic;
      this.addHandles(o12.createDragPipeline((o13, e19, i14, n12, s7) => this._buildDragEventPipeline(t9, o13, e19, i14, n12, s7), s6.elevationInfo, l17.data.spatialReference, e18), B);
    }
    this._updateMoveManipulationAngle(n11);
  }
  _createVisualElements(t9) {
    for (const o12 of t9) {
      const e17 = o12.object, i13 = l12({
        view: this.view,
        object: e17,
        forEachManipulator: (t10) => {
          o12.manipulationXY?.forEachManipulator(t10), this._moveManipulation?.forEachManipulator(t10);
        },
        onManipulatorsChanged: () => e()
      });
      null != i13 && (o12.geometryRepresentation = i13.visualElement, o12.geometryRepresentation instanceof w4 && this.addHandles([o12.geometryRepresentation.events.on("attachment-origin-changed", () => {
        o12.object.isDraped || this._updateMoveManipulation(t9);
      }), d2(() => o12.object.isDraped, () => this._updateMoveManipulation(t9))], B), this.addHandles(i13, B));
    }
  }
  _updateMoveManipulationAngle(t9) {
    this._moveManipulation && (this._moveManipulation.angle = r11(t6(t9.object)));
  }
  _updateMoveManipulation(t9) {
    const o12 = e7(0, 0, 0, this.view.spatialReference);
    let e17 = 0, i13 = false;
    const n11 = this._moveManipulation;
    if (n11) {
      for (const n12 of t9) {
        if (!n12.object.visible) continue;
        this.enableZ && o8(n12.object.operations, n12.object.elevationInfo) && (i13 = true);
        const t10 = n12.geometryRepresentation instanceof w4 && !n12.object.isDraped ? n12.geometryRepresentation.attachmentOrigin : n12.object.origin;
        if (null != t10) {
          const {
            x: i14,
            y: n13,
            z: s6
          } = t10;
          o12.x += i14, o12.y += n13, s6 && (o12.z ??= 0, o12.z += s6), e17++;
        }
      }
      e17 > 0 ? (o12.x /= e17, o12.y /= e17, o12.z ??= 0, o12.z /= e17, n11.location = o12, n11.xyManipulation.available = true, n11.xyAxisManipulation.available = true, n11.zManipulation.available = i13) : n11.available = false;
    }
  }
  _buildDragEventPipeline(t9, o12, e17, i13, n11, s6) {
    const a14 = [], l17 = [];
    let r14 = null, p12 = null;
    const c10 = () => {
      for (const t10 of a14) t10.dragging = false;
      a14.length = 0, l17.length = 0, r14 = null, p12 = null, this._moveManipulation && (this._moveManipulation.interactive = true);
    };
    if (1 === t9.length && o12 === c7.XY) {
      const o13 = t9[0].object;
      ({
        steps: i13,
        cancel: n11
      } = this._buildSnappingPipelineSteps(o13, o13.elevationInfo, i13, n11, s6));
    }
    return n11 = n11.next((t10) => p12?.(t10)).next(() => (l17.length && this.events.emit("move-stop", new q5(l17)), this.destroyed || c10(), null)), {
      steps: i13 = i13.next((o13) => {
        if ("start" === o13.action) {
          a14.length = 0, l17.length = 0;
          for (const o14 of t9) o14.dragging || !o14.manipulationXY?.hasManipulator(e17) && o14.manipulationXY?.grabbing || (a14.push(o14), l17.push(o14.object), o14.dragging = true);
          if (0 !== l17.length && (this._moveManipulation && (this._moveManipulation.interactive = false), r14 = S4(l17), p12 = z4(l17), this._emitRecordUndo(), this.events.emit("move-start", new L4(l17)), this.destroyed)) return null;
        }
        return 0 !== l17.length ? o13 : null;
      }).next((t10) => r14?.(t10)).next((t10) => (this._updateMoveTooltip(o12, t10), t10)).next((t10) => {
        switch (t10.action) {
          case "start":
          case "update":
            if (t10.translationX || t10.translationY || t10.translationZ) {
              const o13 = this.view.toScreen(t10.mapStart), e18 = this.view.toScreen(t10.mapEnd), i14 = e18.x - o13.x, n12 = e18.y - o13.y;
              if (this.events.emit("move", new N2(i14, n12, l17)), this.destroyed) return null;
            }
            break;
          case "end":
            if (this.events.emit("move-stop", new q5(l17)), this.destroyed) return null;
            c10();
        }
        return null;
      }),
      cancel: n11
    };
  }
  _connectTooltips() {
    let t9;
    if (this.removeHandles(J4), this._shouldShowMovePointTooltip) {
      const o12 = this.objects.at(0), {
        events: e17
      } = this;
      this._movePointTooltipInfo ??= new i6({
        viewType: this.view.type,
        sketchOptions: this.sketchOptions
      });
      const i13 = {
        onMoveStart: () => {
          this._emitRecordUndo(), e17.emit("move-start", new L4([o12]));
        },
        onMove: () => e17.emit("move", new N2(0, 0, [o12])),
        onMoveStop: () => e17.emit("move-stop", new q5([o12]))
      };
      t9 = m6(this.tooltip, o12, () => ({
        sketchOptions: this.sketchOptions,
        activeTooltipInfo: this._movePointTooltipInfo,
        callbacks: i13
      }));
    } else t9 = d2(() => this.sketchOptions.tooltips.effectiveEnabled ? this._latestTooltipInfo : null, (t10) => {
      this.tooltip.info = t10;
    }, A2);
    this.addHandles(t9, J4);
  }
  _showTooltip(t9) {
    this._shouldShowMovePointTooltip || this._updateMoveTooltip(t9);
  }
  _hideTooltip() {
    this._shouldShowMovePointTooltip || (this.tooltip?.clear(), this._latestTooltipInfo = null);
  }
  _updateMoveTooltip(t9, o12) {
    if (this._shouldShowMovePointTooltip) return;
    const {
      sketchOptions: e17
    } = this;
    switch (t9) {
      case c7.XY:
        this._latestTooltipInfo = this._translateTooltipInfo ??= new i7({
          sketchOptions: e17
        }), W3(this._latestTooltipInfo, o12, (t10, o13) => m3(t10, o13));
        break;
      case c7.XY_AXIS:
        this._latestTooltipInfo = this._translateXYTooltipInfo ??= new i9({
          sketchOptions: e17
        }), W3(this._latestTooltipInfo, o12, (t10, e18) => y4(m3(t10, e18), a8(o12)));
        break;
      case c7.Z:
        this._latestTooltipInfo = this._translateZTooltipInfo ??= new i10({
          sketchOptions: e17
        }), W3(this._latestTooltipInfo, o12, y5);
    }
    this._latestTooltipInfo.sketchOptions = e17;
  }
  _emitRecordUndo() {
    const t9 = this.objects.toArray().map((t10) => t10.createUndoRecord?.()).filter(O);
    t9.length > 0 && this.events.emit("record-undo", {
      updates: t9
    });
  }
  _buildSnappingPipelineSteps(t9, o12, e17, i13, n11) {
    const s6 = t6(t9);
    if (null == s6 || "point" !== s6.type && "mesh" !== s6.type) return {
      steps: e17,
      cancel: i13
    };
    const a14 = ("point" === s6.type ? s6 : s6.anchor).clone(), l17 = new e12({
      elevationInfo: o12,
      pointer: n11,
      editGeometryOperations: E4.fromGeometry(a14, this.view.state.viewingMode),
      visualizer: new R4(),
      excludeFeature: t9.graphic
    }), r14 = this.snappingManager, {
      snappingStep: p12,
      cancelSnapping: c10
    } = f6({
      snappingContext: l17,
      snappingManager: r14,
      updatingHandles: this._updatingHandles
    });
    return i13 = i13.next(c10), {
      steps: e17 = e17.next((o13) => {
        a14.z = m2(this.view, a14, t9.elevationInfo, {
          mode: "absolute-height",
          offset: 0
        });
        return __spreadProps(__spreadValues({}, o13), {
          snapOrigin: l17.coordinateHelper.pointToVector(a14)
        });
      }).next(...p12),
      cancel: i13
    };
  }
};
e2([y({
  constructOnly: true,
  nonNullable: true
})], K.prototype, "view", void 0), e2([y()], K.prototype, "objects", void 0), e2([y({
  constructOnly: true,
  nonNullable: true
})], K.prototype, "enableZ", void 0), e2([y({
  constructOnly: true,
  type: l9
})], K.prototype, "sketchOptions", void 0), e2([y({
  constructOnly: true
})], K.prototype, "snappingManager", void 0), e2([y()], K.prototype, "type", void 0), e2([y()], K.prototype, "updating", null), e2([y()], K.prototype, "_latestTooltipInfo", void 0), e2([y()], K.prototype, "_shouldShowMovePointTooltip", null), e2([y()], K.prototype, "activeTooltipInfo", null), K = e2([a("esri.views.3d.interactive.editingTools.move.MoveTool3D")], K);
var Q = class {
  constructor(t9) {
    this.object = t9, this.geometryRepresentation = null, this.manipulationXY = null, this.dragging = false;
  }
};
function W3(t9, o12, e17) {
  if (null == o12 || "end" === o12.action) return void (t9.distance = h6);
  const {
    mapStart: i13,
    mapEnd: n11
  } = o12, s6 = e17(i13, n11);
  t9.distance = null != s6 ? s6 : h6;
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/reshape/edgeOffsetUtils.js
function m7(e17, r14, o12) {
  const n11 = "on-the-ground" === o12.mode ? Z2.XY : Z2.XYZ;
  return new Y(e17, n11, r14, 0);
}
function p8(e17, r14, n11) {
  const t9 = n();
  if (!e17.renderCoordsHelper.toRenderCoords(r14, t9)) return null;
  const s6 = j6(e17, r14, F2(n11.plane)), f9 = j6(e17, r14, n11.edgeDirection);
  if (null == s6 || null == f9) return null;
  const u14 = _2(n(), s6, f9);
  return j(t9, u14, E2());
}
function j6(e17, r14, o12) {
  const t9 = e7(r14.x + o12[0], r14.y + o12[1], r14.z + o12[2], r14.spatialReference), s6 = n(), i13 = n();
  return e17.renderCoordsHelper.toRenderCoords(r14, s6) && e17.renderCoordsHelper.toRenderCoords(t9, i13) ? J(i13, s6, i13) : null;
}
function g5(e17, t9, s6) {
  const l17 = F2(e17), d9 = J(n(), t9, s6), f9 = _2(n(), d9, l17), u14 = _2(n(), d9, f9);
  return t3(d9[0], d9[1], d9[2], 0, f9[0], f9[1], f9[2], 0, u14[0], u14[1], u14[2], 0, 0, 0, 0, 1);
}
function C4(r14, o12, n11) {
  const c10 = n11.projectToRenderScreen(r14, x()), i13 = n11.projectToRenderScreen(o12, x());
  return null != c10 && null != i13 ? v2(e4(c10, c10, i13)) : 0;
}

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/ReshapeEdgeOffsetTooltipInfo.js
var p9 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "reshape-edge-offset", this.distance = h6, this.area = null, this.totalLength = null;
  }
};
e2([y()], p9.prototype, "type", void 0), e2([y()], p9.prototype, "distance", void 0), e2([y()], p9.prototype, "area", void 0), e2([y()], p9.prototype, "totalLength", void 0), p9 = e2([a("esri.views.interactive.tooltip.infos.ReshapeEdgeOffsetTooltipInfo")], p9);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/reshape/reshapeTooltipUtils.js
function S8(t9, e17) {
  const o12 = e17?.type;
  return {
    edgeOffset: new p9({
      sketchOptions: t9,
      viewType: o12
    }),
    movePoint: new i6({
      sketchOptions: t9,
      viewType: o12
    }),
    selectedVertex: new p7({
      sketchOptions: t9,
      viewType: o12
    }),
    translate: new i7({
      sketchOptions: t9,
      viewType: o12
    }),
    translateXY: new i9({
      sketchOptions: t9,
      viewType: o12
    }),
    translateZ: new i10({
      sketchOptions: t9,
      viewType: o12
    })
  };
}
function X2(e17, o12, i13) {
  function a14() {
    const t9 = i13(), e18 = t9.sketchOptions.tooltips.effectiveEnabled ? t9.activeTooltipInfo : null;
    return __spreadProps(__spreadValues({}, t9), {
      activeTooltipInfo: e18
    });
  }
  let p12 = false;
  function l17(t9) {
    p12 = true, V4(o12, t9), e17.info = t9.activeTooltipInfo, p12 = false;
  }
  return o([d2(a14, l17, A2), d2(() => {
    const t9 = a14(), {
      activeTooltipInfo: e18
    } = t9;
    if (e18 && "key" in e18) return {
      context: t9,
      activeTooltipInfo: e18,
      key: e18.key,
      geometry: t6(o12)
    };
  }, (t9, e18) => {
    t9 && !p12 && e18 && e18.key !== t9.key && E7(t9.activeTooltipInfo, o12, t9.context);
  }, C), o12.on("committed", () => l17(a14())), T(e17)]);
}
function E7(t9, e17, {
  selectedVertexManipulatorInfo: o12,
  callbacks: i13
}) {
  const n11 = t6(e17);
  switch (n11?.type) {
    case "mesh":
      "move-point" === t9.type && u12(t9, n11.origin, e17, i13);
      break;
    case "point":
      "move-point" === t9.type && u12(t9, n11, e17, i13);
      break;
    case "polyline":
    case "polygon":
      "selected-vertex" === t9.type && R7(t9, o12, e17, i13);
  }
}
function R7(t9, e17, o12, i13) {
  if ("vertex" !== e17?.type) return;
  const {
    dx: n11,
    dy: s6,
    dz: r14
  } = V2(t9, e17.manipulator.location);
  0 === n11 && 0 === s6 && 0 === r14 || (i13.onReshapeStart?.(), o12.operations?.moveVertices([e17.handle], n11, s6, r14, E3.NEW_STEP), i13.onReshape?.(), i13.onReshapeStop?.());
}
function V4(t9, {
  activeTooltipInfo: e17,
  selectedVertexManipulatorInfo: o12,
  sketchOptions: i13
}) {
  if (e17) switch (e17.sketchOptions = i13, e17?.type) {
    case "move-point":
      v7(e17, t9);
      break;
    case "selected-vertex":
      Y2(e17, o12, t9);
  }
}
function Y2(t9, e17, o12) {
  if (!t9 || "selected-vertex" !== t9.type) return;
  const i13 = e17?.manipulator.location;
  t9.setLocationFromPoint(i13), y6(t9, i13, o12);
  const n11 = o12.operations?.data.geometry;
  switch (n11?.type) {
    case "polygon":
      t9.geometryType = "polygon", t9.totalLength.visible = false, t9.area.actual = u9(n11);
      break;
    case "polyline":
      t9.geometryType = "polyline", t9.totalLength.actual = c4(n11), t9.area.visible = false;
  }
}
function Z3(t9, e17, {
  sketchOptions: o12,
  tooltipInfos: n11
}) {
  let s6 = null;
  switch (t9) {
    case c7.XY:
      s6 = n11.translate, P7(s6, e17, (t10, e18) => m3(t10, e18));
      break;
    case c7.XY_AXIS:
      s6 = n11.translateXY, P7(s6, e17, (t10, o13) => y4(m3(t10, o13), a8(e17)));
      break;
    case c7.Z:
      s6 = n11.translateZ, P7(s6, e17, y5);
  }
  return s6.sketchOptions = o12, s6;
}
function P7(t9, o12, i13) {
  if (null != o12 && "end" !== o12.action) {
    const {
      mapStart: n11,
      mapEnd: s6
    } = o12, r14 = i13(n11, s6);
    t9.distance = null != r14 ? r14 : h6;
  } else t9.distance = h6;
}
function A9(t9, o12, {
  sketchOptions: i13,
  tooltipInfos: n11
}) {
  const s6 = n11.edgeOffset;
  if (s6.distance = h6, null != o12 && "end" !== o12.action) {
    const e17 = t9.operations, {
      mapEnd: i14,
      signedDistance: n12,
      operation: r15
    } = o12;
    if (null != n12 && null != e17) {
      const o13 = e17.data.coordinateHelper, a14 = n12 * r15.selectedArrow;
      s6.distance = D5(t9.isDraped, a14, i14, r15.plane, o13);
    }
  }
  const r14 = t9.operations?.data.geometry;
  return s6.area = "polygon" === r14?.type ? u9(r14) : null, s6.totalLength = "polyline" === r14?.type ? c4(r14) : null, s6.sketchOptions = i13, s6;
}
function D5(t9, e17, i13, n11, s6) {
  if (t9) {
    const t10 = s6.toXYZ(s6.pointToVector(i13)), r14 = J2(n11, t10, c3.get()), a14 = u7(r14, t10, s6.spatialReference);
    if (null != a14) return a5(a14.value * Math.sign(e17), a14.unit);
  }
  return a5(e17 * W(i13.spatialReference), "meters");
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/reshape/ReshapeOperation.js
var ve = Symbol();
var Me = class extends S2 {
  get grabbingOrDragging() {
    return this._numGrabbing + this._numDragging > 0;
  }
  get _operations() {
    return this.object.operations;
  }
  constructor(e17) {
    super(e17), this._selectedIndex = 0, this._manipulatorHandles = new r(), this._manipulatorInfos = [], this._numGrabbing = 0, this._numDragging = 0, this._reshapeEventState = Se.NONE, this._updatingHandles = new h4(), this._recreatingManipulators = false, this._settings = new j4({
      getTheme: () => this.view.effectiveTheme
    }), this.events = new o2(), this.activeTooltipInfo = null, this._vertexLaserLineVisualElement = null;
  }
  initialize() {
    const {
      view: e17
    } = this, t9 = this._settings.manipulators, i13 = t9.vertex;
    this.tooltipInfos = S8(this._sketchOptions, e17), this._vertexManipulatorMaterial = f5(E(i13.color), i13.renderOccluded), this._vertexManipulatorOutlineMaterial = h7(E(i13.outlineColor), i13.renderOccluded), this._vertexManipulatorHoverOutlineMaterial = h7(E(i13.hoverOutlineColor), i13.renderOccluded);
    const n11 = t9.edge;
    this._edgeManipulatorMaterial = f5(E(n11.color), n11.renderOccluded), this._edgeManipulatorOutlineMaterial = h7(E(n11.outlineColor), n11.renderOccluded);
    const o12 = t9.edgeOffset;
    this._edgeOffsetManipulatorMaterial = f5(E(o12.color), o12.renderOccluded, false), this._edgeOffsetManipulatorHoverMaterial = f5(E(o12.hoverColor), o12.renderOccluded, false);
    const s6 = t9.selected;
    this._selectedManipulatorMaterial = f5(E(s6.color), s6.renderOccluded), this._selectedManipulatorOutlineMaterial = h7(E(s6.outlineColor), s6.renderOccluded), this._selectedManipulatorHoverOutlineMaterial = h7(E(s6.hoverOutlineColor), s6.renderOccluded), this.tooltip = new h9({
      view: e17
    }), this.addHandles([d2(() => {
      const e18 = this._settings.manipulators;
      return {
        vertexSettings: e18.vertex,
        edgeSettings: e18.edge,
        edgeOffsetSettings: e18.edgeOffset,
        selectedSettings: e18.selected
      };
    }, ({
      vertexSettings: e18,
      edgeSettings: t10,
      edgeOffsetSettings: i14,
      selectedSettings: a14
    }) => {
      e18.applyColor(this._vertexManipulatorMaterial), e18.applyOutline(this._vertexManipulatorOutlineMaterial), e18.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial), t10.applyColor(this._edgeManipulatorMaterial), t10.applyOutline(this._edgeManipulatorOutlineMaterial), i14.applyColor(this._edgeOffsetManipulatorMaterial), i14.applyHover(this._edgeOffsetManipulatorHoverMaterial), a14.applyColor(this._selectedManipulatorMaterial), a14.applyOutline(this._selectedManipulatorOutlineMaterial), a14.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial);
    }), d2(() => this.object.visible, (e18) => {
      for (const t10 of this._manipulatorInfos) t10.manipulator.available = e18, "edge" === t10.type && "edgeManipulator" in t10 && (t10.edgeManipulator.available = e18);
    }), d2(() => this._numGrabbing + this._numDragging === 0, (e18) => this._toggleAutoHideManipulators(e18)), d2(() => ({
      labels: this._segmentLabels,
      enabled: this._sketchOptions.labels.enabled,
      edgeOffsetEnabled: this.enableEdgeOffset
    }), ({
      labels: e18,
      enabled: t10,
      edgeOffsetEnabled: i14
    }) => {
      null != e18 && (e18.visible = t10, e18.edgeDistance = i14 ? "far" : "default");
    }, P), X2(this.tooltip, this.object, () => this._tooltipsContext), v(() => this._operations, "vertex-update", (e18) => {
      this._updateManipulatorPositions(e18.vertices);
    }, {
      onListenerAdd: () => this._recreateManipulators()
    }), v(() => this._operations?.data, "change", (e18) => {
      "undo" !== e18.operation && "redo" !== e18.operation || this._recreateManipulators();
    })]);
  }
  destroy() {
    this._segmentLabels = u(this._segmentLabels), this.tooltip = u(this.tooltip), this._removeManipulators(), this._updatingHandles.destroy();
  }
  get updating() {
    return this._updatingHandles.updating;
  }
  get manipulators() {
    return this.tool.manipulators;
  }
  get view() {
    return this.tool.view;
  }
  get object() {
    return this.tool.object;
  }
  get enableZShape() {
    return this.tool.enableZShape;
  }
  get enableDeleteVertices() {
    return this.tool.enableDeleteVertices;
  }
  get enableZVertex() {
    return this.tool.enableZVertex;
  }
  get autoHideManipulators() {
    return this.tool.autoHideManipulators;
  }
  get enableMoveObject() {
    return this.tool.enableMoveObject;
  }
  get enableMidpoints() {
    return this.tool.enableMidpoints;
  }
  get enableEdgeOffset() {
    return this.tool.enableEdgeOffset;
  }
  get _sketchOptions() {
    return this.tool.sketchOptions;
  }
  get _accentColor() {
    return this.view.effectiveTheme.accentColor;
  }
  removeSelectedVertices() {
    const e17 = this._manipulatorInfos.filter((e18) => e18.manipulator.selected && "vertex" === e18.type);
    return this._removeVertices(e17), e17.length;
  }
  onManipulatorSelectionChanged() {
    this.events.emit("manipulators-changed");
  }
  _removeManipulators() {
    this._manipulatorHandles.removeAll(), this._moveManipulation = u(this._moveManipulation), this._objectMoveManipulation = u(this._objectMoveManipulation), this.manipulators.removeAll(), this._manipulatorInfos = [], this._numGrabbing = 0, this._numDragging = 0;
  }
  _createManipulators(e17) {
    if (null == this._operations) return;
    const t9 = this.object.elevationInfo;
    for (const i13 of this._operations.data.components) {
      const a14 = e17?.byComponentIndex.get(i13.index);
      for (const e18 of i13.vertices) {
        const i14 = a14?.has(e18.index);
        this._createVertexOrEdgeManipulator(e18, t9, i14);
      }
      for (const e18 of i13.edges) this._createVertexOrEdgeManipulator(e18, t9);
    }
    this._createObjectMoveManipulation(), this._createMoveManipulation(t9), this._createVisualElements();
  }
  get canRedo() {
    return null != this._operations && this._operations.canRedo;
  }
  get canUndo() {
    return null != this._operations && this._operations.canUndo;
  }
  redo() {
    return this._operations?.redo();
  }
  undo() {
    return this.events.emit("undo"), this._operations?.undo();
  }
  _recreateManipulators() {
    if (!this._recreatingManipulators) {
      if (this._recreatingManipulators = true, this._removeManipulators(), this._resetTooltip(), this._operations && this._segmentLabels?.context?.editGeometryOperations === this._operations || (this._segmentLabels = u(this._segmentLabels)), this._createManipulators(), !this._segmentLabels && this._operations) {
        const e17 = this._sketchOptions.labels;
        this._segmentLabels = new a9({
          context: {
            view: this.view,
            editGeometryOperations: this._operations,
            elevationInfo: this.object.elevationInfo,
            labelOptions: e17
          },
          visible: e17.enabled
        });
      }
      this._recreatingManipulators = false;
    }
  }
  _perObjectManipulatorDragAction(e17, t9) {
    if ("end" === t9.action) return t9;
    let i13 = 0;
    const a14 = [], n11 = this._manipulatorInfos.some((e18) => "vertex" === e18.type && e18.manipulator.selected), o12 = e17 === He.SELECTED_OR_ALL && n11;
    for (const s6 of this._manipulatorInfos) "vertex" === s6.type && (s6.manipulator.grabbing || o12 && !s6.manipulator.selected || a14.push(s6), i13++);
    this._moveVertices(a14, t9);
    if (a14.length === i13) {
      if (this._updateEventState(Se.MOVING), this.destroyed) return t9;
      this.events.emit("move", {
        type: "move",
        dx: t9.screenDeltaX,
        dy: t9.screenDeltaY,
        object: this.object
      });
    } else {
      if (this._updateEventState(Se.RESHAPING), this.destroyed) return t9;
      this.events.emit("reshape", {
        type: "reshape",
        object: this.object
      });
    }
    return t9;
  }
  _toggleAutoHideManipulators(e17) {
    this.autoHideManipulators && (e17 ? this.removeHandles(ve) : this.tool.manipulators.forEach(({
      manipulator: e18
    }) => {
      const t9 = e18.disableDisplay?.();
      t9 && this.addHandles(t9, ve);
    }));
  }
  _isMultiVertexSelection() {
    return this._manipulatorInfos.reduce((e17, t9) => "vertex" === t9.type && t9.manipulator.selected ? e17 + 1 : e17, 0) > 1;
  }
  _perVertexManipulatorDragAction(e17) {
    if (this._updateEventState(Se.RESHAPING), this.destroyed) return;
    const {
      mapDeltaX: t9,
      mapDeltaY: i13,
      mapDeltaZ: a14
    } = e17;
    if (!t9 && !i13 && !a14) return;
    const n11 = [];
    for (const o12 of this._manipulatorInfos) "vertex" === o12.type && (o12.manipulator.selected && !o12.manipulator.grabbing || o12 === e17.info) && n11.push(o12);
    this._moveVertices(n11, e17, E3.ACCUMULATE_STEPS), this.events.emit("reshape", {
      type: "reshape",
      object: this.object
    });
  }
  _updateEventState(e17) {
    if (e17 === this._reshapeEventState) return false;
    switch (e17) {
      case Se.NONE:
        if (0 !== this._numGrabbing || 0 !== this._numDragging) return false;
        switch (this._reshapeEventState) {
          case Se.MOVING:
            this.events.emit("move", {
              type: "move-stop",
              dx: 0,
              dy: 0,
              object: this.object
            });
            break;
          case Se.RESHAPING:
            this.events.emit("reshape", {
              type: "reshape-stop",
              object: this.object
            });
        }
        break;
      case Se.MOVING:
        switch (this._reshapeEventState) {
          case Se.NONE:
            this.events.emit("move", {
              type: "move-start",
              dx: 0,
              dy: 0,
              object: this.object
            });
            break;
          case Se.RESHAPING:
            this.events.emit("reshape", {
              type: "reshape-stop",
              object: this.object
            }), this.destroyed || this.events.emit("move", {
              type: "move-start",
              dx: 0,
              dy: 0,
              object: this.object
            });
        }
        break;
      case Se.RESHAPING:
        switch (this._reshapeEventState) {
          case Se.NONE:
            this.events.emit("reshape", {
              type: "reshape-start",
              object: this.object
            });
            break;
          case Se.MOVING:
            this.events.emit("move", {
              type: "move-stop",
              dx: 0,
              dy: 0,
              object: this.object
            }), this.destroyed || this.events.emit("reshape", {
              type: "reshape-start",
              object: this.object
            });
        }
    }
    if (this.destroyed) return false;
    const t9 = this._reshapeEventState !== e17;
    return this._reshapeEventState = e17, t9;
  }
  _createObjectMoveManipulation() {
    const {
      tool: e17,
      view: t9,
      object: i13,
      _operations: a14
    } = this;
    if (a14) {
      if (this._objectMoveManipulation = new l13({
        tool: e17,
        view: t9,
        object: i13
      }), this.enableMoveObject) {
        let e18 = null;
        this._manipulatorHandles.add(this._objectMoveManipulation.createDragPipeline((t10, i14, n11) => {
          i14.next((e19) => this._trackNumDragging(e19)).next((t11) => ("start" === t11.action && (e18 = a14.createUndoGroup()), t11)).next((e19) => this._perObjectManipulatorDragAction(He.ALL, e19)).next((e19) => (this._updateTranslateObjectTooltip(c7.XY, e19), e19)).next((t11) => {
            "end" === t11.action && (this._resetTooltip(), e18 = l(e18));
          }), n11.next(() => this._onDragCancel(true, () => e18 = l(e18)));
        })), this._objectMoveManipulation.forEachManipulator((e19) => this._manipulatorHandles.add(this._watchAndUpdateGrabState(e19, false)));
      } else this._objectMoveManipulation.forEachManipulator((e18) => {
        e18.grabbable = false, e18.cursor = null;
      });
      this._objectMoveManipulation.forEachManipulator((e18) => this._manipulatorHandles.add(e18.events.on("immediate-click", (e19) => {
        this._manipulatorInfos.some((e20) => e20.manipulator.selected) ? this._clearSelection() : this.events.emit("immediate-click", __spreadProps(__spreadValues({}, e19), {
          object: this.object
        })), e19.stopPropagation();
      })));
    }
  }
  _createMoveManipulation(e17) {
    const {
      object: t9,
      tool: i13,
      view: a14,
      _operations: n11
    } = this;
    if (!n11) return;
    this._moveManipulation = new u11({
      tool: i13,
      view: a14,
      xyAvailable: true,
      xyAxisAvailable: true,
      zAvailable: this.enableZShape && o8(t9.operations, t9.elevationInfo),
      snapToScene: false,
      radius: u11.radiusForSymbol(t9.graphic?.symbol)
    }), this._moveManipulation.forEachManipulator((e18) => this.addHandles([e18.events.on("immediate-click", (t10) => {
      this._moveManipulation.zManipulation.hasManipulator(e18) || this._manipulatorInfos.some((e19) => e19.manipulator.selected) || this.events.emit("immediate-click", __spreadProps(__spreadValues({}, t10), {
        object: this.object
      })), t10.stopPropagation();
    }), this._watchAndUpdateGrabState(e18, false)]));
    const o12 = (e18) => (t10) => {
      this.addHandles(t10.events.on("focus-changed", ({
        action: t11
      }) => {
        "focus" === t11 ? this._updateTranslateTooltip(e18) : this._resetTooltip();
      }));
    };
    this._moveManipulation.xyManipulation.forEachManipulator(o12(c7.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(o12(c7.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(o12(c7.Z)), this._moveManipulation.elevationInfo = {
      mode: "absolute-height",
      offset: 0
    };
    const s6 = n11.data.spatialReference;
    this.addHandles([this._moveManipulation.createDragPipeline((a15, o13, s7, r14, l17) => {
      const {
        snappingStep: p12,
        cancelSnapping: d9
      } = f6({
        predicate: (e18) => !!e18.info,
        snappingManager: i13.snappingManager,
        snappingContext: new e12({
          editGeometryOperations: n11,
          elevationInfo: e17,
          pointer: l17,
          excludeFeature: t9.graphic,
          visualizer: new R4()
        }),
        updatingHandles: this._updatingHandles,
        useZ: false
      });
      return r14 = r14.next((e18) => (this._onDragCancel(), e18)).next(d9), {
        steps: s7 = s7.next((e18) => this._trackNumDragging(e18)).next((e18) => {
          const t10 = this._manipulatorInfos.filter((e19) => "vertex" === e19.type && e19.manipulator.selected);
          return e18.manipulatorType === A5.TRANSLATE_XY && 1 === t10.length ? __spreadProps(__spreadValues({}, e18), {
            info: t10[0],
            snapOrigin: t10[0].handle.pos
          }) : e18;
        }).next(D2(this.view, e17, t9.graphic ?? void 0)).next(...p12).next(v4()).next((e18) => this._perObjectManipulatorDragAction(He.SELECTED_OR_ALL, e18)).next((e18) => (this._updateTranslateTooltip(a15, e18), e18)),
        cancel: r14
      };
    }, e17, s6, t9.graphic), d2(() => t9.visible, () => this._updateMoveManipulationPosition(), P), t9.on("committed", () => {
      this._recreatingManipulators || this._updateMoveManipulationPosition();
    }), d2(() => t9.isDraped, (e18) => {
      this._updateMoveManipulationPosition();
      const t10 = "align-move-manipulation";
      e18 ? this.addHandles(this.view.elevationProvider.on("elevation-change", () => this._updateMoveManipulationPosition()), t10) : this.removeHandles(t10);
    }, P)]);
  }
  _createVisualElements() {
    const {
      object: e17,
      view: t9
    } = this, i13 = l12({
      view: t9,
      object: e17,
      forEachManipulator: (e18) => {
        if (!this.destroyed && !this._recreatingManipulators) {
          this._objectMoveManipulation.forEachManipulator(e18), this._moveManipulation.forEachManipulator(e18);
          for (const t10 of this._manipulatorInfos) e18(t10.manipulator, A5.TRANSLATE_XY);
        }
      },
      onManipulatorsChanged: (e18) => this.events.on("manipulators-changed", e18)
    });
    null != i13 && (this._outlineVisualElement = i13.visualElement instanceof w4 ? i13.visualElement : null);
    const a14 = this._outlineVisualElement;
    if (null != a14) {
      const t10 = () => {
        e17.isDraped || this._updateMoveManipulationPosition();
      };
      this._manipulatorHandles.add(v(() => a14.events, "attachment-origin-changed", t10, {
        onListenerAdd: t10
      }));
    }
    this._manipulatorHandles.add(i13);
  }
  _createEdgeOffsetManipulator(e17, t9 = this.object.elevationInfo) {
    const i13 = this._operations;
    if (e17.component.vertices.length <= 2 || !i13) return null;
    const a14 = this._settings.manipulators.edgeOffset, n11 = a14.size / 2, o12 = n11 + a14.collisionPadding, r14 = n11 / o12, l17 = r14 * Math.sqrt(3) / 2;
    null == this._edgeOffsetManipulatorGeometryInside && (this._edgeOffsetManipulatorGeometryInside = wt(this._edgeOffsetManipulatorMaterial, l17, r14 / 2, r14 / 2, a14.height, a14.offset)), null == this._edgeOffsetManipulatorGeometryOutside && (this._edgeOffsetManipulatorGeometryOutside = wt(this._edgeOffsetManipulatorMaterial, -l17, r14 / 2, r14 / 2, a14.height, -a14.offset));
    const p12 = [new e10(this._edgeOffsetManipulatorGeometryInside.instantiate(), t5.Unfocused), new e10(this._edgeOffsetManipulatorGeometryInside.instantiate({
      material: this._edgeOffsetManipulatorHoverMaterial
    }), t5.Focused), new e10(this._edgeOffsetManipulatorGeometryOutside.instantiate(), t5.Unfocused), new e10(this._edgeOffsetManipulatorGeometryOutside.instantiate({
      material: this._edgeOffsetManipulatorHoverMaterial
    }), t5.Focused)], d9 = new ee({
      view: this.view,
      renderObjects: p12,
      elevationInfo: "on-the-ground" !== t9.mode || y3(this.object.graphic?.symbol) ? {
        mode: "absolute-height",
        offset: 0
      } : t9,
      worldOriented: false,
      focusMultiplier: 1,
      radius: o12,
      available: this.object.visible,
      collisionType: {
        type: "disc",
        direction: r3(0, 0, 1)
      },
      collisionPriority: 1,
      metadata: {
        deleting: false
      }
    }), h11 = new ee({
      view: this.view,
      worldSized: true,
      worldOriented: false,
      available: this.object.visible,
      collisionPriority: -10,
      cursor: this.enableMoveObject ? "move" : "default",
      metadata: {
        deleting: false
      }
    }), u14 = {
      manipulator: d9,
      handle: e17,
      locationUpdateHandle: null,
      type: "edge",
      selectedIndex: 0,
      edgeManipulator: h11,
      elevationInfo: t9,
      visibilityHandle: null
    };
    this._autoHideEdgeOffsetManipulator(u14, a14.minSquaredEdgeLength), this._updateEdgeOffsetManipulator(u14);
    const c10 = [];
    for (const s6 of [e17.leftVertex, e17.rightVertex]) {
      const e18 = this._getManipulatorInfoFromHandle(s6);
      null != e18 && c10.push(e18.manipulator.events.on("location-update", () => this._updateEdgeOffsetManipulator(u14)));
    }
    u14.locationUpdateHandle = o(c10), this._manipulatorHandles.add(u14.locationUpdateHandle, d9), this._manipulatorHandles.add([this._watchAndUpdateGrabState(d9, true), this._watchAndUpdateGrabState(h11, true)], d9), this._manipulatorHandles.add(p4(d9, this._createEdgeOffsetPipeline(u14, t9)), d9), this._manipulatorHandles.add(p4(h11, (e18, a15, n12, o13) => {
      if ("touch" === o13) {
        this._createEdgeOffsetPipeline(u14, t9)(e18, a15, n12);
      } else if (this.enableMoveObject) {
        const o14 = this.object.graphic, s6 = i13.data.spatialReference;
        a15.next((e19) => this._trackNumDragging(e19)).next(M2(this.view, e18.elevationAlignedLocation)).next(D3(this.view, e18.elevationAlignedLocation, t9, s6, o14)).next(j3()).next(v4()).next((e19) => this._perObjectManipulatorDragAction(He.ALL, e19)).next((e19) => (this._updateTranslateObjectTooltip(c7.XY, e19), e19)).next((e19) => {
          "end" === e19.action && this._resetTooltip();
        }), n12.next(() => this._onDragCancel(!e18.metadata.deleting));
      }
    }), d9);
    const m8 = (e18) => {
      this._manipulatorInfos.some((e19) => e19.manipulator.selected) ? this._clearSelection() : this.events.emit("immediate-click", __spreadProps(__spreadValues({}, e18), {
        object: this.object
      })), e18.stopPropagation();
    };
    return this._manipulatorHandles.add([d9.events.on("immediate-click", m8), h11.events.on("immediate-click", m8), d9.events.on("focus-changed", ({
      action: e18
    }) => {
      "focus" === e18 ? this._updateEdgeOffsetTooltip(null) : this._resetTooltip();
    })], d9), this._manipulatorInfos.push(u14), this.manipulators.add(d9), this.manipulators.add(h11), this.events.emit("manipulators-changed"), u14;
  }
  _autoHideEdgeOffsetManipulator(e17, t9) {
    const i13 = e17.manipulator, a14 = e17.edgeManipulator, n11 = () => {
      e17.visibilityHandle = l(e17.visibilityHandle);
      const n12 = this._getManipulatorInfoFromHandle(e17.handle.leftVertex), o12 = this._getManipulatorInfoFromHandle(e17.handle.rightVertex), l17 = null != n12 && null != o12 && C4(n12.manipulator.renderLocation, o12.manipulator.renderLocation, this.view.state.camera) < t9;
      (!i13.focused && !a14.focused || l17) && (i13.grabbable = !l17, a14.grabbable = !l17, e17.visibilityHandle = o([i13.disableDisplay(), e(() => {
        i13.grabbable = true, a14.grabbable = this.enableMoveObject;
      })]));
    };
    this._manipulatorHandles.add([i13.events.on("focus-changed", n11), a14.events.on("focus-changed", n11), e(() => {
      l(e17.visibilityHandle), a14.metadata.deleting = true, this.manipulators.remove(a14);
    })], i13), n11();
  }
  _updateEdgeOffsetManipulator(e17) {
    if (!this._operations) return;
    this._updateManipulatorPosition(e17);
    const {
      coordinateHelper: t9
    } = this._operations.data, i13 = p8(this.view, e17.manipulator.elevationAlignedLocation, m7(t9, e17.handle, e17.manipulator.elevationInfo)), a14 = this._getManipulatorInfoFromHandle(e17.handle.leftVertex), n11 = this._getManipulatorInfoFromHandle(e17.handle.rightVertex);
    if (null == a14 || null == n11) return;
    const o12 = a14.manipulator.renderLocation, s6 = n11.manipulator.renderLocation, r14 = null != i13 ? g5(i13, o12, s6) : o4;
    e17.manipulator.modelTransform = r14, e17.edgeManipulator.elevationAlignedLocation = e17.manipulator.elevationAlignedLocation, e17.edgeManipulator.modelTransform = r14;
    const l17 = s2(e4(Ee, o12, s6)) / 2;
    e17.edgeManipulator.collisionType = {
      type: "line",
      paths: [[[-l17, 0, 0], [l17, 0, 0]]]
    };
  }
  _createEdgeOffsetPipeline(e17, t9) {
    return (i13, a14, n11) => {
      const o12 = this._operations;
      if (!o12) return;
      this._clearSelection();
      const {
        step: s6,
        cleanup: r14
      } = this._initializeEdgeOffset(e17, t9, o12);
      a14.next((e18) => this._trackNumDragging(e18)).next(M2(this.view, i13.elevationAlignedLocation)).next(s6).next(C2(this.view)).next(A4(this.view, o12.data.spatialReference)).next(v4()).next(be()).next(this._applyEdgeOffsetStep(e17)).next(this._showEdgeOffsetTooltip()).next((e18) => {
        "end" === e18.action && r14();
      }), n11.next(() => {
        i13.metadata.deleting || (r14(), this._onDragCancel());
      });
    };
  }
  _initializeEdgeOffset(e17, t9, i13) {
    const {
      view: n11
    } = this, o12 = m7(i13.data.coordinateHelper, e17.handle, t9), r14 = i13.createUndoGroup(), p12 = p8(n11, e17.manipulator.elevationAlignedLocation, o12);
    if (o12.requiresSplitEdgeLeft) {
      const t10 = this._getManipulatorInfoFromHandle(e17.handle.leftVertex.leftEdge);
      null != t10 && this._splitEdgeManipulator(t10, 1);
    }
    if (o12.requiresSplitEdgeRight) {
      const t10 = this._getManipulatorInfoFromHandle(e17.handle.rightVertex.rightEdge);
      null != t10 && this._splitEdgeManipulator(t10, 0);
    }
    const c10 = () => new m({
      paths: [[e17.handle.leftVertex.pos, e17.handle.rightVertex.pos]],
      spatialReference: i13.data.spatialReference
    }), m8 = this._settings, g7 = new w4({
      view: n11,
      isDraped: this.object.isDraped,
      geometry: c10(),
      elevationInfo: e17.elevationInfo,
      width: m8.visualElements.lineObjects.outline.width,
      attached: false,
      isDecoration: true
    });
    let _4;
    const f9 = () => {
      this._cleanEdgeOffsetCollapsedEdges(e17), _4 = l(_4);
    }, v8 = this.events.on("undo", f9);
    return _4 = o([d2(() => E(this._accentColor), (e18) => g7.color = e18, P), l2(g7), d2(() => this.object.isDraped, (e18) => g7.isDraped = e18), this.object.on("committed", () => g7.geometry = c10()), r14, v8]), g7.attached = true, {
      step: (e18) => null == o12 || null == p12 ? (f9(), null) : __spreadProps(__spreadValues({}, e18), {
        operation: o12,
        plane: p12
      }),
      cleanup: f9
    };
  }
  _applyEdgeOffsetStep(e17) {
    return (t9) => {
      if (this.destroyed || null == t9.operation) return t9;
      this._updateEventState(Se.RESHAPING);
      const {
        mapDeltaX: i13,
        mapDeltaY: a14,
        mapDeltaZ: n11
      } = t9;
      return (i13 || a14 || n11) && (this._offsetEdge(e17, t9), this.events.emit("reshape", {
        type: "reshape",
        object: this.object
      })), t9;
    };
  }
  _showEdgeOffsetTooltip() {
    return (e17) => (null != e17.signedDistance && this.object.operations ? this._updateEdgeOffsetTooltip(e17) : this._resetTooltip(), e17);
  }
  _cleanEdgeOffsetCollapsedEdges(e17) {
    if (!this._operations) return;
    const t9 = e17.handle.leftVertex.leftEdge?.leftVertex, i13 = e17.handle.leftVertex, a14 = e17.handle.rightVertex.rightEdge?.rightVertex, n11 = e17.handle.rightVertex, o12 = this._operations.data.coordinateHelper, s6 = [];
    if (t9 && o12.distance(t9.pos, i13.pos) < je) {
      const e18 = this._getManipulatorInfoFromHandle(i13);
      null != e18 && s6.push(e18);
    }
    if (o12.distance(i13.pos, n11.pos) < je || a14 && o12.distance(a14.pos, n11.pos) < je) {
      const e18 = this._getManipulatorInfoFromHandle(n11);
      null != e18 && s6.push(e18);
    }
    s6.length && this._removeVertices(s6);
  }
  _createVertexOrEdgeManipulator(e17, t9 = this.object.elevationInfo, i13 = false) {
    const {
      view: a14,
      _operations: n11
    } = this;
    if (!n11) return null;
    const o12 = this._settings;
    if ("edge" === e17.type) {
      if (this.enableEdgeOffset) return this._createEdgeOffsetManipulator(e17, t9);
      if (!this.enableMidpoints) return null;
    }
    if (null == this._vertexManipulatorGeometry || null == this._vertexManipulatorOutlineGeometry) {
      const {
        size: e18,
        outlineSize: t10
      } = xe(o12.manipulators.vertex);
      this._vertexManipulatorGeometry = st(this._vertexManipulatorMaterial, e18, 16, 16), this._vertexManipulatorOutlineGeometry = st(this._vertexManipulatorOutlineMaterial, t10, 16, 16);
    }
    if (null == this._edgeManipulatorGeometry || null == this._edgeManipulatorOutlineGeometry) {
      const {
        size: e18,
        outlineSize: t10
      } = xe(o12.manipulators.edge);
      this._edgeManipulatorGeometry = st(this._edgeManipulatorMaterial, e18, 16, 16), this._edgeManipulatorOutlineGeometry = st(this._edgeManipulatorOutlineMaterial, t10, 16, 16);
    }
    const r14 = this._operations?.data.type, l17 = "point" === r14 || "mesh" === r14 ? [] : [new e10(this._vertexManipulatorGeometry.instantiate(), Ie.Vertex | t5.Unselected), new e10(this._vertexManipulatorOutlineGeometry.instantiate(), Ie.Vertex | t5.Unfocused | t5.Unselected), new e10(this._vertexManipulatorOutlineGeometry.instantiate({
      material: this._vertexManipulatorHoverOutlineMaterial
    }), Ie.Vertex | t5.Focused | t5.Unselected), new e10(this._vertexManipulatorGeometry.instantiate({
      material: this._selectedManipulatorMaterial
    }), t5.Selected), new e10(this._vertexManipulatorOutlineGeometry.instantiate({
      material: this._selectedManipulatorOutlineMaterial
    }), t5.Selected | t5.Unfocused), new e10(this._vertexManipulatorOutlineGeometry.instantiate({
      material: this._selectedManipulatorHoverOutlineMaterial
    }), t5.Selected | t5.Focused)];
    this.enableMidpoints && l17.push(new e10(this._edgeManipulatorGeometry.instantiate({
      material: this._vertexManipulatorMaterial
    }), Ie.Edge | t5.Focused | t5.Unselected), new e10(this._edgeManipulatorOutlineGeometry.instantiate({
      material: this._vertexManipulatorHoverOutlineMaterial
    }), Ie.Edge | t5.Focused | t5.Unselected), new e10(this._edgeManipulatorGeometry.instantiate(), Ie.Edge | t5.Unfocused | t5.Unselected), new e10(this._edgeManipulatorOutlineGeometry.instantiate(), Ie.Edge | t5.Unfocused | t5.Unselected));
    const p12 = new ee({
      view: a14,
      renderObjects: l17,
      elevationInfo: t9,
      focusMultiplier: 1,
      touchMultiplier: 1,
      available: this.object.visible,
      metadata: {
        deleting: false
      }
    });
    p12.selected = i13, this._setTypeSpecificManipulatorSettings(p12, e17, t9);
    const h11 = "edge" === e17.type ? {
      manipulator: p12,
      handle: e17,
      locationUpdateHandle: null,
      type: "edge",
      selectedIndex: 0
    } : {
      manipulator: p12,
      handle: e17,
      type: "vertex",
      selectedIndex: 0
    };
    if (this._manipulatorInfos.push(h11), this.manipulators.add(p12), this._updateManipulatorPosition(h11), "edge" === h11.type) {
      const e18 = [];
      for (const t10 of [h11.handle.leftVertex, h11.handle.rightVertex]) {
        const i14 = this._getManipulatorInfoFromHandle(t10);
        null != i14 && e18.push(i14.manipulator.events.on("location-update", () => this._updateManipulatorPosition(h11)));
      }
      h11.locationUpdateHandle = o(e18), this._manipulatorHandles.add(h11.locationUpdateHandle, p12);
    }
    this._manipulatorHandles.add(this._watchAndUpdateGrabState(p12, true), p12);
    const u14 = p4(p12, (e18, i14, a15, o13) => {
      let s6 = null;
      const {
        snappingStep: r15,
        cancelSnapping: l18
      } = f6({
        predicate: () => !this._isMultiVertexSelection(),
        snappingManager: this.tool.snappingManager,
        snappingContext: new e12({
          editGeometryOperations: n11,
          elevationInfo: t9,
          pointer: o13,
          excludeFeature: this.object.graphic,
          visualizer: new R4()
        }),
        updatingHandles: this._updatingHandles,
        useZ: false
      });
      a15 = a15.next((t10) => (this._onDragCancel(!e18.metadata.deleting, () => s6 = l(s6)), t10)).next(l18), i14.next((e19) => this._trackNumDragging(e19)).next((e19) => {
        if ("start" === e19.action && this._operations && (s6 = this._operations.createUndoGroup()), "edge" === h11.type) {
          const t10 = this._splitEdgeManipulator(h11);
          return __spreadProps(__spreadValues({}, e19), {
            info: t10,
            snapOrigin: t10.handle.pos
          });
        }
        return __spreadProps(__spreadValues({}, e19), {
          info: h11,
          snapOrigin: h11.handle.pos
        });
      }).next(M2(this.view, e18.elevationAlignedLocation)).next(D3(this.view, e18.elevationAlignedLocation, this.object.elevationInfo, e18.location.spatialReference, this.object.graphic)).next(D2(this.view, t9, this.object.graphic ?? void 0)).next(...r15).next(v4()).next((e19) => {
        this._perVertexManipulatorDragAction(e19), "end" === e19.action && (s6 = l(s6)), this._resetTooltip();
      });
    });
    return this._manipulatorHandles.add([u14, p12.events.on("immediate-click", (e18) => this._manipulatorClickCallback(e18, h11)), p12.events.on("select-changed", () => {
      h11.selectedIndex = ++this._selectedIndex, this._updateMoveManipulationPosition(), this._resetTooltip();
    }), p12.events.on("focus-changed", () => {
      this._resetTooltip();
    })], p12), this.events.emit("manipulators-changed"), h11;
  }
  _trackNumDragging(e17) {
    switch (e17.action) {
      case "start":
        this._numDragging++;
        break;
      case "end":
        this._numDragging--;
    }
    return e17;
  }
  _onDragCancel(e17 = true, t9) {
    switch (this._numDragging--, e17 && this.undo(), null != this.tool.snappingManager && this.tool.snappingManager.doneSnapping(), this._resetTooltip(), this._reshapeEventState) {
      case Se.NONE:
        break;
      case Se.MOVING:
        this.events.emit("move", {
          type: "move",
          dx: 0,
          dy: 0,
          object: this.object
        });
        break;
      case Se.RESHAPING:
        this.events.emit("reshape", {
          type: "reshape",
          object: this.object
        });
    }
    t9 && t9(), this.destroyed || this._updateEventState(Se.NONE);
  }
  _setTypeSpecificManipulatorSettings(e17, t9, i13) {
    const a14 = this._settings;
    switch (t9.type) {
      case "vertex": {
        e17.state = Ie.Vertex, e17.selectable = true, e17.cursor = "move", e17.collisionPriority = 2;
        const {
          size: t10,
          collisionPadding: n11
        } = a14.manipulators.vertex;
        e17.radius = t10 / 2 + n11, e17.elevationInfo = i13;
        const o12 = this._operations?.data.type;
        e17.interactive = null != o12 && "point" !== o12 && "mesh" !== o12;
        break;
      }
      case "edge": {
        e17.state = Ie.Edge, e17.selectable = false, e17.cursor = "copy", e17.collisionPriority = -1;
        const {
          size: t10,
          collisionPadding: n11
        } = a14.manipulators.edge;
        e17.radius = t10 / 2 + n11, e17.elevationInfo = "on-the-ground" !== i13.mode || y3(this.object.graphic?.symbol) ? {
          mode: "absolute-height",
          offset: 0
        } : i13;
        break;
      }
    }
  }
  _watchAndUpdateGrabState(e17, t9) {
    return e17.events.on("grab-changed", (i13) => this._onGrabStateChanged(e17, t9, i13.action, i13.pointerType));
  }
  _onGrabStateChanged(e17, t9, i13, a14 = "mouse") {
    if (!this._recreatingManipulators) {
      if ("start" === i13) t9 && this._updateSelection(e17), this._numGrabbing++;
      else if (this._numGrabbing--, this._updateEventState(Se.NONE), this.destroyed) return;
      this._moveManipulation.interactive = !this._numGrabbing, ("touch" !== a14 || this.enableEdgeOffset) && (this._manipulatorInfos.forEach((e18) => {
        const {
          manipulator: t10
        } = e18, i14 = this._operations?.data.type;
        t10.interactive = t10.grabbing || !this._numGrabbing && null != i14 && "point" !== i14 && "mesh" !== i14, "edgeManipulator" in e18 && (e18.edgeManipulator.interactive = e18.edgeManipulator.grabbing || !this._numGrabbing);
      }), this._objectMoveManipulation.forEachManipulator((e18) => {
        e18.interactive = e18.grabbing || !this._numGrabbing;
      }));
    }
  }
  _clearSelection() {
    for (const e17 of this._manipulatorInfos) e17.manipulator.grabbing || (e17.manipulator.selected = false);
  }
  _updateSelection(e17) {
    e17.grabbing && !e17.selected && e17.selectable && (this._clearSelection(), e17.selected = true, this.events.emit("manipulators-changed"));
  }
  _removeManipulator(e17) {
    null != e17 && (e17.manipulator.metadata.deleting = true, this.manipulators.remove(e17.manipulator), this._manipulatorHandles.remove(e17.manipulator), S(this._manipulatorInfos, e17), this.events.emit("manipulators-changed"), this._resetTooltip());
  }
  _getManipulatorInfoFromHandle(e17) {
    if (e17) {
      for (const t9 of this._manipulatorInfos) if (e17 === t9.handle) return t9;
    }
    return null;
  }
  _updateManipulatorPositions(e17) {
    for (const t9 of e17) this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t9));
  }
  _updateManipulatorPosition(e17) {
    const t9 = this._operations;
    if (null != e17 && t9) {
      if ("vertex" === e17.type) e17.manipulator.location = t9.data.coordinateHelper.vectorToDehydratedPoint(e17.handle.pos, Oe), e17.manipulator.grabbing && null != this._vertexLaserLineVisualElement && (this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation = e17.manipulator.renderLocation);
      else if ("edge" === e17.type) {
        const i13 = this._getManipulatorInfoFromHandle(e17.handle.leftVertex), a14 = this._getManipulatorInfoFromHandle(e17.handle.rightVertex);
        if (null == i13 || null == a14) return;
        const n11 = i13.manipulator, o12 = a14.manipulator;
        if (null != e17.manipulator.elevationInfo && "on-the-ground" === e17.manipulator.elevationInfo.mode) {
          const i14 = n11.location, a15 = o12.location, s6 = 0.5, r14 = i14.x + s6 * (a15.x - i14.x), l17 = i14.y + s6 * (a15.y - i14.y), p12 = i14.hasZ && a15.hasZ ? 0 : void 0;
          e17.manipulator.location = e7(r14, l17, p12, t9.data.spatialReference);
        } else A3(Ee, n11.renderLocation, o12.renderLocation, 0.5), e17.manipulator.renderLocation = Ee;
      }
    }
  }
  _splitEdgeManipulator(e17, t9 = 0.5) {
    const i13 = this._operations, a14 = i13.splitEdge(e17.handle, t9).createdVertex;
    e17.locationUpdateHandle = l(e17.locationUpdateHandle);
    const n11 = this.object.elevationInfo;
    let o12;
    this.enableEdgeOffset ? (this._removeManipulator(e17), o12 = this._createVertexOrEdgeManipulator(a14)) : (o12 = e17, o12.handle = a14, o12.type = "vertex", this._setTypeSpecificManipulatorSettings(e17.manipulator, e17.handle, n11)), a14.leftEdge && this._createVertexOrEdgeManipulator(a14.leftEdge), a14.rightEdge && this._createVertexOrEdgeManipulator(a14.rightEdge), this._updateManipulatorPosition(o12), this.enableEdgeOffset || this._resetTooltip(), this._updateSelection(e17.manipulator);
    const s6 = this._updateEventState(Se.RESHAPING), r14 = i13.data.coordinateHelper.vectorToArray(o12.handle.pos), l17 = i13.data.components.indexOf(a14.component);
    return this.events.emit("vertex-add", {
      type: "vertex-add",
      object: this.object,
      vertices: [{
        coordinates: r14,
        componentIndex: l17,
        vertexIndex: a14.index
      }],
      added: r14
    }), s6 && this._updateEventState(Se.NONE), o12;
  }
  _updateMoveManipulationPosition() {
    const e17 = o3(Ee, 0, 0, 0);
    let t9 = 0, i13 = false, a14 = null, n11 = null;
    for (const r14 of this._manipulatorInfos) "vertex" === r14.type && (r14.manipulator.selected ? (t9++, u2(e17, e17, r14.manipulator.renderLocation), null == a14 || r14.selectedIndex > a14.selectedIndex ? (n11 = a14, a14 = r14) : (null == n11 || r14.selectedIndex > n11.selectedIndex) && (n11 = r14)) : i13 = true);
    const o12 = this.object, s6 = this._operations?.data.geometry;
    if (0 === t9) {
      const e18 = o12.visible && this.enableMoveObject;
      this._moveManipulation.xyManipulation.available = e18, this._moveManipulation.xyAxisManipulation.available = e18, this._moveManipulation.xyAxisManipulation.orthogonalAvailable = e18, this._moveManipulation.zManipulation.available = e18 && this.enableZShape && o8(this._operations, o12.elevationInfo), this._moveManipulation.angle = r11(s6), this._moveManipulation.radius = u11.radiusForSymbol(o12.graphic?.symbol);
    } else {
      const e18 = o12.visible;
      this._moveManipulation.xyManipulation.available = e18, this._moveManipulation.xyAxisManipulation.available = e18, this._moveManipulation.zManipulation.available = e18 && this.enableZVertex && o8(this._operations, this.object.elevationInfo), this._moveManipulation.xyAxisManipulation.orthogonalAvailable = e18 && 1 !== t9;
      let i14 = 0;
      if (null != a14) {
        const e19 = a14.handle.pos, t10 = null != n11 ? n11.handle.pos : a14.handle.leftEdge?.leftVertex ? a14.handle.leftEdge.leftVertex.pos : null, o13 = null == n11 && a14.handle.rightEdge?.rightVertex ? a14.handle.rightEdge.rightVertex.pos : null;
        t10 && o13 ? this._moveManipulation.xyAxisManipulation.available = false : t10 ? i14 = ye(t10, e19) : o13 && (i14 = ye(e19, o13));
      }
      this._moveManipulation.angle = i14, this._moveManipulation.radius = o9;
    }
    0 !== t9 && i13 ? (g(e17, e17, 1 / t9), Oe.spatialReference = this._operations.data.spatialReference, Oe.hasZ = true, this.view.renderCoordsHelper.fromRenderCoords(e17, Oe), this._moveManipulation.elevationAlignedLocation = Oe) : null == this._outlineVisualElement || this.object.isDraped || null == this._outlineVisualElement.attachmentOrigin ? F3(this._moveManipulation, this.object) : this._moveManipulation.elevationAlignedLocation = this._outlineVisualElement.attachmentOrigin;
  }
  _removeVertices(e17) {
    const t9 = new Array(), i13 = this._operations;
    if (i13) {
      for (const a14 of e17) {
        const e18 = a14.handle.component;
        if ("vertex" === a14.type && i13.canRemoveVertex(e18)) {
          t9.push(a14.handle), this._removeManipulator(a14), this._removeManipulator(this._getManipulatorInfoFromHandle(a14.handle.leftEdge)), this._removeManipulator(this._getManipulatorInfoFromHandle(a14.handle.rightEdge));
          const n11 = i13.removeVertices([a14.handle]), o12 = n11.removedVertices?.[0].createdEdge;
          o12 ? this._createVertexOrEdgeManipulator(o12) : this.enableEdgeOffset && e18.vertices.length <= 2 && this._removeManipulator(this._getManipulatorInfoFromHandle(e18.edges[0]));
        }
      }
      if (t9.length > 0) {
        const e18 = t9.map((e19) => {
          const t10 = i13.data.components.indexOf(e19.component);
          return {
            coordinates: i13.data.coordinateHelper.vectorToArray(e19.pos),
            componentIndex: t10,
            vertexIndex: e19.index
          };
        }), a14 = this._updateEventState(Se.RESHAPING);
        if (this.destroyed) return;
        if (this.events.emit("vertex-remove", {
          type: "vertex-remove",
          object: this.object,
          removed: e18.map((e19) => e19.coordinates),
          vertices: e18
        }), this.destroyed) return;
        if (a14 && (this._updateEventState(Se.NONE), this.destroyed)) return;
        this._updateMoveManipulationPosition();
      }
    }
  }
  _moveVertices(e17, t9, i13 = "start" === t9.action ? E3.NEW_STEP : E3.ACCUMULATE_STEPS) {
    const a14 = this._operations;
    if (a14) {
      e17.length > 0 && a14.moveVertices(e17.map((e18) => e18.handle), t9.mapDeltaX, t9.mapDeltaY, t9.mapDeltaZ, i13);
      for (const t10 of e17) this._updateManipulatorPosition(t10);
    }
  }
  _offsetEdge(e17, t9) {
    if (null == t9.operation || null == t9.signedDistance) return;
    const i13 = this._operations;
    if (!i13) return;
    const a14 = t9.operation.clone();
    a14.distance = t9.signedDistance, i13.updateVertices([e17.handle.leftVertex, e17.handle.rightVertex], a14), this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e17.handle.leftVertex)), this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e17.handle.rightVertex));
  }
  _manipulatorClickCallback(e17, t9) {
    e17.shiftKey || this._clearSelection(), "vertex" === t9.type && (t9.manipulator.selected = !t9.manipulator.selected, this.enableDeleteVertices && e17.button === t4.Right && this._removeVertices([t9])), "edge" === t9.type && e17.button === t4.Left && this._splitEdgeManipulator(t9), e17.stopPropagation();
  }
  _updateTranslateTooltip(e17, t9) {
    null != this._defaultTooltipInfo ? this._resetTooltip() : this._updateTranslateObjectTooltip(e17, t9);
  }
  _updateTranslateObjectTooltip(e17, t9) {
    this.activeTooltipInfo = Z3(e17, t9, this._tooltipsContext);
  }
  _updateEdgeOffsetTooltip(e17) {
    this.activeTooltipInfo = A9(this.object, e17, this._tooltipsContext);
  }
  _resetTooltip() {
    this.activeTooltipInfo = this._defaultTooltipInfo;
  }
  get _defaultTooltipInfo() {
    const e17 = this._operations?.data.type;
    switch (e17) {
      case "polyline":
      case "polygon":
        return this._selectedVertexManipulatorInfo ? this.tooltipInfos.selectedVertex : null;
      case "point":
      case "mesh":
        return this.tooltipInfos.movePoint;
      default:
        return null;
    }
  }
  get _selectedVertexManipulatorInfo() {
    const e17 = this._manipulatorInfos.filter((e18) => "vertex" === e18.type && e18.manipulator.selected);
    return 1 === e17.length ? e17[0] : null;
  }
  get _tooltipsContext() {
    const {
      events: e17
    } = this;
    return {
      sketchOptions: this._sketchOptions,
      tooltipInfos: this.tooltipInfos,
      activeTooltipInfo: this.activeTooltipInfo,
      selectedVertexManipulatorInfo: this._selectedVertexManipulatorInfo,
      callbacks: {
        onReshapeStart: () => e17.emit("reshape", {
          type: "reshape-start",
          object: this.object
        }),
        onReshape: () => e17.emit("reshape", {
          type: "reshape",
          object: this.object
        }),
        onReshapeStop: () => e17.emit("reshape", {
          type: "reshape-stop",
          object: this.object
        }),
        onMoveStart: () => e17.emit("move", {
          type: "move-start",
          object: this.object,
          dx: 0,
          dy: 0
        }),
        onMove: () => e17.emit("move", {
          type: "move",
          object: this.object,
          dx: 0,
          dy: 0
        }),
        onMoveStop: () => e17.emit("move", {
          type: "move-stop",
          object: this.object,
          dx: 0,
          dy: 0
        })
      }
    };
  }
  get test() {
  }
};
function be() {
  return (e17) => {
    const {
      operation: t9,
      mapEnd: i13
    } = e17;
    return null == t9 || null == i13 ? e17 : ("start" === e17.action && t9.selectArrowFromStartPoint(i13), __spreadProps(__spreadValues({}, e17), {
      signedDistance: t9.signedDistanceToPoint(i13)
    }));
  };
}
function xe(e17) {
  const t9 = e17.size / 2, i13 = t9 + e17.collisionPadding;
  return {
    size: t9 / i13,
    outlineSize: (t9 + e17.outlineSize) / i13
  };
}
function ye(e17, t9) {
  return Math.atan2(t9[1] - e17[1], t9[0] - e17[0]) + Math.PI / 2;
}
e2([y()], Me.prototype, "_numGrabbing", void 0), e2([y()], Me.prototype, "_numDragging", void 0), e2([y()], Me.prototype, "grabbingOrDragging", null), e2([y()], Me.prototype, "_operations", null), e2([y()], Me.prototype, "_segmentLabels", void 0), e2([y({
  constructOnly: true
})], Me.prototype, "tool", void 0), e2([y()], Me.prototype, "tooltip", void 0), e2([y()], Me.prototype, "activeTooltipInfo", void 0), e2([y({
  readOnly: true
})], Me.prototype, "updating", null), e2([y()], Me.prototype, "manipulators", null), e2([y()], Me.prototype, "view", null), e2([y()], Me.prototype, "object", null), e2([y()], Me.prototype, "enableZShape", null), e2([y()], Me.prototype, "enableDeleteVertices", null), e2([y()], Me.prototype, "enableZVertex", null), e2([y()], Me.prototype, "autoHideManipulators", null), e2([y()], Me.prototype, "enableMoveObject", null), e2([y()], Me.prototype, "enableMidpoints", null), e2([y()], Me.prototype, "enableEdgeOffset", null), e2([y()], Me.prototype, "_sketchOptions", null), e2([y()], Me.prototype, "_accentColor", null), e2([y()], Me.prototype, "_tooltipsContext", null), Me = e2([a("esri.views.3d.interactive.editingTools.reshape.ReshapeOperation")], Me);
var Oe = e7(0, 0, void 0, f.WGS84);
var Ee = n();
var je = 1e-6;
var Ie;
var Se;
var He;
!function(e17) {
  e17.Vertex = u6.Custom1, e17.Edge = u6.Custom2;
}(Ie || (Ie = {})), function(e17) {
  e17[e17.NONE = 0] = "NONE", e17[e17.MOVING = 1] = "MOVING", e17[e17.RESHAPING = 2] = "RESHAPING";
}(Se || (Se = {})), function(e17) {
  e17[e17.ALL = 0] = "ALL", e17[e17.SELECTED_OR_ALL = 1] = "SELECTED_OR_ALL";
}(He || (He = {}));

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/reshape/ReshapeTool3D.js
var l14 = class extends n4 {
  constructor(e17) {
    super(e17), this.events = new o2(), this.enableZShape = true, this.enableZVertex = true, this.enableMoveObject = true, this.enableDeleteVertices = true, this.autoHideManipulators = false, this.enableMidpoints = true, this.enableEdgeOffset = false, this.type = "reshape-3d", this.sketchOptions = new l9(), this.snappingManager = null, this.automaticManipulatorSelection = false;
  }
  initialize() {
    const e17 = this._reshapeOperation = new Me({
      tool: this
    });
    this.addHandles([e17.events.on("reshape", (e18) => this.events.emit("reshape", e18)), e17.events.on("move", (e18) => this.events.emit("move", e18)), e17.events.on("vertex-add", (e18) => this.events.emit("vertex-add", e18)), e17.events.on("vertex-remove", (e18) => this.events.emit("vertex-remove", e18)), e17.events.on("immediate-click", (e18) => this.events.emit("immediate-click", __spreadProps(__spreadValues({}, e18), {
      object: this.object
    }))), this.view.on("pointer-down", ["Shift"], (e18) => e18.stopPropagation())]), this.finishToolCreation();
  }
  destroy() {
    this._reshapeOperation = u(this._reshapeOperation);
  }
  get updating() {
    return ((this.object.updating ?? false) || this._reshapeOperation?.updating) ?? false;
  }
  get activeTooltipInfo() {
    return this._reshapeOperation?.activeTooltipInfo ?? null;
  }
  get tooltip() {
    return this._reshapeOperation?.tooltip ?? null;
  }
  onManipulatorSelectionChanged() {
    this._reshapeOperation && this._reshapeOperation.onManipulatorSelectionChanged();
  }
  get canUndo() {
    return this._reshapeOperation.canUndo ?? false;
  }
  undo() {
    null != this.snappingManager && this.snappingManager.doneSnapping(), this._reshapeOperation.undo();
  }
  get canRedo() {
    return this._reshapeOperation.canRedo ?? false;
  }
  redo() {
    null != this.snappingManager && this.snappingManager.doneSnapping(), this._reshapeOperation.redo();
  }
  onInputEvent(e17) {
    const t9 = this._reshapeOperation;
    if ((!t9 || t9.grabbingOrDragging || !G4(e17, t9.tooltip)) && this.enableDeleteVertices && "key-down" === e17.type && p5.delete.includes(e17.key)) {
      this._reshapeOperation.removeSelectedVertices() > 0 && e17.stopPropagation();
    }
  }
  reset() {
  }
  get test() {
  }
};
e2([y()], l14.prototype, "_reshapeOperation", void 0), e2([y()], l14.prototype, "view", void 0), e2([y({
  constructOnly: true
})], l14.prototype, "object", void 0), e2([y()], l14.prototype, "enableZShape", void 0), e2([y()], l14.prototype, "enableZVertex", void 0), e2([y()], l14.prototype, "enableMoveObject", void 0), e2([y()], l14.prototype, "enableDeleteVertices", void 0), e2([y()], l14.prototype, "autoHideManipulators", void 0), e2([y()], l14.prototype, "enableMidpoints", void 0), e2([y()], l14.prototype, "enableEdgeOffset", void 0), e2([y()], l14.prototype, "type", void 0), e2([y({
  type: l9
})], l14.prototype, "sketchOptions", void 0), e2([y()], l14.prototype, "snappingManager", void 0), e2([y()], l14.prototype, "updating", null), e2([y()], l14.prototype, "activeTooltipInfo", null), e2([y()], l14.prototype, "tooltip", null), e2([y()], l14.prototype, "automaticManipulatorSelection", void 0), l14 = e2([a("esri.views.3d.interactive.editingTools.reshape.ReshapeTool3D")], l14);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/ScaleRotateMeshAdapter.js
var p10 = class extends S2 {
  constructor(t9) {
    super(t9), this._interactionState = null;
  }
  initialize() {
    this.addHandles([p(() => {
      const t9 = this._interactionState;
      return t9 && t9.angle !== t9.previousAngle ? {
        interactionState: t9,
        angle: t9.state.angle
      } : null;
    }, ({
      interactionState: t9
    }) => {
      this._updateMeshRotation(t9);
    }, C), p(() => {
      const t9 = this._interactionState;
      return t9 && t9.scale !== t9.previousScale ? {
        interactionState: t9,
        scale: t9.state.scale
      } : null;
    }, ({
      interactionState: t9
    }) => {
      this._updateMeshSize(t9);
    }, C)]);
  }
  get initialAngle() {
    return this._interactionState?.initialAngle ?? 0;
  }
  get angle() {
    const t9 = this.geometry.transform;
    if (null == t9) return this._interactionState?.angle ?? 0;
    const e17 = y2(t9.rotation)[2];
    return Math.abs(e17) > 0.999999 ? h2(z3(t9.rotation)) * Math.sign(e17) : 0;
  }
  get angleClockwise() {
    return -this.angle;
  }
  get relativeAngle() {
    return this.angle - this.initialAngle;
  }
  get relativeAngleClockwise() {
    return -this.relativeAngle;
  }
  get scale() {
    return this._interactionState?.scale ?? 1;
  }
  startInteraction() {
    const t9 = new g6({
      angle: this.angle
    });
    this._interactionState = t9;
    const e17 = () => {
      this._interactionState = null;
    };
    return {
      state: t9,
      done: e17,
      cancel: () => {
        t9.cancel(), e17();
      }
    };
  }
  createUndoRecord() {
    return this.object.createUndoRecord();
  }
  _updateMeshRotation(t9) {
    const {
      angle: e17,
      previousAngle: o12
    } = t9;
    t9.previousAngle = e17;
    const r14 = M(e17 - o12);
    this.geometry.rotate(0, 0, r14, {
      origin: this.geometry.anchor
    });
  }
  _updateMeshSize(t9) {
    const {
      scale: e17,
      previousScale: o12
    } = t9;
    t9.previousScale = e17;
    const i13 = e17 / o12, r14 = this.geometry.anchor;
    this.geometry.scale(i13, {
      origin: r14
    });
  }
};
e2([y({
  constructOnly: true
})], p10.prototype, "object", void 0), e2([y({
  constructOnly: true
})], p10.prototype, "geometry", void 0), e2([y({
  constructOnly: true
})], p10.prototype, "viewingMode", void 0), e2([y()], p10.prototype, "initialAngle", null), e2([y()], p10.prototype, "angle", null), e2([y()], p10.prototype, "angleClockwise", null), e2([y()], p10.prototype, "relativeAngle", null), e2([y()], p10.prototype, "relativeAngleClockwise", null), e2([y()], p10.prototype, "scale", null), e2([y()], p10.prototype, "_interactionState", void 0), p10 = e2([a("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter")], p10);
var g6 = class extends S2 {
  get state() {
    const {
      angle: t9,
      scale: e17
    } = this;
    return {
      angle: t9,
      scale: e17
    };
  }
  constructor(t9) {
    super(t9), this.angle = 0, this.initialAngle = 0, this.previousAngle = 0, this.previousScale = 1, this.scale = 1, this.initialAngle = t9.angle, this.previousAngle = t9.angle;
  }
  cancel() {
    this.angle = this.initialAngle, this.scale = 1;
  }
};
e2([y()], g6.prototype, "angle", void 0), e2([y()], g6.prototype, "initialAngle", void 0), e2([y()], g6.prototype, "previousAngle", void 0), e2([y()], g6.prototype, "previousScale", void 0), e2([y()], g6.prototype, "scale", void 0), e2([y()], g6.prototype, "state", null), g6 = e2([a("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter.InteractionState")], g6);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/ScaleRotateObjectSymbol3DAdapter.js
var a12 = class extends S2 {
  constructor(t9) {
    super(t9), this.sizeAxis = null, this._interactionState = null;
  }
  initialize() {
    this.addHandles(p(() => null != this._interactionState ? this._interactionState.state : null, (t9) => {
      this._updateSymbol(t9);
    }, C));
  }
  get initialAngle() {
    return this._interactionState?.initialAngle ?? 0;
  }
  get angle() {
    return null != this._interactionState ? this._interactionState.angle : null != this._orientationReferenceSymbolLayer ? c9(this._orientationReferenceSymbolLayer.heading ?? 0) : 0;
  }
  get angleClockwise() {
    return -this.angle;
  }
  get orientation() {
    return this.angle;
  }
  get orientationClockwise() {
    return this.angleClockwise;
  }
  get relativeAngle() {
    return this.angle - this.initialAngle;
  }
  get relativeAngleClockwise() {
    return -this.relativeAngle;
  }
  get scale() {
    return this._interactionState?.scale ?? 1;
  }
  get size() {
    const t9 = this._sizeReferenceSymbolLayer;
    if (null == t9) return null;
    const e17 = this.findLayerView(), i13 = this._graphicSymbol;
    if (null == e17 || null == i13 || "point-3d" !== i13.type) return null;
    const l17 = e17.getSymbolLayerSize(i13, t9);
    if ("size" in l17 && null != l17.size) return l17.size;
    const n11 = this.sizeAxis;
    return !("width" in l17) || null == l17.width || null != n11 && "width" !== n11 && "all" !== n11 && "width-and-depth" !== n11 ? !("depth" in l17) || null == t9.depth || null != n11 && "depth" !== n11 && "all" !== n11 && "width-and-depth" !== n11 ? !("height" in l17) || null == t9.height || null != n11 && "height" !== n11 && "all" !== n11 ? null : l17.height : l17.depth : l17.width;
  }
  get _sizeReferenceSymbolLayer() {
    const t9 = this._graphicSymbol;
    return null == t9 || 0 === t9.symbolLayers.length ? null : t9.symbolLayers.find((t10) => "object" === t10.type);
  }
  get _orientationReferenceSymbolLayer() {
    const t9 = this._graphicSymbol;
    return null == t9 || 0 === t9.symbolLayers.length ? null : t9.symbolLayers.find((t10) => "object" === t10.type && null != t10.heading);
  }
  get _graphicSymbol() {
    return null != this.graphic?.symbol && "point-3d" === this.graphic.symbol.type ? this.graphic.symbol : null;
  }
  set _graphicSymbol(t9) {
    this.graphic.symbol = t9;
  }
  startInteraction() {
    const t9 = this._graphicSymbol, e17 = this.findLayerView();
    if (null != this._interactionState || null == t9 || null == e17) return h10;
    const i13 = t9.symbolLayers.map((i14) => "object" === i14.type ? e17.getSymbolLayerSize(t9, i14) : null).toArray(), l17 = t9.clone(), n11 = this.angle, o12 = new p11({
      originalSymbol: l17,
      angle: n11,
      initialSizes: i13
    });
    this._interactionState = o12;
    const r14 = () => {
      this._interactionState = null;
    };
    return {
      state: o12,
      done: r14,
      cancel: () => {
        this._graphicSymbol = l17, r14();
      }
    };
  }
  createUndoRecord() {
    let t9 = this.graphic.symbol, e17 = null;
    return {
      undo: (i13) => {
        e17 = i13.symbol, i13.symbol = t9;
      },
      redo: (i13) => {
        t9 = i13.symbol, i13.symbol = e17;
      }
    };
  }
  _updateSymbol({
    scale: t9,
    angle: e17,
    originalSymbol: l17,
    initialSizes: n11
  }) {
    const o12 = this._graphicSymbol;
    if (null == o12 || "point-3d" !== o12.type) return;
    const r14 = o12.clone(), s6 = -M(e17 - this.initialAngle);
    let a14 = false;
    this._forEachObjectSymbolLayerPair(l17, r14, (e18, i13, l18) => {
      const o13 = (e18.heading ?? 0) + s6;
      i13.heading !== o13 && (i13.heading = o13, a14 = true);
      const r15 = n11[l18];
      if (null != r15 && "width" in r15) {
        r15.width = this.sizeFilter(r15.width), r15.height = this.sizeFilter(r15.height), r15.depth = this.sizeFilter(r15.depth);
        const e19 = r15.width * t9;
        i13.width !== e19 && (i13.width = e19, a14 = true);
        const l19 = r15.depth * t9;
        i13.depth !== l19 && (i13.depth = l19, a14 = true);
        const n12 = r15.height * t9;
        i13.height !== n12 && (i13.height = n12, a14 = true);
      }
    }), a14 && (this._graphicSymbol = r14);
  }
  _forEachObjectSymbolLayerPair(t9, e17, i13) {
    t9.symbolLayers.forEach((t10, l17) => {
      const n11 = e17.symbolLayers.at(l17);
      "object" === t10.type && "object" === n11.type && i13(t10, n11, l17);
    });
  }
};
function c9(t9) {
  return -h2(t9);
}
e2([y()], a12.prototype, "initialAngle", null), e2([y()], a12.prototype, "angle", null), e2([y()], a12.prototype, "angleClockwise", null), e2([y()], a12.prototype, "orientation", null), e2([y()], a12.prototype, "orientationClockwise", null), e2([y()], a12.prototype, "relativeAngle", null), e2([y()], a12.prototype, "relativeAngleClockwise", null), e2([y()], a12.prototype, "scale", null), e2([y()], a12.prototype, "size", null), e2([y()], a12.prototype, "sizeAxis", void 0), e2([y({
  constructOnly: true
})], a12.prototype, "graphic", void 0), e2([y()], a12.prototype, "_interactionState", void 0), e2([y({
  constructOnly: true
})], a12.prototype, "findLayerView", void 0), e2([y({
  constructOnly: true
})], a12.prototype, "sizeFilter", void 0), e2([y()], a12.prototype, "_sizeReferenceSymbolLayer", null), e2([y()], a12.prototype, "_orientationReferenceSymbolLayer", null), e2([y()], a12.prototype, "_graphicSymbol", null), a12 = e2([a("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter")], a12);
var h10 = {
  state: {
    angle: 0,
    scale: 0
  },
  done: () => {
  },
  cancel: () => {
  }
};
var p11 = class extends S2 {
  get state() {
    const {
      originalSymbol: t9,
      angle: e17,
      initialAngle: i13,
      scale: l17,
      initialSizes: n11
    } = this;
    return {
      originalSymbol: t9,
      angle: e17,
      initialAngle: i13,
      scale: l17,
      initialSizes: n11
    };
  }
  constructor(t9) {
    super(t9), this.angle = 0, this.initialAngle = 0, this.scale = 1, this.initialAngle = t9.angle;
  }
};
e2([y()], p11.prototype, "originalSymbol", void 0), e2([y()], p11.prototype, "angle", void 0), e2([y()], p11.prototype, "initialAngle", void 0), e2([y()], p11.prototype, "initialSizes", void 0), e2([y()], p11.prototype, "scale", void 0), e2([y()], p11.prototype, "state", null), p11 = e2([a("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter.InteractionState")], p11);

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TransformAbsoluteTooltipInfo.js
var e14 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "transform-absolute", this.orientation = null, this.orientationPrecision = null, this.rotationType = "geographic", this.size = null, this.sizePrecision = null, this.sizeUnit = null;
  }
};
e2([y()], e14.prototype, "type", void 0), e2([y()], e14.prototype, "orientation", void 0), e2([y()], e14.prototype, "orientationPrecision", void 0), e2([y()], e14.prototype, "rotationType", void 0), e2([y()], e14.prototype, "size", void 0), e2([y()], e14.prototype, "sizePrecision", void 0), e2([y()], e14.prototype, "sizeUnit", void 0), e14 = e2([a("esri.views.interactive.tooltip.infos.TransformAbsoluteTooltipInfo")], e14);

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TransformRotateTooltipInfo.js
var e15 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "transform-rotate", this.rotation = null, this.rotationPrecision = null, this.orientation = null, this.orientationPrecision = null, this.rotationType = "geographic";
  }
};
e2([y()], e15.prototype, "type", void 0), e2([y()], e15.prototype, "rotation", void 0), e2([y()], e15.prototype, "rotationPrecision", void 0), e2([y()], e15.prototype, "orientation", void 0), e2([y()], e15.prototype, "orientationPrecision", void 0), e2([y()], e15.prototype, "rotationType", void 0), e15 = e2([a("esri.views.interactive.tooltip.infos.TransformRotateTooltipInfo")], e15);

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TransformScaleTooltipInfo.js
var e16 = class extends r8 {
  constructor(o12) {
    super(o12), this.type = "transform-scale", this.size = null, this.sizeUnit = null, this.sizePrecision = null;
  }
};
e2([y()], e16.prototype, "type", void 0), e2([y()], e16.prototype, "scale", void 0), e2([y()], e16.prototype, "size", void 0), e2([y()], e16.prototype, "sizeUnit", void 0), e2([y()], e16.prototype, "sizePrecision", void 0), e16 = e2([a("esri.views.interactive.tooltip.infos.TransformScaleTooltipInfo")], e16);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/ScaleRotateTransform.js
var Mt;
!function(t9) {
  t9.ScaleIn = u6.Custom2, t9.ScaleOut = u6.Custom3, t9.RotateLeft = u6.Custom4, t9.RotateRight = u6.Custom5, t9.Unlocked = u6.Custom7, t9.DelayedFocused = u6.Custom8, t9.TouchInput = u6.Custom12;
}(Mt || (Mt = {}));
var yt = class extends S2 {
  get angle() {
    return this.adapter.angle;
  }
  get scale() {
    return this.adapter.scale;
  }
  set location(t9) {
    this._ringManipulator.location = t9;
  }
  set elevationAlignedLocation(t9) {
    this._ringManipulator.elevationAlignedLocation = t9;
  }
  get grabbing() {
    return this._ringManipulator.grabbing;
  }
  set interactive(t9) {
    this._ringManipulator.interactive = t9;
  }
  get updating() {
    return !!this._activeAnimation;
  }
  get tooltipEffectiveEnabled() {
    return this.sketchOptions.tooltips.effectiveEnabled && this.tooltipEnabled;
  }
  constructor(t9) {
    super(t9), this.mode = null, this.tooltipEnabled = true, this._scaleRotateDragData = null, this._activeAnimation = null, this._ringIndicatorDelayMs = q3, this._absoluteTooltipInfo = null, this._scaleTooltipInfo = null, this._rotateTooltipInfo = null, this.events = new o2(), this.getFocused = () => this._ringManipulator.focused, this.getScale = () => "scale" === this._scaleRotateDragData?.mode ? this.adapter.scale : 1;
  }
  initialize() {
    this.tooltip = new h9({
      view: this.tool.view
    }), this._createManipulator(), this._updateDragState(), this._updateManipulatorTransform(), this.addHandles([p(() => !this.tooltipEffectiveEnabled, () => this.tooltip.clear(), P), d2(() => {
      const {
        adapter: t9
      } = this, {
        info: e17
      } = this.tooltip;
      return e17 === this._absoluteTooltipInfo && this.getFocused() ? [e17, t9.size, t9.orientationClockwise] : [null];
    }, ([t9]) => {
      t9 && this._updateFocusTooltip();
    }), d2(() => {
      const {
        adapter: t9
      } = this;
      return [t9.angle, t9.scale];
    }, () => this._updateManipulatorTransform())]);
  }
  destroy() {
    this._activeAnimation?.frameTask.remove(), this._activeAnimation = null, this.tool.manipulators.remove(this._ringManipulator), this._ringManipulator = null, this.tooltip = u(this.tooltip);
  }
  startAnimation(t9) {
    this.cancelActiveAnimation(), t9.start();
    const e17 = A({
      update: ({
        deltaTime: e18
      }) => {
        t9.update(e18) && this.cancelActiveAnimation();
      }
    });
    this._activeAnimation = __spreadProps(__spreadValues({}, t9), {
      frameTask: e17
    });
  }
  cancelActiveAnimation() {
    this._activeAnimation?.frameTask.remove(), this._activeAnimation = u(this._activeAnimation);
  }
  forEachManipulator(t9) {
    t9(this._ringManipulator, A5.SCALE_ROTATE);
  }
  _createManipulator() {
    const t9 = this._createRingManipulator();
    this._ringManipulator = t9, this.tool.manipulators.add(t9);
    const e17 = this.tool.object, a14 = p4(t9, (t10, a15, i13) => {
      this._scaleRotateDragData = null;
      const r14 = this.adapter.startInteraction(), l17 = {
        mode: "none",
        origin: t2(t10.renderLocation),
        initialAngle: this.adapter.angle,
        angle: 0,
        angleDir: 0,
        scaleDir: 0
      };
      this._scaleRotateDragData = l17, this._updateDragState();
      const c10 = c3.get();
      this.tool.view.renderCoordsHelper.worldUpAtPosition(t10.renderLocation, c10), a15.next(O2(this.tool.view, j(t10.renderLocation, c10, E2()))).next((t11) => {
        const a16 = F2(t11.plane), i14 = w2(t11.renderStart, t11.renderEnd, l17.origin, a16), c11 = s3.shortestSignedDiff(l17.angle, i14);
        l17.angleDir = e5(l17.angleDir + c11, -m5, m5), l17.angle = i14;
        const p12 = Tt(l17, t11), h11 = p12 - this.adapter.scale;
        if (l17.scaleDir = e5(l17.scaleDir + h11, -k2, k2), this._onScaleChanged(), "none" === l17.mode) {
          const a17 = this.mode || jt(t11, t11.plane, l17.origin, this.tool.view.state.camera);
          if (null != a17) {
            switch (a17) {
              case "rotate":
                this.tool.events.emit("rotate-start", {
                  object: e17,
                  angle: 0
                }), this.tool.events.emit("record-undo", {
                  updates: [this.adapter.createUndoRecord()]
                });
                break;
              case "scale":
                this.tool.events.emit("scale-start", {
                  object: e17,
                  xScale: 1,
                  yScale: 1
                }), this.tool.events.emit("record-undo", {
                  updates: [this.adapter.createUndoRecord()]
                });
            }
            l17.mode = a17;
          }
        }
        switch (l17.mode) {
          case "rotate":
            r14.state.angle = l17.initialAngle + i14;
            break;
          case "scale":
            r14.state.scale = p12, this._onScaleChanged();
        }
        switch (this._updateDragState(), this._updateManipulatorTransform(), t11.action) {
          case "start":
          case "update":
            switch (l17.mode) {
              case "rotate":
                this.tool.events.emit("rotate", {
                  object: e17,
                  angle: M(l17.angle)
                });
                break;
              case "scale":
                this.tool.events.emit("scale", {
                  object: e17,
                  xScale: p12,
                  yScale: p12
                });
            }
            break;
          case "end":
            switch (l17.mode) {
              case "rotate":
                this.tool.events.emit("rotate-stop", {
                  object: e17,
                  angle: M(l17.angle)
                });
                break;
              case "scale":
                this.tool.events.emit("scale-stop", {
                  object: e17,
                  xScale: p12,
                  yScale: p12
                });
            }
        }
        return "end" === t11.action && (this.startAnimation(It(this, () => this._onScaleChanged())), this._scaleRotateDragData = null, this._updateDragState(), r14.done()), t11;
      }).next(this._updateTooltipPipelineStep(l17)), i13.next(() => {
        if (r14.cancel(), null != this._scaleRotateDragData) {
          switch (this._scaleRotateDragData.mode) {
            case "none":
              break;
            case "rotate":
              this.tool.events.emit("rotate-stop", {
                object: e17,
                angle: 0
              });
              break;
            case "scale":
              this.tool.events.emit("scale-stop", {
                object: e17,
                xScale: 1,
                yScale: 1
              });
          }
          this.startAnimation(It(this, () => this._onScaleChanged())), this._scaleRotateDragData = null, this._updateDragState();
        }
        this._updateFocusTooltip();
      });
    });
    this.addHandles([a14, t9.events.on("focus-changed", (t10) => {
      "focus" === t10.action ? this.startAnimation(kt(this, () => this._updateDelayedFocusedState(), {
        delayMs: this._ringIndicatorDelayMs
      })) : this._updateDelayedFocusedState();
    }), t9.events.on("immediate-click", (t10) => {
      t10.stopPropagation();
    }), d2(() => this.tool.object.visible, (t10) => this._ringManipulator.available = t10, P)]);
  }
  _updateTooltipPipelineStep(t9) {
    return (e17) => {
      const {
        sketchOptions: a14
      } = this, {
        visualVariables: o12
      } = a14.tooltips;
      if (!this.tooltipEffectiveEnabled) return e17;
      if ("end" === e17.action) return this._updateFocusTooltip(), e17;
      const {
        tooltip: i13
      } = this;
      switch (t9.mode) {
        case "scale": {
          i13.info = this._scaleTooltipInfo ??= new e16({
            sketchOptions: a14
          });
          const {
            size: t10,
            scale: e18
          } = this.adapter, s6 = o12?.size, n11 = i13.info;
          n11.sketchOptions = a14, n11.scale = i4(e18), n11.size = null != t10 ? a5(t10, "meters") : void 0, n11.sizePrecision = Et(s6?.valueType), n11.sizeUnit = s6?.unit;
          break;
        }
        case "rotate": {
          i13.info = this._rotateTooltipInfo ??= new e15({
            sketchOptions: a14
          });
          const {
            orientationClockwise: t10,
            relativeAngleClockwise: e18
          } = this.adapter, s6 = o12?.rotation, n11 = Et(s6?.valueType), r14 = i13.info;
          r14.sketchOptions = a14, r14.rotation = null != e18 ? o6(e18, "radians", "geographic") : void 0, r14.rotationPrecision = n11, r14.rotationType = s6?.rotationType ?? "geographic", r14.orientation = null != t10 ? o6(t10, "radians", "geographic") : void 0, r14.orientationPrecision = n11;
          break;
        }
      }
      return e17;
    };
  }
  _updateFocusTooltip() {
    const {
      sketchOptions: t9,
      tooltip: e17
    } = this, {
      visualVariables: a14
    } = t9.tooltips;
    if (!this.tooltipEffectiveEnabled) return;
    if (this.getFocused()) {
      const o12 = a14?.rotation, i13 = a14?.size, s6 = this.mode, {
        size: n11,
        orientationClockwise: r14
      } = this.adapter, c10 = null != r14 && (null == s6 || "rotate" === s6), h11 = null != n11 && (null == s6 || "scale" === s6);
      e17.info = this._absoluteTooltipInfo ??= new e14({
        sketchOptions: t9
      });
      const u14 = e17.info;
      u14.sketchOptions = t9, u14.orientation = c10 ? o6(r14, "radians", "geographic") : void 0, u14.orientationPrecision = Et(o12?.valueType), u14.rotationType = o12?.rotationType ?? "geographic", u14.size = h11 ? a5(n11, "meters") : void 0, u14.sizeUnit = i13?.unit, u14.sizePrecision = Et(i13?.valueType);
    } else e17.clear();
  }
  _onScaleChanged() {
    this.events.emit("scale-changed"), this._updateManipulatorTransform();
  }
  _updateDelayedFocusedState() {
    this._ringManipulator.updateStateEnabled(Mt.DelayedFocused, this.getFocused()), this._updateFocusTooltip();
  }
  _updateDragState() {
    if (this._ringManipulator.updateStateEnabled(Mt.Unlocked, !(null != this._scaleRotateDragData && "none" !== this._scaleRotateDragData?.mode)), null != this._scaleRotateDragData) switch (this._scaleRotateDragData.mode) {
      case "rotate":
        this._ringManipulator.updateStateEnabled(Mt.ScaleIn | Mt.ScaleOut, false), this._ringManipulator.updateStateEnabled(Mt.RotateLeft, this._scaleRotateDragData.angleDir < 0), this._ringManipulator.updateStateEnabled(Mt.RotateRight, this._scaleRotateDragData.angleDir >= 0);
        break;
      case "scale":
        this._ringManipulator.updateStateEnabled(Mt.RotateLeft | Mt.RotateRight, false), this._ringManipulator.updateStateEnabled(Mt.ScaleIn, this._scaleRotateDragData.scaleDir < 0), this._ringManipulator.updateStateEnabled(Mt.ScaleOut, this._scaleRotateDragData.scaleDir >= 0);
    }
    else this._ringManipulator.updateStateEnabled(Mt.ScaleIn | Mt.ScaleOut | Mt.RotateLeft | Mt.RotateRight, false);
  }
  _updateManipulatorTransform() {
    const t9 = p3(f3.get(), this.adapter.angle, r3(0, 0, 1));
    if (null == t9) return;
    const e17 = this.getScale(), a14 = d3(f3.get(), o3(c3.get(), e17, e17, e17));
    this._ringManipulator.modelTransform = c(f3.get(), a14, t9);
  }
  _createRingManipulator() {
    const t9 = (t10, e18, a15) => {
      const o13 = [], i14 = Math.ceil(t7 * (e18 - t10) / (2 * Math.PI));
      for (let s7 = 0; s7 < i14 + 1; s7++) {
        const n12 = t10 + s7 * (e18 - t10) / i14;
        o13.push(r3(a15 * Math.cos(n12), a15 * Math.sin(n12), 0));
      }
      return o13;
    }, e17 = (e18) => t9(0, 2 * Math.PI, e18), a14 = (t10) => [[-t10 / 2, 0], [t10 / 2, 0], [t10 / 2, P5 / 2], [-t10 / 2, P5 / 2]], o12 = this._createMaterial(1), i13 = (t10, e18, i14 = o12) => it(i14, a14(e18), t10, [], [], false), s6 = e17(I), n11 = i13(s6, i5), r14 = {
      left: new Array(),
      right: new Array()
    }, l17 = [];
    for (let w6 = 0; w6 < 2; w6++) {
      const e18 = w6 * Math.PI - Math.PI / 4, a15 = Math.PI / 2 - x9, s7 = e18 + a15, n12 = e18 + Math.PI / 2 - a15, c11 = t9(s7, n12, n5), p13 = i13(c11, l11);
      l17.push(c11), l17.push(t9(s7, n12, p6 - i5 / 2)), r14.left.push(p13), r14.right.push(p13.instantiate());
      for (let t10 = 0; t10 < 2; t10++) {
        const e19 = 0 === t10, a16 = e6();
        if (e19) {
          f2(a16, a16, [1, -1, 1]), b(a16, a16, -s7, [0, 0, 1]);
          const t11 = Math.round(f7 * (c11.length - 1));
          a16[12] = c11[t11][0], a16[13] = c11[t11][1], a16[14] = c11[t11][2];
        } else {
          b(a16, a16, n12, [0, 0, 1]);
          const t11 = Math.round((1 - f7) * (c11.length - 1));
          a16[12] = c11[t11][0], a16[13] = c11[t11][1], a16[14] = c11[t11][2];
        }
        const i14 = wt(o12, r9, 0, s4, P5);
        mt(i14, a16), (e19 ? r14.left : r14.right).push(i14);
      }
    }
    const c10 = [];
    for (let S11 = 0; S11 < 2; S11++) {
      const e18 = S11 * Math.PI - Math.PI / 4, a15 = Math.PI / 2 - b3, o13 = e18 + a15, s7 = e18 + Math.PI / 2 - a15, n12 = t9(o13, s7, p6);
      c10.push(i13(n12, l11));
    }
    const p12 = this._createMaterial(0.66), h11 = this._createMaterial(0.5), u14 = this._createMaterial(0.33), d9 = e17(I + g3), m8 = e17(I + j5), g7 = i13(d9, l11, p12), f9 = i13(m8, l11, u14), _4 = e17(I - g3), v8 = e17(I - j5), b5 = i13(_4, l11, p12), D7 = i13(v8, l11, u14);
    let T5 = [new e10(n11, Mt.DelayedFocused), new e10(n11.instantiate({
      material: h11
    }), t5.None)];
    this.mode && "scale" !== this.mode || (T5 = T5.concat([...c10.map((t10) => new e10(t10, Mt.DelayedFocused | Mt.Unlocked)), new e10(g7, Mt.DelayedFocused | Mt.ScaleIn), new e10(f9, Mt.DelayedFocused | Mt.ScaleIn), new e10(b5, Mt.DelayedFocused | Mt.ScaleOut), new e10(D7, Mt.DelayedFocused | Mt.ScaleOut)])), this.mode && "rotate" !== this.mode || (T5 = T5.concat([...r14.right.map((t10) => new e10(t10.instantiate(), Mt.DelayedFocused | Mt.Unlocked)), ...r14.left.map((t10) => new e10(t10, Mt.DelayedFocused | Mt.RotateLeft)), ...r14.right.map((t10) => new e10(t10, Mt.DelayedFocused | Mt.RotateRight))]));
    const j8 = [s6, ...l17];
    return new ee({
      view: this.tool.view,
      renderObjects: T5,
      autoScaleRenderObjects: false,
      worldOriented: true,
      radius: i5,
      focusMultiplier: 1,
      touchMultiplier: 1.5,
      elevationInfo: this.tool.object.elevationInfo,
      collisionType: {
        type: "ribbon",
        paths: j8,
        direction: r3(0, 0, 1)
      }
    });
  }
  _createMaterial(t9) {
    const e17 = new d5({
      cullFace: e8.Back,
      renderOccluded: h5.Transparent,
      isDecoration: true
    });
    return this.addHandles(d2(() => ({
      color: F(this.tool.view.effectiveTheme.accentColor, t9)
    }), (t10) => e17.setParameters(t10), P)), e17;
  }
  get test() {
  }
};
function Tt(t9, e17) {
  const a14 = e4(c3.get(), e17.renderStart, t9.origin), o12 = e4(c3.get(), e17.renderEnd, t9.origin), i13 = s2(a14), s6 = s2(o12);
  return 0 === i13 ? 0 : s6 / i13;
}
function jt(t9, e17, a14, o12) {
  const {
    renderStart: i13,
    renderEnd: s6
  } = t9, n11 = wt2(i13, o12, c3.get()), r14 = wt2(s6, o12, c3.get());
  if (p2(n11, r14) < d7 * d7) return null;
  const l17 = e4(c3.get(), i13, a14), c10 = _2(c3.get(), l17, F2(e17)), p12 = i13, h11 = u2(c3.get(), p12, c10), u14 = wt2(a14, o12, c3.get()), d9 = n11, m8 = wt2(h11, o12, c3.get()), g7 = e4(c3.get(), m8, d9), f9 = e4(c3.get(), n11, u14), _4 = l4(d9, g7), v8 = l4(u14, f9);
  return x3(_4, r14) < x3(v8, r14) ? "rotate" : "scale";
}
function wt2(t9, e17, a14) {
  return e17.projectToScreen(t9, Ot), o3(a14, Ot[0], Ot[1], 0);
}
var Rt;
function It(t9, e17) {
  let a14 = null, o12 = 1;
  const i13 = () => o12;
  return {
    start: () => {
      o12 = t9.getScale(), a14 = t9.getScale, t9.getScale = i13, e17();
    },
    update: (t10) => (o12 += ((o12 + 1) / 2 - o12) * Math.min(t10 * u10, 1), e17(), Math.abs(o12 - 1) < 0.01 ? Rt.STOP : Rt.CONTINUE),
    destroy: () => {
      a14 && (t9.getScale = a14), e17();
    }
  };
}
function kt(t9, e17, a14) {
  let o12 = 0, i13 = null;
  const s6 = () => false;
  return {
    start: () => {
      i13 = t9.getFocused, t9.getFocused = s6, o12 = 0, e17();
    },
    update: (t10) => (o12 += t10, !i13?.() || o12 >= a14.delayMs ? Rt.STOP : Rt.CONTINUE),
    destroy: () => {
      i13 && (t9.getFocused = i13), e17();
    }
  };
}
function Et(t9) {
  switch (t9) {
    case "integer":
    case "long":
      return 0;
    default:
      return null;
  }
}
e2([y({
  constructOnly: true
})], yt.prototype, "tool", void 0), e2([y({
  constructOnly: true
})], yt.prototype, "adapter", void 0), e2([y({
  constructOnly: true
})], yt.prototype, "sketchOptions", void 0), e2([y()], yt.prototype, "mode", void 0), e2([y()], yt.prototype, "tooltipEnabled", void 0), e2([y()], yt.prototype, "_activeAnimation", void 0), e2([y()], yt.prototype, "updating", null), e2([y()], yt.prototype, "tooltipEffectiveEnabled", null), yt = e2([a("esri.views.3d.interactive.editingTools.transform.ScaleRotateTransform")], yt), function(t9) {
  t9[t9.CONTINUE = 0] = "CONTINUE", t9[t9.STOP = 1] = "STOP";
}(Rt || (Rt = {}));
var Ot = i3();

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TransformMeshTooltipInfo.js
var r12 = class extends h8(r8) {
  constructor(t9) {
    super(t9), this.type = "transform-mesh", this.orientation = x8({
      actual: null,
      lockable: false
    }), this.scale = F4({
      actual: null,
      lockable: false
    }), this.allFields.forEach((t10) => {
      t10.lockable = false, t10.setActual(null);
    });
  }
  get key() {
    return {
      longitude: this.longitude.actual,
      latitude: this.latitude.actual,
      x: this.x.actual,
      y: this.y.actual,
      elevation: this.elevation.actual,
      geographic: this.geographic,
      orientation: this.orientation.actual,
      scale: this.scale.actual
    };
  }
  get allFields() {
    return [this.longitude, this.latitude, this.x, this.y, this.elevation, this.orientation, this.scale];
  }
};
e2([y()], r12.prototype, "key", null), e2([y()], r12.prototype, "allFields", null), r12 = e2([a("esri.views.interactive.tooltip.infos.TransformMeshTooltipInfo")], r12);

// ../../../node_modules/@arcgis/core/views/interactive/tooltip/infos/TransformPointTooltipInfo.js
var i11 = class extends h8(r8) {
  constructor(o12) {
    super(o12), this.type = "transform-point", this.allFields.forEach((o13) => {
      o13.lockable = false, o13.setActual(null);
    });
  }
  get allFields() {
    return [this.longitude, this.latitude, this.x, this.y, this.elevation];
  }
};
e2([y()], i11.prototype, "allFields", null), i11 = e2([a("esri.views.interactive.tooltip.infos.TransformPointTooltipInfo")], i11);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/TransformTool3D.js
var z7 = class extends n4 {
  constructor(t9) {
    super(t9), this.events = new o2(), this.enableZ = true, this.enableRotation = true, this.enableScaling = true, this.sketchOptions = new l9(), this.type = "transform-3d", this._updatingHandles = new h4(), this._scaleRotate = null;
  }
  initialize() {
    const {
      events: t9,
      object: o12,
      view: a14
    } = this;
    this.tooltip = new h9({
      view: a14
    }), this._moveManipulation = new u11({
      tool: this,
      view: a14,
      snapToScene: this.snapToScene,
      xyAvailable: true,
      xyAxisAvailable: true,
      zAvailable: this.enableZ && o8(o12.operations, o12.elevationInfo),
      radius: u11.radiusForSymbol(o12.graphic?.symbol)
    }), this._moveManipulation.forEachManipulator((e17) => this.addHandles(e17.events.on("immediate-click", (e18) => {
      t9.emit("immediate-click", __spreadProps(__spreadValues({}, e18), {
        object: this.object
      })), e18.stopPropagation();
    })));
    const s6 = o12.elevationInfo;
    if (this._moveManipulation.elevationInfo = s6, this.addHandles(a10(o12)), this._moveManipulation.createManipulatedObjectDragPipeline((t10, e17, i13, n11, r15) => {
      if (t10 === c7.XY) {
        const {
          snappingStep: t11,
          cancelSnapping: e18
        } = f6({
          snappingContext: new e12({
            elevationInfo: s6,
            pointer: r15,
            editGeometryOperations: E4.fromGeometry(new _({
              spatialReference: o12.operations?.data.spatialReference
            }), a14.state.viewingMode),
            visualizer: new R4(),
            excludeFeature: o12.graphic
          }),
          snappingManager: this.snappingManager,
          updatingHandles: this._updatingHandles,
          useZ: false
        });
        n11 = n11.next(e18), i13 = i13.next(U(this.view, s6)).next(...t11);
      }
      return {
        steps: i13,
        cancel: n11
      };
    }, o12, (e17) => {
      const {
        action: o13,
        object: i13,
        dxScreen: a15,
        dyScreen: n11
      } = e17, s7 = {
        object: i13,
        dxScreen: a15,
        dyScreen: n11
      };
      switch (o13) {
        case "start":
          this._emitRecordUndo(), t9.emit("translate-start", s7);
          break;
        case "update":
          t9.emit("translate", s7);
          break;
        case "end":
          t9.emit("translate-stop", s7);
      }
    }), this._moveManipulation.angle = null != this._scaleRotate ? this._scaleRotate.angle : 0, this._scaleRotateAdapter = this._createScaleRotateAdapter(), this.addHandles(d2(() => this._scaleRotateAdapter.angle, () => this._updateMoveAngle())), this.enableScaling || this.enableRotation) {
      const t10 = this.enableScaling && this.enableRotation ? null : this.enableScaling ? "scale" : "rotate";
      this._scaleRotate = new yt({
        tool: this,
        mode: t10,
        adapter: this._scaleRotateAdapter,
        sketchOptions: this.sketchOptions,
        tooltipEnabled: "mesh" !== t6(o12)?.type
      }), this.addHandles(this._scaleRotate.events.on("scale-changed", () => this._onScaleChanged()));
    }
    this.addHandles([l12({
      view: this.view,
      object: o12,
      forEachManipulator: (t10) => this._forEachManipulator(t10),
      onManipulatorsChanged: () => e()
    }), o12.on("committed", () => this._onGeometryChanged()), this._hideManipulatorsForObjectState(), d2(() => a14.scale, () => this._updateMoveAngle())].filter(O)), this._onGeometryChanged(), this._updateMoveAngle(), this._forEachManipulator((t10) => {
      t10 instanceof ee && this.addHandles(t10.events.on("grab-changed", () => this._updateManipulatorsInteractive()));
    });
    const r14 = a14?.type, {
      sketchOptions: l17
    } = this;
    this._meshTooltipInfo = new r12({
      viewType: r14,
      sketchOptions: l17
    }), this._pointTooltipInfo = new i11({
      viewType: r14,
      sketchOptions: l17
    });
    const c10 = {
      object: o12,
      dxScreen: 0,
      dyScreen: 0
    }, m8 = {
      onMoveStart: () => {
        this._emitRecordUndo(), t9.emit("translate-start", __spreadValues({}, c10));
      },
      onMove: () => t9.emit("translate", __spreadValues({}, c10)),
      onMoveStop: () => t9.emit("translate-stop", __spreadValues({}, c10)),
      onRotateStart: (e17) => {
        this._emitRecordUndo(), t9.emit("rotate-start", {
          object: o12,
          angle: e17
        });
      },
      onRotate: (e17) => t9.emit("rotate", {
        object: o12,
        angle: e17
      }),
      onRotateStop: (e17) => t9.emit("rotate-stop", {
        object: o12,
        angle: e17
      }),
      onScaleStart: (e17, i13) => {
        this._emitRecordUndo(), t9.emit("scale-start", {
          object: o12,
          xScale: e17,
          yScale: i13
        });
      },
      onScale: (e17, i13) => t9.emit("scale", {
        object: o12,
        xScale: e17,
        yScale: i13
      }),
      onScaleStop: (e17, i13) => t9.emit("scale-stop", {
        object: o12,
        xScale: e17,
        yScale: i13
      })
    };
    this.addHandles(m6(this.tooltip, this.object, () => ({
      sketchOptions: this.sketchOptions,
      activeTooltipInfo: this.activeTooltipInfo,
      callbacks: m8
    }))), this.finishToolCreation();
  }
  destroy() {
    this.tooltip.destroy(), this._moveManipulation.destroy(), this._scaleRotate = u(this._scaleRotate), this._scaleRotateAdapter = u(this._scaleRotateAdapter), this._updatingHandles.destroy(), this._set("view", null), this._set("object", null);
  }
  onInputEvent(t9) {
    if (!this.destroyed && !G4(t9, this.tooltip)) return super.onInputEvent(t9);
  }
  _updateManipulatorsInteractive() {
    null != this._scaleRotate && (this._scaleRotate.interactive = !this._moveManipulation.grabbing, this._moveManipulation.interactive = !this._scaleRotate.grabbing);
  }
  _createScaleRotateAdapter() {
    const t9 = t6(this.object);
    return "mesh" === t9?.type ? new p10({
      object: this.object,
      geometry: t9,
      viewingMode: this.view.state.viewingMode
    }) : new a12({
      graphic: this.object.graphic,
      sizeFilter: (t10) => this._enforceNonZeroSize(t10),
      findLayerView: () => this.view.allLayerViews.find((t10) => t10.layer === this.object.graphic?.layer),
      sizeAxis: this.sketchOptions?.tooltips?.visualVariables?.size?.axis ?? null
    });
  }
  _forEachManipulator(t9) {
    this._moveManipulation?.forEachManipulator(t9), this._scaleRotate?.forEachManipulator(t9);
  }
  _hideManipulatorsForObjectState() {
    return d2(() => this.object.visible, (t9) => {
      this._forEachManipulator((e17) => e17.available = t9), this._moveManipulation.zManipulation.available = t9 && this.enableZ && o8(this.object.operations, this.object.elevationInfo);
    });
  }
  _emitRecordUndo() {
    this.events.emit("record-undo", {
      updates: [this.object.createUndoRecord()]
    });
  }
  set snapToScene(t9) {
    this._moveManipulation && (this._moveManipulation.snapToScene = t9), this._set("snapToScene", t9);
  }
  get updating() {
    return this._updatingHandles.updating || !!this._scaleRotate?.updating;
  }
  get activeTooltipInfo() {
    return null != this._scaleRotate?.tooltip?.info ? null : "mesh" === t6(this.object)?.type ? this._meshTooltipInfo : this._pointTooltipInfo;
  }
  set location(t9) {
    this._moveManipulation.location = t9, this._scaleRotate && (this._scaleRotate.location = t9);
  }
  set elevationAlignedLocation(t9) {
    this._moveManipulation.elevationAlignedLocation = t9, this._scaleRotate && (this._scaleRotate.elevationAlignedLocation = t9);
  }
  reset() {
  }
  onHide() {
    this._scaleRotate?.cancelActiveAnimation();
  }
  _onScaleChanged() {
    null != this._scaleRotate && (this._moveManipulation.displayScale = this._scaleRotate.getScale());
  }
  _updateMoveAngle() {
    const {
      view: t9
    } = this, e17 = t9.state.viewingMode === l5.Local || t9.scale < v5;
    this._moveManipulation.angle = e17 ? this._scaleRotateAdapter.angle : 0;
  }
  _onGeometryChanged() {
    F3(this, this.object);
  }
  _enforceNonZeroSize(t9) {
    return t9 || this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation);
  }
  get test() {
  }
};
e2([y({
  constructOnly: true,
  nonNullable: true
})], z7.prototype, "view", void 0), e2([y({
  constructOnly: true,
  nonNullable: true
})], z7.prototype, "object", void 0), e2([y({
  constructOnly: true,
  nonNullable: true
})], z7.prototype, "enableZ", void 0), e2([y()], z7.prototype, "enableRotation", void 0), e2([y()], z7.prototype, "enableScaling", void 0), e2([y({
  constructOnly: true,
  type: l9
})], z7.prototype, "sketchOptions", void 0), e2([y({
  value: false
})], z7.prototype, "snapToScene", null), e2([y({
  constructOnly: true
})], z7.prototype, "snappingManager", void 0), e2([y({
  readOnly: true
})], z7.prototype, "type", void 0), e2([y({
  readOnly: true
})], z7.prototype, "updating", null), e2([y()], z7.prototype, "activeTooltipInfo", null), z7 = e2([a("esri.views.3d.interactive.editingTools.transform.TransformTool3D")], z7);

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/ExtentMove.js
var b4 = class {
  get _object() {
    return this._tool.object;
  }
  get _operations() {
    return this._object.operations;
  }
  constructor(t9, e17) {
    this._tool = t9, this._bounds = e17, this._moveXYTooltipInfo = null, this._moveZTooltipInfo = null;
    const o12 = this._tool, i13 = o12.view;
    this.moveXYObjectManipulation = new l13({
      view: i13,
      tool: o12,
      object: this._object
    }), o12.addHandles(this._createMoveXYObjectDragPipeline()), this.moveZManipulator = new I2(i13, H2.CENTER_ON_CALLOUT), this.moveZManipulator.state |= Si, o12.manipulators.add(this.moveZManipulator), o12.addHandles([this._createMoveZDragPipeline()]), o12.addHandles([o12.events.on("translate-stop", () => {
      this._moveXYTooltipInfo = null, this._moveZTooltipInfo = null;
    })]);
  }
  destroy() {
    this.moveXYObjectManipulation.destroy(), this._tool.manipulators.remove(this.moveZManipulator), this.moveZManipulator.destroy();
  }
  forEachManipulator(t9) {
    this.moveXYObjectManipulation.forEachManipulator(t9), t9(this.moveZManipulator, A5.TRANSLATE_Z);
  }
  updateManipulators(t9, e17) {
    const n11 = this.moveZManipulator, s6 = x2(f3.get(), t9, Math.PI);
    s6[12] = 0, s6[13] = 0, s6[14] = 0, n11.modelTransform = s6, n11.renderLocation = e4(c3.get(), e17.origin, e17.basis1);
  }
  getUpdatedTooltipInfo() {
    return this.moveXYObjectManipulation.grabbing || this.moveXYObjectManipulation.dragging ? this._computeMoveXYTooltipInfo() : this.moveZManipulator.focused ? this._computeMoveZTooltipInfo() : null;
  }
  _computeMoveXYTooltipInfo() {
    const t9 = this._tool, o12 = this._moveXYTooltipInfo ??= new i7({
      sketchOptions: t9.sketchOptions
    });
    if (this.moveXYObjectManipulation.dragging) {
      const e17 = this._bounds, i13 = e17.mapBoundsStart.origin, n11 = e17.mapBounds.origin, {
        renderSpatialReference: a14
      } = t9.view;
      if (!a14) return null;
      const r14 = u8(i13, n11, a14);
      if (null == r14) return null;
      o12.distance = r14;
    } else o12.distance = h6;
    return o12;
  }
  _computeMoveZTooltipInfo() {
    const t9 = this._tool, o12 = this._moveZTooltipInfo ??= new i10({
      sketchOptions: t9.sketchOptions
    });
    if (this.moveZManipulator.dragging) {
      const e17 = this._bounds, i13 = e17.mapBoundsStart.origin, n11 = e17.mapBounds.origin, {
        renderSpatialReference: a14
      } = t9.view;
      if (!a14) return null;
      const r14 = g2(i13, n11, a14);
      if (null == r14) return null;
      o12.distance = r14;
    } else o12.distance = h6;
    return o12;
  }
  _createMoveXYObjectDragPipeline() {
    return this.moveXYObjectManipulation.createDragPipeline((t9, e17, o12) => this._applyObjectMoveSteps(e17, o12));
  }
  _createMoveZDragPipeline() {
    if (!this._operations) return e();
    const e17 = this._operations.data.spatialReference;
    return p4(this.moveZManipulator, (t9, o12, i13) => {
      const a14 = t2(t9.renderLocation), r14 = o12.next(G2(this._tool.view, a14, e17)).next(j3());
      this._applyObjectMoveSteps(r14, i13);
    });
  }
  _applyObjectMoveSteps(t9, e17) {
    const {
      _tool: o12,
      _object: i13
    } = this, n11 = t9.next((t10) => ("start" === t10.action && (o12.inputState = {
      type: "move"
    }, this._bounds.backupMapBounds(), o12.events.emit("translate-start", {
      object: i13,
      dxScreen: t10.screenDeltaX,
      dyScreen: t10.screenDeltaY
    })), t10)).next(v4()).next(this._moveDragUpdateGeometry()).next((t10) => {
      const e18 = {
        object: i13,
        dxScreen: t10.screenDeltaX,
        dyScreen: t10.screenDeltaY
      };
      switch (t10.action) {
        case "start":
        case "update":
          (t10.mapEnd.x - t10.mapStart.x || t10.mapEnd.y - t10.mapStart.y || (t10.mapEnd.z ?? 0) - (t10.mapStart.z ?? 0)) && o12.events.emit("translate", e18);
          break;
        case "end":
          o12.inputState = null, o12.events.emit("translate-stop", e18);
      }
      return t10;
    });
    return e17.next(() => {
      null != o12.inputState && o12.events.emit("translate-stop", {
        object: i13,
        dxScreen: 0,
        dyScreen: 0
      }), o12.cancel();
    }), n11;
  }
  _moveDragUpdateGeometry() {
    const t9 = this._tool;
    return (e17) => {
      if (null == t9.inputState || "move" !== t9.inputState.type) return e17;
      const o12 = "start" === e17.action ? E3.NEW_STEP : E3.ACCUMULATE_STEPS;
      if (this._operations) {
        const t10 = this._operations.move(e17.mapDeltaX, e17.mapDeltaY, e17.mapDeltaZ, o12);
        this._bounds.updateMapBoundsFromOperation(t10);
      }
      return e17;
    };
  }
};

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/ExtentRotate.js
var M7 = class {
  get _object() {
    return this._tool.object;
  }
  get _operations() {
    return this._object.operations;
  }
  constructor(t9, e17, o12) {
    this._tool = t9, this._bounds = e17, this._snapRotation = o12, this._rotateTooltipInfo = null, this._startAngle = 0, this._endAngle = 0;
    const r14 = this._tool, a14 = r14.view, n11 = !a14._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;
    this.rotateManipulator = new g4(a14, (t10, e18) => l7(a14.textures, {
      accentColor: t10,
      contrastColor: e18,
      preMultiplyAlpha: n11
    })), r14.addHandles([this.rotateManipulator.events.on("grab-changed", (t10) => this._onRotateGrab(t10)), this._createRotateDragPipeline(this.rotateManipulator)]), r14.manipulators.add(this.rotateManipulator), r14.addHandles([r14.events.on("rotate-start", (t10) => this._startAngle = t10.angle), r14.events.on("rotate", (t10) => this._endAngle = t10.angle), r14.events.on("rotate-stop", () => {
      this._startAngle = 0, this._endAngle = 0;
    })]);
  }
  destroy() {
    this._tool.manipulators.remove(this.rotateManipulator), this.rotateManipulator.destroy();
  }
  forEachManipulator(t9) {
    t9(this.rotateManipulator, A5.ROTATE);
  }
  updateManipulators(t9, r14) {
    const a14 = this._bounds.mapBounds.plane[2] < 0 ? Math.PI : 0, n11 = l3(f3.get(), t9, a14);
    n11[12] = 0, n11[13] = 0, n11[14] = 0, this.rotateManipulator.modelTransform = n11, this.rotateManipulator.renderLocation = u2(c3.get(), r14.origin, r14.basis1);
  }
  getUpdatedTooltipInfo() {
    return this.rotateManipulator.focused ? this._computeRotateTooltipInfo() : null;
  }
  _computeRotateTooltipInfo() {
    const t9 = this._rotateTooltipInfo ??= new s5({
      sketchOptions: this._tool.sketchOptions
    });
    return t9.angle = this._startAngle - this._endAngle, t9;
  }
  _onRotateGrab({
    action: t9,
    screenPoint: e17
  }) {
    const o12 = this._tool, r14 = this._bounds;
    if ("start" !== t9 || !e17) return;
    const a14 = li(r14.displayBounds, o12.view.renderCoordsHelper, _i.HEADING, E2()), n11 = m4(o12.view.state.camera, e17);
    S3(a14, n11, c3.get()) && (r14.backupMapBounds(), o12.inputState = {
      type: "rotate",
      rotatePlane: a14
    });
  }
  _createRotateDragPipeline(e17) {
    const {
      _tool: o12,
      _object: r14
    } = this;
    return p4(e17, (e18, a14, n11) => {
      const s6 = o12.inputState;
      null != s6 && (a14.next((t9) => ("start" === t9.action && o12.events.emit("rotate-start", {
        object: r14,
        angle: 0
      }), t9)).next(O2(o12.view, s6.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(s6)).next(...this._snapRotation()).next(this._rotateDragUpdateGeometry()).next((e19) => {
        const a15 = {
          object: r14,
          angle: M(e19.rotateAngle)
        };
        switch (e19.action) {
          case "start":
          case "update":
            o12.events.emit("rotate", a15);
            break;
          case "end":
            o12.inputState = null, o12.events.emit("rotate-stop", a15);
        }
        return e19;
      }), n11.next(() => {
        null != o12.inputState && o12.events.emit("rotate-stop", {
          object: r14,
          angle: 0
        }), o12.cancel();
      }));
    });
  }
  _rotateDragRenderPlaneToRotate(t9) {
    return (e17) => {
      const o12 = F2(t9.rotatePlane), r14 = w2(e17.renderStart, e17.renderEnd, this._bounds.displayBounds.origin, o12);
      return __spreadProps(__spreadValues({}, e17), {
        rotateAxis: o12,
        rotateAngle: r14
      });
    };
  }
  _rotateDragUpdateGeometry() {
    const t9 = this._bounds;
    return (e17) => {
      const o12 = r4(n(), t9.mapBoundsStart.origin), s6 = "start" === e17.action ? E3.NEW_STEP : E3.ACCUMULATE_STEPS;
      if (this._operations) {
        const r14 = this._operations.rotate(o12, e17.rotateAngle, s6, e11.REPLACE);
        Z(t9.mapBoundsStart, t9.mapBounds), t9.updateMapBoundsFromOperation(r14);
      }
      return e17;
    };
  }
};

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/extentUtils.js
var x10 = class {
  constructor(t9, o12) {
    this._tool = t9, this.mapBounds = W2(), this.mapBoundsStart = W2(), this.displayBounds = W2(), t9.addHandles(v(() => t9.object, "modified-externally", () => this._resetMapBounds(), {
      onListenerAdd: () => this._resetMapBounds()
    })), this._onDisplayBoundsChanged = o12;
  }
  get displayBoundsMargin() {
    const {
      view: s6,
      object: t9
    } = this._tool, o12 = t6(t9), i13 = s6.pointsOfInterest?.centerOnSurfaceFrequent.location ?? o12?.extent?.center;
    return i13 ? D6 * s6.pixelSizeAt(i13) : 0;
  }
  backupMapBounds() {
    Z(this.mapBounds, this.mapBoundsStart);
  }
  updateDisplayBounds() {
    this._calculateDisplayBounds(), this._onDisplayBoundsChanged?.();
  }
  updateMapBoundsFromOperation(s6) {
    d8(s6, this.mapBounds), this.updateDisplayBounds();
  }
  updateMapBoundsFromOperationInverse(s6) {
    E6(s6, this.mapBounds), this.updateDisplayBounds();
  }
  _resetMapBounds() {
    this._calculateMapBounds(), this.updateDisplayBounds();
  }
  _calculateMapBounds() {
    const {
      view: s6,
      attachmentOrigin: e17,
      object: a14
    } = this._tool, n11 = a14.operations?.data;
    if (!n11) return;
    const r14 = n11.geometry;
    this.spatialReference = r14.spatialReference;
    const p12 = n7(r14);
    l6(p12, p12, -1);
    const d9 = s6.spatialReference, c10 = r14.spatialReference, l17 = e17 ? s6.pixelSizeAt(e17) * z(d9) / W(c10) : 0;
    F7(p12, n11, O4 * l17, this.mapBounds);
  }
  _calculateDisplayBounds() {
    const {
      view: s6,
      attachmentOrigin: t9
    } = this._tool, o12 = t9?.z ?? f4(this.mapBounds.origin, s6.elevationProvider, o7.fromElevationInfo(this._tool.object.elevationInfo), s6.renderCoordsHelper), i13 = Z(this.mapBounds);
    i13.origin[2] = o12 ?? 0, U4(i13, s6.renderCoordsHelper, this.spatialReference, this.displayBoundsMargin, this.displayBounds);
  }
};
var D6 = 10;
var O4 = 80;
function U4(s6, t9, o12, i13 = 0, u14) {
  u14 || (u14 = W2()), t9.toRenderCoords(s6.origin, o12, u14.origin);
  const m8 = c3.get();
  u2(m8, s6.origin, s6.basis1), u2(m8, m8, s6.basis2), t9.toRenderCoords(m8, o12, m8);
  const h11 = c3.get();
  u2(h11, s6.origin, s6.basis1), e4(h11, h11, s6.basis2), t9.toRenderCoords(h11, o12, h11);
  const B3 = c3.get();
  e4(B3, s6.origin, s6.basis1), e4(B3, B3, s6.basis2), t9.toRenderCoords(B3, o12, B3);
  const j8 = c3.get();
  e4(j8, s6.origin, s6.basis1), u2(j8, j8, s6.basis2), t9.toRenderCoords(j8, o12, j8);
  const y8 = A3(c3.get(), m8, h11, 0.5);
  e4(y8, y8, u14.origin);
  const v8 = A3(c3.get(), B3, j8, 0.5);
  e4(v8, u14.origin, v8), A3(u14.basis1, y8, v8, 0.5);
  const _4 = A3(c3.get(), j8, m8, 0.5);
  e4(_4, _4, u14.origin);
  const R8 = A3(c3.get(), h11, B3, 0.5);
  e4(R8, u14.origin, R8), A3(u14.basis2, _4, R8, 0.5);
  const C5 = _2(c3.get(), u14.basis1, u14.basis2), M8 = _2(C5, C5, u14.basis1);
  return z2(M8, M8), g(u14.basis2, M8, P2(u14.basis2, M8)), g(u14.basis1, u14.basis1, 1 + i13 / s2(u14.basis1)), g(u14.basis2, u14.basis2, 1 + i13 / s2(u14.basis2)), J3(u14), u14;
}
function S9(s6, t9, o12) {
  return e4(w5, e4(w5, s6.origin, s6.basis1), s6.basis2), q(I4, w5, s6.basis1, 2), q(A10, I4, s6.basis2, 2), q(k3, w5, s6.basis2, 2), w5[2] = I4[2] = A10[2] = k3[2] = t9, o10({
    topLeft: k3,
    topRight: A10,
    bottomRight: I4,
    bottomLeft: w5,
    spatialReference: o12
  });
}
var k3 = n();
var A10 = n();
var I4 = n();
var w5 = n();

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/ExtentScale.js
var j7 = class {
  get _object() {
    return this._tool.object;
  }
  get _operations() {
    return this._object.operations;
  }
  get zMax() {
    if (!this._zMaxDirty || !this._operations) return this._zMax;
    const t9 = this._operations.data;
    if (t9.geometry.hasZ) {
      const e17 = t9.coordinateHelper;
      this._zMax = Number.NEGATIVE_INFINITY;
      for (const s6 of t9.components) for (const t10 of s6.vertices) {
        const s7 = e17.getZ(t10.pos) ?? 0;
        this._zMax = Math.max(s7, this._zMax);
      }
    } else this._zMax = 0;
    return this._zMaxDirty = false, this._zMax;
  }
  constructor(e17, a14, i13) {
    this._tool = e17, this._bounds = a14, this._preserveAspectRatioStep = i13, this._resizeHandles = [{
      direction: [1, 0]
    }, {
      direction: [1, 1]
    }, {
      direction: [0, 1]
    }, {
      direction: [-1, 1]
    }, {
      direction: [-1, 0]
    }, {
      direction: [-1, -1]
    }, {
      direction: [0, -1]
    }, {
      direction: [1, -1]
    }], this._scaleTooltipInfo = null, this._displayBoundsStart = W2(), this._displayBoundsMarginStart = 0, this._startScale = n3(), this._endScale = n3(), this._sizeStart = null, this._zMax = 0, this._zMaxDirty = true;
    const o12 = this._tool, r14 = o12.view;
    this.resizeManipulators = this._resizeHandles.map((t9) => {
      const e18 = new v6(r14, t9);
      return o12.addHandles([e18.events.on("grab-changed", (t10) => this._onResizeGrab(t10)), this._createResizeDragPipeline(e18, t9)]), e18;
    }), o12.manipulators.addMany(this.resizeManipulators), o12.addHandles([o12.events.on("scale-start", (e18) => {
      o5(this._startScale, e18.xScale, e18.yScale), o5(this._endScale, e18.xScale, e18.yScale);
    }), o12.events.on("scale", (e18) => {
      o5(this._endScale, e18.xScale, e18.yScale);
    }), o12.events.on("scale-stop", () => {
      o5(this._startScale, 0, 0), o5(this._endScale, 0, 0);
    })]), this._operations && o12.addHandles(this._operations.data.on("change", () => {
      "resize" !== o12.inputState?.type && (this._zMaxDirty = true);
    }));
  }
  destroy() {
    this.forEachManipulator((t9) => {
      this._tool.manipulators.remove(t9), t9.destroy();
    });
  }
  forEachManipulator(t9) {
    this.resizeManipulators.forEach((e17) => t9(e17, A5.SCALE));
  }
  updateManipulators(t9, e17) {
    this.resizeManipulators.forEach((s6, a14) => {
      gi(s6, this._resizeHandles[a14], t9, e17);
    });
  }
  getUpdatedTooltipInfo() {
    return this.resizeManipulators.some((t9) => t9.focused) ? this._computeScaleTooltipInfo() : null;
  }
  _computeScaleTooltipInfo() {
    const t9 = this._tool, e17 = this._scaleTooltipInfo ??= new i8({
      sketchOptions: t9.sketchOptions
    }), s6 = S9(this._bounds.mapBounds, this.zMax, this._bounds.spatialReference);
    return null == s6 ? null : (e17.xSize = s6.xSize, e17.ySize = s6.ySize, null != this._sizeStart && this.resizeManipulators.some((t10) => t10.dragging) ? (e17.xScale = s6.xSize.value / this._sizeStart.xSize.value, e17.yScale = s6.ySize.value / this._sizeStart.ySize.value) : (e17.xScale = 1, e17.yScale = 1), e17);
  }
  _onResizeGrab({
    action: t9,
    screenPoint: e17
  }) {
    const s6 = this._tool, a14 = this._bounds;
    if ("start" !== t9 || !e17) return;
    const i13 = m4(s6.view.state.camera, e17);
    S3(a14.displayBounds.plane, i13, c3.get()) && (a14.backupMapBounds(), Z(a14.displayBounds, this._displayBoundsStart), this._displayBoundsMarginStart = a14.displayBoundsMargin, this._sizeStart = S9(a14.mapBoundsStart, this.zMax, a14.spatialReference), s6.inputState = {
      type: "resize"
    });
  }
  _createResizeDragPipeline(t9, e17) {
    const {
      _tool: s6,
      _object: a14
    } = this;
    return p4(t9, (t10, i13, o12) => {
      null != s6.inputState && (i13.next((t11) => ("start" === t11.action && s6.events.emit("scale-start", {
        object: a14,
        xScale: 1,
        yScale: 1
      }), t11)).next(O2(s6.view, this._displayBoundsStart.plane)).next((t11) => __spreadProps(__spreadValues({}, t11), {
        handle: e17
      })).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next((t11) => {
        const e18 = {
          object: a14,
          xScale: t11.factor1,
          yScale: t11.factor2
        };
        switch (t11.action) {
          case "start":
          case "update":
            s6.events.emit("scale", e18);
            break;
          case "end":
            s6.inputState = null, s6.events.emit("scale-stop", e18);
        }
        return t11;
      }), o12.next(() => {
        null != s6.inputState && s6.events.emit("scale-stop", {
          object: a14,
          xScale: 1,
          yScale: 1
        }), s6.cancel();
      }));
    });
  }
  _resizeDragRenderPlaneToFactors() {
    const t9 = this._bounds;
    return (e17) => {
      const s6 = this._displayBoundsStart, c10 = e17.handle.direction, l17 = t9.displayBoundsMargin, p12 = this._displayBoundsMarginStart, d9 = r4(c3.get(), s6.origin);
      q(d9, d9, s6.basis1, -c10[0]), q(d9, d9, s6.basis2, -c10[1]);
      const u14 = e4(c3.get(), e17.renderEnd, d9), m8 = e4(c3.get(), e17.renderStart, d9), f9 = Ei(e17.handle), z8 = hi(s6), y8 = hi(t9.displayBounds) / z8, x11 = (t10, e18) => {
        if (0 === t10) return 1;
        let s7 = s2(e18), a14 = 0.5 * t10 * P2(e18, u14) / s7;
        const i13 = a14 < 0 ? -1 : 1;
        if (f9) {
          a14 += (s7 - 0.5 * t10 * P2(e18, m8) / s7) * i13 * y8;
        }
        const o12 = s7 < 1.5 * p12 ? 1 : B2;
        return s7 = Math.max(s7 - p12, B2), i13 > 0 && (a14 -= l17), i13 * Math.max(i13 * (a14 / s7), o12);
      };
      return __spreadProps(__spreadValues({}, e17), {
        factor1: x11(c10[0], s6.basis1),
        factor2: x11(c10[1], s6.basis2)
      });
    };
  }
  _resizeDragUpdateGeometry() {
    const o12 = this._bounds;
    return (r14) => {
      const n11 = r4(n(), o12.mapBoundsStart.origin);
      q(n11, n11, o12.mapBoundsStart.basis1, -r14.handle.direction[0]), q(n11, n11, o12.mapBoundsStart.basis2, -r14.handle.direction[1]);
      const l17 = o5(n3(), o12.mapBoundsStart.basis1[0], o12.mapBoundsStart.basis1[1]);
      v3(l17, l17);
      const d9 = "start" === r14.action ? E3.NEW_STEP : E3.ACCUMULATE_STEPS;
      if (this._operations) {
        const t9 = this._operations.scale(n11, l17, r14.factor1, r14.factor2, d9, e11.REPLACE);
        Z(o12.mapBoundsStart, o12.mapBounds), o12.updateMapBoundsFromOperation(t9);
      }
      return r14;
    };
  }
};
var B2 = 1e-6;

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/PreserveAspectRatio.js
var a13 = class {
  constructor() {
    this._lastDragEvent = null, this._next = null, this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(t9) {
    if (this._enabled !== t9 && null != this._lastDragEvent && null != this._next) {
      const e17 = __spreadProps(__spreadValues({}, this._lastDragEvent), {
        action: "update"
      });
      t9 && n8(e17), this._next.execute(e17);
    }
    this._enabled = t9;
  }
  createDragEventPipelineStep() {
    this._lastDragEvent = null;
    const t9 = new w3();
    return this._next = t9, [(t10) => (this._lastDragEvent = "end" !== t10.action ? __spreadValues({}, t10) : null, this._enabled && n8(t10), t10), t9];
  }
  get test() {
  }
};
function n8(e17) {
  const a14 = Ei(e17.handle) ? Math.max(Math.abs(e17.factor1), Math.abs(e17.factor2)) : 0 === e17.handle.direction[0] ? Math.abs(e17.factor2) : Math.abs(e17.factor1);
  e17.factor1 = e17.factor1 < 0 ? -a14 : a14, e17.factor2 = e17.factor2 < 0 ? -a14 : a14;
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/extentTransform/SnapRotation.js
var n9 = class {
  constructor() {
    this._lastDragEvent = null, this._next = null, this.incrementRadians = h2(5), this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(t9) {
    if (this._enabled !== t9 && null != this._lastDragEvent && null != this._next) {
      const e17 = __spreadProps(__spreadValues({}, this._lastDragEvent), {
        action: "update"
      });
      t9 && this._adjustRotation(e17), this._next.execute(e17);
    }
    this._enabled = t9;
  }
  createDragEventPipelineStep() {
    this._lastDragEvent = null;
    const t9 = new w3();
    return this._next = t9, [(t10) => (this._lastDragEvent = "end" !== t10.action ? __spreadValues({}, t10) : null, this._enabled && this._adjustRotation(t10), t10), t9];
  }
  _adjustRotation(t9) {
    t9.rotateAngle = Math.round(t9.rotateAngle / this.incrementRadians) * this.incrementRadians;
  }
};

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/transform/ExtentTransformTool.js
var T4 = class extends n4 {
  get updating() {
    return !!this.object.updating;
  }
  constructor(t9) {
    super(t9), this.events = new o2(), this.enableZ = true, this.enableScaling = true, this.enableRotation = true, this.sketchOptions = new l9(), this._preserveAspectRatio = new a13(), this._snapRotation = new n9(), this.grabbing = false, this.inputState = null, this._attachmentOrigin = null, this.type = "transform-3d", this._outlineVisualElement = null;
  }
  initialize() {
    const {
      view: t9,
      object: e17
    } = this, s6 = this._bounds = new x10(this, () => this._updateManipulators());
    this._extentMove = new b4(this, s6), this._extentScale = new j7(this, s6, () => this._preserveAspectRatio.createDragEventPipelineStep()), this._extentRotate = new M7(this, s6, () => this._snapRotation.createDragEventPipelineStep()), this.addHandles([d2(() => this.enableZ, () => this._updateManipulatorAvailability(this._extentMove.moveZManipulator, A5.TRANSLATE_Z)), d2(() => this.enableScaling, () => this._extentScale.forEachManipulator((t10) => this._updateManipulatorAvailability(t10, A5.SCALE))), d2(() => this.enableRotation, () => this._updateManipulatorAvailability(this._extentRotate.rotateManipulator, A5.ROTATE))]), this._updateManipulators(), this._updateAllManipulatorAvailability();
    const n11 = l12({
      view: t9,
      object: e17,
      forEachManipulator: (t10) => this._forEachManipulator(t10),
      onManipulatorsChanged: () => e()
    });
    if (null != n11) {
      const {
        visualElement: t10
      } = n11;
      t10 instanceof w4 && (this._outlineVisualElement = t10, this.addHandles(t10.events.on("attachment-origin-changed", () => this._bounds.updateDisplayBounds()))), this.addHandles(n11);
    }
    this.addHandles([e17.on("committed", () => this._onGeometryChanged()), d2(() => this.object.visible, () => this._updateAllManipulatorAvailability()), d2(() => this.object.isDraped, () => this._graphicDrapedChanged(), P), d2(() => t9.pointsOfInterest?.centerOnSurfaceFrequent.location, () => s6.updateDisplayBounds())]);
    const r14 = (t10) => {
      this.addHandles(t10.events.on("grab-changed", () => {
        this.grabbing = t10.grabbing, this._updateAllManipulatorAvailability();
      }));
    };
    this._forEachManipulator(r14);
    const l17 = (t10, i13) => {
      this.addHandles(t10.events.on("immediate-click", (t11) => {
        i13 === A5.TRANSLATE_XY && this.events.emit("immediate-click", __spreadProps(__spreadValues({}, t11), {
          object: e17
        })), t11.stopPropagation();
      }));
    };
    this._forEachManipulator(l17), this._initializeTooltip(), this.finishToolCreation();
  }
  destroy() {
    this._extentMove.destroy(), this._extentScale.destroy(), this._extentRotate.destroy(), this.tooltip.destroy(), this._set("view", null), this._set("object", null);
  }
  _initializeTooltip() {
    const {
      view: t9
    } = this, e17 = this.tooltip = new h9({
      view: t9
    }), i13 = () => {
      e17.info = this._getUpdatedTooltipInfo();
    };
    this.addHandles([d2(() => this.sketchOptions.tooltips.effectiveEnabled, i13), this.events.on("translate-start", i13), this.events.on("translate", i13), this.events.on("translate-stop", () => this.tooltip.clear()), this.events.on("rotate-start", i13), this.events.on("rotate", i13), this.events.on("rotate-stop", i13), this.events.on("scale-start", i13), this.events.on("scale", i13), this.events.on("scale-stop", i13)]), this._forEachManipulator((t10) => {
      this.addHandles([t10.events.on("focus-changed", i13), t10.events.on("grab-changed", i13), t10.events.on("drag", (t11) => {
        "cancel" === t11.action ? this.tooltip.clear() : i13();
      })]);
    });
  }
  _getUpdatedTooltipInfo() {
    return this.sketchOptions.tooltips.effectiveEnabled ? this._extentMove.getUpdatedTooltipInfo() ?? this._extentScale.getUpdatedTooltipInfo() ?? this._extentRotate.getUpdatedTooltipInfo() : null;
  }
  _onGeometryChanged() {
    this._bounds.updateDisplayBounds();
  }
  _graphicDrapedChanged() {
    this.removeHandles(S10), this._bounds.updateDisplayBounds(), this.object.isDraped && this.addHandles(this.view.elevationProvider.on("elevation-change", (t9) => {
      null != this._attachmentOrigin && w(t9.extent, this._attachmentOrigin.x, this._attachmentOrigin.y) && this._bounds.updateDisplayBounds();
    }), S10);
  }
  _updateManipulators() {
    if (!this.visible) return;
    const t9 = this._bounds.displayBounds, e17 = ci(t9, f3.get());
    this._extentMove.updateManipulators(e17, t9), this._extentScale.updateManipulators(e17, t9), this._extentRotate.updateManipulators(e17, t9);
  }
  _updateAllManipulatorAvailability() {
    this._forEachManipulator((t9, e17) => this._updateManipulatorAvailability(t9, e17));
  }
  _updateManipulatorAvailability(t9, e17) {
    const i13 = this.grabbing && !t9.grabbing;
    if (t9.interactive = !i13, t9 instanceof ee) {
      const o12 = this.object.visible, a14 = this.enableZ && o8(this.object.operations, this.object.elevationInfo);
      switch (e17) {
        case A5.ROTATE:
          t9.available = o12 && this.enableRotation;
          break;
        case A5.SCALE:
          t9.available = o12 && (this.enableScaling || this.enableRotation || a14), t9.interactive = !i13 && this.enableScaling, t9.state = this.enableScaling ? Hi : Ui;
          break;
        case A5.TRANSLATE_Z:
          t9.available = o12 && a14;
          break;
        default:
          t9.available = o12;
      }
    }
  }
  _forEachManipulator(t9) {
    this._extentMove.forEachManipulator(t9), this._extentScale.forEachManipulator(t9), this._extentRotate.forEachManipulator(t9);
  }
  get preserveAspectRatio() {
    return this._preserveAspectRatio.enabled;
  }
  set preserveAspectRatio(t9) {
    this._preserveAspectRatio.enabled = t9, this._set("preserveAspectRatio", t9);
  }
  get snapRotation() {
    return this._snapRotation.enabled;
  }
  set snapRotation(t9) {
    this._snapRotation.enabled = t9, this._set("snapRotation", t9);
  }
  get attachmentOrigin() {
    const t9 = this.object.isDraped ? null : this._outlineVisualElement?.attachmentOrigin;
    return this._attachmentOrigin = t9 ?? this.object.origin ?? t6(this.object)?.extent?.center, this._attachmentOrigin;
  }
  reset() {
  }
  cancel() {
    if (this.canUndo) {
      const t9 = this.object.operations?.undo();
      t9 && this._bounds.updateMapBoundsFromOperationInverse(t9);
    }
    this.inputState = null;
  }
  get canUndo() {
    return !!this.object.operations?.canUndo;
  }
  undo() {
    if (null != this.inputState) this.view.activeTool = null;
    else if (this.canUndo) {
      const t9 = this.object.operations?.undo();
      t9 && this._bounds.updateMapBoundsFromOperationInverse(t9);
    }
  }
  get canRedo() {
    return !!this.object.operations?.canRedo;
  }
  redo() {
    if (this.canRedo) {
      const t9 = this.object.operations?.redo();
      t9 && this._bounds.updateMapBoundsFromOperation(t9);
    }
  }
  get test() {
  }
};
e2([y()], T4.prototype, "updating", null), e2([y({
  constructOnly: true,
  nonNullable: true
})], T4.prototype, "view", void 0), e2([y({
  constructOnly: true,
  nonNullable: true
})], T4.prototype, "object", void 0), e2([y()], T4.prototype, "enableZ", void 0), e2([y()], T4.prototype, "enableScaling", void 0), e2([y()], T4.prototype, "enableRotation", void 0), e2([y({
  constructOnly: true,
  type: l9
})], T4.prototype, "sketchOptions", void 0), e2([y()], T4.prototype, "preserveAspectRatio", null), e2([y()], T4.prototype, "snapRotation", null), e2([y()], T4.prototype, "grabbing", void 0), e2([y()], T4.prototype, "inputState", void 0), e2([y({
  readOnly: true
})], T4.prototype, "type", void 0), e2([y()], T4.prototype, "tooltip", void 0), T4 = e2([a("esri.views.3d.interactive.editingTools.transform.ExtentTransformTool")], T4);
var S10 = "draped-elevation-changes";

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/undoRecords.js
function r13(e17) {
  return null != e17 && "mesh" === e17.type ? o11(e17) : n10(e17);
}
function o11(e17) {
  return a4(e17.vertexSpace) ? i12(e17, e17.transform, e17.vertexSpace) : l15(e17);
}
function n10(e17) {
  let t9 = e17, r14 = null;
  return {
    undo(e18) {
      r14 = e18.geometry, e18.geometry = t9;
    },
    redo(e18) {
      t9 = e18.geometry, e18.geometry = r14;
    }
  };
}
function i12(t9, r14, o12) {
  let n11 = r14?.clone(), i13 = t2(o12.origin), l17 = null, u14 = null;
  return {
    undo: () => {
      l17 = t9.transform?.clone(), u14 = t2(o12.origin), t9.transform = n11, t9.vertexSpace.origin = i13;
    },
    redo: () => {
      n11 = t9.transform?.clone(), i13 = t2(o12.origin), t9.transform = l17, t9.vertexSpace.origin = u14;
    }
  };
}
function l15(e17) {
  let t9, r14 = e17.vertexAttributes.clonePositional();
  return {
    undo: () => {
      t9 = e17.vertexAttributes.clonePositional(), e17.vertexAttributes = r14;
    },
    redo: () => {
      r14 = e17.vertexAttributes.clonePositional(), e17.vertexAttributes = t9;
    }
  };
}

// ../../../node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatedObject3DGraphic.js
var l16 = Symbol();
var u13 = class extends o2.EventedAccessor {
  get operations() {
    return this._operations;
  }
  get updating() {
    return this._updatingHandles.updating;
  }
  get elevationInfo() {
    return a3(this.graphic);
  }
  get visible() {
    return this._graphicState.displaying;
  }
  get isDraped() {
    return this._graphicState.isDraped;
  }
  get origin() {
    return D(this.view, this.graphic);
  }
  constructor(t9) {
    super(t9), this._updatingHandles = new h4();
  }
  destroy() {
    this._operations = u(this._operations), this._updatingHandles.destroy();
  }
  initialize() {
    this._graphicState = new e13({
      graphic: this.graphic
    }), this._graphicState.on("changed", () => this.emit("committed")), this.addHandles(this.view.trackGraphicState(this._graphicState)), this.addHandles(this._updatingHandles.add(() => this.graphic.geometry, (t9) => {
      const e17 = this._operations?.data.geometry;
      if (t9 !== e17) {
        if (!t9 || "multipoint" === t9?.type || "extent" === t9?.type) return u(this._operations), this.removeHandles(l16), void (this._operations = null);
        if (this._operations?.trySetGeometry(t9)) this.emit("modified-externally");
        else {
          u(this._operations), this.removeHandles(l16);
          const e18 = E4.fromGeometry(t9, this.view.state.viewingMode);
          this._operations = e18, this.addHandles(e18.data.on("change", () => this.graphic.geometry = e18.data.geometry), l16);
        }
      }
    }, P));
  }
  createManipulator(t9) {
    return new S5(__spreadValues({
      view: this.view,
      graphic: this.graphic
    }, t9));
  }
  maskOccludee() {
    return this.view.maskOccludee(this.graphic);
  }
  endInteraction() {
    const t9 = this.graphic.geometry;
    "mesh" === t9?.type && this.graphic.notifyMeshTransformChanged({
      action: a6.UpdateFastLocalOrigin
    });
  }
  toMap(t9) {
    return this.view.toMap(t9, {
      include: [this.graphic]
    });
  }
  createUndoRecord() {
    const {
      graphic: {
        geometry: t9
      }
    } = this;
    return r13(t9);
  }
};
e2([y({
  constructOnly: true
})], u13.prototype, "view", void 0), e2([y({
  constructOnly: true
})], u13.prototype, "graphic", void 0), e2([y()], u13.prototype, "_operations", void 0), e2([y()], u13.prototype, "operations", null), e2([y()], u13.prototype, "updating", null), u13 = e2([a("esri.views.3d.interactive.editingTools.ManipulatedObject3DGraphic")], u13);
export {
  z6 as DrawGraphicTool3D,
  T4 as ExtentTransformTool,
  u13 as ManipulatedObject3DGraphic,
  K as MoveTool3D,
  l14 as ReshapeTool3D,
  z7 as TransformTool3D
};
//# sourceMappingURL=editingTools-7IRQ4AHR.js.map
