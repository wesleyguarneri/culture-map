import {
  C,
  N,
  O,
  P,
  R,
  k,
  q,
  v,
  x
} from "./chunk-SDSV6EUK.js";
import "./chunk-NH2TONNG.js";
import "./chunk-L6LZ5TYL.js";
import "./chunk-7PCL3GUC.js";
import "./chunk-BO5GTO4F.js";
import "./chunk-DON3YPGT.js";
import "./chunk-C7NRYPDG.js";
import "./chunk-4QBFFLOC.js";
import "./chunk-O437BSYE.js";
import "./chunk-YZNT6QWD.js";
import {
  n
} from "./chunk-2GRLWAHK.js";
import {
  i as i2
} from "./chunk-YTFX4PFO.js";
import {
  c as c2
} from "./chunk-USSQX44O.js";
import "./chunk-OTI4DGZ5.js";
import "./chunk-KQDYTHCF.js";
import {
  p as p3
} from "./chunk-TR6FCWXY.js";
import "./chunk-TROPJVOL.js";
import {
  c
} from "./chunk-JKHDI77M.js";
import "./chunk-3AY5EJVP.js";
import "./chunk-XQCKIDQO.js";
import {
  s as s3
} from "./chunk-BNK4CEA6.js";
import "./chunk-BPMRTFHU.js";
import {
  C as C2,
  l as l3
} from "./chunk-6LDLRQX4.js";
import {
  l as l4
} from "./chunk-Z4YAQ5JI.js";
import "./chunk-K2XCQKCC.js";
import "./chunk-AJS4B62I.js";
import {
  p as p2
} from "./chunk-S5EXT7FA.js";
import {
  e as e2
} from "./chunk-73Y7XDLH.js";
import {
  m as m2,
  u
} from "./chunk-YFOAET4H.js";
import "./chunk-5U4TBXYS.js";
import "./chunk-6WG22V46.js";
import "./chunk-OOGIXDXG.js";
import "./chunk-JFYQTYD3.js";
import "./chunk-KDJZAYOF.js";
import "./chunk-5453A3C5.js";
import "./chunk-HCFDI7IX.js";
import "./chunk-AQJS6F3O.js";
import "./chunk-WUB6LJVL.js";
import "./chunk-QXSES7JX.js";
import "./chunk-YPU2P4KO.js";
import {
  d as d2
} from "./chunk-UFVMJL32.js";
import "./chunk-2SMFPIRI.js";
import "./chunk-2GMKFOCL.js";
import "./chunk-ZR5BOILP.js";
import "./chunk-QCBC3RJX.js";
import "./chunk-63QCTVYB.js";
import "./chunk-U74WRHVJ.js";
import "./chunk-TCPN7AEH.js";
import {
  b as b2
} from "./chunk-TRSGUVSM.js";
import "./chunk-U3MA63JX.js";
import "./chunk-WYKKCLBI.js";
import {
  y as y2
} from "./chunk-PFMGJTQM.js";
import "./chunk-Q7SRMLJZ.js";
import "./chunk-PQ4T66BG.js";
import "./chunk-SWPHGZYB.js";
import "./chunk-DWASPXVI.js";
import "./chunk-TNWXOQKO.js";
import "./chunk-MAO5BVLA.js";
import "./chunk-T2S5VXNP.js";
import "./chunk-4U5GUJRA.js";
import "./chunk-7KRERHHR.js";
import "./chunk-T4AP6CTC.js";
import "./chunk-HD65DNIO.js";
import {
  k as k2
} from "./chunk-4KWLMXIA.js";
import "./chunk-BIUXKPKA.js";
import "./chunk-N6TJI25E.js";
import "./chunk-634JLXD4.js";
import "./chunk-Y3EDGYWG.js";
import "./chunk-UF6JOUSJ.js";
import "./chunk-T5JGQSO3.js";
import "./chunk-CIW3KHOW.js";
import "./chunk-J55F4AC2.js";
import "./chunk-IQLBZKUD.js";
import "./chunk-7MZZCQ64.js";
import "./chunk-JOJZ6YC5.js";
import "./chunk-L4TOCXR5.js";
import "./chunk-IMVP5ADD.js";
import "./chunk-H7WPOTQH.js";
import {
  j
} from "./chunk-SJX5DIA7.js";
import "./chunk-6A7CWJED.js";
import "./chunk-LFKEQKEA.js";
import "./chunk-DUTZNK67.js";
import "./chunk-IN6BQCWS.js";
import "./chunk-JM7HAEY6.js";
import {
  f as f3
} from "./chunk-DOK4SACJ.js";
import {
  l
} from "./chunk-OUKUASAF.js";
import "./chunk-V5RMUGJJ.js";
import "./chunk-D2NB6D6N.js";
import {
  t as t2
} from "./chunk-UWJIHV6Q.js";
import {
  b
} from "./chunk-ZUSCOMQM.js";
import {
  d,
  l as l2,
  p,
  s as s2,
  t,
  y as y3
} from "./chunk-DSEUCBVP.js";
import "./chunk-UPDWQH75.js";
import {
  S
} from "./chunk-RXWBJSJ5.js";
import {
  f as f2
} from "./chunk-M2NS3MSU.js";
import "./chunk-HMNBB7ED.js";
import "./chunk-3RRMLFFN.js";
import "./chunk-DR5TVNEL.js";
import "./chunk-HT2T6PUB.js";
import "./chunk-K64AAM77.js";
import "./chunk-6EUVKE22.js";
import "./chunk-A3NNJ7XA.js";
import "./chunk-OKJHJ3CY.js";
import "./chunk-XTVPEVHA.js";
import {
  g,
  p as p4
} from "./chunk-DTUSTSEJ.js";
import "./chunk-JCWFGRHQ.js";
import "./chunk-JILEJ6R2.js";
import "./chunk-GAW5JHG4.js";
import {
  i,
  o as o2
} from "./chunk-OEKKQXBD.js";
import "./chunk-S3IO7V4Q.js";
import "./chunk-DZALMCYL.js";
import "./chunk-K226GFDN.js";
import "./chunk-4ZZRP4MA.js";
import "./chunk-7ZJ6P7J7.js";
import "./chunk-FPFZQCEQ.js";
import "./chunk-YVULORT6.js";
import "./chunk-PB33BAI3.js";
import "./chunk-CVB43GGP.js";
import "./chunk-EODIWR2E.js";
import "./chunk-LLDOZWVV.js";
import "./chunk-FYAEQPUY.js";
import "./chunk-7XMEZQ34.js";
import {
  m
} from "./chunk-BDM2D6IC.js";
import "./chunk-U2ZVAEKG.js";
import "./chunk-EDSMXTFO.js";
import "./chunk-MNLT652N.js";
import "./chunk-OGZAGPIO.js";
import "./chunk-HJJIIYFF.js";
import "./chunk-7RMVJCDW.js";
import "./chunk-T6GCUITX.js";
import "./chunk-TUIGM7TV.js";
import "./chunk-IHVSZYZS.js";
import "./chunk-6CA6K3O7.js";
import {
  w
} from "./chunk-NYQ5CYNR.js";
import "./chunk-O7UDKFOW.js";
import {
  f
} from "./chunk-TKPMIAIW.js";
import "./chunk-NQOJNTB3.js";
import "./chunk-MFOQYQFG.js";
import "./chunk-NKCPFCP3.js";
import "./chunk-3ZXOUEQG.js";
import "./chunk-AXVPJBVW.js";
import "./chunk-OXEPWRM7.js";
import "./chunk-POILQGXA.js";
import "./chunk-JJS7PR2U.js";
import "./chunk-L5YS4GSA.js";
import "./chunk-PRREDSOB.js";
import "./chunk-V5C6HSAM.js";
import "./chunk-SYATLP3H.js";
import "./chunk-V6AMQYXE.js";
import "./chunk-6WHTZNUH.js";
import "./chunk-EITGQLII.js";
import "./chunk-TIVJXVMN.js";
import "./chunk-XNUH25NY.js";
import "./chunk-WGAPNV7F.js";
import "./chunk-BXQGM56A.js";
import {
  e
} from "./chunk-4Z5SGKRM.js";
import "./chunk-ANKOCGE2.js";
import {
  y
} from "./chunk-7CJXZOFG.js";
import "./chunk-IRGZKO7V.js";
import "./chunk-5SELS7VU.js";
import {
  a3 as a
} from "./chunk-DDYVXG4F.js";
import "./chunk-ANP42J2U.js";
import "./chunk-HJY2YILU.js";
import "./chunk-7DA6A5LD.js";
import "./chunk-2MMLMOWS.js";
import "./chunk-4323ZVPF.js";
import {
  o,
  s2 as s
} from "./chunk-WYIDUUN2.js";
import "./chunk-DXLOWWK7.js";
import {
  __async
} from "./chunk-JWIQHGQB.js";

// ../../../node_modules/@arcgis/core/layers/graphics/sources/OGCFeatureSource.js
var S2 = class extends m {
  constructor() {
    super(...arguments), this.featureDefinition = null, this.type = "ogc-feature";
  }
  load(t3) {
    return this.addResolvingPromise(this._loadOGCServices(this.layer, t3)), this.when();
  }
  getSource() {
    const {
      featureDefinition: {
        collection: t3,
        layerDefinition: e3,
        spatialReference: s4,
        supportedCrs: r
      },
      layer: {
        apiKey: o3,
        customParameters: p5,
        effectiveMaxRecordCount: i3
      }
    } = this;
    return {
      type: "ogc-source",
      collection: t3,
      layerDefinition: e3,
      maxRecordCount: i3,
      queryParameters: {
        apiKey: o3,
        customParameters: p5
      },
      spatialReference: s4,
      supportedCrs: r
    };
  }
  queryExtent(t3, e3 = {}) {
    return null;
  }
  queryFeatureCount(t3, e3 = {}) {
    return null;
  }
  queryFeatures(t3, e3 = {}) {
    return this.queryFeaturesJSON(t3, e3).then((t4) => d2.fromJSON(t4));
  }
  queryFeaturesJSON(t3, e3 = {}) {
    const s4 = this.getSource();
    return this.load(e3).then(() => R(s4, t3, e3));
  }
  queryObjectIds(t3, e3 = {}) {
    return null;
  }
  serviceSupportsSpatialReference(t3) {
    return !(!t3.isWGS84 && !t3.isWebMercator) || !!this.featureDefinition.supportedCrs[t3.wkid];
  }
  _conformsToType(t3, e3) {
    const s4 = new RegExp(`^${o(e3)}$`, "i");
    return t3.conformsTo.some((t4) => s4.test(t4)) ?? false;
  }
  _getCapabilities(t3, e3) {
    return {
      analytics: {
        supportsCacheHint: false
      },
      attachment: null,
      data: {
        isVersioned: false,
        supportsAttachment: false,
        supportsM: false,
        supportsZ: t3
      },
      metadata: {
        supportsAdvancedFieldProperties: false
      },
      operations: {
        supportsCalculate: false,
        supportsTruncate: false,
        supportsValidateSql: false,
        supportsAdd: false,
        supportsDelete: false,
        supportsEditing: false,
        supportsChangeTracking: false,
        supportsQuery: false,
        supportsQueryAnalytics: false,
        supportsQueryAttachments: false,
        supportsQueryTopFeatures: false,
        supportsResizeAttachments: false,
        supportsSync: false,
        supportsUpdate: false,
        supportsExceedsLimitStatistics: false,
        supportsAsyncConvert3D: false
      },
      query: {
        maxRecordCount: e3,
        maxRecordCountFactor: void 0,
        standardMaxRecordCount: void 0,
        supportsCacheHint: false,
        supportsCentroid: false,
        supportsDisjointSpatialRelationship: false,
        supportsDistance: false,
        supportsDistinct: false,
        supportsExtent: false,
        supportsFormatPBF: false,
        supportsGeometryProperties: false,
        supportsHavingClause: false,
        supportsHistoricMoment: false,
        supportsMaxRecordCountFactor: false,
        supportsOrderBy: false,
        supportsPagination: false,
        supportsPercentileStatistics: false,
        supportsQuantization: false,
        supportsQuantizationEditMode: false,
        supportsQueryByAnonymous: false,
        supportsQueryByOthers: false,
        supportsQueryGeometry: false,
        supportsResultType: false,
        supportsStandardizedQueriesOnly: false,
        supportsTopFeaturesQuery: false,
        supportsStatistics: false,
        supportsSpatialAggregationStatistics: false,
        supportedSpatialAggregationStatistics: {
          envelope: false,
          centroid: false,
          convexHull: false
        },
        supportsDefaultSpatialReference: false,
        supportsFullTextSearch: false,
        supportsCompactGeometry: false,
        supportsSqlExpression: false,
        tileMaxRecordCount: void 0
      },
      queryRelated: {
        supportsCount: false,
        supportsOrderBy: false,
        supportsPagination: false,
        supportsCacheHint: false
      },
      queryTopFeatures: {
        supportsCacheHint: false
      },
      editing: {
        supportsDeleteByAnonymous: false,
        supportsDeleteByOthers: false,
        supportsGeometryUpdate: false,
        supportsGlobalId: false,
        supportsReturnServiceEditsInSourceSpatialReference: false,
        supportsRollbackOnFailure: false,
        supportsUpdateByAnonymous: false,
        supportsUpdateByOthers: false,
        supportsUploadWithItemId: false,
        supportsUpdateWithoutM: false,
        supportsAsyncApplyEdits: false,
        zDefault: void 0
      }
    };
  }
  _getMaxRecordCount(t3) {
    const e3 = t3?.components?.parameters;
    return e3?.limit?.schema?.maximum ?? e3?.limitFeatures?.schema?.maximum;
  }
  _getStorageSpatialReference(t3) {
    const e3 = t3.storageCrs ?? x, s4 = C(e3);
    return null == s4 ? f.WGS84 : new f({
      wkid: s4
    });
  }
  _getSupportedSpatialReferences(t3, e3) {
    const s4 = "#/crs", r = t3.crs ?? [x], o3 = r.includes(s4) ? r.filter((t4) => t4 !== s4).concat(e3.crs ?? []) : r, p5 = /^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;
    return o3.filter((t4) => !p5.test(t4));
  }
  _loadOGCServices(t3, s4) {
    return __async(this, null, function* () {
      const o3 = null != s4 ? s4.signal : null, {
        apiKey: p5,
        collectionId: i3,
        customParameters: a2,
        fields: f4,
        geometryType: g2,
        hasZ: S3,
        objectIdField: C3,
        timeInfo: R2,
        url: w2
      } = t3, j2 = {
        fields: f4?.map((t4) => t4.toJSON()),
        geometryType: i.toJSON(g2),
        hasZ: S3 ?? false,
        objectIdField: C3,
        timeInfo: R2?.toJSON()
      }, x2 = {
        apiKey: p5,
        customParameters: a2,
        signal: o3
      }, v2 = yield P(w2, x2), [F, O2] = yield Promise.all([O(v2, x2), N(v2, x2)]);
      if (!this._conformsToType(F, "http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson")) throw new s("ogc-feature-layer:no-geojson-support", "Server does not support geojson");
      const D = O2.collections.find(({
        id: t4
      }) => t4 === i3);
      if (!D) throw new s("ogc-feature-layer:collection-not-found", "Server does not contain the named collection");
      const T = this._conformsToType(F, "http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30") ? yield q(v2, x2) : null, A = yield v(D, j2, x2), _ = this._getMaxRecordCount(T), P2 = this._getCapabilities(A.hasZ, _), b3 = this._getStorageSpatialReference(D).toJSON(), q2 = this._getSupportedSpatialReferences(D, O2), E = new RegExp(`^${o(k)}`, "i"), G = {};
      for (const e3 of q2) {
        const t4 = C(e3);
        null != t4 && (G[t4] || (G[t4] = e3.replace(E, "")));
      }
      this.featureDefinition = {
        capabilities: P2,
        collection: D,
        layerDefinition: A,
        spatialReference: b3,
        supportedCrs: G
      };
    });
  }
};
e([y()], S2.prototype, "featureDefinition", void 0), e([y({
  constructOnly: true
})], S2.prototype, "layer", void 0), e([y()], S2.prototype, "type", void 0), S2 = e([a("esri.layers.graphics.sources.OGCFeatureSource")], S2);

// ../../../node_modules/@arcgis/core/layers/OGCFeatureLayer.js
var U = s3();
var B = class extends i2(e2(c2(c(l(p3(l4(t2(b(j(f3(S(f2)))))))))))) {
  constructor(e3) {
    super(e3), this.capabilities = null, this.collectionId = null, this.copyright = null, this.description = null, this.displayField = null, this.elevationInfo = null, this.fields = null, this.fieldsIndex = null, this.fullExtent = null, this.geometryType = null, this.hasZ = void 0, this.labelingInfo = null, this.labelsVisible = true, this.legendEnabled = true, this.maxRecordCount = null, this.objectIdField = null, this.operationalLayerType = "OGCFeatureLayer", this.popupEnabled = true, this.popupTemplate = null, this.screenSizePerspectiveEnabled = true, this.source = new S2({
      layer: this
    }), this.spatialReference = null, this.title = null, this.type = "ogc-feature", this.typeIdField = null, this.types = null, this.url = null;
  }
  destroy() {
    this.source?.destroy();
  }
  load(e3) {
    return this.addResolvingPromise(this.loadFromPortal({
      supportedTypes: ["OGCFeatureServer"]
    }, e3).then(() => this._fetchService(e3))), this.when();
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  get effectiveMaxRecordCount() {
    return this.maxRecordCount ?? this.capabilities?.query.maxRecordCount ?? 5e3;
  }
  get isTable() {
    return this.loaded && null == this.geometryType;
  }
  set renderer(e3) {
    p4(e3, this.fieldsIndex), this._set("renderer", e3);
  }
  on(e3, r) {
    return super.on(e3, r);
  }
  createPopupTemplate(e3) {
    return p2(this, e3);
  }
  createQuery() {
    return new b2();
  }
  getField(e3) {
    return this.fieldsIndex.get(e3);
  }
  getFieldDomain(e3, r) {
    let t3, i3 = false;
    const o3 = r?.feature?.attributes, s4 = this.typeIdField && o3?.[this.typeIdField];
    return null != s4 && this.types && (i3 = this.types.some((r2) => r2.id == s4 && (t3 = r2.domains?.[e3], "inherited" === t3?.type && (t3 = this._getLayerDomain(e3)), true))), i3 || t3 || (t3 = this._getLayerDomain(e3)), t3;
  }
  queryFeatures(e3, r) {
    return this.load().then(() => this.source.queryFeatures(b2.from(e3) || this.createQuery(), r)).then((e4) => (e4?.features?.forEach((e5) => {
      e5.layer = e5.sourceLayer = this;
    }), e4));
  }
  serviceSupportsSpatialReference(e3) {
    return this.source?.serviceSupportsSpatialReference(e3) ?? false;
  }
  _fetchService(e3) {
    return __async(this, null, function* () {
      yield this.source.load(e3), this.read(this.source.featureDefinition, {
        origin: "service"
      }), p4(this.renderer, this.fieldsIndex), g(this.timeInfo, this.fieldsIndex);
    });
  }
  _getLayerDomain(e3) {
    if (!this.fields) return null;
    for (const r of this.fields) if (r.name === e3 && r.domain) return r.domain;
    return null;
  }
};
e([y({
  readOnly: true,
  json: {
    origins: {
      service: {
        read: true
      }
    }
  }
})], B.prototype, "capabilities", void 0), e([y({
  type: String,
  json: {
    write: true
  }
})], B.prototype, "collectionId", void 0), e([y({
  type: String
})], B.prototype, "copyright", void 0), e([y({
  readOnly: true
})], B.prototype, "defaultPopupTemplate", null), e([y({
  readOnly: true,
  type: String,
  json: {
    origins: {
      service: {
        name: "collection.description"
      }
    }
  }
})], B.prototype, "description", void 0), e([y({
  type: String
})], B.prototype, "displayField", void 0), e([y({
  type: Number
})], B.prototype, "effectiveMaxRecordCount", null), e([y(d)], B.prototype, "elevationInfo", void 0), e([y({
  type: [y2],
  json: {
    origins: {
      service: {
        name: "layerDefinition.fields"
      }
    }
  }
})], B.prototype, "fields", void 0), e([y(U.fieldsIndex)], B.prototype, "fieldsIndex", void 0), e([y({
  readOnly: true,
  type: w,
  json: {
    origins: {
      service: {
        name: "layerDefinition.extent"
      }
    }
  }
})], B.prototype, "fullExtent", void 0), e([y({
  type: o2.apiValues,
  json: {
    origins: {
      service: {
        name: "layerDefinition.geometryType",
        read: {
          reader: o2.read
        }
      }
    }
  }
})], B.prototype, "geometryType", void 0), e([y({
  type: Boolean,
  json: {
    origins: {
      service: {
        name: "layerDefinition.hasZ"
      }
    }
  }
})], B.prototype, "hasZ", void 0), e([y({
  type: Boolean,
  readOnly: true
})], B.prototype, "isTable", null), e([y({
  type: [C2],
  json: {
    origins: {
      "web-document": {
        name: "layerDefinition.drawingInfo.labelingInfo",
        read: {
          reader: l3
        },
        write: true
      }
    }
  }
})], B.prototype, "labelingInfo", void 0), e([y(l2)], B.prototype, "labelsVisible", void 0), e([y(y3)], B.prototype, "legendEnabled", void 0), e([y({
  type: Number
})], B.prototype, "maxRecordCount", void 0), e([y({
  type: String,
  json: {
    origins: {
      service: {
        name: "layerDefinition.objectIdField"
      }
    }
  }
})], B.prototype, "objectIdField", void 0), e([y({
  type: ["OGCFeatureLayer"]
})], B.prototype, "operationalLayerType", void 0), e([y(s2)], B.prototype, "popupEnabled", void 0), e([y({
  type: k2,
  json: {
    name: "popupInfo",
    write: true
  }
})], B.prototype, "popupTemplate", void 0), e([y({
  types: m2,
  json: {
    origins: {
      service: {
        name: "layerDefinition.drawingInfo.renderer",
        write: false
      },
      "web-scene": {
        types: u,
        name: "layerDefinition.drawingInfo.renderer",
        write: true
      }
    },
    name: "layerDefinition.drawingInfo.renderer",
    write: true
  }
})], B.prototype, "renderer", null), e([y(t)], B.prototype, "screenSizePerspectiveEnabled", void 0), e([y({
  readOnly: true
})], B.prototype, "source", void 0), e([y({
  readOnly: true,
  type: f,
  json: {
    origins: {
      service: {
        read: true
      }
    }
  }
})], B.prototype, "spatialReference", void 0), e([y({
  type: String,
  json: {
    write: {
      enabled: true,
      ignoreOrigin: true,
      isRequired: true
    },
    origins: {
      service: {
        name: "collection.title"
      }
    }
  }
})], B.prototype, "title", void 0), e([y({
  readOnly: true,
  json: {
    read: false
  }
})], B.prototype, "type", void 0), e([y({
  type: String,
  readOnly: true
})], B.prototype, "typeIdField", void 0), e([y({
  type: [n]
})], B.prototype, "types", void 0), e([y(p)], B.prototype, "url", void 0), B = e([a("esri.layers.OGCFeatureLayer")], B);
var V = B;
export {
  V as default
};
//# sourceMappingURL=OGCFeatureLayer-MO2K7T4M.js.map
