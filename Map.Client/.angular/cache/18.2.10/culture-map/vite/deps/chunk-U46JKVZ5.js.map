{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/views/3d/layers/support/PopupSceneLayerView.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Error.js\";\nimport \"../../../../core/Logger.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/RandomLCG.js\";\nimport { subclass as r } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { unpackFieldNames as s, populateMissingFields as a } from \"../../../../layers/support/fieldUtils.js\";\nimport { getFetchPopupTemplate as o, getRequiredFields as p } from \"../../../layers/support/popupUtils.js\";\nconst i = i => {\n  let c = class extends i {\n    _validateFetchPopupFeatures(e) {\n      const {\n          layer: r\n        } = this,\n        {\n          popupEnabled: s\n        } = r;\n      if (!s) throw new t(\"scenelayerview3d:fetchPopupFeatures\", \"Popups are disabled\", {\n        layer: r\n      });\n      if (!o(r, e)) throw new t(\"scenelayerview3d:fetchPopupFeatures\", \"Layer does not define a popup template\", {\n        layer: r\n      });\n    }\n    async prepareFetchPopupFeatures(e) {}\n    async fetchPopupFeaturesFromGraphics(e, t) {\n      if (this._validateFetchPopupFeatures(t), 0 === e.length) return [];\n      const r = \"scene\" === this.layer.type && null != this.layer.associatedLayer ? this.layer.associatedLayer : this.layer;\n      let i = [];\n      \"fieldsIndex\" in this.layer && (i = s(this.layer.fieldsIndex, await p(r, o(this.layer, t)))), await this.prepareFetchPopupFeatures(i);\n      const c = new Set(),\n        n = [],\n        l = [];\n      for (const s of e) a(i, s, c) ? l.push(s) : n.push(s);\n      if (0 === l.length) return n;\n      const u = new Map();\n      for (let s = 0; s < e.length; s++) u.set(e[s].getObjectId() ?? 0, s);\n      const h = await this.whenGraphicAttributes(l, [...c]).catch(() => l).then(e => n.concat(e));\n      return h.sort((e, t) => {\n        const r = e.getObjectId() ?? 0,\n          s = u.get(r) ?? 0,\n          a = t.getObjectId() ?? 0;\n        return s - (u.get(a) ?? 0);\n      }), h;\n    }\n  };\n  return c = e([r(\"esri.views.3d.layers.support.PopupSceneLayerView\")], c), c;\n};\nexport { i as PopupSceneLayerView };"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAYA,IAAM,IAAI,CAAAA,OAAK;AACb,MAAI,IAAI,cAAcA,GAAE;AAAA,IACtB,4BAA4BC,IAAG;AAC7B,YAAM;AAAA,QACF,OAAO;AAAA,MACT,IAAI,MACJ;AAAA,QACE,cAAcC;AAAA,MAChB,IAAI;AACN,UAAI,CAACA,GAAG,OAAM,IAAI,EAAE,uCAAuC,uBAAuB;AAAA,QAChF,OAAO;AAAA,MACT,CAAC;AACD,UAAI,CAAC,EAAE,GAAGD,EAAC,EAAG,OAAM,IAAI,EAAE,uCAAuC,0CAA0C;AAAA,QACzG,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,IACM,0BAA0BA,IAAG;AAAA;AAAA,MAAC;AAAA;AAAA,IAC9B,+BAA+BA,IAAG,GAAG;AAAA;AACzC,YAAI,KAAK,4BAA4B,CAAC,GAAG,MAAMA,GAAE,OAAQ,QAAO,CAAC;AACjE,cAAM,IAAI,YAAY,KAAK,MAAM,QAAQ,QAAQ,KAAK,MAAM,kBAAkB,KAAK,MAAM,kBAAkB,KAAK;AAChH,YAAID,KAAI,CAAC;AACT,yBAAiB,KAAK,UAAUA,KAAI,EAAE,KAAK,MAAM,aAAa,MAAM,EAAE,GAAG,EAAE,KAAK,OAAO,CAAC,CAAC,CAAC,IAAI,MAAM,KAAK,0BAA0BA,EAAC;AACpI,cAAMG,KAAI,oBAAI,IAAI,GAChBC,KAAI,CAAC,GACL,IAAI,CAAC;AACP,mBAAWF,MAAKD,GAAG,IAAED,IAAGE,IAAGC,EAAC,IAAI,EAAE,KAAKD,EAAC,IAAIE,GAAE,KAAKF,EAAC;AACpD,YAAI,MAAM,EAAE,OAAQ,QAAOE;AAC3B,cAAM,IAAI,oBAAI,IAAI;AAClB,iBAASF,KAAI,GAAGA,KAAID,GAAE,QAAQC,KAAK,GAAE,IAAID,GAAEC,EAAC,EAAE,YAAY,KAAK,GAAGA,EAAC;AACnE,cAAM,IAAI,MAAM,KAAK,sBAAsB,GAAG,CAAC,GAAGC,EAAC,CAAC,EAAE,MAAM,MAAM,CAAC,EAAE,KAAK,CAAAF,OAAKG,GAAE,OAAOH,EAAC,CAAC;AAC1F,eAAO,EAAE,KAAK,CAACA,IAAGI,OAAM;AACtB,gBAAMC,KAAIL,GAAE,YAAY,KAAK,GAC3BC,KAAI,EAAE,IAAII,EAAC,KAAK,GAChBC,KAAIF,GAAE,YAAY,KAAK;AACzB,iBAAOH,MAAK,EAAE,IAAIK,EAAC,KAAK;AAAA,QAC1B,CAAC,GAAG;AAAA,MACN;AAAA;AAAA,EACF;AACA,SAAO,IAAI,EAAE,CAAC,EAAE,kDAAkD,CAAC,GAAG,CAAC,GAAG;AAC5E;",
  "names": ["i", "e", "s", "c", "n", "t", "r", "a"]
}
