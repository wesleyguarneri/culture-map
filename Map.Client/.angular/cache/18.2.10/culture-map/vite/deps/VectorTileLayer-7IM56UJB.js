import {
  t as t3
} from "./chunk-BAAB562I.js";
import "./chunk-R27BBJA3.js";
import {
  p as p2
} from "./chunk-T64NGWGJ.js";
import "./chunk-SRFJDSP2.js";
import {
  j as j2
} from "./chunk-RTZ7XMXL.js";
import {
  l as l3
} from "./chunk-53QPRVJS.js";
import "./chunk-TXQH7JZF.js";
import "./chunk-NJSYD5KZ.js";
import "./chunk-MPUFKSB2.js";
import {
  e as e5
} from "./chunk-3NGDRCQI.js";
import "./chunk-NQEXQAS7.js";
import "./chunk-R4DKV4UN.js";
import "./chunk-SNHPS7NU.js";
import "./chunk-6HBAAUBO.js";
import "./chunk-YLE5AYZV.js";
import "./chunk-LM2N2I5R.js";
import {
  i
} from "./chunk-YTFX4PFO.js";
import {
  l as l2
} from "./chunk-DSMB46HB.js";
import {
  e as e4
} from "./chunk-73Y7XDLH.js";
import "./chunk-TCPN7AEH.js";
import "./chunk-PQ4T66BG.js";
import "./chunk-SWPHGZYB.js";
import "./chunk-IMVP5ADD.js";
import "./chunk-H7WPOTQH.js";
import {
  e as e3
} from "./chunk-B5ZW6SJE.js";
import {
  j
} from "./chunk-SJX5DIA7.js";
import "./chunk-LFKEQKEA.js";
import "./chunk-DUTZNK67.js";
import "./chunk-IN6BQCWS.js";
import "./chunk-CRNUMTSV.js";
import "./chunk-JM7HAEY6.js";
import {
  p,
  z
} from "./chunk-LJEOBI2I.js";
import "./chunk-2OMCGIU4.js";
import {
  l
} from "./chunk-OUKUASAF.js";
import "./chunk-V5RMUGJJ.js";
import "./chunk-D2NB6D6N.js";
import {
  t as t2
} from "./chunk-UWJIHV6Q.js";
import {
  b as b2
} from "./chunk-ZUSCOMQM.js";
import "./chunk-DSEUCBVP.js";
import "./chunk-UPDWQH75.js";
import {
  S
} from "./chunk-RXWBJSJ5.js";
import {
  f as f2
} from "./chunk-M2NS3MSU.js";
import "./chunk-HMNBB7ED.js";
import "./chunk-3RRMLFFN.js";
import "./chunk-DR5TVNEL.js";
import "./chunk-HT2T6PUB.js";
import "./chunk-K64AAM77.js";
import "./chunk-6EUVKE22.js";
import "./chunk-A3NNJ7XA.js";
import "./chunk-OKJHJ3CY.js";
import "./chunk-XTVPEVHA.js";
import "./chunk-DTUSTSEJ.js";
import "./chunk-JCWFGRHQ.js";
import "./chunk-JILEJ6R2.js";
import "./chunk-GAW5JHG4.js";
import "./chunk-OEKKQXBD.js";
import "./chunk-S3IO7V4Q.js";
import "./chunk-K226GFDN.js";
import "./chunk-7ZJ6P7J7.js";
import "./chunk-FPFZQCEQ.js";
import "./chunk-YVULORT6.js";
import "./chunk-PB33BAI3.js";
import "./chunk-CVB43GGP.js";
import "./chunk-LLDOZWVV.js";
import "./chunk-FYAEQPUY.js";
import "./chunk-7XMEZQ34.js";
import "./chunk-BDM2D6IC.js";
import {
  x
} from "./chunk-U2ZVAEKG.js";
import "./chunk-EDSMXTFO.js";
import "./chunk-MNLT652N.js";
import "./chunk-OGZAGPIO.js";
import "./chunk-HJJIIYFF.js";
import "./chunk-7RMVJCDW.js";
import "./chunk-T6GCUITX.js";
import "./chunk-TUIGM7TV.js";
import "./chunk-IHVSZYZS.js";
import "./chunk-6CA6K3O7.js";
import {
  w
} from "./chunk-NYQ5CYNR.js";
import {
  _,
  d as d2
} from "./chunk-O7UDKFOW.js";
import {
  f
} from "./chunk-TKPMIAIW.js";
import {
  o
} from "./chunk-NQOJNTB3.js";
import {
  r as r2
} from "./chunk-MFOQYQFG.js";
import "./chunk-NKCPFCP3.js";
import "./chunk-3ZXOUEQG.js";
import "./chunk-AXVPJBVW.js";
import "./chunk-OXEPWRM7.js";
import "./chunk-POILQGXA.js";
import {
  U as U2,
  g2 as g
} from "./chunk-JJS7PR2U.js";
import "./chunk-L5YS4GSA.js";
import "./chunk-PRREDSOB.js";
import "./chunk-V5C6HSAM.js";
import {
  Et,
  I,
  K,
  Rt,
  U,
  V,
  Y,
  pt,
  q,
  qt,
  s as s3,
  v
} from "./chunk-SYATLP3H.js";
import "./chunk-V6AMQYXE.js";
import "./chunk-6WHTZNUH.js";
import "./chunk-EITGQLII.js";
import "./chunk-TIVJXVMN.js";
import {
  d
} from "./chunk-XNUH25NY.js";
import "./chunk-WGAPNV7F.js";
import "./chunk-BXQGM56A.js";
import {
  e as e2
} from "./chunk-4Z5SGKRM.js";
import "./chunk-ANKOCGE2.js";
import {
  y
} from "./chunk-7CJXZOFG.js";
import "./chunk-IRGZKO7V.js";
import "./chunk-5SELS7VU.js";
import {
  a3,
  r2 as r
} from "./chunk-DDYVXG4F.js";
import "./chunk-ANP42J2U.js";
import {
  a as a2,
  b,
  c2 as c,
  m,
  s as s2
} from "./chunk-HJY2YILU.js";
import "./chunk-7DA6A5LD.js";
import {
  u
} from "./chunk-2MMLMOWS.js";
import "./chunk-4323ZVPF.js";
import {
  a,
  n2 as n,
  s2 as s
} from "./chunk-WYIDUUN2.js";
import {
  e3 as e,
  t4 as t
} from "./chunk-DXLOWWK7.js";
import {
  __async,
  __spreadProps,
  __spreadValues
} from "./chunk-JWIQHGQB.js";

// ../../../node_modules/@arcgis/core/layers/support/imageUtils.js
var A = null;
function o2(o4) {
  if (A) return A;
  const l7 = {
    lossy: "UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",
    lossless: "UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",
    alpha: "UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",
    animation: "UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"
  };
  return A = new Promise((A3) => {
    const n3 = new Image();
    n3.onload = () => {
      n3.onload = n3.onerror = null, A3(n3.width > 0 && n3.height > 0);
    }, n3.onerror = () => {
      n3.onload = n3.onerror = null, A3(false);
    }, n3.src = "data:image/webp;base64," + l7[o4];
  }), A;
}

// ../../../node_modules/@arcgis/core/layers/support/SpriteSource.js
var h = 1.15;
var n2 = class {
  constructor(t4, e6) {
    this._spriteSource = t4, this._maxTextureSize = e6, this.devicePixelRatio = 1, this._spriteImageFormat = "png", this._isRetina = false, this._spritesData = {}, this.image = null, this.width = null, this.height = null, this.loadStatus = "not-loaded", "url" === t4.type && t4.spriteFormat && (this._spriteImageFormat = t4.spriteFormat), t4.pixelRatio && (this.devicePixelRatio = t4.pixelRatio), this.baseURL = t4.spriteUrl;
  }
  get spriteNames() {
    const t4 = [];
    for (const e6 in this._spritesData) t4.push(e6);
    return t4.sort(), t4;
  }
  getSpriteInfo(t4) {
    return this._spritesData ? this._spritesData[t4] : null;
  }
  load(t4) {
    return __async(this, null, function* () {
      if (this.baseURL) {
        this.loadStatus = "loading";
        try {
          yield this._loadSprites(t4), this.loadStatus = "loaded";
        } catch {
          this.loadStatus = "failed";
        }
      } else this.loadStatus = "failed";
    });
  }
  _loadSprites(t4) {
    return __async(this, null, function* () {
      this._isRetina = this.devicePixelRatio > h;
      const {
        width: s5,
        height: r4,
        data: a5,
        json: o4
      } = yield this._getSpriteData(this._spriteSource, t4), n3 = Object.keys(o4);
      if (!n3 || 0 === n3.length || !a5) return this._spritesData = this.image = null, void (this.width = this.height = 0);
      this._spritesData = o4, this.width = s5, this.height = r4;
      const d5 = Math.max(this._maxTextureSize, 4096);
      if (s5 > d5 || r4 > d5) {
        const t5 = `Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${d5} pixels}`;
        throw n.getLogger("esri.layers.support.SpriteSource").error(t5), new s("SpriteSource", t5);
      }
      let p4;
      for (let e6 = 0; e6 < a5.length; e6 += 4) p4 = a5[e6 + 3] / 255, a5[e6] = a5[e6] * p4, a5[e6 + 1] = a5[e6 + 1] * p4, a5[e6 + 2] = a5[e6 + 2] * p4;
      this.image = a5;
    });
  }
  _getSpriteData(i2, n3) {
    return __async(this, null, function* () {
      if ("image" === i2.type) {
        let t4, a5;
        if (this.devicePixelRatio < h) {
          if (!i2.spriteSource1x) throw new s("SpriteSource", "no image data provided for low resolution sprites!");
          t4 = i2.spriteSource1x.image, a5 = i2.spriteSource1x.json;
        } else {
          if (!i2.spriteSource2x) throw new s("SpriteSource", "no image data provided for high resolution sprites!");
          t4 = i2.spriteSource2x.image, a5 = i2.spriteSource2x.json;
        }
        return "width" in t4 && "height" in t4 && "data" in t4 && (t(t4.data) || e(t4.data)) ? {
          width: t4.width,
          height: t4.height,
          data: new Uint8Array(t4.data),
          json: a5
        } : __spreadProps(__spreadValues({}, d3(t4)), {
          json: a5
        });
      }
      const p4 = I(this.baseURL), l7 = p4.query ? "?" + v(p4.query) : "", g3 = this._isRetina ? "@2x" : "", u3 = `${p4.path}${g3}.${this._spriteImageFormat}${l7}`, c3 = `${p4.path}${g3}.json${l7}`, [m2, S3] = yield Promise.all([U(c3, n3), U(u3, __spreadValues({
        responseType: "image"
      }, n3))]);
      return __spreadProps(__spreadValues({}, d3(S3.data)), {
        json: m2.data
      });
    });
  }
};
function d3(t4) {
  const e6 = document.createElement("canvas"), i2 = e6.getContext("2d");
  e6.width = t4.width, e6.height = t4.height, i2.drawImage(t4, 0, 0, t4.width, t4.height);
  const s5 = i2.getImageData(0, 0, t4.width, t4.height);
  return {
    width: t4.width,
    height: t4.height,
    data: new Uint8Array(s5.data)
  };
}

// ../../../node_modules/@arcgis/core/views/2d/engine/vectorTiles/TilemapIndex.js
var l4 = class {
  constructor(e6) {
    this.url = e6;
  }
  destroy() {
    this._tileIndexPromise = null;
  }
  fetchTileIndex() {
    return __async(this, null, function* () {
      return this._tileIndexPromise || (this._tileIndexPromise = U(this.url).then((e6) => e6.data.index)), this._tileIndexPromise;
    });
  }
  dataKey(e6, r4) {
    return __async(this, null, function* () {
      const l7 = yield this.fetchTileIndex();
      return s2(r4), this._getIndexedDataKey(l7, e6);
    });
  }
  _getIndexedDataKey(e6, t4) {
    const l7 = [t4];
    if (t4.level < 0 || t4.row < 0 || t4.col < 0 || t4.row >> t4.level > 0 || t4.col >> t4.level > 0) return null;
    let i2 = t4;
    for (; 0 !== i2.level; ) i2 = new e5(i2.level - 1, i2.row >> 1, i2.col >> 1, i2.world), l7.push(i2);
    let o4, s5, n3 = e6, a5 = l7.pop();
    if (1 === n3) return a5;
    for (; l7.length; ) if (o4 = l7.pop(), s5 = (1 & o4.col) + ((1 & o4.row) << 1), n3) {
      if (0 === n3[s5]) {
        a5 = null;
        break;
      }
      if (1 === n3[s5]) {
        a5 = o4;
        break;
      }
      a5 = o4, n3 = n3[s5];
    }
    return a5;
  }
};

// ../../../node_modules/@arcgis/core/views/2d/engine/vectorTiles/TilemapRequest.js
var l5 = class {
  constructor(e6, t4) {
    this._tilemap = e6, this._tileIndexUrl = t4;
  }
  destroy() {
    this._tilemap = u(this._tilemap), this._tileIndexPromise = null;
  }
  fetchTileIndex(t4) {
    return __async(this, null, function* () {
      return this._tileIndexPromise || (this._tileIndexPromise = U(this._tileIndexUrl, {
        query: __spreadValues({}, t4?.query)
      }).then((e6) => e6.data.index)), this._tileIndexPromise;
    });
  }
  dataKey(e6, t4) {
    const {
      level: l7,
      row: s5,
      col: o4
    } = e6, n3 = new e5(e6);
    return this._tilemap.fetchAvailabilityUpsample(l7, s5, o4, n3, t4).then(() => (n3.world = e6.world, n3)).catch((e7) => {
      if (b(e7)) throw e7;
      return null;
    });
  }
};

// ../../../node_modules/@arcgis/core/views/2d/engine/vectorTiles/style/VectorTilesRequestManager.js
var l6 = class {
  constructor(t4) {
    this._tileUrl = t4, this._promise = null, this._abortController = null, this._abortOptions = [];
  }
  getData(t4) {
    (null == this._promise || c(this._abortController?.signal)) && (this._promise = this._makeRequest(this._tileUrl));
    const o4 = this._abortOptions;
    return o4.push(t4), m(t4, () => {
      o4.every((t5) => c(t5)) && this._abortController.abort();
    }), this._promise.then((t5) => a(t5));
  }
  _makeRequest(r4) {
    return __async(this, null, function* () {
      this._abortController = new AbortController();
      const {
        data: o4
      } = yield U(r4, {
        responseType: "array-buffer",
        signal: this._abortController.signal
      });
      return o4;
    });
  }
};
var a4 = /* @__PURE__ */ new Map();
function c2(t4, r4, o4, e6, s5) {
  const l7 = I(t4), a5 = l7.query;
  if (a5) for (const [i2, n3] of Object.entries(a5)) switch (n3) {
    case "{x}":
      a5[i2] = e6.toString();
      break;
    case "{y}":
      a5[i2] = o4.toString();
      break;
    case "{z}":
      a5[i2] = r4.toString();
  }
  const c3 = l7.path;
  return p3(Et(c3.replaceAll(/\{z\}/gi, r4.toString()).replaceAll(/\{y\}/gi, o4.toString()).replaceAll(/\{x\}/gi, e6.toString()), __spreadValues({}, l7.query)), s5);
}
function p3(t4, r4) {
  return r(a4, t4, () => new l6(t4)).getData(r4).finally(() => a4.delete(t4));
}

// ../../../node_modules/@arcgis/core/views/2d/engine/vectorTiles/style/VectorTileSource.js
var u2 = class {
  constructor(h3, u3, m2) {
    this.tilemap = null, this.tileInfo = null, this.capabilities = null, this.fullExtent = null, this.initialExtent = null, this.name = h3, this.sourceUrl = u3;
    const f3 = I(this.sourceUrl), c3 = a(m2), x3 = c3.tiles;
    if (f3) for (let t4 = 0; t4 < x3.length; t4++) {
      const r4 = I(x3[t4]);
      r4 && (Y(r4.path) || (r4.path = V(f3.path, r4.path)), x3[t4] = Et(r4.path, __spreadValues(__spreadValues({}, f3.query), r4.query)));
    }
    this.tileServers = x3;
    const d5 = m2.capabilities && m2.capabilities.split(",").map((t4) => t4.toLowerCase().trim()), y2 = true === m2?.exportTilesAllowed, T = true === d5?.includes("tilemap"), I2 = y2 && m2.hasOwnProperty("maxExportTilesCount") ? m2.maxExportTilesCount : 0;
    this.capabilities = {
      operations: {
        supportsExportTiles: y2,
        supportsTileMap: T
      },
      exportTiles: y2 ? {
        maxExportTilesCount: +I2
      } : null
    }, this.tileInfo = z.fromJSON(c3.tileInfo);
    const g3 = m2.tileMap ? Et(V(f3.path, m2.tileMap), f3.query ?? {}) : null;
    T ? (this.type = "vector-tile", this.tilemap = new l5(new j2({
      layer: {
        parsedUrl: f3,
        tileInfo: this.tileInfo
      },
      minLOD: c3.minLOD ?? this.tileInfo.lods[0].level,
      maxLOD: c3.maxLOD ?? this.tileInfo.lods[this.tileInfo.lods.length - 1].level
    }), g3)) : g3 && (this.tilemap = new l4(g3)), this.fullExtent = w.fromJSON(m2.fullExtent), this.initialExtent = w.fromJSON(m2.initialExtent);
  }
  destroy() {
    this.tilemap?.destroy();
  }
  getRefKey(t4, e6) {
    return __async(this, null, function* () {
      return (yield this.tilemap?.dataKey(t4, e6)) ?? t4;
    });
  }
  requestTile(t4, e6, i2, l7) {
    const s5 = this.tileServers[e6 % this.tileServers.length];
    return c2(s5, t4, e6, i2, l7);
  }
  isCompatibleWith(t4) {
    const e6 = this.tileInfo, i2 = t4.tileInfo;
    if (!e6.spatialReference.equals(i2.spatialReference)) return false;
    if (!e6.origin.equals(i2.origin)) return false;
    if (Math.round(e6.dpi) !== Math.round(i2.dpi)) return false;
    const l7 = e6.lods, s5 = i2.lods, r4 = Math.min(l7.length, s5.length);
    for (let o4 = 0; o4 < r4; o4++) {
      const t5 = l7[o4], e7 = s5[o4];
      if (t5.level !== e7.level || Math.round(t5.scale) !== Math.round(e7.scale)) return false;
    }
    return true;
  }
};

// ../../../node_modules/@arcgis/core/layers/support/vectorTileLayerLoader.js
function x2(e6, t4) {
  return __async(this, null, function* () {
    const r4 = {
      source: null,
      sourceBase: null,
      sourceUrl: null,
      validatedSource: null,
      style: null,
      styleBase: null,
      styleUrl: null,
      sourceNameToSource: {},
      primarySourceName: "",
      spriteFormat: "png"
    }, [o4, s5] = "string" == typeof e6 ? [e6, null] : [null, e6.jsonUrl];
    yield S2(r4, "esri", e6, s5, t4);
    return {
      layerDefinition: r4.validatedSource,
      url: o4,
      serviceUrl: r4.sourceUrl,
      style: r4.style,
      styleUrl: r4.styleUrl,
      spriteUrl: r4.style.sprite && d4(r4.styleBase, r4.style.sprite),
      spriteFormat: r4.spriteFormat,
      glyphsUrl: r4.style.glyphs && d4(r4.styleBase, r4.style.glyphs),
      sourceNameToSource: r4.sourceNameToSource,
      primarySourceName: r4.primarySourceName
    };
  });
}
function d4(...e6) {
  let t4;
  for (const r4 of e6) if (null != r4) if (pt(r4)) {
    if (t4) {
      const e7 = t4.split("://")[0];
      t4 = e7 + ":" + r4.trim();
    }
  } else t4 = Y(r4) ? r4 : V(t4, r4);
  return t4 ? qt(t4) : void 0;
}
function S2(t4, o4, s5, l7, n3) {
  return __async(this, null, function* () {
    let u3, c3, a5;
    if (s2(n3), "string" == typeof s5) {
      const t5 = K(s5);
      a5 = yield U(t5, __spreadProps(__spreadValues({}, n3), {
        responseType: "json",
        query: __spreadValues({
          f: "json"
        }, n3?.query)
      })), a5.ssl && (u3 && (u3 = u3.replace(/^http:/i, "https:")), c3 && (c3 = c3.replace(/^http:/i, "https:"))), u3 = t5, c3 = t5;
    } else null != s5 && (a5 = {
      data: s5
    }, u3 = s5.jsonUrl || null, c3 = l7);
    const f3 = a5?.data;
    if (w2(f3)) return t4.styleUrl = u3 || null, j3(t4, f3, c3, n3);
    if (U3(f3)) return t4.sourceUrl ? g2(t4, f3, c3, false, o4, n3) : (t4.sourceUrl = u3 || null, g2(t4, f3, c3, true, o4, n3));
    throw new Error("You must specify the URL or the JSON for a service or for a style.");
  });
}
function h2(e6) {
  return "object" == typeof e6 && !!e6 && "tilejson" in e6 && null != e6.tilejson;
}
function w2(e6) {
  return !!e6 && "sources" in e6 && !!e6.sources;
}
function U3(e6) {
  return !w2(e6);
}
function j3(e6, t4, r4, o4) {
  return __async(this, null, function* () {
    const s5 = r4 ? Rt(r4) : q();
    e6.styleBase = s5, e6.style = t4, t4["sprite-format"] && "webp" === t4["sprite-format"].toLowerCase() && (e6.spriteFormat = "webp");
    const l7 = [];
    if (t4.sources && t4.sources.esri) {
      const r5 = t4.sources.esri;
      r5.url ? yield S2(e6, "esri", d4(s5, r5.url), void 0, o4) : l7.push(S2(e6, "esri", r5, s5, o4));
    }
    for (const n3 of Object.keys(t4.sources)) "esri" !== n3 && "vector" === t4.sources[n3].type && (t4.sources[n3].url ? l7.push(S2(e6, n3, d4(s5, t4.sources[n3].url), void 0, o4)) : t4.sources[n3].tiles && l7.push(S2(e6, n3, t4.sources[n3], s5, o4)));
    yield Promise.all(l7);
  });
}
function g2(e6, t4, r4, o4, s5, l7) {
  return __async(this, null, function* () {
    const i2 = r4 ? qt(r4) + "/" : q(), u3 = v2(t4), f3 = new u2(s5, Et(i2, l7?.query ?? {}), u3);
    if (!o4 && e6.primarySourceName in e6.sourceNameToSource) {
      const t5 = e6.sourceNameToSource[e6.primarySourceName];
      if (!t5.isCompatibleWith(f3)) return;
      null != f3.fullExtent && (null != t5.fullExtent ? t5.fullExtent.union(f3.fullExtent) : t5.fullExtent = f3.fullExtent.clone()), t5.tileInfo && f3.tileInfo && t5.tileInfo.lods.length < f3.tileInfo.lods.length && (t5.tileInfo = f3.tileInfo);
    }
    if (o4 && (e6.sourceBase = i2, e6.source = t4, e6.validatedSource = u3, e6.primarySourceName = s5), e6.sourceNameToSource[s5] = f3, !h2(e6) && "defaultStyles" in t4 && !e6.style) {
      if (null == t4.defaultStyles) throw new Error();
      return "string" == typeof t4.defaultStyles ? S2(e6, "", d4(i2, t4.defaultStyles, "root.json"), void 0, l7) : S2(e6, "", t4.defaultStyles, d4(i2, "root.json"), l7);
    }
  });
}
function v2(e6) {
  const r4 = 512;
  if (N(e6)) {
    const t4 = e6?.tileInfo;
    return null != t4 && (null == t4.rows && (t4.rows = r4), null == t4.cols && (t4.cols = r4)), e6;
  }
  const o4 = {
    xmin: -20037507067161843e-9,
    ymin: -20037507067161843e-9,
    xmax: 20037507067161843e-9,
    ymax: 20037507067161843e-9,
    spatialReference: {
      wkid: 102100,
      latestWkid: 3857
    }
  };
  let s5 = null;
  if (h2(e6)) {
    const {
      bounds: r5
    } = e6;
    if (r5) {
      const e7 = d2({
        x: r5[0],
        y: r5[1],
        spatialReference: a(g)
      }), o5 = d2({
        x: r5[2],
        y: r5[3],
        spatialReference: a(g)
      });
      s5 = {
        xmin: e7.x,
        ymin: e7.y,
        xmax: o5.x,
        ymax: o5.y,
        spatialReference: a(U2)
      };
    }
  }
  null === s5 && (s5 = o4);
  let l7 = 78271.51696400007, n3 = 2958287637957775e-7;
  const i2 = [], u3 = e6.hasOwnProperty("maxzoom") && null != e6.maxzoom ? +e6.maxzoom : 22, c3 = 0, a5 = 0;
  for (let t4 = 0; t4 <= u3; t4++) i2.push({
    level: t4,
    scale: n3,
    resolution: l7
  }), l7 /= 2, n3 /= 2;
  return {
    capabilities: "TilesOnly",
    initialExtent: s5,
    fullExtent: o4,
    minScale: c3,
    maxScale: a5,
    tiles: e6.tiles,
    tileInfo: {
      rows: r4,
      cols: r4,
      dpi: 96,
      format: "pbf",
      origin: {
        x: -20037508342787e-6,
        y: 20037508342787e-6
      },
      lods: i2,
      spatialReference: a(U2)
    }
  };
}
function N(e6) {
  return e6.hasOwnProperty("tileInfo");
}

// ../../../node_modules/@arcgis/core/views/2d/engine/vectorTiles/tileInfoUtils.js
var s4 = 1e-6;
function r3(l7, e6) {
  if (l7 === e6) return true;
  if (null == l7 && null != e6) return false;
  if (null != l7 && null == e6) return false;
  if (null == l7 || null == e6) return false;
  if (!l7.spatialReference.equals(e6.spatialReference) || l7.dpi !== e6.dpi) return false;
  const n3 = l7.origin, r4 = e6.origin;
  if (Math.abs(n3.x - r4.x) >= s4 || Math.abs(n3.y - r4.y) >= s4) return false;
  let o4, t4;
  l7.lods[0].scale > e6.lods[0].scale ? (o4 = l7, t4 = e6) : (t4 = l7, o4 = e6);
  for (let i2 = o4.lods[0].scale; i2 >= t4.lods[t4.lods.length - 1].scale - s4; i2 /= 2) if (Math.abs(i2 - t4.lods[0].scale) < s4) return true;
  return false;
}
function o3(s5, r4) {
  if (s5 === r4) return s5;
  if (null == s5 && null != r4) return r4;
  if (null != s5 && null == r4) return s5;
  if (null == s5 || null == r4) return null;
  const o4 = s5.size[0], t4 = s5.format, i2 = s5.dpi, u3 = new _({
    x: s5.origin.x,
    y: s5.origin.y
  }), a5 = s5.spatialReference, f3 = s5.lods[0].scale > r4.lods[0].scale ? s5.lods[0] : r4.lods[0], d5 = s5.lods[s5.lods.length - 1].scale <= r4.lods[r4.lods.length - 1].scale ? s5.lods[s5.lods.length - 1] : r4.lods[r4.lods.length - 1], c3 = f3.scale, p4 = f3.resolution, g3 = d5.scale, h3 = [];
  let m2 = c3, y2 = p4, x3 = 0;
  for (; m2 > g3; ) h3.push(new p({
    level: x3,
    resolution: y2,
    scale: m2
  })), x3++, m2 /= 2, y2 /= 2;
  return new z({
    size: [o4, o4],
    dpi: i2,
    format: t4 || "pbf",
    origin: u3,
    lods: h3,
    spatialReference: a5
  });
}

// ../../../node_modules/@arcgis/core/layers/VectorTileLayer.js
var N2 = class extends l(t2(p2(l2(b2(j(e4(i(S(f2))))))))) {
  constructor(...e6) {
    super(...e6), this._spriteSourceMap = /* @__PURE__ */ new Map(), this.currentStyleInfo = null, this.isReference = null, this.operationalLayerType = "VectorTileLayer", this.style = null, this.tilemapCache = null, this.type = "vector-tile", this.url = null, this.path = null;
  }
  normalizeCtorArgs(e6, t4) {
    return "string" == typeof e6 ? __spreadValues({
      url: e6
    }, t4) : e6;
  }
  destroy() {
    if (this.sourceNameToSource) for (const e6 of Object.values(this.sourceNameToSource)) e6?.destroy();
    this.primarySource?.destroy(), this._spriteSourceMap.clear();
  }
  prefetchResources(e6) {
    return __async(this, null, function* () {
      yield this.loadSpriteSource(globalThis.devicePixelRatio || 1, e6);
    });
  }
  load(e6) {
    const r4 = this.loadFromPortal({
      supportedTypes: ["Vector Tile Service"],
      supportsData: false
    }, e6).catch(a2).then(() => __async(this, null, function* () {
      if (!this.portalItem?.id) return;
      const r5 = `${this.portalItem.itemCdnUrl}/resources/styles/root.json`;
      (yield U(r5, __spreadProps(__spreadValues({}, e6), {
        query: __spreadProps(__spreadValues({
          f: "json"
        }, this.customParameters), {
          token: this.apiKey
        })
      }))).data && this.read({
        url: r5
      }, e3(this.portalItem, "portal-item"));
    })).catch(a2).then(() => this._loadStyle(e6));
    return this.addResolvingPromise(r4), Promise.resolve(this);
  }
  get attributionDataUrl() {
    const e6 = this.currentStyleInfo, t4 = e6?.serviceUrl && I(e6.serviceUrl);
    if (!t4) return null;
    const r4 = this._getDefaultAttribution(t4.path);
    return r4 ? Et(r4, __spreadProps(__spreadValues({}, this.customParameters), {
      token: this.apiKey
    })) : null;
  }
  get capabilities() {
    const e6 = this.primarySource;
    return e6 ? e6.capabilities : {
      operations: {
        supportsExportTiles: false,
        supportsTileMap: false
      },
      exportTiles: null
    };
  }
  get fullExtent() {
    return this.primarySource?.fullExtent || null;
  }
  get initialExtent() {
    return this.primarySource?.initialExtent || null;
  }
  get parsedUrl() {
    return this.serviceUrl ? I(this.serviceUrl) : null;
  }
  get serviceUrl() {
    return this.currentStyleInfo?.serviceUrl || null;
  }
  get spatialReference() {
    return this.tileInfo?.spatialReference ?? null;
  }
  get styleUrl() {
    return this.currentStyleInfo?.styleUrl || null;
  }
  writeStyleUrl(e6, t4) {
    e6 && pt(e6) && (e6 = `https:${e6}`);
    const r4 = s3(e6);
    t4.styleUrl = x(e6, r4);
  }
  get tileInfo() {
    const e6 = [];
    for (const r4 in this.sourceNameToSource) e6.push(this.sourceNameToSource[r4]);
    let t4 = this.primarySource?.tileInfo || new z();
    if (e6.length > 1) for (let r4 = 0; r4 < e6.length; r4++) r3(t4, e6[r4].tileInfo) && (t4 = o3(t4, e6[r4].tileInfo));
    return t4;
  }
  readTilemapCache(e6, t4) {
    const r4 = t4.capabilities?.includes("Tilemap");
    return r4 ? new j2({
      layer: this
    }) : null;
  }
  readVersion(e6, t4) {
    return t4.version ? parseFloat(t4.version) : parseFloat(t4.currentVersion);
  }
  loadSpriteSource(e6 = 1, t4) {
    return __async(this, null, function* () {
      if (!this._spriteSourceMap.has(e6)) {
        const r4 = t3().maxTextureSize, i2 = this.currentStyleInfo?.spriteUrl ? Et(this.currentStyleInfo.spriteUrl, __spreadProps(__spreadValues({}, this.customParameters), {
          token: this.apiKey
        })) : null, o4 = new n2({
          type: "url",
          spriteUrl: i2,
          pixelRatio: e6,
          spriteFormat: this.currentStyleInfo?.spriteFormat
        }, r4);
        yield o4.load(t4), this._spriteSourceMap.set(e6, o4);
      }
      return this._spriteSourceMap.get(e6);
    });
  }
  setSpriteSource(e6, t4) {
    return __async(this, null, function* () {
      if (!e6) return null;
      const r4 = t3().maxTextureSize, i2 = e6.spriteUrl, o4 = i2 ? Et(i2, __spreadProps(__spreadValues({}, this.customParameters), {
        token: this.apiKey
      })) : null;
      if (!o4 && "url" === e6.type) return null;
      const s5 = new n2(e6, r4);
      try {
        yield s5.load(t4);
        const r5 = e6.pixelRatio || 1;
        return this._spriteSourceMap.clear(), this._spriteSourceMap.set(r5, s5), o4 && this.currentStyleInfo && (this.currentStyleInfo.spriteUrl = o4), this.emit("spriteSource-change", {
          spriteSource: s5
        }), s5;
      } catch (a5) {
        a2(a5);
      }
      return null;
    });
  }
  loadStyle(e6, t4) {
    return __async(this, null, function* () {
      const i2 = e6 || this.style || this.url;
      return this._loadingTask && "string" == typeof i2 && this.url === i2 || (this._loadingTask?.abort(), this._loadingTask = d((e7) => (this._spriteSourceMap.clear(), this._getSourceAndStyle(i2, {
        signal: e7
      })), t4)), this._loadingTask.promise;
    });
  }
  getStyleLayerId(e6) {
    return this.styleRepository.getStyleLayerId(e6);
  }
  getStyleLayerIndex(e6) {
    return this.styleRepository.getStyleLayerIndex(e6);
  }
  getPaintProperties(e6) {
    return a(this.styleRepository?.getPaintProperties(e6));
  }
  setPaintProperties(e6, t4) {
    const r4 = this.styleRepository.isPainterDataDriven(e6);
    this.styleRepository.setPaintProperties(e6, t4);
    const i2 = this.styleRepository.isPainterDataDriven(e6);
    this.emit("paint-change", {
      layer: e6,
      paint: t4,
      isDataDriven: r4 || i2
    });
  }
  getStyleLayer(e6) {
    return a(this.styleRepository.getStyleLayer(e6));
  }
  setStyleLayer(e6, t4) {
    this.styleRepository.setStyleLayer(e6, t4), this.emit("style-layer-change", {
      layer: e6,
      index: t4
    });
  }
  deleteStyleLayer(e6) {
    this.styleRepository.deleteStyleLayer(e6), this.emit("delete-style-layer", {
      layer: e6
    });
  }
  getLayoutProperties(e6) {
    return a(this.styleRepository.getLayoutProperties(e6));
  }
  setLayoutProperties(e6, t4) {
    this.styleRepository.setLayoutProperties(e6, t4), this.emit("layout-change", {
      layer: e6,
      layout: t4
    });
  }
  setStyleLayerVisibility(e6, t4) {
    this.styleRepository.setStyleLayerVisibility(e6, t4), this.emit("style-layer-visibility-change", {
      layer: e6,
      visibility: t4
    });
  }
  getStyleLayerVisibility(e6) {
    return this.styleRepository.getStyleLayerVisibility(e6);
  }
  write(e6, t4) {
    return t4?.origin && !this.styleUrl ? (t4.messages && t4.messages.push(new s("vectortilelayer:unsupported", `VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`, {
      layer: this
    })), null) : super.write(e6, t4);
  }
  getTileUrl(e6, t4, r4) {
    return null;
  }
  _getSourceAndStyle(e6, t4) {
    return __async(this, null, function* () {
      if (!e6) throw new Error("invalid style!");
      const r4 = yield x2(e6, __spreadProps(__spreadValues({}, t4), {
        query: __spreadProps(__spreadValues({}, this.customParameters), {
          token: this.apiKey
        })
      }));
      if ("webp" === r4.spriteFormat) {
        (yield o2("lossy")) || (r4.spriteFormat = "png");
      }
      this._set("currentStyleInfo", __spreadValues({}, r4)), "string" == typeof e6 ? (this.url = e6, this.style = null) : (this.url = null, this.style = e6), this._set("sourceNameToSource", r4.sourceNameToSource), this._set("primarySource", r4.sourceNameToSource[r4.primarySourceName]), this._set("styleRepository", new l3(r4.style)), this.read(r4.layerDefinition, {
        origin: "service"
      }), this.emit("load-style");
    });
  }
  _getDefaultAttribution(e6) {
    const t4 = e6.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i), r4 = ["OpenStreetMap_v2", "OpenStreetMap_Daylight_v2", "OpenStreetMap_Export_v2", "OpenStreetMap_FTS_v2", "OpenStreetMap_GCS_v2", "World_Basemap", "World_Basemap_v2", "World_Basemap_Export_v2", "World_Basemap_GCS_v2", "World_Basemap_WGS84", "World_Contours_v2", "World_Hillshade_v2"];
    if (!t4) return;
    const i2 = t4[2] && t4[2].toLowerCase();
    if (!i2) return;
    const o4 = t4[1] || "";
    for (const s5 of r4) if (s5.toLowerCase().includes(i2)) return K(`//static.arcgis.com/attribution/Vector${o4}/${s5}`);
  }
  _loadStyle(e6) {
    return __async(this, null, function* () {
      return this._loadingTask?.promise ?? this.loadStyle(null, e6);
    });
  }
};
e2([y({
  readOnly: true
})], N2.prototype, "attributionDataUrl", null), e2([y({
  type: ["show", "hide"]
})], N2.prototype, "listMode", void 0), e2([y({
  json: {
    read: true,
    write: true
  }
})], N2.prototype, "blendMode", void 0), e2([y({
  readOnly: true,
  json: {
    read: false
  }
})], N2.prototype, "capabilities", null), e2([y({
  readOnly: true
})], N2.prototype, "currentStyleInfo", void 0), e2([y({
  json: {
    read: false
  },
  readOnly: true,
  type: w
})], N2.prototype, "fullExtent", null), e2([y({
  json: {
    read: false
  },
  readOnly: true,
  type: w
})], N2.prototype, "initialExtent", null), e2([y({
  type: Boolean,
  json: {
    read: false,
    write: {
      enabled: true,
      overridePolicy: () => ({
        enabled: false
      })
    }
  }
})], N2.prototype, "isReference", void 0), e2([y({
  type: ["VectorTileLayer"]
})], N2.prototype, "operationalLayerType", void 0), e2([y({
  readOnly: true
})], N2.prototype, "parsedUrl", null), e2([y()], N2.prototype, "style", void 0), e2([y({
  readOnly: true
})], N2.prototype, "serviceUrl", null), e2([y({
  type: f,
  readOnly: true
})], N2.prototype, "spatialReference", null), e2([y({
  readOnly: true
})], N2.prototype, "styleRepository", void 0), e2([y({
  readOnly: true
})], N2.prototype, "sourceNameToSource", void 0), e2([y({
  readOnly: true
})], N2.prototype, "primarySource", void 0), e2([y({
  type: String,
  readOnly: true,
  json: {
    write: {
      ignoreOrigin: true
    },
    origins: {
      "web-document": {
        write: {
          ignoreOrigin: true,
          isRequired: true
        }
      }
    }
  }
})], N2.prototype, "styleUrl", null), e2([r2(["portal-item", "web-document"], "styleUrl")], N2.prototype, "writeStyleUrl", null), e2([y({
  json: {
    read: false,
    origins: {
      service: {
        read: false
      }
    }
  },
  readOnly: true,
  type: z
})], N2.prototype, "tileInfo", null), e2([y()], N2.prototype, "tilemapCache", void 0), e2([o("service", "tilemapCache", ["capabilities", "tileInfo"])], N2.prototype, "readTilemapCache", null), e2([y({
  json: {
    read: false
  },
  readOnly: true,
  value: "vector-tile"
})], N2.prototype, "type", void 0), e2([y({
  json: {
    origins: {
      "web-document": {
        read: {
          source: "styleUrl"
        }
      },
      "portal-item": {
        read: {
          source: "url"
        }
      }
    },
    write: false,
    read: false
  }
})], N2.prototype, "url", void 0), e2([y({
  readOnly: true
})], N2.prototype, "version", void 0), e2([o("version", ["version", "currentVersion"])], N2.prototype, "readVersion", null), e2([y({
  type: String,
  json: {
    origins: {
      "web-scene": {
        read: true,
        write: true
      }
    },
    read: false
  }
})], N2.prototype, "path", void 0), N2 = e2([a3("esri.layers.VectorTileLayer")], N2);
var A2 = N2;
export {
  A2 as default
};
//# sourceMappingURL=VectorTileLayer-7IM56UJB.js.map
