{
  "version": 3,
  "sources": ["../../../../../../node_modules/@arcgis/core/rest/support/meshFeatureSet.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from \"../../Graphic.js\";\nimport t from \"../../core/Logger.js\";\nimport { getOrCreateMapValue as r } from \"../../core/MapUtils.js\";\nimport o from \"../../geometry/Extent.js\";\nimport n from \"../../geometry/Mesh.js\";\nimport s from \"../../geometry/Point.js\";\nimport a from \"../../geometry/SpatialReference.js\";\nimport i from \"../../geometry/support/MeshTransform.js\";\nimport { ServiceAssetPart as u, ServiceAsset as f } from \"../../geometry/support/meshUtils/External.js\";\nimport { getFormatIdMimeType as c } from \"../../layers/support/infoFor3D.js\";\nimport l from \"./FeatureSet.js\";\nconst m = () => t.getLogger(\"esri.rest.support.meshFeatureSet\");\nfunction p(t, r, o) {\n  const n = o.features;\n  o.features = [], delete o.geometryType;\n  const s = l.fromJSON(o);\n  if (s.geometryType = \"mesh\", !o.assetMaps) return s;\n  const i = d(r, o.assetMaps),\n    u = t.sourceSpatialReference ?? a.WGS84,\n    f = o.globalIdFieldName,\n    {\n      outFields: c\n    } = t,\n    m = null != c && c.length > 0 ? g(c.includes(\"*\") ? null : new Set(c)) : () => ({});\n  for (const a of n) {\n    const t = y(a, f, u, r, i);\n    s.features.push(new e({\n      geometry: t,\n      attributes: m(a)\n    }));\n  }\n  return s;\n}\nfunction g(e) {\n  return ({\n    attributes: t\n  }) => {\n    if (!t) return {};\n    if (!e) return t;\n    for (const r in t) e.has(r) || delete t[r];\n    return t;\n  };\n}\nfunction y(e, t, r, s, a) {\n  const i = e.attributes[t],\n    u = a.get(i);\n  if (null == u || !e.geometry) return null;\n  const f = E(e, r, s),\n    c = o.fromJSON(e.geometry);\n  c.spatialReference = r;\n  const l = h(e.attributes, s),\n    m = r.isGeographic ? \"local\" : \"georeferenced\",\n    p = D(u);\n  return p ? n.createWithExternalSource(f, p, {\n    extent: c,\n    transform: l,\n    vertexSpace: m\n  }) : n.createIncomplete(f, {\n    extent: c,\n    transform: l,\n    vertexSpace: m\n  });\n}\nfunction E({\n  attributes: e\n}, t, {\n  transformFieldRoles: r\n}) {\n  const o = e[r.originX],\n    n = e[r.originY],\n    a = e[r.originZ];\n  return new s({\n    x: o,\n    y: n,\n    z: a,\n    spatialReference: t\n  });\n}\nfunction h(e, {\n  transformFieldRoles: t\n}) {\n  return new i({\n    translation: [e[t.translationX], -e[t.translationZ], e[t.translationY]],\n    rotationAxis: [e[t.rotationX], -e[t.rotationZ], e[t.rotationY]],\n    rotationAngle: e[t.rotationDeg],\n    scale: [e[t.scaleX], e[t.scaleZ], e[t.scaleY]]\n  });\n}\nvar S;\nfunction d(e, t) {\n  const o = new Map();\n  for (const n of t) {\n    const t = n.parentGlobalId;\n    if (null == t) continue;\n    const s = n.assetName,\n      a = n.assetType,\n      i = n.assetHash,\n      u = n.assetURL,\n      f = n.conversionStatus,\n      l = n.seqNo,\n      p = c(a, e.supportedFormats);\n    if (!p) {\n      m().error(\"mesh-feature-set:unknown-format\", `Service returned an asset of type ${a}, but it does not list it as a supported type`);\n      continue;\n    }\n    const g = r(o, t, () => ({\n      files: new Map()\n    }));\n    r(g.files, s, () => ({\n      name: s,\n      type: a,\n      mimeType: p,\n      status: M(f),\n      parts: []\n    })).parts[l] = {\n      hash: i,\n      url: u\n    };\n  }\n  return o;\n}\nfunction D(e) {\n  const t = Array.from(e.files.values()),\n    r = new Array();\n  for (const o of t) {\n    if (o.status !== S.COMPLETED) return null;\n    const e = new Array();\n    for (const t of o.parts) {\n      if (!t) return null;\n      e.push(new u(t.url, t.hash));\n    }\n    r.push(new f(o.name, o.mimeType, e));\n  }\n  return r;\n}\nfunction M(e) {\n  switch (e) {\n    case \"COMPLETED\":\n    case \"SUBMITTED\":\n      return S.COMPLETED;\n    case \"INPROGRESS\":\n      return S.PENDING;\n    default:\n      return S.FAILED;\n  }\n}\n!function (e) {\n  e[e.FAILED = 0] = \"FAILED\", e[e.PENDING = 1] = \"PENDING\", e[e.COMPLETED = 2] = \"COMPLETED\";\n}(S || (S = {}));\nexport { d as assetMapFromAssetMapsJSON, y as extractMesh, p as meshFeatureSetFromJSON };"],
  "mappings": "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",
  "names": ["r", "o", "n", "s", "d", "i", "f", "m", "t", "p", "g", "e"]
}
